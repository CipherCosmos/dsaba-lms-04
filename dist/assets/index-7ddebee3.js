var Ry=Object.defineProperty;var Iy=(t,e,s)=>e in t?Ry(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var Re=(t,e,s)=>(Iy(t,typeof e!="symbol"?e+"":e,s),s);import{r as G,a as Ly,b as at,g as By}from"./vendor-280e31ee.js";import{c as He,a as Oa,u as vt,b as ge,_ as ep,d as Uy,P as $y}from"./redux-89e29039.js";import{L as Ps,u as Wy,a as Vy,R as zy,b as Ft,N as Hy,B as Gy}from"./router-6dcf552f.js";import{D as kr,X as tp,S as Xy,M as qy,W as Yy,a as Ky,C as Ot,A as Sn,z as Ue,b as Ad,G as ia,U as bn,L as Jy,E as xi,c as pi,d as Zy,e as io,B as Sr,f as Ct,g as gt,h as Cs,T as Rt,i as rs,j as Pt,k as Mt,l as lo,m as j0,n as Si,o as co,p as oo,q as Qa,r as ba,s as Qy,t as eb,u as tb,P as sp,F as Fr,v as sb,w as rb,x as fo,y as k0,H as rp,I as ab,J as nb,K as ap,N as ib,O as lb,Q as Na,R as Xl,V as la,Y as cb,Z as Xo,_ as Oi,$ as ob,a0 as hc,a1 as Lu,a2 as mc,a3 as Bu,a4 as db,a5 as S0,a6 as fb,a7 as ub,a8 as uo,a9 as Uu,aa as hb,ab as mb,ac as xb,ad as pb,ae as gb,af as vb}from"./ui-b342c19d.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var np={exports:{}},qo={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yb=G,bb=Symbol.for("react.element"),_b=Symbol.for("react.fragment"),wb=Object.prototype.hasOwnProperty,Nb=yb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jb={key:!0,ref:!0,__self:!0,__source:!0};function ip(t,e,s){var r,a={},i=null,l=null;s!==void 0&&(i=""+s),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)wb.call(e,r)&&!jb.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:bb,type:t,key:i,ref:l,props:a,_owner:Nb.current}}qo.Fragment=_b;qo.jsx=ip;qo.jsxs=ip;np.exports=qo;var n=np.exports,E0={},$u=Ly;E0.createRoot=$u.createRoot,E0.hydrateRoot=$u.hydrateRoot;function lp(t,e){return function(){return t.apply(e,arguments)}}const{toString:kb}=Object.prototype,{getPrototypeOf:of}=Object,{iterator:Yo,toStringTag:cp}=Symbol,Ko=(t=>e=>{const s=kb.call(e);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Vr=t=>(t=t.toLowerCase(),e=>Ko(e)===t),Jo=t=>e=>typeof e===t,{isArray:Di}=Array,jl=Jo("undefined");function ql(t){return t!==null&&!jl(t)&&t.constructor!==null&&!jl(t.constructor)&&nr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const op=Vr("ArrayBuffer");function Sb(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&op(t.buffer),e}const Eb=Jo("string"),nr=Jo("function"),dp=Jo("number"),Yl=t=>t!==null&&typeof t=="object",Tb=t=>t===!0||t===!1,Wc=t=>{if(Ko(t)!=="object")return!1;const e=of(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(cp in t)&&!(Yo in t)},Cb=t=>{if(!Yl(t)||ql(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Ab=Vr("Date"),Fb=Vr("File"),Ob=Vr("Blob"),Db=Vr("FileList"),Pb=t=>Yl(t)&&nr(t.pipe),Mb=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||nr(t.append)&&((e=Ko(t))==="formdata"||e==="object"&&nr(t.toString)&&t.toString()==="[object FormData]"))},Rb=Vr("URLSearchParams"),[Ib,Lb,Bb,Ub]=["ReadableStream","Request","Response","Headers"].map(Vr),$b=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Kl(t,e,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let r,a;if(typeof t!="object"&&(t=[t]),Di(t))for(r=0,a=t.length;r<a;r++)e.call(null,t[r],r,t);else{if(ql(t))return;const i=s?Object.getOwnPropertyNames(t):Object.keys(t),l=i.length;let c;for(r=0;r<l;r++)c=i[r],e.call(null,t[c],c,t)}}function fp(t,e){if(ql(t))return null;e=e.toLowerCase();const s=Object.keys(t);let r=s.length,a;for(;r-- >0;)if(a=s[r],e===a.toLowerCase())return a;return null}const _n=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),up=t=>!jl(t)&&t!==_n;function T0(){const{caseless:t}=up(this)&&this||{},e={},s=(r,a)=>{const i=t&&fp(e,a)||a;Wc(e[i])&&Wc(r)?e[i]=T0(e[i],r):Wc(r)?e[i]=T0({},r):Di(r)?e[i]=r.slice():e[i]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&Kl(arguments[r],s);return e}const Wb=(t,e,s,{allOwnKeys:r}={})=>(Kl(e,(a,i)=>{s&&nr(a)?t[i]=lp(a,s):t[i]=a},{allOwnKeys:r}),t),Vb=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),zb=(t,e,s,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),s&&Object.assign(t.prototype,s)},Hb=(t,e,s,r)=>{let a,i,l;const c={};if(e=e||{},t==null)return e;do{for(a=Object.getOwnPropertyNames(t),i=a.length;i-- >0;)l=a[i],(!r||r(l,t,e))&&!c[l]&&(e[l]=t[l],c[l]=!0);t=s!==!1&&of(t)}while(t&&(!s||s(t,e))&&t!==Object.prototype);return e},Gb=(t,e,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=e.length;const r=t.indexOf(e,s);return r!==-1&&r===s},Xb=t=>{if(!t)return null;if(Di(t))return t;let e=t.length;if(!dp(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=t[e];return s},qb=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&of(Uint8Array)),Yb=(t,e)=>{const r=(t&&t[Yo]).call(t);let a;for(;(a=r.next())&&!a.done;){const i=a.value;e.call(t,i[0],i[1])}},Kb=(t,e)=>{let s;const r=[];for(;(s=t.exec(e))!==null;)r.push(s);return r},Jb=Vr("HTMLFormElement"),Zb=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,a){return r.toUpperCase()+a}),Wu=(({hasOwnProperty:t})=>(e,s)=>t.call(e,s))(Object.prototype),Qb=Vr("RegExp"),hp=(t,e)=>{const s=Object.getOwnPropertyDescriptors(t),r={};Kl(s,(a,i)=>{let l;(l=e(a,i,t))!==!1&&(r[i]=l||a)}),Object.defineProperties(t,r)},e_=t=>{hp(t,(e,s)=>{if(nr(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=t[s];if(nr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},t_=(t,e)=>{const s={},r=a=>{a.forEach(i=>{s[i]=!0})};return Di(t)?r(t):r(String(t).split(e)),s},s_=()=>{},r_=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function a_(t){return!!(t&&nr(t.append)&&t[cp]==="FormData"&&t[Yo])}const n_=t=>{const e=new Array(10),s=(r,a)=>{if(Yl(r)){if(e.indexOf(r)>=0)return;if(ql(r))return r;if(!("toJSON"in r)){e[a]=r;const i=Di(r)?[]:{};return Kl(r,(l,c)=>{const o=s(l,a+1);!jl(o)&&(i[c]=o)}),e[a]=void 0,i}}return r};return s(t,0)},i_=Vr("AsyncFunction"),l_=t=>t&&(Yl(t)||nr(t))&&nr(t.then)&&nr(t.catch),mp=((t,e)=>t?setImmediate:e?((s,r)=>(_n.addEventListener("message",({source:a,data:i})=>{a===_n&&i===s&&r.length&&r.shift()()},!1),a=>{r.push(a),_n.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",nr(_n.postMessage)),c_=typeof queueMicrotask<"u"?queueMicrotask.bind(_n):typeof process<"u"&&process.nextTick||mp,o_=t=>t!=null&&nr(t[Yo]),ie={isArray:Di,isArrayBuffer:op,isBuffer:ql,isFormData:Mb,isArrayBufferView:Sb,isString:Eb,isNumber:dp,isBoolean:Tb,isObject:Yl,isPlainObject:Wc,isEmptyObject:Cb,isReadableStream:Ib,isRequest:Lb,isResponse:Bb,isHeaders:Ub,isUndefined:jl,isDate:Ab,isFile:Fb,isBlob:Ob,isRegExp:Qb,isFunction:nr,isStream:Pb,isURLSearchParams:Rb,isTypedArray:qb,isFileList:Db,forEach:Kl,merge:T0,extend:Wb,trim:$b,stripBOM:Vb,inherits:zb,toFlatObject:Hb,kindOf:Ko,kindOfTest:Vr,endsWith:Gb,toArray:Xb,forEachEntry:Yb,matchAll:Kb,isHTMLForm:Jb,hasOwnProperty:Wu,hasOwnProp:Wu,reduceDescriptors:hp,freezeMethods:e_,toObjectSet:t_,toCamelCase:Zb,noop:s_,toFiniteNumber:r_,findKey:fp,global:_n,isContextDefined:up,isSpecCompliantForm:a_,toJSONObject:n_,isAsyncFn:i_,isThenable:l_,setImmediate:mp,asap:c_,isIterable:o_};function et(t,e,s,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}ie.inherits(et,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ie.toJSONObject(this.config),code:this.code,status:this.status}}});const xp=et.prototype,pp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{pp[t]={value:t}});Object.defineProperties(et,pp);Object.defineProperty(xp,"isAxiosError",{value:!0});et.from=(t,e,s,r,a,i)=>{const l=Object.create(xp);return ie.toFlatObject(t,l,function(o){return o!==Error.prototype},c=>c!=="isAxiosError"),et.call(l,t.message,e,s,r,a),l.cause=t,l.name=t.name,i&&Object.assign(l,i),l};const d_=null;function C0(t){return ie.isPlainObject(t)||ie.isArray(t)}function gp(t){return ie.endsWith(t,"[]")?t.slice(0,-2):t}function Vu(t,e,s){return t?t.concat(e).map(function(a,i){return a=gp(a),!s&&i?"["+a+"]":a}).join(s?".":""):e}function f_(t){return ie.isArray(t)&&!t.some(C0)}const u_=ie.toFlatObject(ie,{},null,function(e){return/^is[A-Z]/.test(e)});function Zo(t,e,s){if(!ie.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,s=ie.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,v){return!ie.isUndefined(v[p])});const r=s.metaTokens,a=s.visitor||f,i=s.dots,l=s.indexes,o=(s.Blob||typeof Blob<"u"&&Blob)&&ie.isSpecCompliantForm(e);if(!ie.isFunction(a))throw new TypeError("visitor must be a function");function d(m){if(m===null)return"";if(ie.isDate(m))return m.toISOString();if(ie.isBoolean(m))return m.toString();if(!o&&ie.isBlob(m))throw new et("Blob is not supported. Use a Buffer instead.");return ie.isArrayBuffer(m)||ie.isTypedArray(m)?o&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function f(m,p,v){let b=m;if(m&&!v&&typeof m=="object"){if(ie.endsWith(p,"{}"))p=r?p:p.slice(0,-2),m=JSON.stringify(m);else if(ie.isArray(m)&&f_(m)||(ie.isFileList(m)||ie.endsWith(p,"[]"))&&(b=ie.toArray(m)))return p=gp(p),b.forEach(function(g,j){!(ie.isUndefined(g)||g===null)&&e.append(l===!0?Vu([p],j,i):l===null?p:p+"[]",d(g))}),!1}return C0(m)?!0:(e.append(Vu(v,p,i),d(m)),!1)}const u=[],h=Object.assign(u_,{defaultVisitor:f,convertValue:d,isVisitable:C0});function x(m,p){if(!ie.isUndefined(m)){if(u.indexOf(m)!==-1)throw Error("Circular reference detected in "+p.join("."));u.push(m),ie.forEach(m,function(b,_){(!(ie.isUndefined(b)||b===null)&&a.call(e,b,ie.isString(_)?_.trim():_,p,h))===!0&&x(b,p?p.concat(_):[_])}),u.pop()}}if(!ie.isObject(t))throw new TypeError("data must be an object");return x(t),e}function zu(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function df(t,e){this._pairs=[],t&&Zo(t,this,e)}const vp=df.prototype;vp.append=function(e,s){this._pairs.push([e,s])};vp.toString=function(e){const s=e?function(r){return e.call(this,r,zu)}:zu;return this._pairs.map(function(a){return s(a[0])+"="+s(a[1])},"").join("&")};function h_(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function yp(t,e,s){if(!e)return t;const r=s&&s.encode||h_;ie.isFunction(s)&&(s={serialize:s});const a=s&&s.serialize;let i;if(a?i=a(e,s):i=ie.isURLSearchParams(e)?e.toString():new df(e,s).toString(r),i){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class m_{constructor(){this.handlers=[]}use(e,s,r){return this.handlers.push({fulfilled:e,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ie.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Hu=m_,bp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},x_=typeof URLSearchParams<"u"?URLSearchParams:df,p_=typeof FormData<"u"?FormData:null,g_=typeof Blob<"u"?Blob:null,v_={isBrowser:!0,classes:{URLSearchParams:x_,FormData:p_,Blob:g_},protocols:["http","https","file","blob","url","data"]},ff=typeof window<"u"&&typeof document<"u",A0=typeof navigator=="object"&&navigator||void 0,y_=ff&&(!A0||["ReactNative","NativeScript","NS"].indexOf(A0.product)<0),b_=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),__=ff&&window.location.href||"http://localhost",w_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ff,hasStandardBrowserEnv:y_,hasStandardBrowserWebWorkerEnv:b_,navigator:A0,origin:__},Symbol.toStringTag,{value:"Module"})),Is={...w_,...v_};function N_(t,e){return Zo(t,new Is.classes.URLSearchParams,{visitor:function(s,r,a,i){return Is.isNode&&ie.isBuffer(s)?(this.append(r,s.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function j_(t){return ie.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function k_(t){const e={},s=Object.keys(t);let r;const a=s.length;let i;for(r=0;r<a;r++)i=s[r],e[i]=t[i];return e}function _p(t){function e(s,r,a,i){let l=s[i++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),o=i>=s.length;return l=!l&&ie.isArray(a)?a.length:l,o?(ie.hasOwnProp(a,l)?a[l]=[a[l],r]:a[l]=r,!c):((!a[l]||!ie.isObject(a[l]))&&(a[l]=[]),e(s,r,a[l],i)&&ie.isArray(a[l])&&(a[l]=k_(a[l])),!c)}if(ie.isFormData(t)&&ie.isFunction(t.entries)){const s={};return ie.forEachEntry(t,(r,a)=>{e(j_(r),a,s,0)}),s}return null}function S_(t,e,s){if(ie.isString(t))try{return(e||JSON.parse)(t),ie.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(s||JSON.stringify)(t)}const uf={transitional:bp,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const r=s.getContentType()||"",a=r.indexOf("application/json")>-1,i=ie.isObject(e);if(i&&ie.isHTMLForm(e)&&(e=new FormData(e)),ie.isFormData(e))return a?JSON.stringify(_p(e)):e;if(ie.isArrayBuffer(e)||ie.isBuffer(e)||ie.isStream(e)||ie.isFile(e)||ie.isBlob(e)||ie.isReadableStream(e))return e;if(ie.isArrayBufferView(e))return e.buffer;if(ie.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let c;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return N_(e,this.formSerializer).toString();if((c=ie.isFileList(e))||r.indexOf("multipart/form-data")>-1){const o=this.env&&this.env.FormData;return Zo(c?{"files[]":e}:e,o&&new o,this.formSerializer)}}return i||a?(s.setContentType("application/json",!1),S_(e)):e}],transformResponse:[function(e){const s=this.transitional||uf.transitional,r=s&&s.forcedJSONParsing,a=this.responseType==="json";if(ie.isResponse(e)||ie.isReadableStream(e))return e;if(e&&ie.isString(e)&&(r&&!this.responseType||a)){const l=!(s&&s.silentJSONParsing)&&a;try{return JSON.parse(e)}catch(c){if(l)throw c.name==="SyntaxError"?et.from(c,et.ERR_BAD_RESPONSE,this,null,this.response):c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Is.classes.FormData,Blob:Is.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ie.forEach(["delete","get","head","post","put","patch"],t=>{uf.headers[t]={}});const hf=uf,E_=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),T_=t=>{const e={};let s,r,a;return t&&t.split(`
`).forEach(function(l){a=l.indexOf(":"),s=l.substring(0,a).trim().toLowerCase(),r=l.substring(a+1).trim(),!(!s||e[s]&&E_[s])&&(s==="set-cookie"?e[s]?e[s].push(r):e[s]=[r]:e[s]=e[s]?e[s]+", "+r:r)}),e},Gu=Symbol("internals");function zi(t){return t&&String(t).trim().toLowerCase()}function Vc(t){return t===!1||t==null?t:ie.isArray(t)?t.map(Vc):String(t)}function C_(t){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(t);)e[r[1]]=r[2];return e}const A_=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Fd(t,e,s,r,a){if(ie.isFunction(r))return r.call(this,e,s);if(a&&(e=s),!!ie.isString(e)){if(ie.isString(r))return e.indexOf(r)!==-1;if(ie.isRegExp(r))return r.test(e)}}function F_(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,r)=>s.toUpperCase()+r)}function O_(t,e){const s=ie.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+s,{value:function(a,i,l){return this[r].call(this,e,a,i,l)},configurable:!0})})}class Qo{constructor(e){e&&this.set(e)}set(e,s,r){const a=this;function i(c,o,d){const f=zi(o);if(!f)throw new Error("header name must be a non-empty string");const u=ie.findKey(a,f);(!u||a[u]===void 0||d===!0||d===void 0&&a[u]!==!1)&&(a[u||o]=Vc(c))}const l=(c,o)=>ie.forEach(c,(d,f)=>i(d,f,o));if(ie.isPlainObject(e)||e instanceof this.constructor)l(e,s);else if(ie.isString(e)&&(e=e.trim())&&!A_(e))l(T_(e),s);else if(ie.isObject(e)&&ie.isIterable(e)){let c={},o,d;for(const f of e){if(!ie.isArray(f))throw TypeError("Object iterator must return a key-value pair");c[d=f[0]]=(o=c[d])?ie.isArray(o)?[...o,f[1]]:[o,f[1]]:f[1]}l(c,s)}else e!=null&&i(s,e,r);return this}get(e,s){if(e=zi(e),e){const r=ie.findKey(this,e);if(r){const a=this[r];if(!s)return a;if(s===!0)return C_(a);if(ie.isFunction(s))return s.call(this,a,r);if(ie.isRegExp(s))return s.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=zi(e),e){const r=ie.findKey(this,e);return!!(r&&this[r]!==void 0&&(!s||Fd(this,this[r],r,s)))}return!1}delete(e,s){const r=this;let a=!1;function i(l){if(l=zi(l),l){const c=ie.findKey(r,l);c&&(!s||Fd(r,r[c],c,s))&&(delete r[c],a=!0)}}return ie.isArray(e)?e.forEach(i):i(e),a}clear(e){const s=Object.keys(this);let r=s.length,a=!1;for(;r--;){const i=s[r];(!e||Fd(this,this[i],i,e,!0))&&(delete this[i],a=!0)}return a}normalize(e){const s=this,r={};return ie.forEach(this,(a,i)=>{const l=ie.findKey(r,i);if(l){s[l]=Vc(a),delete s[i];return}const c=e?F_(i):String(i).trim();c!==i&&delete s[i],s[c]=Vc(a),r[c]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return ie.forEach(this,(r,a)=>{r!=null&&r!==!1&&(s[a]=e&&ie.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const r=new this(e);return s.forEach(a=>r.set(a)),r}static accessor(e){const r=(this[Gu]=this[Gu]={accessors:{}}).accessors,a=this.prototype;function i(l){const c=zi(l);r[c]||(O_(a,l),r[c]=!0)}return ie.isArray(e)?e.forEach(i):i(e),this}}Qo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ie.reduceDescriptors(Qo.prototype,({value:t},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[s]=r}}});ie.freezeMethods(Qo);const Ir=Qo;function Od(t,e){const s=this||hf,r=e||s,a=Ir.from(r.headers);let i=r.data;return ie.forEach(t,function(c){i=c.call(s,i,a.normalize(),e?e.status:void 0)}),a.normalize(),i}function wp(t){return!!(t&&t.__CANCEL__)}function Pi(t,e,s){et.call(this,t??"canceled",et.ERR_CANCELED,e,s),this.name="CanceledError"}ie.inherits(Pi,et,{__CANCEL__:!0});function Np(t,e,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?t(s):e(new et("Request failed with status code "+s.status,[et.ERR_BAD_REQUEST,et.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function D_(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function P_(t,e){t=t||10;const s=new Array(t),r=new Array(t);let a=0,i=0,l;return e=e!==void 0?e:1e3,function(o){const d=Date.now(),f=r[i];l||(l=d),s[a]=o,r[a]=d;let u=i,h=0;for(;u!==a;)h+=s[u++],u=u%t;if(a=(a+1)%t,a===i&&(i=(i+1)%t),d-l<e)return;const x=f&&d-f;return x?Math.round(h*1e3/x):void 0}}function M_(t,e){let s=0,r=1e3/e,a,i;const l=(d,f=Date.now())=>{s=f,a=null,i&&(clearTimeout(i),i=null),t(...d)};return[(...d)=>{const f=Date.now(),u=f-s;u>=r?l(d,f):(a=d,i||(i=setTimeout(()=>{i=null,l(a)},r-u)))},()=>a&&l(a)]}const ho=(t,e,s=3)=>{let r=0;const a=P_(50,250);return M_(i=>{const l=i.loaded,c=i.lengthComputable?i.total:void 0,o=l-r,d=a(o),f=l<=c;r=l;const u={loaded:l,total:c,progress:c?l/c:void 0,bytes:o,rate:d||void 0,estimated:d&&c&&f?(c-l)/d:void 0,event:i,lengthComputable:c!=null,[e?"download":"upload"]:!0};t(u)},s)},Xu=(t,e)=>{const s=t!=null;return[r=>e[0]({lengthComputable:s,total:t,loaded:r}),e[1]]},qu=t=>(...e)=>ie.asap(()=>t(...e)),R_=Is.hasStandardBrowserEnv?((t,e)=>s=>(s=new URL(s,Is.origin),t.protocol===s.protocol&&t.host===s.host&&(e||t.port===s.port)))(new URL(Is.origin),Is.navigator&&/(msie|trident)/i.test(Is.navigator.userAgent)):()=>!0,I_=Is.hasStandardBrowserEnv?{write(t,e,s,r,a,i){const l=[t+"="+encodeURIComponent(e)];ie.isNumber(s)&&l.push("expires="+new Date(s).toGMTString()),ie.isString(r)&&l.push("path="+r),ie.isString(a)&&l.push("domain="+a),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function L_(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function B_(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function jp(t,e,s){let r=!L_(e);return t&&(r||s==!1)?B_(t,e):e}const Yu=t=>t instanceof Ir?{...t}:t;function Mn(t,e){e=e||{};const s={};function r(d,f,u,h){return ie.isPlainObject(d)&&ie.isPlainObject(f)?ie.merge.call({caseless:h},d,f):ie.isPlainObject(f)?ie.merge({},f):ie.isArray(f)?f.slice():f}function a(d,f,u,h){if(ie.isUndefined(f)){if(!ie.isUndefined(d))return r(void 0,d,u,h)}else return r(d,f,u,h)}function i(d,f){if(!ie.isUndefined(f))return r(void 0,f)}function l(d,f){if(ie.isUndefined(f)){if(!ie.isUndefined(d))return r(void 0,d)}else return r(void 0,f)}function c(d,f,u){if(u in e)return r(d,f);if(u in t)return r(void 0,d)}const o={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(d,f,u)=>a(Yu(d),Yu(f),u,!0)};return ie.forEach(Object.keys({...t,...e}),function(f){const u=o[f]||a,h=u(t[f],e[f],f);ie.isUndefined(h)&&u!==c||(s[f]=h)}),s}const kp=t=>{const e=Mn({},t);let{data:s,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:i,headers:l,auth:c}=e;e.headers=l=Ir.from(l),e.url=yp(jp(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let o;if(ie.isFormData(s)){if(Is.hasStandardBrowserEnv||Is.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((o=l.getContentType())!==!1){const[d,...f]=o?o.split(";").map(u=>u.trim()).filter(Boolean):[];l.setContentType([d||"multipart/form-data",...f].join("; "))}}if(Is.hasStandardBrowserEnv&&(r&&ie.isFunction(r)&&(r=r(e)),r||r!==!1&&R_(e.url))){const d=a&&i&&I_.read(i);d&&l.set(a,d)}return e},U_=typeof XMLHttpRequest<"u",$_=U_&&function(t){return new Promise(function(s,r){const a=kp(t);let i=a.data;const l=Ir.from(a.headers).normalize();let{responseType:c,onUploadProgress:o,onDownloadProgress:d}=a,f,u,h,x,m;function p(){x&&x(),m&&m(),a.cancelToken&&a.cancelToken.unsubscribe(f),a.signal&&a.signal.removeEventListener("abort",f)}let v=new XMLHttpRequest;v.open(a.method.toUpperCase(),a.url,!0),v.timeout=a.timeout;function b(){if(!v)return;const g=Ir.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),w={data:!c||c==="text"||c==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:g,config:t,request:v};Np(function(y){s(y),p()},function(y){r(y),p()},w),v=null}"onloadend"in v?v.onloadend=b:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(b)},v.onabort=function(){v&&(r(new et("Request aborted",et.ECONNABORTED,t,v)),v=null)},v.onerror=function(){r(new et("Network Error",et.ERR_NETWORK,t,v)),v=null},v.ontimeout=function(){let j=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const w=a.transitional||bp;a.timeoutErrorMessage&&(j=a.timeoutErrorMessage),r(new et(j,w.clarifyTimeoutError?et.ETIMEDOUT:et.ECONNABORTED,t,v)),v=null},i===void 0&&l.setContentType(null),"setRequestHeader"in v&&ie.forEach(l.toJSON(),function(j,w){v.setRequestHeader(w,j)}),ie.isUndefined(a.withCredentials)||(v.withCredentials=!!a.withCredentials),c&&c!=="json"&&(v.responseType=a.responseType),d&&([h,m]=ho(d,!0),v.addEventListener("progress",h)),o&&v.upload&&([u,x]=ho(o),v.upload.addEventListener("progress",u),v.upload.addEventListener("loadend",x)),(a.cancelToken||a.signal)&&(f=g=>{v&&(r(!g||g.type?new Pi(null,t,v):g),v.abort(),v=null)},a.cancelToken&&a.cancelToken.subscribe(f),a.signal&&(a.signal.aborted?f():a.signal.addEventListener("abort",f)));const _=D_(a.url);if(_&&Is.protocols.indexOf(_)===-1){r(new et("Unsupported protocol "+_+":",et.ERR_BAD_REQUEST,t));return}v.send(i||null)})},W_=(t,e)=>{const{length:s}=t=t?t.filter(Boolean):[];if(e||s){let r=new AbortController,a;const i=function(d){if(!a){a=!0,c();const f=d instanceof Error?d:this.reason;r.abort(f instanceof et?f:new Pi(f instanceof Error?f.message:f))}};let l=e&&setTimeout(()=>{l=null,i(new et(`timeout ${e} of ms exceeded`,et.ETIMEDOUT))},e);const c=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),t=null)};t.forEach(d=>d.addEventListener("abort",i));const{signal:o}=r;return o.unsubscribe=()=>ie.asap(c),o}},V_=W_,z_=function*(t,e){let s=t.byteLength;if(!e||s<e){yield t;return}let r=0,a;for(;r<s;)a=r+e,yield t.slice(r,a),r=a},H_=async function*(t,e){for await(const s of G_(t))yield*z_(s,e)},G_=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:s,value:r}=await e.read();if(s)break;yield r}}finally{await e.cancel()}},Ku=(t,e,s,r)=>{const a=H_(t,e);let i=0,l,c=o=>{l||(l=!0,r&&r(o))};return new ReadableStream({async pull(o){try{const{done:d,value:f}=await a.next();if(d){c(),o.close();return}let u=f.byteLength;if(s){let h=i+=u;s(h)}o.enqueue(new Uint8Array(f))}catch(d){throw c(d),d}},cancel(o){return c(o),a.return()}},{highWaterMark:2})},ed=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Sp=ed&&typeof ReadableStream=="function",X_=ed&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Ep=(t,...e)=>{try{return!!t(...e)}catch{return!1}},q_=Sp&&Ep(()=>{let t=!1;const e=new Request(Is.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Ju=64*1024,F0=Sp&&Ep(()=>ie.isReadableStream(new Response("").body)),mo={stream:F0&&(t=>t.body)};ed&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!mo[e]&&(mo[e]=ie.isFunction(t[e])?s=>s[e]():(s,r)=>{throw new et(`Response type '${e}' is not supported`,et.ERR_NOT_SUPPORT,r)})})})(new Response);const Y_=async t=>{if(t==null)return 0;if(ie.isBlob(t))return t.size;if(ie.isSpecCompliantForm(t))return(await new Request(Is.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(ie.isArrayBufferView(t)||ie.isArrayBuffer(t))return t.byteLength;if(ie.isURLSearchParams(t)&&(t=t+""),ie.isString(t))return(await X_(t)).byteLength},K_=async(t,e)=>{const s=ie.toFiniteNumber(t.getContentLength());return s??Y_(e)},J_=ed&&(async t=>{let{url:e,method:s,data:r,signal:a,cancelToken:i,timeout:l,onDownloadProgress:c,onUploadProgress:o,responseType:d,headers:f,withCredentials:u="same-origin",fetchOptions:h}=kp(t);d=d?(d+"").toLowerCase():"text";let x=V_([a,i&&i.toAbortSignal()],l),m;const p=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let v;try{if(o&&q_&&s!=="get"&&s!=="head"&&(v=await K_(f,r))!==0){let w=new Request(e,{method:"POST",body:r,duplex:"half"}),k;if(ie.isFormData(r)&&(k=w.headers.get("content-type"))&&f.setContentType(k),w.body){const[y,N]=Xu(v,ho(qu(o)));r=Ku(w.body,Ju,y,N)}}ie.isString(u)||(u=u?"include":"omit");const b="credentials"in Request.prototype;m=new Request(e,{...h,signal:x,method:s.toUpperCase(),headers:f.normalize().toJSON(),body:r,duplex:"half",credentials:b?u:void 0});let _=await fetch(m,h);const g=F0&&(d==="stream"||d==="response");if(F0&&(c||g&&p)){const w={};["status","statusText","headers"].forEach(S=>{w[S]=_[S]});const k=ie.toFiniteNumber(_.headers.get("content-length")),[y,N]=c&&Xu(k,ho(qu(c),!0))||[];_=new Response(Ku(_.body,Ju,y,()=>{N&&N(),p&&p()}),w)}d=d||"text";let j=await mo[ie.findKey(mo,d)||"text"](_,t);return!g&&p&&p(),await new Promise((w,k)=>{Np(w,k,{data:j,headers:Ir.from(_.headers),status:_.status,statusText:_.statusText,config:t,request:m})})}catch(b){throw p&&p(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new et("Network Error",et.ERR_NETWORK,t,m),{cause:b.cause||b}):et.from(b,b&&b.code,t,m)}}),O0={http:d_,xhr:$_,fetch:J_};ie.forEach(O0,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Zu=t=>`- ${t}`,Z_=t=>ie.isFunction(t)||t===null||t===!1,Tp={getAdapter:t=>{t=ie.isArray(t)?t:[t];const{length:e}=t;let s,r;const a={};for(let i=0;i<e;i++){s=t[i];let l;if(r=s,!Z_(s)&&(r=O0[(l=String(s)).toLowerCase()],r===void 0))throw new et(`Unknown adapter '${l}'`);if(r)break;a[l||"#"+i]=r}if(!r){const i=Object.entries(a).map(([c,o])=>`adapter ${c} `+(o===!1?"is not supported by the environment":"is not available in the build"));let l=e?i.length>1?`since :
`+i.map(Zu).join(`
`):" "+Zu(i[0]):"as no adapter specified";throw new et("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:O0};function Dd(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Pi(null,t)}function Qu(t){return Dd(t),t.headers=Ir.from(t.headers),t.data=Od.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Tp.getAdapter(t.adapter||hf.adapter)(t).then(function(r){return Dd(t),r.data=Od.call(t,t.transformResponse,r),r.headers=Ir.from(r.headers),r},function(r){return wp(r)||(Dd(t),r&&r.response&&(r.response.data=Od.call(t,t.transformResponse,r.response),r.response.headers=Ir.from(r.response.headers))),Promise.reject(r)})}const Cp="1.11.0",td={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{td[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const eh={};td.transitional=function(e,s,r){function a(i,l){return"[Axios v"+Cp+"] Transitional option '"+i+"'"+l+(r?". "+r:"")}return(i,l,c)=>{if(e===!1)throw new et(a(l," has been removed"+(s?" in "+s:"")),et.ERR_DEPRECATED);return s&&!eh[l]&&(eh[l]=!0,console.warn(a(l," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(i,l,c):!0}};td.spelling=function(e){return(s,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function Q_(t,e,s){if(typeof t!="object")throw new et("options must be an object",et.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let a=r.length;for(;a-- >0;){const i=r[a],l=e[i];if(l){const c=t[i],o=c===void 0||l(c,i,t);if(o!==!0)throw new et("option "+i+" must be "+o,et.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new et("Unknown option "+i,et.ERR_BAD_OPTION)}}const zc={assertOptions:Q_,validators:td},zr=zc.validators;class xo{constructor(e){this.defaults=e||{},this.interceptors={request:new Hu,response:new Hu}}async request(e,s){try{return await this._request(e,s)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=Mn(this.defaults,s);const{transitional:r,paramsSerializer:a,headers:i}=s;r!==void 0&&zc.assertOptions(r,{silentJSONParsing:zr.transitional(zr.boolean),forcedJSONParsing:zr.transitional(zr.boolean),clarifyTimeoutError:zr.transitional(zr.boolean)},!1),a!=null&&(ie.isFunction(a)?s.paramsSerializer={serialize:a}:zc.assertOptions(a,{encode:zr.function,serialize:zr.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),zc.assertOptions(s,{baseUrl:zr.spelling("baseURL"),withXsrfToken:zr.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let l=i&&ie.merge(i.common,i[s.method]);i&&ie.forEach(["delete","get","head","post","put","patch","common"],m=>{delete i[m]}),s.headers=Ir.concat(l,i);const c=[];let o=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(s)===!1||(o=o&&p.synchronous,c.unshift(p.fulfilled,p.rejected))});const d=[];this.interceptors.response.forEach(function(p){d.push(p.fulfilled,p.rejected)});let f,u=0,h;if(!o){const m=[Qu.bind(this),void 0];for(m.unshift(...c),m.push(...d),h=m.length,f=Promise.resolve(s);u<h;)f=f.then(m[u++],m[u++]);return f}h=c.length;let x=s;for(u=0;u<h;){const m=c[u++],p=c[u++];try{x=m(x)}catch(v){p.call(this,v);break}}try{f=Qu.call(this,x)}catch(m){return Promise.reject(m)}for(u=0,h=d.length;u<h;)f=f.then(d[u++],d[u++]);return f}getUri(e){e=Mn(this.defaults,e);const s=jp(e.baseURL,e.url,e.allowAbsoluteUrls);return yp(s,e.params,e.paramsSerializer)}}ie.forEach(["delete","get","head","options"],function(e){xo.prototype[e]=function(s,r){return this.request(Mn(r||{},{method:e,url:s,data:(r||{}).data}))}});ie.forEach(["post","put","patch"],function(e){function s(r){return function(i,l,c){return this.request(Mn(c||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}xo.prototype[e]=s(),xo.prototype[e+"Form"]=s(!0)});const Hc=xo;class mf{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(i){s=i});const r=this;this.promise.then(a=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](a);r._listeners=null}),this.promise.then=a=>{let i;const l=new Promise(c=>{r.subscribe(c),i=c}).then(a);return l.cancel=function(){r.unsubscribe(i)},l},e(function(i,l,c){r.reason||(r.reason=new Pi(i,l,c),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=r=>{e.abort(r)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new mf(function(a){e=a}),cancel:e}}}const ew=mf;function tw(t){return function(s){return t.apply(null,s)}}function sw(t){return ie.isObject(t)&&t.isAxiosError===!0}const D0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(D0).forEach(([t,e])=>{D0[e]=t});const rw=D0;function Ap(t){const e=new Hc(t),s=lp(Hc.prototype.request,e);return ie.extend(s,Hc.prototype,e,{allOwnKeys:!0}),ie.extend(s,e,null,{allOwnKeys:!0}),s.create=function(a){return Ap(Mn(t,a))},s}const ms=Ap(hf);ms.Axios=Hc;ms.CanceledError=Pi;ms.CancelToken=ew;ms.isCancel=wp;ms.VERSION=Cp;ms.toFormData=Zo;ms.AxiosError=et;ms.Cancel=ms.CanceledError;ms.all=function(e){return Promise.all(e)};ms.spread=tw;ms.isAxiosError=sw;ms.mergeConfig=Mn;ms.AxiosHeaders=Ir;ms.formToJSON=t=>_p(ie.isHTMLForm(t)?new FormData(t):t);ms.getAdapter=Tp.getAdapter;ms.HttpStatusCode=rw;ms.default=ms;const aw=ms,nw={API_URL:{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_URL||"http://localhost:8000",TIMEOUT:15e3,RETRY_ATTEMPTS:5},Pd=()=>nw,th={BASE_URL:Pd().API_URL,TIMEOUT:Pd().TIMEOUT,RETRY_ATTEMPTS:Pd().RETRY_ATTEMPTS},we=aw.create({baseURL:th.BASE_URL,timeout:th.TIMEOUT,headers:{"Content-Type":"application/json"}});we.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t});we.interceptors.response.use(t=>t,async t=>{var s,r;const e=t.config;if(((s=t.response)==null?void 0:s.status)===401)return localStorage.removeItem("token"),window.location.href="/login",Promise.reject(t);if(((r=t.response)==null?void 0:r.status)===422){const a=t.response.data;if(a.detail&&Array.isArray(a.detail)){const i=a.detail.map(l=>({field:l.loc?l.loc.join("."):"general",message:l.msg,type:l.type}));t.formattedErrors=i}}if(!t.response&&e&&!e._retry){e._retry=!0,await new Promise(a=>setTimeout(a,1e3));try{return await we(e)}catch(a){return Promise.reject(a)}}return Promise.reject(t)});const Fp={login:async t=>(await we.post("/auth/login",t)).data,getCurrentUser:async()=>(await we.get("/auth/me")).data},sd={getAll:async()=>(await we.get("/departments")).data,create:async t=>(await we.post("/departments",t)).data,update:async(t,e)=>(await we.put(`/departments/${t}`,e)).data,delete:async t=>{await we.delete(`/departments/${t}`)}},rd={getAll:async()=>(await we.get("/classes")).data,create:async t=>(await we.post("/classes",t)).data,update:async(t,e)=>(await we.put(`/classes/${t}`,e)).data,delete:async t=>{await we.delete(`/classes/${t}`)}},ad={getAll:async()=>(await we.get("/subjects")).data,create:async t=>(await we.post("/subjects",t)).data,update:async(t,e)=>(await we.put(`/subjects/${t}`,e)).data,delete:async t=>{await we.delete(`/subjects/${t}`)}},Jl={getAll:async()=>(await we.get("/users")).data,create:async t=>(await we.post("/users",t)).data,update:async(t,e)=>(await we.put(`/users/${t}`,e)).data,delete:async t=>{await we.delete(`/users/${t}`)},resetPassword:async t=>(await we.post(`/users/${t}/reset-password`)).data},nd={getAll:async()=>(await we.get("/exams")).data,getById:async t=>(await we.get(`/exams/${t}`)).data,create:async t=>(await we.post("/exams",t)).data,update:async(t,e)=>(await we.put(`/exams/${t}`,e)).data,delete:async t=>{await we.delete(`/exams/${t}`)},getQuestions:async t=>(await we.get(`/exams/${t}/questions`)).data},id={getByExam:async t=>(await we.get(`/marks/exam/${t}`)).data,getByStudent:async t=>(await we.get(`/marks/student/${t}`)).data,getLockStatus:async t=>(await we.get(`/marks/exam/${t}/lock-status`)).data,bulkCreate:async t=>(await we.post("/marks/bulk",t)).data,update:async(t,e)=>(await we.put(`/marks/${t}`,e)).data},Qr={getStudentAnalytics:async t=>(await we.get(`/analytics/student/${t}`)).data,getTeacherAnalytics:async t=>(await we.get(`/analytics/teacher/${t}`)).data,getHODAnalytics:async t=>(await we.get(`/analytics/hod/${t}`)).data,getClassAnalytics:async t=>(await we.get(`/analytics/class/${t}`)).data,getSubjectAnalytics:async t=>(await we.get(`/analytics/subject/${t}`)).data,getStrategicDashboardData:async t=>(await we.get(`/analytics/strategic/department/${t}`)).data,getCOAttainment:async(t,e="all")=>(await we.get(`/analytics/co-attainment/${t}?exam_type=${e}`)).data,getPOAttainment:async(t,e="all")=>(await we.get(`/analytics/po-attainment/${t}?exam_type=${e}`)).data,getStudentPerformance:async(t,e,s="all")=>{const r=new URLSearchParams({exam_type:s});return e&&r.append("class_id",e.toString()),(await we.get(`/analytics/student-performance/${t}?${r}`)).data},getClassPerformance:async(t,e="all")=>(await we.get(`/analytics/class-performance/${t}?exam_type=${e}`)).data,getCOPOMapping:async t=>(await we.get(`/analytics/co-po-mapping/${t}`)).data,generateReport:async(t,e,s="pdf")=>(await we.post("/reports/generate",{report_type:t,filters:e,format:s},{responseType:"blob"})).data,getReportTemplates:async()=>(await we.get("/reports/templates")).data},iw={getStats:async()=>(await we.get("/dashboard/stats")).data},gi={getTemplates:async()=>(await we.get("/reports/templates")).data,generateReport:async(t,e,s="pdf")=>(await we.post("/reports/generate",{report_type:t,filters:e,format:s})).data,getReportStatus:async t=>(await we.get(`/reports/status/${t}`)).data,downloadReport:async t=>(await we.get(`/reports/download/${t}`,{responseType:"blob"})).data},Zl={getBySubject:async t=>(await we.get(`/subjects/${t}/cos`)).data,create:async(t,e)=>(await we.post(`/subjects/${t}/cos`,{...e,subject_id:t})).data,update:async(t,e)=>(await we.put(`/cos/${t}`,e)).data,delete:async t=>{await we.delete(`/cos/${t}`)}},Ql={getByDepartment:async t=>(await we.get(`/departments/${t}/pos`)).data,create:async(t,e)=>(await we.post(`/departments/${t}/pos`,{...e,department_id:t})).data,update:async(t,e)=>(await we.put(`/pos/${t}`,e)).data,delete:async t=>{await we.delete(`/pos/${t}`)}},Op={getBySubject:async t=>(await we.get(`/subjects/${t}/co-targets`)).data,bulkUpdate:async(t,e)=>(await we.put(`/subjects/${t}/co-targets`,{subject_id:t,co_targets:e.map(r=>({...r,subject_id:t}))})).data},Dp={getBySubject:async t=>(await we.get(`/subjects/${t}/assessment-weights`)).data,bulkUpdate:async(t,e)=>(await we.put(`/subjects/${t}/assessment-weights`,{subject_id:t,assessment_weights:e.map(r=>({...r,subject_id:t}))})).data},po={getBySubject:async t=>(await we.get(`/subjects/${t}/co-po-matrix`)).data,bulkUpdate:async(t,e)=>(await we.put(`/subjects/${t}/co-po-matrix`,{subject_id:t,co_po_matrix:e.map(r=>({...r,subject_id:t}))})).data},Pp={getByQuestion:async t=>(await we.get(`/questions/${t}/co-weights`)).data,bulkUpdate:async(t,e)=>(await we.put(`/questions/${t}/co-weights`,{question_id:t,co_weights:e})).data},ld={getBySubject:async t=>(await we.get(`/subjects/${t}/indirect-attainment`)).data,create:async(t,e)=>(await we.post(`/subjects/${t}/indirect-attainment`,e)).data,update:async(t,e)=>(await we.put(`/indirect-attainment/${t}`,e)).data,delete:async t=>{await we.delete(`/indirect-attainment/${t}`)}},lw={getBySubject:async t=>(await we.get(`/subjects/${t}/attainment-audit`)).data},Mp={getSubjectAttainment:async(t,e)=>(await we.get(`/analytics/attainment/subject/${t}`,{params:e?{exam_type:e}:{}})).data,getStudentAttainment:async(t,e)=>(await we.get(`/analytics/attainment/student/${t}`,{params:{subject_id:e}})).data,getClassAttainment:async(t,e)=>(await we.get(`/analytics/attainment/class/${t}`,{params:e?{term:e}:{}})).data,getProgramAttainment:async(t,e)=>(await we.get(`/analytics/attainment/program/${t}`,{params:e?{year:e}:{}})).data,getCOAttainment:async(t,e)=>(await we.get(`/analytics/co-attainment/${t}`,{params:{exam_type:e||"all"}})).data,getPOAttainment:async(t,e)=>(await we.get(`/analytics/po-attainment/${t}`,{params:{exam_type:e||"all"}})).data,getBlueprintValidation:async t=>(await we.get(`/analytics/attainment/blueprint-validation/${t}`)).data,getStudentPerformance:async(t,e,s)=>(await we.get(`/analytics/student-performance/${t}`,{params:{student_id:e,exam_type:s||"all"}})).data,getClassPerformance:async(t,e)=>(await we.get(`/analytics/class-performance/${t}`,{params:{exam_type:e||"all"}})).data,getCOPOMapping:async t=>(await we.get(`/analytics/co-po-mapping/${t}`)).data},cw={getProgress:async t=>(await we.get(`/student-progress/${t}`)).data,getGoals:async t=>(await we.get(`/student-goals/${t}`)).data,createGoal:async t=>(await we.post("/student-goals",t)).data,updateGoal:async(t,e)=>(await we.put(`/student-goals/${t}`,e)).data,deleteGoal:async t=>{await we.delete(`/student-goals/${t}`)},getMilestones:async t=>(await we.get(`/student-milestones/${t}`)).data,createMilestone:async t=>(await we.post("/student-milestones",t)).data,updateMilestone:async(t,e)=>(await we.put(`/student-milestones/${t}`,e)).data,deleteMilestone:async t=>{await we.delete(`/student-milestones/${t}`)}},ow={user:null,isAuthenticated:!1,loading:!1,error:null},Gc=He("auth/login",async t=>{const e=await Fp.login(t);return localStorage.setItem("token",e.access_token),e.user}),Rp=He("auth/logout",async()=>{localStorage.removeItem("token")}),Xc=He("auth/fetchCurrentUser",async()=>await Fp.getCurrentUser()),Ip=Oa({name:"auth",initialState:ow,reducers:{clearError:t=>{t.error=null},initializeAuth:t=>{localStorage.getItem("token")&&(t.isAuthenticated=!0,t.loading=!0)}},extraReducers:t=>{t.addCase(Gc.pending,e=>{e.loading=!0,e.error=null}).addCase(Gc.fulfilled,(e,s)=>{e.loading=!1,e.isAuthenticated=!0,e.user=s.payload}).addCase(Gc.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Login failed",e.isAuthenticated=!1,localStorage.removeItem("token")}).addCase(Rp.fulfilled,e=>{e.isAuthenticated=!1,e.user=null,e.loading=!1,e.error=null}).addCase(Xc.pending,e=>{e.loading=!0}).addCase(Xc.fulfilled,(e,s)=>{e.loading=!1,e.isAuthenticated=!0,e.user=s.payload}).addCase(Xc.rejected,e=>{e.loading=!1,e.isAuthenticated=!1,e.user=null,localStorage.removeItem("token")})}}),{clearError:dw,initializeAuth:fw}=Ip.actions,uw=Ip.reducer,Lp=G.createContext(void 0),Bp=()=>{const t=G.useContext(Lp);if(t===void 0)throw new Error("useSidebar must be used within a SidebarProvider");return t},hw=({children:t})=>{const[e,s]=G.useState(!1),[r,a]=G.useState(!1);G.useEffect(()=>{const c=localStorage.getItem("sidebarCollapsed");c!==null&&s(JSON.parse(c))},[]),G.useEffect(()=>{localStorage.setItem("sidebarCollapsed",JSON.stringify(e))},[e]);const i=()=>{s(!e)},l=()=>{a(!r)};return n.jsx(Lp.Provider,{value:{isCollapsed:e,toggleSidebar:i,isMobileMenuOpen:r,toggleMobileMenu:l},children:t})},mw=()=>{const[t,e]=G.useState(null),[s,r]=G.useState(!1),[a,i]=G.useState(!1);G.useEffect(()=>{(()=>{if(window.matchMedia("(display-mode: standalone)").matches){i(!0);return}if(window.navigator.standalone===!0){i(!0);return}})();const d=u=>{u.preventDefault(),e(u),r(!0)},f=()=>{i(!0),r(!1),e(null)};return window.addEventListener("beforeinstallprompt",d),window.addEventListener("appinstalled",f),()=>{window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",f)}},[]);const l=async()=>{if(t)try{await t.prompt();const{outcome:o}=await t.userChoice;console.log(o==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),e(null),r(!1)}catch(o){console.error("Error during installation:",o)}},c=()=>{r(!1),sessionStorage.setItem("pwa-install-dismissed","true")};return a||!s||sessionStorage.getItem("pwa-install-dismissed")?null:n.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-sm",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-4",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:n.jsx(kr,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Install IEMS"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Get quick access to your exam management system"})]})]}),n.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:n.jsx(tp,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[n.jsx(Xy,{className:"h-4 w-4"}),n.jsx("span",{children:"Works offline"})]}),n.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[n.jsx(qy,{className:"h-4 w-4"}),n.jsx("span",{children:"Native app experience"})]})]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:l,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Install App"}),n.jsx("button",{onClick:c,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 text-sm font-medium transition-colors",children:"Not now"})]})]})})},xw=()=>{const[t,e]=G.useState(navigator.onLine),[s,r]=G.useState(!1),[a,i]=G.useState("loading");return G.useEffect(()=>{(()=>{if(window.matchMedia("(display-mode: standalone)").matches){r(!0);return}if(window.navigator.standalone===!0){r(!0);return}r(!1)})();const c=()=>e(!0),o=()=>e(!1);return window.addEventListener("online",c),window.addEventListener("offline",o),"serviceWorker"in navigator?navigator.serviceWorker.ready.then(()=>{i("registered")}).catch(()=>{i("error")}):i("unsupported"),()=>{window.removeEventListener("online",c),window.removeEventListener("offline",o)}},[]),s?n.jsx("div",{className:"fixed top-4 right-4 z-40",children:n.jsxs("div",{className:"flex items-center space-x-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 px-3 py-2",children:[n.jsxs("div",{className:"flex items-center space-x-1",children:[t?n.jsx(Yy,{className:"h-4 w-4 text-green-500"}):n.jsx(Ky,{className:"h-4 w-4 text-red-500"}),n.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:t?"Online":"Offline"})]}),n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(Ot,{className:"h-4 w-4 text-blue-500"}),n.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"PWA"})]}),n.jsxs("div",{className:"flex items-center space-x-1",children:[a==="registered"&&n.jsx(Ot,{className:"h-4 w-4 text-green-500"}),a==="error"&&n.jsx(Sn,{className:"h-4 w-4 text-red-500"}),a==="loading"&&n.jsx("div",{className:"h-4 w-4 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"}),n.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"SW"})]})]})}):null};var ec=t=>t.type==="checkbox",wn=t=>t instanceof Date,Gs=t=>t==null;const Up=t=>typeof t=="object";var ns=t=>!Gs(t)&&!Array.isArray(t)&&Up(t)&&!wn(t),pw=t=>ns(t)&&t.target?ec(t.target)?t.target.checked:t.target.value:t,gw=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,vw=(t,e)=>t.has(gw(e)),yw=t=>{const e=t.constructor&&t.constructor.prototype;return ns(e)&&e.hasOwnProperty("isPrototypeOf")},xf=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function $t(t){let e;const s=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(xf&&(t instanceof Blob||r))&&(s||ns(t)))if(e=s?[]:Object.create(Object.getPrototypeOf(t)),!s&&!yw(t))e=t;else for(const a in t)t.hasOwnProperty(a)&&(e[a]=$t(t[a]));else return t;return e}var cd=t=>/^\w*$/.test(t),Wt=t=>t===void 0,od=t=>Array.isArray(t)?t.filter(Boolean):[],pf=t=>od(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Me=(t,e,s)=>{if(!e||!ns(t))return s;const r=(cd(e)?[e]:pf(e)).reduce((a,i)=>Gs(a)?a:a[i],t);return Wt(r)||r===t?Wt(t[e])?s:t[e]:r},Jr=t=>typeof t=="boolean",bt=(t,e,s)=>{let r=-1;const a=cd(e)?[e]:pf(e),i=a.length,l=i-1;for(;++r<i;){const c=a[r];let o=s;if(r!==l){const d=t[c];o=ns(d)||Array.isArray(d)?d:isNaN(+a[r+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;t[c]=o,t=t[c]}};const sh={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Nr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ma={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},$p=at.createContext(null);$p.displayName="HookFormContext";const bw=()=>at.useContext($p);var _w=(t,e,s,r=!0)=>{const a={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(a,i,{get:()=>{const l=i;return e._proxyFormState[l]!==Nr.all&&(e._proxyFormState[l]=!r||Nr.all),s&&(s[l]=!0),t[l]}});return a};const Wp=typeof window<"u"?at.useLayoutEffect:at.useEffect;var ea=t=>typeof t=="string",ww=(t,e,s,r,a)=>ea(t)?(r&&e.watch.add(t),Me(s,t,a)):Array.isArray(t)?t.map(i=>(r&&e.watch.add(i),Me(s,i))):(r&&(e.watchAll=!0),s),P0=t=>Gs(t)||!Up(t);function Wa(t,e,s=new WeakSet){if(P0(t)||P0(e))return t===e;if(wn(t)&&wn(e))return t.getTime()===e.getTime();const r=Object.keys(t),a=Object.keys(e);if(r.length!==a.length)return!1;if(s.has(t)||s.has(e))return!0;s.add(t),s.add(e);for(const i of r){const l=t[i];if(!a.includes(i))return!1;if(i!=="ref"){const c=e[i];if(wn(l)&&wn(c)||ns(l)&&ns(c)||Array.isArray(l)&&Array.isArray(c)?!Wa(l,c,s):l!==c)return!1}}return!0}var Vp=(t,e,s,r,a)=>e?{...s[t],types:{...s[t]&&s[t].types?s[t].types:{},[r]:a||!0}}:{},ar=t=>Array.isArray(t)?t:[t],rh=()=>{let t=[];return{get observers(){return t},next:a=>{for(const i of t)i.next&&i.next(a)},subscribe:a=>(t.push(a),{unsubscribe:()=>{t=t.filter(i=>i!==a)}}),unsubscribe:()=>{t=[]}}},Hs=t=>ns(t)&&!Object.keys(t).length,gf=t=>t.type==="file",Or=t=>typeof t=="function",go=t=>{if(!xf)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},zp=t=>t.type==="select-multiple",vf=t=>t.type==="radio",Nw=t=>vf(t)||ec(t),Md=t=>go(t)&&t.isConnected;function jw(t,e){const s=e.slice(0,-1).length;let r=0;for(;r<s;)t=Wt(t)?r++:t[e[r++]];return t}function kw(t){for(const e in t)if(t.hasOwnProperty(e)&&!Wt(t[e]))return!1;return!0}function ss(t,e){const s=Array.isArray(e)?e:cd(e)?[e]:pf(e),r=s.length===1?t:jw(t,s),a=s.length-1,i=s[a];return r&&delete r[i],a!==0&&(ns(r)&&Hs(r)||Array.isArray(r)&&kw(r))&&ss(t,s.slice(0,-1)),t}var Hp=t=>{for(const e in t)if(Or(t[e]))return!0;return!1};function vo(t,e={}){const s=Array.isArray(t);if(ns(t)||s)for(const r in t)Array.isArray(t[r])||ns(t[r])&&!Hp(t[r])?(e[r]=Array.isArray(t[r])?[]:{},vo(t[r],e[r])):Gs(t[r])||(e[r]=!0);return e}function Gp(t,e,s){const r=Array.isArray(t);if(ns(t)||r)for(const a in t)Array.isArray(t[a])||ns(t[a])&&!Hp(t[a])?Wt(e)||P0(s[a])?s[a]=Array.isArray(t[a])?vo(t[a],[]):{...vo(t[a])}:Gp(t[a],Gs(e)?{}:e[a],s[a]):s[a]=!Wa(t[a],e[a]);return s}var Hi=(t,e)=>Gp(t,e,vo(e));const ah={value:!1,isValid:!1},nh={value:!0,isValid:!0};var Xp=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Wt(t[0].attributes.value)?Wt(t[0].value)||t[0].value===""?nh:{value:t[0].value,isValid:!0}:nh:ah}return ah},qp=(t,{valueAsNumber:e,valueAsDate:s,setValueAs:r})=>Wt(t)?t:e?t===""?NaN:t&&+t:s&&ea(t)?new Date(t):r?r(t):t;const ih={isValid:!1,value:null};var Yp=t=>Array.isArray(t)?t.reduce((e,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:e,ih):ih;function lh(t){const e=t.ref;return gf(e)?e.files:vf(e)?Yp(t.refs).value:zp(e)?[...e.selectedOptions].map(({value:s})=>s):ec(e)?Xp(t.refs).value:qp(Wt(e.value)?t.ref.value:e.value,t)}var Sw=(t,e,s,r)=>{const a={};for(const i of t){const l=Me(e,i);l&&bt(a,i,l._f)}return{criteriaMode:s,names:[...t],fields:a,shouldUseNativeValidation:r}},yo=t=>t instanceof RegExp,Gi=t=>Wt(t)?t:yo(t)?t.source:ns(t)?yo(t.value)?t.value.source:t.value:t,ui=t=>({isOnSubmit:!t||t===Nr.onSubmit,isOnBlur:t===Nr.onBlur,isOnChange:t===Nr.onChange,isOnAll:t===Nr.all,isOnTouch:t===Nr.onTouched});const ch="AsyncFunction";var Ew=t=>!!t&&!!t.validate&&!!(Or(t.validate)&&t.validate.constructor.name===ch||ns(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===ch)),Tw=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),M0=(t,e,s)=>!s&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const vi=(t,e,s,r)=>{for(const a of s||Object.keys(t)){const i=Me(t,a);if(i){const{_f:l,...c}=i;if(l){if(l.refs&&l.refs[0]&&e(l.refs[0],a)&&!r)return!0;if(l.ref&&e(l.ref,l.name)&&!r)return!0;if(vi(c,e))break}else if(ns(c)&&vi(c,e))break}}};function oh(t,e,s){const r=Me(t,s);if(r||cd(s))return{error:r,name:s};const a=s.split(".");for(;a.length;){const i=a.join("."),l=Me(e,i),c=Me(t,i);if(l&&!Array.isArray(l)&&s!==i)return{name:s};if(c&&c.type)return{name:i,error:c};if(c&&c.root&&c.root.type)return{name:`${i}.root`,error:c.root};a.pop()}return{name:s}}var Cw=(t,e,s,r)=>{s(t);const{name:a,...i}=t;return Hs(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(l=>e[l]===(!r||Nr.all))},Aw=(t,e,s)=>!t||!e||t===e||ar(t).some(r=>r&&(s?r===e:r.startsWith(e)||e.startsWith(r))),Fw=(t,e,s,r,a)=>a.isOnAll?!1:!s&&a.isOnTouch?!(e||t):(s?r.isOnBlur:a.isOnBlur)?!t:(s?r.isOnChange:a.isOnChange)?t:!0,Ow=(t,e)=>!od(Me(t,e)).length&&ss(t,e),Kp=(t,e,s)=>{const r=ar(Me(t,s));return bt(r,"root",e[s]),bt(t,s,r),t},qc=t=>ea(t);function dh(t,e,s="validate"){if(qc(t)||Array.isArray(t)&&t.every(qc)||Jr(t)&&!t)return{type:s,message:qc(t)?t:"",ref:e}}var ri=t=>ns(t)&&!yo(t)?t:{value:t,message:""},R0=async(t,e,s,r,a,i)=>{const{ref:l,refs:c,required:o,maxLength:d,minLength:f,min:u,max:h,pattern:x,validate:m,name:p,valueAsNumber:v,mount:b}=t._f,_=Me(s,p);if(!b||e.has(p))return{};const g=c?c[0]:l,j=A=>{a&&g.reportValidity&&(g.setCustomValidity(Jr(A)?"":A||""),g.reportValidity())},w={},k=vf(l),y=ec(l),N=k||y,S=(v||gf(l))&&Wt(l.value)&&Wt(_)||go(l)&&l.value===""||_===""||Array.isArray(_)&&!_.length,T=Vp.bind(null,p,r,w),E=(A,H,V,L=ma.maxLength,P=ma.minLength)=>{const J=A?H:V;w[p]={type:A?L:P,message:J,ref:l,...T(A?L:P,J)}};if(i?!Array.isArray(_)||!_.length:o&&(!N&&(S||Gs(_))||Jr(_)&&!_||y&&!Xp(c).isValid||k&&!Yp(c).isValid)){const{value:A,message:H}=qc(o)?{value:!!o,message:o}:ri(o);if(A&&(w[p]={type:ma.required,message:H,ref:g,...T(ma.required,H)},!r))return j(H),w}if(!S&&(!Gs(u)||!Gs(h))){let A,H;const V=ri(h),L=ri(u);if(!Gs(_)&&!isNaN(_)){const P=l.valueAsNumber||_&&+_;Gs(V.value)||(A=P>V.value),Gs(L.value)||(H=P<L.value)}else{const P=l.valueAsDate||new Date(_),J=de=>new Date(new Date().toDateString()+" "+de),Ee=l.type=="time",Y=l.type=="week";ea(V.value)&&_&&(A=Ee?J(_)>J(V.value):Y?_>V.value:P>new Date(V.value)),ea(L.value)&&_&&(H=Ee?J(_)<J(L.value):Y?_<L.value:P<new Date(L.value))}if((A||H)&&(E(!!A,V.message,L.message,ma.max,ma.min),!r))return j(w[p].message),w}if((d||f)&&!S&&(ea(_)||i&&Array.isArray(_))){const A=ri(d),H=ri(f),V=!Gs(A.value)&&_.length>+A.value,L=!Gs(H.value)&&_.length<+H.value;if((V||L)&&(E(V,A.message,H.message),!r))return j(w[p].message),w}if(x&&!S&&ea(_)){const{value:A,message:H}=ri(x);if(yo(A)&&!_.match(A)&&(w[p]={type:ma.pattern,message:H,ref:l,...T(ma.pattern,H)},!r))return j(H),w}if(m){if(Or(m)){const A=await m(_,s),H=dh(A,g);if(H&&(w[p]={...H,...T(ma.validate,H.message)},!r))return j(H.message),w}else if(ns(m)){let A={};for(const H in m){if(!Hs(A)&&!r)break;const V=dh(await m[H](_,s),g,H);V&&(A={...V,...T(H,V.message)},j(V.message),r&&(w[p]=A))}if(!Hs(A)&&(w[p]={ref:g,...A},!r))return w}}return j(!0),w};const Dw={mode:Nr.onSubmit,reValidateMode:Nr.onChange,shouldFocusError:!0};function Pw(t={}){let e={...Dw,...t},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:Or(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},a=ns(e.defaultValues)||ns(e.values)?$t(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:$t(a),l={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},o,d=0;const f={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let u={...f};const h={array:rh(),state:rh()},x=e.criteriaMode===Nr.all,m=M=>q=>{clearTimeout(d),d=setTimeout(M,q)},p=async M=>{if(!e.disabled&&(f.isValid||u.isValid||M)){const q=e.resolver?Hs((await y()).errors):await S(r,!0);q!==s.isValid&&h.state.next({isValid:q})}},v=(M,q)=>{!e.disabled&&(f.isValidating||f.validatingFields||u.isValidating||u.validatingFields)&&((M||Array.from(c.mount)).forEach(Q=>{Q&&(q?bt(s.validatingFields,Q,q):ss(s.validatingFields,Q))}),h.state.next({validatingFields:s.validatingFields,isValidating:!Hs(s.validatingFields)}))},b=(M,q=[],Q,_e,ve=!0,fe=!0)=>{if(_e&&Q&&!e.disabled){if(l.action=!0,fe&&Array.isArray(Me(r,M))){const Fe=Q(Me(r,M),_e.argA,_e.argB);ve&&bt(r,M,Fe)}if(fe&&Array.isArray(Me(s.errors,M))){const Fe=Q(Me(s.errors,M),_e.argA,_e.argB);ve&&bt(s.errors,M,Fe),Ow(s.errors,M)}if((f.touchedFields||u.touchedFields)&&fe&&Array.isArray(Me(s.touchedFields,M))){const Fe=Q(Me(s.touchedFields,M),_e.argA,_e.argB);ve&&bt(s.touchedFields,M,Fe)}(f.dirtyFields||u.dirtyFields)&&(s.dirtyFields=Hi(a,i)),h.state.next({name:M,isDirty:E(M,q),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else bt(i,M,q)},_=(M,q)=>{bt(s.errors,M,q),h.state.next({errors:s.errors})},g=M=>{s.errors=M,h.state.next({errors:s.errors,isValid:!1})},j=(M,q,Q,_e)=>{const ve=Me(r,M);if(ve){const fe=Me(i,M,Wt(Q)?Me(a,M):Q);Wt(fe)||_e&&_e.defaultChecked||q?bt(i,M,q?fe:lh(ve._f)):V(M,fe),l.mount&&p()}},w=(M,q,Q,_e,ve)=>{let fe=!1,Fe=!1;const rt={name:M};if(!e.disabled){if(!Q||_e){(f.isDirty||u.isDirty)&&(Fe=s.isDirty,s.isDirty=rt.isDirty=E(),fe=Fe!==rt.isDirty);const Ze=Wa(Me(a,M),q);Fe=!!Me(s.dirtyFields,M),Ze?ss(s.dirtyFields,M):bt(s.dirtyFields,M,!0),rt.dirtyFields=s.dirtyFields,fe=fe||(f.dirtyFields||u.dirtyFields)&&Fe!==!Ze}if(Q){const Ze=Me(s.touchedFields,M);Ze||(bt(s.touchedFields,M,Q),rt.touchedFields=s.touchedFields,fe=fe||(f.touchedFields||u.touchedFields)&&Ze!==Q)}fe&&ve&&h.state.next(rt)}return fe?rt:{}},k=(M,q,Q,_e)=>{const ve=Me(s.errors,M),fe=(f.isValid||u.isValid)&&Jr(q)&&s.isValid!==q;if(e.delayError&&Q?(o=m(()=>_(M,Q)),o(e.delayError)):(clearTimeout(d),o=null,Q?bt(s.errors,M,Q):ss(s.errors,M)),(Q?!Wa(ve,Q):ve)||!Hs(_e)||fe){const Fe={..._e,...fe&&Jr(q)?{isValid:q}:{},errors:s.errors,name:M};s={...s,...Fe},h.state.next(Fe)}},y=async M=>{v(M,!0);const q=await e.resolver(i,e.context,Sw(M||c.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return v(M),q},N=async M=>{const{errors:q}=await y(M);if(M)for(const Q of M){const _e=Me(q,Q);_e?bt(s.errors,Q,_e):ss(s.errors,Q)}else s.errors=q;return q},S=async(M,q,Q={valid:!0})=>{for(const _e in M){const ve=M[_e];if(ve){const{_f:fe,...Fe}=ve;if(fe){const rt=c.array.has(fe.name),Ze=ve._f&&Ew(ve._f);Ze&&f.validatingFields&&v([_e],!0);const St=await R0(ve,c.disabled,i,x,e.shouldUseNativeValidation&&!q,rt);if(Ze&&f.validatingFields&&v([_e]),St[fe.name]&&(Q.valid=!1,q))break;!q&&(Me(St,fe.name)?rt?Kp(s.errors,St,fe.name):bt(s.errors,fe.name,St[fe.name]):ss(s.errors,fe.name))}!Hs(Fe)&&await S(Fe,q,Q)}}return Q.valid},T=()=>{for(const M of c.unMount){const q=Me(r,M);q&&(q._f.refs?q._f.refs.every(Q=>!Md(Q)):!Md(q._f.ref))&&me(M)}c.unMount=new Set},E=(M,q)=>!e.disabled&&(M&&q&&bt(i,M,q),!Wa(de(),a)),A=(M,q,Q)=>ww(M,c,{...l.mount?i:Wt(q)?a:ea(M)?{[M]:q}:q},Q,q),H=M=>od(Me(l.mount?i:a,M,e.shouldUnregister?Me(a,M,[]):[])),V=(M,q,Q={})=>{const _e=Me(r,M);let ve=q;if(_e){const fe=_e._f;fe&&(!fe.disabled&&bt(i,M,qp(q,fe)),ve=go(fe.ref)&&Gs(q)?"":q,zp(fe.ref)?[...fe.ref.options].forEach(Fe=>Fe.selected=ve.includes(Fe.value)):fe.refs?ec(fe.ref)?fe.refs.forEach(Fe=>{(!Fe.defaultChecked||!Fe.disabled)&&(Array.isArray(ve)?Fe.checked=!!ve.find(rt=>rt===Fe.value):Fe.checked=ve===Fe.value||!!ve)}):fe.refs.forEach(Fe=>Fe.checked=Fe.value===ve):gf(fe.ref)?fe.ref.value="":(fe.ref.value=ve,fe.ref.type||h.state.next({name:M,values:$t(i)})))}(Q.shouldDirty||Q.shouldTouch)&&w(M,ve,Q.shouldTouch,Q.shouldDirty,!0),Q.shouldValidate&&Y(M)},L=(M,q,Q)=>{for(const _e in q){if(!q.hasOwnProperty(_e))return;const ve=q[_e],fe=M+"."+_e,Fe=Me(r,fe);(c.array.has(M)||ns(ve)||Fe&&!Fe._f)&&!wn(ve)?L(fe,ve,Q):V(fe,ve,Q)}},P=(M,q,Q={})=>{const _e=Me(r,M),ve=c.array.has(M),fe=$t(q);bt(i,M,fe),ve?(h.array.next({name:M,values:$t(i)}),(f.isDirty||f.dirtyFields||u.isDirty||u.dirtyFields)&&Q.shouldDirty&&h.state.next({name:M,dirtyFields:Hi(a,i),isDirty:E(M,fe)})):_e&&!_e._f&&!Gs(fe)?L(M,fe,Q):V(M,fe,Q),M0(M,c)&&h.state.next({...s,name:M}),h.state.next({name:l.mount?M:void 0,values:$t(i)})},J=async M=>{l.mount=!0;const q=M.target;let Q=q.name,_e=!0;const ve=Me(r,Q),fe=Ze=>{_e=Number.isNaN(Ze)||wn(Ze)&&isNaN(Ze.getTime())||Wa(Ze,Me(i,Q,Ze))},Fe=ui(e.mode),rt=ui(e.reValidateMode);if(ve){let Ze,St;const Ke=q.type?lh(ve._f):pw(M),ct=M.type===sh.BLUR||M.type===sh.FOCUS_OUT,cs=!Tw(ve._f)&&!e.resolver&&!Me(s.errors,Q)&&!ve._f.deps||Fw(ct,Me(s.touchedFields,Q),s.isSubmitted,rt,Fe),yt=M0(Q,c,ct);bt(i,Q,Ke),ct?(!q||!q.readOnly)&&(ve._f.onBlur&&ve._f.onBlur(M),o&&o(0)):ve._f.onChange&&ve._f.onChange(M);const ee=w(Q,Ke,ct),je=!Hs(ee)||yt;if(!ct&&h.state.next({name:Q,type:M.type,values:$t(i)}),cs)return(f.isValid||u.isValid)&&(e.mode==="onBlur"?ct&&p():ct||p()),je&&h.state.next({name:Q,...yt?{}:ee});if(!ct&&yt&&h.state.next({...s}),e.resolver){const{errors:Ae}=await y([Q]);if(fe(Ke),_e){const $e=oh(s.errors,r,Q),Ve=oh(Ae,r,$e.name||Q);Ze=Ve.error,Q=Ve.name,St=Hs(Ae)}}else v([Q],!0),Ze=(await R0(ve,c.disabled,i,x,e.shouldUseNativeValidation))[Q],v([Q]),fe(Ke),_e&&(Ze?St=!1:(f.isValid||u.isValid)&&(St=await S(r,!0)));_e&&(ve._f.deps&&Y(ve._f.deps),k(Q,St,Ze,ee))}},Ee=(M,q)=>{if(Me(s.errors,q)&&M.focus)return M.focus(),1},Y=async(M,q={})=>{let Q,_e;const ve=ar(M);if(e.resolver){const fe=await N(Wt(M)?M:ve);Q=Hs(fe),_e=M?!ve.some(Fe=>Me(fe,Fe)):Q}else M?(_e=(await Promise.all(ve.map(async fe=>{const Fe=Me(r,fe);return await S(Fe&&Fe._f?{[fe]:Fe}:Fe)}))).every(Boolean),!(!_e&&!s.isValid)&&p()):_e=Q=await S(r);return h.state.next({...!ea(M)||(f.isValid||u.isValid)&&Q!==s.isValid?{}:{name:M},...e.resolver||!M?{isValid:Q}:{},errors:s.errors}),q.shouldFocus&&!_e&&vi(r,Ee,M?ve:c.mount),_e},de=M=>{const q={...l.mount?i:a};return Wt(M)?q:ea(M)?Me(q,M):M.map(Q=>Me(q,Q))},De=(M,q)=>({invalid:!!Me((q||s).errors,M),isDirty:!!Me((q||s).dirtyFields,M),error:Me((q||s).errors,M),isValidating:!!Me(s.validatingFields,M),isTouched:!!Me((q||s).touchedFields,M)}),B=M=>{M&&ar(M).forEach(q=>ss(s.errors,q)),h.state.next({errors:M?s.errors:{}})},X=(M,q,Q)=>{const _e=(Me(r,M,{_f:{}})._f||{}).ref,ve=Me(s.errors,M)||{},{ref:fe,message:Fe,type:rt,...Ze}=ve;bt(s.errors,M,{...Ze,...q,ref:_e}),h.state.next({name:M,errors:s.errors,isValid:!1}),Q&&Q.shouldFocus&&_e&&_e.focus&&_e.focus()},W=(M,q)=>Or(M)?h.state.subscribe({next:Q=>"values"in Q&&M(A(void 0,q),Q)}):A(M,q,!0),z=M=>h.state.subscribe({next:q=>{Aw(M.name,q.name,M.exact)&&Cw(q,M.formState||f,Z,M.reRenderRoot)&&M.callback({values:{...i},...s,...q,defaultValues:a})}}).unsubscribe,ae=M=>(l.mount=!0,u={...u,...M.formState},z({...M,formState:u})),me=(M,q={})=>{for(const Q of M?ar(M):c.mount)c.mount.delete(Q),c.array.delete(Q),q.keepValue||(ss(r,Q),ss(i,Q)),!q.keepError&&ss(s.errors,Q),!q.keepDirty&&ss(s.dirtyFields,Q),!q.keepTouched&&ss(s.touchedFields,Q),!q.keepIsValidating&&ss(s.validatingFields,Q),!e.shouldUnregister&&!q.keepDefaultValue&&ss(a,Q);h.state.next({values:$t(i)}),h.state.next({...s,...q.keepDirty?{isDirty:E()}:{}}),!q.keepIsValid&&p()},xe=({disabled:M,name:q})=>{(Jr(M)&&l.mount||M||c.disabled.has(q))&&(M?c.disabled.add(q):c.disabled.delete(q))},ue=(M,q={})=>{let Q=Me(r,M);const _e=Jr(q.disabled)||Jr(e.disabled);return bt(r,M,{...Q||{},_f:{...Q&&Q._f?Q._f:{ref:{name:M}},name:M,mount:!0,...q}}),c.mount.add(M),Q?xe({disabled:Jr(q.disabled)?q.disabled:e.disabled,name:M}):j(M,!0,q.value),{..._e?{disabled:q.disabled||e.disabled}:{},...e.progressive?{required:!!q.required,min:Gi(q.min),max:Gi(q.max),minLength:Gi(q.minLength),maxLength:Gi(q.maxLength),pattern:Gi(q.pattern)}:{},name:M,onChange:J,onBlur:J,ref:ve=>{if(ve){ue(M,q),Q=Me(r,M);const fe=Wt(ve.value)&&ve.querySelectorAll&&ve.querySelectorAll("input,select,textarea")[0]||ve,Fe=Nw(fe),rt=Q._f.refs||[];if(Fe?rt.find(Ze=>Ze===fe):fe===Q._f.ref)return;bt(r,M,{_f:{...Q._f,...Fe?{refs:[...rt.filter(Md),fe,...Array.isArray(Me(a,M))?[{}]:[]],ref:{type:fe.type,name:M}}:{ref:fe}}}),j(M,!1,void 0,fe)}else Q=Me(r,M,{}),Q._f&&(Q._f.mount=!1),(e.shouldUnregister||q.shouldUnregister)&&!(vw(c.array,M)&&l.action)&&c.unMount.add(M)}}},oe=()=>e.shouldFocusError&&vi(r,Ee,c.mount),ze=M=>{Jr(M)&&(h.state.next({disabled:M}),vi(r,(q,Q)=>{const _e=Me(r,Q);_e&&(q.disabled=_e._f.disabled||M,Array.isArray(_e._f.refs)&&_e._f.refs.forEach(ve=>{ve.disabled=_e._f.disabled||M}))},0,!1))},F=(M,q)=>async Q=>{let _e;Q&&(Q.preventDefault&&Q.preventDefault(),Q.persist&&Q.persist());let ve=$t(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:fe,values:Fe}=await y();s.errors=fe,ve=$t(Fe)}else await S(r);if(c.disabled.size)for(const fe of c.disabled)ss(ve,fe);if(ss(s.errors,"root"),Hs(s.errors)){h.state.next({errors:{}});try{await M(ve,Q)}catch(fe){_e=fe}}else q&&await q({...s.errors},Q),oe(),setTimeout(oe);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Hs(s.errors)&&!_e,submitCount:s.submitCount+1,errors:s.errors}),_e)throw _e},ye=(M,q={})=>{Me(r,M)&&(Wt(q.defaultValue)?P(M,$t(Me(a,M))):(P(M,q.defaultValue),bt(a,M,$t(q.defaultValue))),q.keepTouched||ss(s.touchedFields,M),q.keepDirty||(ss(s.dirtyFields,M),s.isDirty=q.defaultValue?E(M,$t(Me(a,M))):E()),q.keepError||(ss(s.errors,M),f.isValid&&p()),h.state.next({...s}))},Ie=(M,q={})=>{const Q=M?$t(M):a,_e=$t(Q),ve=Hs(M),fe=ve?a:_e;if(q.keepDefaultValues||(a=Q),!q.keepValues){if(q.keepDirtyValues){const Fe=new Set([...c.mount,...Object.keys(Hi(a,i))]);for(const rt of Array.from(Fe))Me(s.dirtyFields,rt)?bt(fe,rt,Me(i,rt)):P(rt,Me(fe,rt))}else{if(xf&&Wt(M))for(const Fe of c.mount){const rt=Me(r,Fe);if(rt&&rt._f){const Ze=Array.isArray(rt._f.refs)?rt._f.refs[0]:rt._f.ref;if(go(Ze)){const St=Ze.closest("form");if(St){St.reset();break}}}}if(q.keepFieldsRef)for(const Fe of c.mount)P(Fe,Me(fe,Fe));else r={}}i=e.shouldUnregister?q.keepDefaultValues?$t(a):{}:$t(fe),h.array.next({values:{...fe}}),h.state.next({values:{...fe}})}c={mount:q.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!f.isValid||!!q.keepIsValid||!!q.keepDirtyValues,l.watch=!!e.shouldUnregister,h.state.next({submitCount:q.keepSubmitCount?s.submitCount:0,isDirty:ve?!1:q.keepDirty?s.isDirty:!!(q.keepDefaultValues&&!Wa(M,a)),isSubmitted:q.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:ve?{}:q.keepDirtyValues?q.keepDefaultValues&&i?Hi(a,i):s.dirtyFields:q.keepDefaultValues&&M?Hi(a,M):q.keepDirty?s.dirtyFields:{},touchedFields:q.keepTouched?s.touchedFields:{},errors:q.keepErrors?s.errors:{},isSubmitSuccessful:q.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:a})},Le=(M,q)=>Ie(Or(M)?M(i):M,q),K=(M,q={})=>{const Q=Me(r,M),_e=Q&&Q._f;if(_e){const ve=_e.refs?_e.refs[0]:_e.ref;ve.focus&&(ve.focus(),q.shouldSelect&&Or(ve.select)&&ve.select())}},Z=M=>{s={...s,...M}},Te={control:{register:ue,unregister:me,getFieldState:De,handleSubmit:F,setError:X,_subscribe:z,_runSchema:y,_focusError:oe,_getWatch:A,_getDirty:E,_setValid:p,_setFieldArray:b,_setDisabledField:xe,_setErrors:g,_getFieldArray:H,_reset:Ie,_resetDefaultValues:()=>Or(e.defaultValues)&&e.defaultValues().then(M=>{Le(M,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:T,_disableForm:ze,_subjects:h,_proxyFormState:f,get _fields(){return r},get _formValues(){return i},get _state(){return l},set _state(M){l=M},get _defaultValues(){return a},get _names(){return c},set _names(M){c=M},get _formState(){return s},get _options(){return e},set _options(M){e={...e,...M}}},subscribe:ae,trigger:Y,register:ue,handleSubmit:F,watch:W,setValue:P,getValues:de,reset:Le,resetField:ye,clearErrors:B,unregister:me,setError:X,setFocus:K,getFieldState:De};return{...Te,formControl:Te}}var Ia=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const t=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const s=(Math.random()*16+t)%16|0;return(e=="x"?s:s&3|8).toString(16)})},Rd=(t,e,s={})=>s.shouldFocus||Wt(s.shouldFocus)?s.focusName||`${t}.${Wt(s.focusIndex)?e:s.focusIndex}.`:"",Id=(t,e)=>[...t,...ar(e)],Ld=t=>Array.isArray(t)?t.map(()=>{}):void 0;function Bd(t,e,s){return[...t.slice(0,e),...ar(s),...t.slice(e)]}var Ud=(t,e,s)=>Array.isArray(t)?(Wt(t[s])&&(t[s]=void 0),t.splice(s,0,t.splice(e,1)[0]),t):[],$d=(t,e)=>[...ar(e),...ar(t)];function Mw(t,e){let s=0;const r=[...t];for(const a of e)r.splice(a-s,1),s++;return od(r).length?r:[]}var Wd=(t,e)=>Wt(e)?[]:Mw(t,ar(e).sort((s,r)=>s-r)),Vd=(t,e,s)=>{[t[e],t[s]]=[t[s],t[e]]},fh=(t,e,s)=>(t[e]=s,t);function Rw(t){const e=bw(),{control:s=e.control,name:r,keyName:a="id",shouldUnregister:i,rules:l}=t,[c,o]=at.useState(s._getFieldArray(r)),d=at.useRef(s._getFieldArray(r).map(Ia)),f=at.useRef(c),u=at.useRef(!1);f.current=c,s._names.array.add(r),at.useMemo(()=>l&&s.register(r,l),[s,l,r]),Wp(()=>s._subjects.array.subscribe({next:({values:w,name:k})=>{if(k===r||!k){const y=Me(w,r);Array.isArray(y)&&(o(y),d.current=y.map(Ia))}}}).unsubscribe,[s,r]);const h=at.useCallback(w=>{u.current=!0,s._setFieldArray(r,w)},[s,r]),x=(w,k)=>{const y=ar($t(w)),N=Id(s._getFieldArray(r),y);s._names.focus=Rd(r,N.length-1,k),d.current=Id(d.current,y.map(Ia)),h(N),o(N),s._setFieldArray(r,N,Id,{argA:Ld(w)})},m=(w,k)=>{const y=ar($t(w)),N=$d(s._getFieldArray(r),y);s._names.focus=Rd(r,0,k),d.current=$d(d.current,y.map(Ia)),h(N),o(N),s._setFieldArray(r,N,$d,{argA:Ld(w)})},p=w=>{const k=Wd(s._getFieldArray(r),w);d.current=Wd(d.current,w),h(k),o(k),!Array.isArray(Me(s._fields,r))&&bt(s._fields,r,void 0),s._setFieldArray(r,k,Wd,{argA:w})},v=(w,k,y)=>{const N=ar($t(k)),S=Bd(s._getFieldArray(r),w,N);s._names.focus=Rd(r,w,y),d.current=Bd(d.current,w,N.map(Ia)),h(S),o(S),s._setFieldArray(r,S,Bd,{argA:w,argB:Ld(k)})},b=(w,k)=>{const y=s._getFieldArray(r);Vd(y,w,k),Vd(d.current,w,k),h(y),o(y),s._setFieldArray(r,y,Vd,{argA:w,argB:k},!1)},_=(w,k)=>{const y=s._getFieldArray(r);Ud(y,w,k),Ud(d.current,w,k),h(y),o(y),s._setFieldArray(r,y,Ud,{argA:w,argB:k},!1)},g=(w,k)=>{const y=$t(k),N=fh(s._getFieldArray(r),w,y);d.current=[...N].map((S,T)=>!S||T===w?Ia():d.current[T]),h(N),o([...N]),s._setFieldArray(r,N,fh,{argA:w,argB:y},!0,!1)},j=w=>{const k=ar($t(w));d.current=k.map(Ia),h([...k]),o([...k]),s._setFieldArray(r,[...k],y=>y,{},!0,!1)};return at.useEffect(()=>{if(s._state.action=!1,M0(r,s._names)&&s._subjects.state.next({...s._formState}),u.current&&(!ui(s._options.mode).isOnSubmit||s._formState.isSubmitted)&&!ui(s._options.reValidateMode).isOnSubmit)if(s._options.resolver)s._runSchema([r]).then(w=>{const k=Me(w.errors,r),y=Me(s._formState.errors,r);(y?!k&&y.type||k&&(y.type!==k.type||y.message!==k.message):k&&k.type)&&(k?bt(s._formState.errors,r,k):ss(s._formState.errors,r),s._subjects.state.next({errors:s._formState.errors}))});else{const w=Me(s._fields,r);w&&w._f&&!(ui(s._options.reValidateMode).isOnSubmit&&ui(s._options.mode).isOnSubmit)&&R0(w,s._names.disabled,s._formValues,s._options.criteriaMode===Nr.all,s._options.shouldUseNativeValidation,!0).then(k=>!Hs(k)&&s._subjects.state.next({errors:Kp(s._formState.errors,k,r)}))}s._subjects.state.next({name:r,values:$t(s._formValues)}),s._names.focus&&vi(s._fields,(w,k)=>{if(s._names.focus&&k.startsWith(s._names.focus)&&w.focus)return w.focus(),1}),s._names.focus="",s._setValid(),u.current=!1},[c,r,s]),at.useEffect(()=>(!Me(s._formValues,r)&&s._setFieldArray(r),()=>{const w=(k,y)=>{const N=Me(s._fields,k);N&&N._f&&(N._f.mount=y)};s._options.shouldUnregister||i?s.unregister(r):w(r,!1)}),[r,s,a,i]),{swap:at.useCallback(b,[h,r,s]),move:at.useCallback(_,[h,r,s]),prepend:at.useCallback(m,[h,r,s]),append:at.useCallback(x,[h,r,s]),remove:at.useCallback(p,[h,r,s]),insert:at.useCallback(v,[h,r,s]),update:at.useCallback(g,[h,r,s]),replace:at.useCallback(j,[h,r,s]),fields:at.useMemo(()=>c.map((w,k)=>({...w,[a]:d.current[k]||Ia()})),[c,a])}}function Mi(t={}){const e=at.useRef(void 0),s=at.useRef(void 0),[r,a]=at.useState({isDirty:!1,isValidating:!1,isLoading:Or(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Or(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:r},t.defaultValues&&!Or(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:l,...c}=Pw(t);e.current={...c,formState:r}}const i=e.current.control;return i._options=t,Wp(()=>{const l=i._subscribe({formState:i._proxyFormState,callback:()=>a({...i._formState}),reRenderRoot:!0});return a(c=>({...c,isReady:!0})),i._formState.isReady=!0,l},[i]),at.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),at.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),at.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),at.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),at.useEffect(()=>{if(i._proxyFormState.isDirty){const l=i._getDirty();l!==r.isDirty&&i._subjects.state.next({isDirty:l})}},[i,r.isDirty]),at.useEffect(()=>{t.values&&!Wa(t.values,s.current)?(i._reset(t.values,{keepFieldsRef:!0,...i._options.resetOptions}),s.current=t.values,a(l=>({...l}))):i._resetDefaultValues()},[i,t.values]),at.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=_w(r,i),e.current}const uh=(t,e,s)=>{if(t&&"reportValidity"in t){const r=Me(s,e);t.setCustomValidity(r&&r.message||""),t.reportValidity()}},Jp=(t,e)=>{for(const s in e.fields){const r=e.fields[s];r&&r.ref&&"reportValidity"in r.ref?uh(r.ref,s,t):r.refs&&r.refs.forEach(a=>uh(a,s,t))}},Iw=(t,e)=>{e.shouldUseNativeValidation&&Jp(t,e);const s={};for(const r in t){const a=Me(e.fields,r),i=Object.assign(t[r]||{},{ref:a&&a.ref});if(Lw(e.names||Object.keys(t),r)){const l=Object.assign({},Me(s,r));bt(l,"root",i),bt(s,r,l)}else bt(s,r,i)}return s},Lw=(t,e)=>t.some(s=>s.startsWith(e+"."));function Ri(t,e,s){return e===void 0&&(e={}),s===void 0&&(s={}),function(r,a,i){try{return Promise.resolve(function(l,c){try{var o=(e.context,Promise.resolve(t[s.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},e,{context:a}))).then(function(d){return i.shouldUseNativeValidation&&Jp({},i),{values:s.raw?r:d,errors:{}}}))}catch(d){return c(d)}return o&&o.then?o.then(void 0,c):o}(0,function(l){if(!l.inner)throw l;return{values:{},errors:Iw((c=l,o=!i.shouldUseNativeValidation&&i.criteriaMode==="all",(c.inner||[]).reduce(function(d,f){if(d[f.path]||(d[f.path]={message:f.message,type:f.type}),o){var u=d[f.path].types,h=u&&u[f.type];d[f.path]=Vp(f.path,o,d,f.type,h?[].concat(h,f.message):f.message)}return d},{})),i)};var c,o}))}catch(l){return Promise.reject(l)}}}function Hn(t){this._maxSize=t,this.clear()}Hn.prototype.clear=function(){this._size=0,this._values=Object.create(null)};Hn.prototype.get=function(t){return this._values[t]};Hn.prototype.set=function(t,e){return this._size>=this._maxSize&&this.clear(),t in this._values||this._size++,this._values[t]=e};var Bw=/[^.^\]^[]+|(?=\[\]|\.\.)/g,Zp=/^\d+$/,Uw=/^\d/,$w=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,Ww=/^\s*(['"]?)(.*?)(\1)\s*$/,yf=512,hh=new Hn(yf),mh=new Hn(yf),xh=new Hn(yf),En={Cache:Hn,split:I0,normalizePath:zd,setter:function(t){var e=zd(t);return mh.get(t)||mh.set(t,function(r,a){for(var i=0,l=e.length,c=r;i<l-1;){var o=e[i];if(o==="__proto__"||o==="constructor"||o==="prototype")return r;c=c[e[i++]]}c[e[i]]=a})},getter:function(t,e){var s=zd(t);return xh.get(t)||xh.set(t,function(a){for(var i=0,l=s.length;i<l;)if(a!=null||!e)a=a[s[i++]];else return;return a})},join:function(t){return t.reduce(function(e,s){return e+(bf(s)||Zp.test(s)?"["+s+"]":(e?".":"")+s)},"")},forEach:function(t,e,s){Vw(Array.isArray(t)?t:I0(t),e,s)}};function zd(t){return hh.get(t)||hh.set(t,I0(t).map(function(e){return e.replace(Ww,"$2")}))}function I0(t){return t.match(Bw)||[""]}function Vw(t,e,s){var r=t.length,a,i,l,c;for(i=0;i<r;i++)a=t[i],a&&(Gw(a)&&(a='"'+a+'"'),c=bf(a),l=!c&&/^\d+$/.test(a),e.call(s,a,c,l,i,t))}function bf(t){return typeof t=="string"&&t&&["'",'"'].indexOf(t.charAt(0))!==-1}function zw(t){return t.match(Uw)&&!t.match(Zp)}function Hw(t){return $w.test(t)}function Gw(t){return!bf(t)&&(zw(t)||Hw(t))}const Xw=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,dd=t=>t.match(Xw)||[],fd=t=>t[0].toUpperCase()+t.slice(1),_f=(t,e)=>dd(t).join(e).toLowerCase(),Qp=t=>dd(t).reduce((e,s)=>`${e}${e?s[0].toUpperCase()+s.slice(1).toLowerCase():s.toLowerCase()}`,""),qw=t=>fd(Qp(t)),Yw=t=>_f(t,"_"),Kw=t=>_f(t,"-"),Jw=t=>fd(_f(t," ")),Zw=t=>dd(t).map(fd).join(" ");var Hd={words:dd,upperFirst:fd,camelCase:Qp,pascalCase:qw,snakeCase:Yw,kebabCase:Kw,sentenceCase:Jw,titleCase:Zw},wf={exports:{}};wf.exports=function(t){return eg(Qw(t),t)};wf.exports.array=eg;function eg(t,e){var s=t.length,r=new Array(s),a={},i=s,l=e2(e),c=t2(t);for(e.forEach(function(d){if(!c.has(d[0])||!c.has(d[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});i--;)a[i]||o(t[i],i,new Set);return r;function o(d,f,u){if(u.has(d)){var h;try{h=", node was:"+JSON.stringify(d)}catch{h=""}throw new Error("Cyclic dependency"+h)}if(!c.has(d))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(d));if(!a[f]){a[f]=!0;var x=l.get(d)||new Set;if(x=Array.from(x),f=x.length){u.add(d);do{var m=x[--f];o(m,c.get(m),u)}while(f);u.delete(d)}r[--s]=d}}}function Qw(t){for(var e=new Set,s=0,r=t.length;s<r;s++){var a=t[s];e.add(a[0]),e.add(a[1])}return Array.from(e)}function e2(t){for(var e=new Map,s=0,r=t.length;s<r;s++){var a=t[s];e.has(a[0])||e.set(a[0],new Set),e.has(a[1])||e.set(a[1],new Set),e.get(a[0]).add(a[1])}return e}function t2(t){for(var e=new Map,s=0,r=t.length;s<r;s++)e.set(t[s],s);return e}var s2=wf.exports;const r2=By(s2),a2=Object.prototype.toString,n2=Error.prototype.toString,i2=RegExp.prototype.toString,l2=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",c2=/^Symbol\((.*)\)(.*)$/;function o2(t){return t!=+t?"NaN":t===0&&1/t<0?"-0":""+t}function ph(t,e=!1){if(t==null||t===!0||t===!1)return""+t;const s=typeof t;if(s==="number")return o2(t);if(s==="string")return e?`"${t}"`:t;if(s==="function")return"[Function "+(t.name||"anonymous")+"]";if(s==="symbol")return l2.call(t).replace(c2,"Symbol($1)");const r=a2.call(t).slice(8,-1);return r==="Date"?isNaN(t.getTime())?""+t:t.toISOString(t):r==="Error"||t instanceof Error?"["+n2.call(t)+"]":r==="RegExp"?i2.call(t):null}function ja(t,e){let s=ph(t,e);return s!==null?s:JSON.stringify(t,function(r,a){let i=ph(this[r],e);return i!==null?i:a},2)}function tg(t){return t==null?[]:[].concat(t)}let sg,rg,ag,d2=/\$\{\s*(\w+)\s*\}/g;sg=Symbol.toStringTag;class gh{constructor(e,s,r,a){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[sg]="Error",this.name="ValidationError",this.value=s,this.path=r,this.type=a,this.errors=[],this.inner=[],tg(e).forEach(i=>{if(Ys.isError(i)){this.errors.push(...i.errors);const l=i.inner.length?i.inner:[i];this.inner.push(...l)}else this.errors.push(i)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}rg=Symbol.hasInstance;ag=Symbol.toStringTag;class Ys extends Error{static formatError(e,s){const r=s.label||s.path||"this";return s=Object.assign({},s,{path:r,originalPath:s.path}),typeof e=="string"?e.replace(d2,(a,i)=>ja(s[i])):typeof e=="function"?e(s):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,s,r,a,i){const l=new gh(e,s,r,a);if(i)return l;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[ag]="Error",this.name=l.name,this.message=l.message,this.type=l.type,this.value=l.value,this.path=l.path,this.errors=l.errors,this.inner=l.inner,Error.captureStackTrace&&Error.captureStackTrace(this,Ys)}static[rg](e){return gh[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let Zr={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:t,type:e,value:s,originalValue:r})=>{const a=r!=null&&r!==s?` (cast from the value \`${ja(r,!0)}\`).`:".";return e!=="mixed"?`${t} must be a \`${e}\` type, but the final value was: \`${ja(s,!0)}\``+a:`${t} must match the configured type. The validated value was: \`${ja(s,!0)}\``+a}},er={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},$a={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},L0={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},B0={isValue:"${path} field must be ${value}"},Yc={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},Kc={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},f2={notType:t=>{const{path:e,value:s,spec:r}=t,a=r.types.length;if(Array.isArray(s)){if(s.length<a)return`${e} tuple value has too few items, expected a length of ${a} but got ${s.length} for value: \`${ja(s,!0)}\``;if(s.length>a)return`${e} tuple value has too many items, expected a length of ${a} but got ${s.length} for value: \`${ja(s,!0)}\``}return Ys.formatError(Zr.notType,t)}};Object.assign(Object.create(null),{mixed:Zr,string:er,number:$a,date:L0,object:Yc,array:Kc,boolean:B0,tuple:f2});const ud=t=>t&&t.__isYupSchema__;class bo{static fromOptions(e,s){if(!s.then&&!s.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:a,otherwise:i}=s,l=typeof r=="function"?r:(...c)=>c.every(o=>o===r);return new bo(e,(c,o)=>{var d;let f=l(...c)?a:i;return(d=f==null?void 0:f(o))!=null?d:o})}constructor(e,s){this.fn=void 0,this.refs=e,this.refs=e,this.fn=s}resolve(e,s){let r=this.refs.map(i=>i.getValue(s==null?void 0:s.value,s==null?void 0:s.parent,s==null?void 0:s.context)),a=this.fn(r,e,s);if(a===void 0||a===e)return e;if(!ud(a))throw new TypeError("conditions must return a schema object");return a.resolve(s)}}const xc={context:"$",value:"."};class Gn{constructor(e,s={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===xc.context,this.isValue=this.key[0]===xc.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?xc.context:this.isValue?xc.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&En.getter(this.path,!0),this.map=s.map}getValue(e,s,r){let a=this.isContext?r:this.isValue?e:s;return this.getter&&(a=this.getter(a||{})),this.map&&(a=this.map(a)),a}cast(e,s){return this.getValue(e,s==null?void 0:s.parent,s==null?void 0:s.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}Gn.prototype.__isYupRef=!0;const Dr=t=>t==null;function ai(t){function e({value:s,path:r="",options:a,originalValue:i,schema:l},c,o){const{name:d,test:f,params:u,message:h,skipAbsent:x}=t;let{parent:m,context:p,abortEarly:v=l.spec.abortEarly,disableStackTrace:b=l.spec.disableStackTrace}=a;const _={value:s,parent:m,context:p};function g(E={}){const A=ng(Object.assign({value:s,originalValue:i,label:l.spec.label,path:E.path||r,spec:l.spec,disableStackTrace:E.disableStackTrace||b},u,E.params),_),H=new Ys(Ys.formatError(E.message||h,A),s,A.path,E.type||d,A.disableStackTrace);return H.params=A,H}const j=v?c:o;let w={path:r,parent:m,type:d,from:a.from,createError:g,resolve(E){return ig(E,_)},options:a,originalValue:i,schema:l};const k=E=>{Ys.isError(E)?j(E):E?o(null):j(g())},y=E=>{Ys.isError(E)?j(E):c(E)};if(x&&Dr(s))return k(!0);let S;try{var T;if(S=f.call(w,s,w),typeof((T=S)==null?void 0:T.then)=="function"){if(a.sync)throw new Error(`Validation test of type: "${w.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(S).then(k,y)}}catch(E){y(E);return}k(S)}return e.OPTIONS=t,e}function ng(t,e){if(!t)return t;for(const s of Object.keys(t))t[s]=ig(t[s],e);return t}function ig(t,e){return Gn.isRef(t)?t.getValue(e.value,e.parent,e.context):t}function u2(t,e,s,r=s){let a,i,l;return e?(En.forEach(e,(c,o,d)=>{let f=o?c.slice(1,c.length-1):c;t=t.resolve({context:r,parent:a,value:s});let u=t.type==="tuple",h=d?parseInt(f,10):0;if(t.innerType||u){if(u&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${l}" must contain an index to the tuple element, e.g. "${l}[0]"`);if(s&&h>=s.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${c}, in the path: ${e}. because there is no value at that index. `);a=s,s=s&&s[h],t=u?t.spec.types[h]:t.innerType}if(!d){if(!t.fields||!t.fields[f])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${l} which is a type: "${t.type}")`);a=s,s=s&&s[f],t=t.fields[f]}i=f,l=o?"["+c+"]":"."+c}),{schema:t,parent:a,parentPath:i}):{parent:a,parentPath:e,schema:t}}class _o extends Set{describe(){const e=[];for(const s of this.values())e.push(Gn.isRef(s)?s.describe():s);return e}resolveAll(e){let s=[];for(const r of this.values())s.push(e(r));return s}clone(){return new _o(this.values())}merge(e,s){const r=this.clone();return e.forEach(a=>r.add(a)),s.forEach(a=>r.delete(a)),r}}function hi(t,e=new Map){if(ud(t)||!t||typeof t!="object")return t;if(e.has(t))return e.get(t);let s;if(t instanceof Date)s=new Date(t.getTime()),e.set(t,s);else if(t instanceof RegExp)s=new RegExp(t),e.set(t,s);else if(Array.isArray(t)){s=new Array(t.length),e.set(t,s);for(let r=0;r<t.length;r++)s[r]=hi(t[r],e)}else if(t instanceof Map){s=new Map,e.set(t,s);for(const[r,a]of t.entries())s.set(r,hi(a,e))}else if(t instanceof Set){s=new Set,e.set(t,s);for(const r of t)s.add(hi(r,e))}else if(t instanceof Object){s={},e.set(t,s);for(const[r,a]of Object.entries(t))s[r]=hi(a,e)}else throw Error(`Unable to clone ${t}`);return s}function h2(t){if(!(t!=null&&t.length))return;const e=[];let s="",r=!1,a=!1;for(let i=0;i<t.length;i++){const l=t[i];if(l==="["&&!a){s&&(e.push(...s.split(".").filter(Boolean)),s=""),r=!0;continue}if(l==="]"&&!a){s&&(/^\d+$/.test(s)?e.push(s):e.push(s.replace(/^"|"$/g,"")),s=""),r=!1;continue}if(l==='"'){a=!a;continue}if(l==="."&&!r&&!a){s&&(e.push(s),s="");continue}s+=l}return s&&e.push(...s.split(".").filter(Boolean)),e}function m2(t,e){const s=e?`${e}.${t.path}`:t.path;return t.errors.map(r=>({message:r,path:h2(s)}))}function lg(t,e){var s;if(!((s=t.inner)!=null&&s.length)&&t.errors.length)return m2(t,e);const r=e?`${e}.${t.path}`:t.path;return t.inner.flatMap(a=>lg(a,r))}class mr{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new _o,this._blacklist=new _o,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(Zr.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(s=>{s.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const s=Object.create(Object.getPrototypeOf(this));return s.type=this.type,s._typeCheck=this._typeCheck,s._whitelist=this._whitelist.clone(),s._blacklist=this._blacklist.clone(),s.internalTests=Object.assign({},this.internalTests),s.exclusiveTests=Object.assign({},this.exclusiveTests),s.deps=[...this.deps],s.conditions=[...this.conditions],s.tests=[...this.tests],s.transforms=[...this.transforms],s.spec=hi(Object.assign({},this.spec,e)),s}label(e){let s=this.clone();return s.spec.label=e,s}meta(...e){if(e.length===0)return this.spec.meta;let s=this.clone();return s.spec.meta=Object.assign(s.spec.meta||{},e[0]),s}withMutation(e){let s=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=s,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let s=this,r=e.clone();const a=Object.assign({},s.spec,r.spec);return r.spec=a,r.internalTests=Object.assign({},s.internalTests,r.internalTests),r._whitelist=s._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=s._blacklist.merge(e._blacklist,e._whitelist),r.tests=s.tests,r.exclusiveTests=s.exclusiveTests,r.withMutation(i=>{e.tests.forEach(l=>{i.test(l.OPTIONS)})}),r.transforms=[...s.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let s=this;if(s.conditions.length){let r=s.conditions;s=s.clone(),s.conditions=[],s=r.reduce((a,i)=>i.resolve(a,e),s),s=s.resolve(e)}return s}resolveOptions(e){var s,r,a,i;return Object.assign({},e,{from:e.from||[],strict:(s=e.strict)!=null?s:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(a=e.recursive)!=null?a:this.spec.recursive,disableStackTrace:(i=e.disableStackTrace)!=null?i:this.spec.disableStackTrace})}cast(e,s={}){let r=this.resolve(Object.assign({value:e},s)),a=s.assert==="ignore-optionality",i=r._cast(e,s);if(s.assert!==!1&&!r.isType(i)){if(a&&Dr(i))return i;let l=ja(e),c=ja(i);throw new TypeError(`The value of ${s.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${l} 
`+(c!==l?`result of cast: ${c}`:""))}return i}_cast(e,s){let r=e===void 0?e:this.transforms.reduce((a,i)=>i.call(this,a,e,this),e);return r===void 0&&(r=this.getDefault(s)),r}_validate(e,s={},r,a){let{path:i,originalValue:l=e,strict:c=this.spec.strict}=s,o=e;c||(o=this._cast(o,Object.assign({assert:!1},s)));let d=[];for(let f of Object.values(this.internalTests))f&&d.push(f);this.runTests({path:i,value:o,originalValue:l,options:s,tests:d},r,f=>{if(f.length)return a(f,o);this.runTests({path:i,value:o,originalValue:l,options:s,tests:this.tests},r,a)})}runTests(e,s,r){let a=!1,{tests:i,value:l,originalValue:c,path:o,options:d}=e,f=p=>{a||(a=!0,s(p,l))},u=p=>{a||(a=!0,r(p,l))},h=i.length,x=[];if(!h)return u([]);let m={value:l,originalValue:c,path:o,options:d,schema:this};for(let p=0;p<i.length;p++){const v=i[p];v(m,f,function(_){_&&(Array.isArray(_)?x.push(..._):x.push(_)),--h<=0&&u(x)})}}asNestedTest({key:e,index:s,parent:r,parentPath:a,originalParent:i,options:l}){const c=e??s;if(c==null)throw TypeError("Must include `key` or `index` for nested validations");const o=typeof c=="number";let d=r[c];const f=Object.assign({},l,{strict:!0,parent:r,value:d,originalValue:i[c],key:void 0,[o?"index":"key"]:c,path:o||c.includes(".")?`${a||""}[${o?c:`"${c}"`}]`:(a?`${a}.`:"")+e});return(u,h,x)=>this.resolve(f)._validate(d,f,h,x)}validate(e,s){var r;let a=this.resolve(Object.assign({},s,{value:e})),i=(r=s==null?void 0:s.disableStackTrace)!=null?r:a.spec.disableStackTrace;return new Promise((l,c)=>a._validate(e,s,(o,d)=>{Ys.isError(o)&&(o.value=d),c(o)},(o,d)=>{o.length?c(new Ys(o,d,void 0,void 0,i)):l(d)}))}validateSync(e,s){var r;let a=this.resolve(Object.assign({},s,{value:e})),i,l=(r=s==null?void 0:s.disableStackTrace)!=null?r:a.spec.disableStackTrace;return a._validate(e,Object.assign({},s,{sync:!0}),(c,o)=>{throw Ys.isError(c)&&(c.value=o),c},(c,o)=>{if(c.length)throw new Ys(c,e,void 0,void 0,l);i=o}),i}isValid(e,s){return this.validate(e,s).then(()=>!0,r=>{if(Ys.isError(r))return!1;throw r})}isValidSync(e,s){try{return this.validateSync(e,s),!0}catch(r){if(Ys.isError(r))return!1;throw r}}_getDefault(e){let s=this.spec.default;return s==null?s:typeof s=="function"?s.call(this,e):hi(s)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,s){const r=this.clone({nullable:e});return r.internalTests.nullable=ai({message:s,name:"nullable",test(a){return a===null?this.schema.spec.nullable:!0}}),r}optionality(e,s){const r=this.clone({optional:e});return r.internalTests.optionality=ai({message:s,name:"optionality",test(a){return a===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=Zr.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=Zr.notNull){return this.nullability(!1,e)}required(e=Zr.required){return this.clone().withMutation(s=>s.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let s=this.clone();return s.transforms.push(e),s}test(...e){let s;if(e.length===1?typeof e[0]=="function"?s={test:e[0]}:s=e[0]:e.length===2?s={name:e[0],test:e[1]}:s={name:e[0],message:e[1],test:e[2]},s.message===void 0&&(s.message=Zr.default),typeof s.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),a=ai(s),i=s.exclusive||s.name&&r.exclusiveTests[s.name]===!0;if(s.exclusive&&!s.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return s.name&&(r.exclusiveTests[s.name]=!!s.exclusive),r.tests=r.tests.filter(l=>!(l.OPTIONS.name===s.name&&(i||l.OPTIONS.test===a.OPTIONS.test))),r.tests.push(a),r}when(e,s){!Array.isArray(e)&&typeof e!="string"&&(s=e,e=".");let r=this.clone(),a=tg(e).map(i=>new Gn(i));return a.forEach(i=>{i.isSibling&&r.deps.push(i.key)}),r.conditions.push(typeof s=="function"?new bo(a,s):bo.fromOptions(a,s)),r}typeError(e){let s=this.clone();return s.internalTests.typeError=ai({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),s}oneOf(e,s=Zr.oneOf){let r=this.clone();return e.forEach(a=>{r._whitelist.add(a),r._blacklist.delete(a)}),r.internalTests.whiteList=ai({message:s,name:"oneOf",skipAbsent:!0,test(a){let i=this.schema._whitelist,l=i.resolveAll(this.resolve);return l.includes(a)?!0:this.createError({params:{values:Array.from(i).join(", "),resolved:l}})}}),r}notOneOf(e,s=Zr.notOneOf){let r=this.clone();return e.forEach(a=>{r._blacklist.add(a),r._whitelist.delete(a)}),r.internalTests.blacklist=ai({message:s,name:"notOneOf",test(a){let i=this.schema._blacklist,l=i.resolveAll(this.resolve);return l.includes(a)?this.createError({params:{values:Array.from(i).join(", "),resolved:l}}):!0}}),r}strip(e=!0){let s=this.clone();return s.spec.strip=e,s}describe(e){const s=(e?this.resolve(e):this).clone(),{label:r,meta:a,optional:i,nullable:l}=s.spec;return{meta:a,label:r,optional:i,nullable:l,default:s.getDefault(e),type:s.type,oneOf:s._whitelist.describe(),notOneOf:s._blacklist.describe(),tests:s.tests.filter((o,d,f)=>f.findIndex(u=>u.OPTIONS.name===o.OPTIONS.name)===d).map(o=>{const d=o.OPTIONS.params&&e?ng(Object.assign({},o.OPTIONS.params),e):o.OPTIONS.params;return{name:o.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(r){try{return{value:await e.validate(r,{abortEarly:!1})}}catch(a){if(a instanceof Ys)return{issues:lg(a)};throw a}}}}}mr.prototype.__isYupSchema__=!0;for(const t of["validate","validateSync"])mr.prototype[`${t}At`]=function(e,s,r={}){const{parent:a,parentPath:i,schema:l}=u2(this,e,s,r.context);return l[t](a&&a[i],Object.assign({},r,{parent:a,path:e}))};for(const t of["equals","is"])mr.prototype[t]=mr.prototype.oneOf;for(const t of["not","nope"])mr.prototype[t]=mr.prototype.notOneOf;function Nf(){return new cg}class cg extends mr{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,s,r)=>{if(r.spec.coerce&&!r.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=B0.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(s){return Dr(s)||s===!0}})}isFalse(e=B0.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(s){return Dr(s)||s===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}Nf.prototype=cg.prototype;const x2=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function p2(t){const e=U0(t);if(!e)return Date.parse?Date.parse(t):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let s=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(s=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(s=0-s)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+s,e.second,e.millisecond)}function U0(t){var e,s;const r=x2.exec(t);return r?{year:xa(r[1]),month:xa(r[2],1)-1,day:xa(r[3],1),hour:xa(r[4]),minute:xa(r[5]),second:xa(r[6]),millisecond:r[7]?xa(r[7].substring(0,3)):0,precision:(e=(s=r[7])==null?void 0:s.length)!=null?e:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:xa(r[10]),minuteOffset:xa(r[11])}:null}function xa(t,e=0){return Number(t)||e}let g2=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,v2=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,y2=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,b2="^\\d{4}-\\d{2}-\\d{2}",_2="\\d{2}:\\d{2}:\\d{2}",w2="(([+-]\\d{2}(:?\\d{2})?)|Z)",N2=new RegExp(`${b2}T${_2}(\\.\\d+)?${w2}$`),j2=t=>Dr(t)||t===t.trim(),k2={}.toString();function Vt(){return new og}class og extends mr{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,s,r)=>{if(!r.spec.coerce||r.isType(e)||Array.isArray(e))return e;const a=e!=null&&e.toString?e.toString():e;return a===k2?e:a})})}required(e){return super.required(e).withMutation(s=>s.test({message:e||Zr.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(s=>s.OPTIONS.name!=="required"),e))}length(e,s=er.length){return this.test({message:s,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,s=er.min){return this.test({message:s,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,s=er.max){return this.test({name:"max",exclusive:!0,message:s,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,s){let r=!1,a,i;return s&&(typeof s=="object"?{excludeEmptyString:r=!1,message:a,name:i}=s:a=s),this.test({name:i||"matches",message:a||er.matches,params:{regex:e},skipAbsent:!0,test:l=>l===""&&r||l.search(e)!==-1})}email(e=er.email){return this.matches(g2,{name:"email",message:e,excludeEmptyString:!0})}url(e=er.url){return this.matches(v2,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=er.uuid){return this.matches(y2,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let s="",r,a;return e&&(typeof e=="object"?{message:s="",allowOffset:r=!1,precision:a=void 0}=e:s=e),this.matches(N2,{name:"datetime",message:s||er.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:s||er.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:i=>{if(!i||r)return!0;const l=U0(i);return l?!!l.z:!1}}).test({name:"datetime_precision",message:s||er.datetime_precision,params:{precision:a},skipAbsent:!0,test:i=>{if(!i||a==null)return!0;const l=U0(i);return l?l.precision===a:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=er.trim){return this.transform(s=>s!=null?s.trim():s).test({message:e,name:"trim",test:j2})}lowercase(e=er.lowercase){return this.transform(s=>Dr(s)?s:s.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:s=>Dr(s)||s===s.toLowerCase()})}uppercase(e=er.uppercase){return this.transform(s=>Dr(s)?s:s.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:s=>Dr(s)||s===s.toUpperCase()})}}Vt.prototype=og.prototype;let S2=t=>t!=+t;function Ks(){return new dg}class dg extends mr{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!S2(e)}}),this.withMutation(()=>{this.transform((e,s,r)=>{if(!r.spec.coerce)return e;let a=e;if(typeof a=="string"){if(a=a.replace(/\s/g,""),a==="")return NaN;a=+a}return r.isType(a)||a===null?a:parseFloat(a)})})}min(e,s=$a.min){return this.test({message:s,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(e)}})}max(e,s=$a.max){return this.test({message:s,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(e)}})}lessThan(e,s=$a.lessThan){return this.test({message:s,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(r){return r<this.resolve(e)}})}moreThan(e,s=$a.moreThan){return this.test({message:s,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(r){return r>this.resolve(e)}})}positive(e=$a.positive){return this.moreThan(0,e)}negative(e=$a.negative){return this.lessThan(0,e)}integer(e=$a.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:s=>Number.isInteger(s)})}truncate(){return this.transform(e=>Dr(e)?e:e|0)}round(e){var s;let r=["ceil","floor","round","trunc"];if(e=((s=e)==null?void 0:s.toLowerCase())||"round",e==="trunc")return this.truncate();if(r.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(a=>Dr(a)?a:Math[e](a))}}Ks.prototype=dg.prototype;let fg=new Date(""),E2=t=>Object.prototype.toString.call(t)==="[object Date]";function jf(){return new tc}class tc extends mr{constructor(){super({type:"date",check(e){return E2(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,s,r)=>!r.spec.coerce||r.isType(e)||e===null?e:(e=p2(e),isNaN(e)?tc.INVALID_DATE:new Date(e)))})}prepareParam(e,s){let r;if(Gn.isRef(e))r=e;else{let a=this.cast(e);if(!this._typeCheck(a))throw new TypeError(`\`${s}\` must be a Date or a value that can be \`cast()\` to a Date`);r=a}return r}min(e,s=L0.min){let r=this.prepareParam(e,"min");return this.test({message:s,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(a){return a>=this.resolve(r)}})}max(e,s=L0.max){let r=this.prepareParam(e,"max");return this.test({message:s,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(a){return a<=this.resolve(r)}})}}tc.INVALID_DATE=fg;jf.prototype=tc.prototype;jf.INVALID_DATE=fg;function T2(t,e=[]){let s=[],r=new Set,a=new Set(e.map(([l,c])=>`${l}-${c}`));function i(l,c){let o=En.split(l)[0];r.add(o),a.has(`${c}-${o}`)||s.push([c,o])}for(const l of Object.keys(t)){let c=t[l];r.add(l),Gn.isRef(c)&&c.isSibling?i(c.path,l):ud(c)&&"deps"in c&&c.deps.forEach(o=>i(o,l))}return r2.array(Array.from(r),s).reverse()}function vh(t,e){let s=1/0;return t.some((r,a)=>{var i;if((i=e.path)!=null&&i.includes(r))return s=a,!0}),s}function ug(t){return(e,s)=>vh(t,e)-vh(t,s)}const hg=(t,e,s)=>{if(typeof t!="string")return t;let r=t;try{r=JSON.parse(t)}catch{}return s.isType(r)?r:t};function Jc(t){if("fields"in t){const e={};for(const[s,r]of Object.entries(t.fields))e[s]=Jc(r);return t.setFields(e)}if(t.type==="array"){const e=t.optional();return e.innerType&&(e.innerType=Jc(e.innerType)),e}return t.type==="tuple"?t.optional().clone({types:t.spec.types.map(Jc)}):"optional"in t?t.optional():t}const C2=(t,e)=>{const s=[...En.normalizePath(e)];if(s.length===1)return s[0]in t;let r=s.pop(),a=En.getter(En.join(s),!0)(t);return!!(a&&r in a)};let yh=t=>Object.prototype.toString.call(t)==="[object Object]";function bh(t,e){let s=Object.keys(t.fields);return Object.keys(e).filter(r=>s.indexOf(r)===-1)}const A2=ug([]);function ca(t){return new mg(t)}class mg extends mr{constructor(e){super({type:"object",check(s){return yh(s)||typeof s=="function"}}),this.fields=Object.create(null),this._sortErrors=A2,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,s={}){var r;let a=super._cast(e,s);if(a===void 0)return this.getDefault(s);if(!this._typeCheck(a))return a;let i=this.fields,l=(r=s.stripUnknown)!=null?r:this.spec.noUnknown,c=[].concat(this._nodes,Object.keys(a).filter(u=>!this._nodes.includes(u))),o={},d=Object.assign({},s,{parent:o,__validating:s.__validating||!1}),f=!1;for(const u of c){let h=i[u],x=u in a;if(h){let m,p=a[u];d.path=(s.path?`${s.path}.`:"")+u,h=h.resolve({value:p,context:s.context,parent:o});let v=h instanceof mr?h.spec:void 0,b=v==null?void 0:v.strict;if(v!=null&&v.strip){f=f||u in a;continue}m=!s.__validating||!b?h.cast(a[u],d):a[u],m!==void 0&&(o[u]=m)}else x&&!l&&(o[u]=a[u]);(x!==u in o||o[u]!==a[u])&&(f=!0)}return f?o:a}_validate(e,s={},r,a){let{from:i=[],originalValue:l=e,recursive:c=this.spec.recursive}=s;s.from=[{schema:this,value:l},...i],s.__validating=!0,s.originalValue=l,super._validate(e,s,r,(o,d)=>{if(!c||!yh(d)){a(o,d);return}l=l||d;let f=[];for(let u of this._nodes){let h=this.fields[u];!h||Gn.isRef(h)||f.push(h.asNestedTest({options:s,key:u,parent:d,parentPath:s.path,originalParent:l}))}this.runTests({tests:f,value:d,originalValue:l,options:s},r,u=>{a(u.sort(this._sortErrors).concat(o),d)})})}clone(e){const s=super.clone(e);return s.fields=Object.assign({},this.fields),s._nodes=this._nodes,s._excludedEdges=this._excludedEdges,s._sortErrors=this._sortErrors,s}concat(e){let s=super.concat(e),r=s.fields;for(let[a,i]of Object.entries(this.fields)){const l=r[a];r[a]=l===void 0?i:l}return s.withMutation(a=>a.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let s={};return this._nodes.forEach(r=>{var a;const i=this.fields[r];let l=e;(a=l)!=null&&a.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[r]})),s[r]=i&&"getDefault"in i?i.getDefault(l):void 0}),s}setFields(e,s){let r=this.clone();return r.fields=e,r._nodes=T2(e,s),r._sortErrors=ug(Object.keys(e)),s&&(r._excludedEdges=s),r}shape(e,s=[]){return this.clone().withMutation(r=>{let a=r._excludedEdges;return s.length&&(Array.isArray(s[0])||(s=[s]),a=[...r._excludedEdges,...s]),r.setFields(Object.assign(r.fields,e),a)})}partial(){const e={};for(const[s,r]of Object.entries(this.fields))e[s]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return Jc(this)}pick(e){const s={};for(const r of e)this.fields[r]&&(s[r]=this.fields[r]);return this.setFields(s,this._excludedEdges.filter(([r,a])=>e.includes(r)&&e.includes(a)))}omit(e){const s=[];for(const r of Object.keys(this.fields))e.includes(r)||s.push(r);return this.pick(s)}from(e,s,r){let a=En.getter(e,!0);return this.transform(i=>{if(!i)return i;let l=i;return C2(i,e)&&(l=Object.assign({},i),r||delete l[e],l[s]=a(i)),l})}json(){return this.transform(hg)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||Yc.exact,test(s){if(s==null)return!0;const r=bh(this.schema,s);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,s=Yc.noUnknown){typeof e!="boolean"&&(s=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:s,test(a){if(a==null)return!0;const i=bh(this.schema,a);return!e||i.length===0||this.createError({params:{unknown:i.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,s=Yc.noUnknown){return this.noUnknown(!e,s)}transformKeys(e){return this.transform(s=>{if(!s)return s;const r={};for(const a of Object.keys(s))r[e(a)]=s[a];return r})}camelCase(){return this.transformKeys(Hd.camelCase)}snakeCase(){return this.transformKeys(Hd.snakeCase)}constantCase(){return this.transformKeys(e=>Hd.snakeCase(e).toUpperCase())}describe(e){const s=(e?this.resolve(e):this).clone(),r=super.describe(e);r.fields={};for(const[i,l]of Object.entries(s.fields)){var a;let c=e;(a=c)!=null&&a.value&&(c=Object.assign({},c,{parent:c.value,value:c.value[i]})),r.fields[i]=l.describe(c)}return r}}ca.prototype=mg.prototype;function kl(t){return new xg(t)}class xg extends mr{constructor(e){super({type:"array",spec:{types:e},check(s){return Array.isArray(s)}}),this.innerType=void 0,this.innerType=e}_cast(e,s){const r=super._cast(e,s);if(!this._typeCheck(r)||!this.innerType)return r;let a=!1;const i=r.map((l,c)=>{const o=this.innerType.cast(l,Object.assign({},s,{path:`${s.path||""}[${c}]`}));return o!==l&&(a=!0),o});return a?i:r}_validate(e,s={},r,a){var i;let l=this.innerType,c=(i=s.recursive)!=null?i:this.spec.recursive;s.originalValue!=null&&s.originalValue,super._validate(e,s,r,(o,d)=>{var f;if(!c||!l||!this._typeCheck(d)){a(o,d);return}let u=new Array(d.length);for(let x=0;x<d.length;x++){var h;u[x]=l.asNestedTest({options:s,index:x,parent:d,parentPath:s.path,originalParent:(h=s.originalValue)!=null?h:e})}this.runTests({value:d,tests:u,originalValue:(f=s.originalValue)!=null?f:e,options:s},r,x=>a(x.concat(o),d))})}clone(e){const s=super.clone(e);return s.innerType=this.innerType,s}json(){return this.transform(hg)}concat(e){let s=super.concat(e);return s.innerType=this.innerType,e.innerType&&(s.innerType=s.innerType?s.innerType.concat(e.innerType):e.innerType),s}of(e){let s=this.clone();if(!ud(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+ja(e));return s.innerType=e,s.spec=Object.assign({},s.spec,{types:e}),s}length(e,s=Kc.length){return this.test({message:s,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,s){return s=s||Kc.min,this.test({message:s,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,s){return s=s||Kc.max,this.test({message:s,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,s)=>this._typeCheck(e)?e:s==null?[]:[].concat(s))}compact(e){let s=e?(r,a,i)=>!e(r,a,i):r=>!!r;return this.transform(r=>r!=null?r.filter(s):r)}describe(e){const s=(e?this.resolve(e):this).clone(),r=super.describe(e);if(s.innerType){var a;let i=e;(a=i)!=null&&a.value&&(i=Object.assign({},i,{parent:i.value,value:i.value[0]})),r.innerType=s.innerType.describe(i)}return r}}kl.prototype=xg.prototype;const F2=ca({username:Vt().required("Username is required").min(3,"Username must be at least 3 characters").trim(),password:Vt().required("Password is required").min(6,"Password must be at least 6 characters"),rememberMe:Nf().default(!1)}),O2=[],D2=()=>{const t=vt(),{loading:e,error:s}=ge(k=>k.auth),[r,a]=G.useState(!1),[i,l]=G.useState(null),[c,o]=G.useState(!1),{register:d,handleSubmit:f,setValue:u,watch:h,formState:{errors:x,isValid:m,touchedFields:p}}=Mi({resolver:Ri(F2),mode:"onChange",defaultValues:{username:"",password:"",rememberMe:!1}}),v=h("username"),b=h("password");G.useEffect(()=>{s&&(Ue.error(s,{icon:n.jsx(Sn,{className:"h-4 w-4"})}),t(dw()))},[s,t]),G.useEffect(()=>{o(!!v||!!b)},[v,b]);const _=G.useCallback(()=>{a(k=>!k)},[]),g=G.useCallback(k=>{l(k),u("username",k.username,{shouldValidate:!0}),u("password",k.password,{shouldValidate:!0}),Ue.success(`Demo credentials loaded for ${k.role}`,{icon:n.jsx(Ad,{className:"h-4 w-4"})})},[u]),j=async k=>{try{await t(Gc(k)).unwrap(),Ue.success("Welcome back! Login successful.",{icon:n.jsx(Ad,{className:"h-4 w-4"})})}catch{}},w=k=>{const y=x[k],N=p[k];let S="input-field pl-10 pr-4 w-full transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500";return y?S+=" border-red-300 bg-red-50 focus:border-red-500 focus:ring-red-200":N&&!y&&(S+=" border-green-300 bg-green-50 focus:border-green-500 focus:ring-green-200"),S};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-primary-100 flex items-center justify-center p-4",children:n.jsx("div",{className:"max-w-md w-full space-y-8",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[n.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 px-8 py-6 text-center",children:[n.jsx("div",{className:"mx-auto h-16 w-16 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center mb-4",children:n.jsx(ia,{className:"h-8 w-8 text-white"})}),n.jsx("h2",{className:"text-2xl font-bold text-white",children:"Internal Exam Management"}),n.jsx("p",{className:"mt-2 text-primary-100",children:"Secure portal for academic excellence"})]}),n.jsxs("div",{className:"px-8 py-6",children:[n.jsxs("form",{className:"space-y-6",onSubmit:f(j),children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(bn,{className:`h-5 w-5 ${x.username?"text-red-400":p.username&&!x.username?"text-green-400":"text-gray-400"}`})}),n.jsx("input",{...d("username"),type:"text",autoComplete:"username",autoFocus:!0,className:w("username"),placeholder:"Enter your username"}),p.username&&!x.username&&n.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:n.jsx(Ad,{className:"h-5 w-5 text-green-400"})})]}),x.username&&n.jsxs("div",{className:"flex items-center mt-2 text-red-600 text-sm",children:[n.jsx(Sn,{className:"h-4 w-4 mr-1"}),x.username.message]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Jy,{className:`h-5 w-5 ${x.password?"text-red-400":p.password&&!x.password?"text-green-400":"text-gray-400"}`})}),n.jsx("input",{...d("password"),type:r?"text":"password",autoComplete:"current-password",className:`${w("password")} pr-12`,placeholder:"Enter your password"}),n.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:_,tabIndex:-1,children:r?n.jsx(xi,{className:"h-5 w-5 text-gray-400 hover:text-gray-600 transition-colors"}):n.jsx(pi,{className:"h-5 w-5 text-gray-400 hover:text-gray-600 transition-colors"})})]}),x.password&&n.jsxs("div",{className:"flex items-center mt-2 text-red-600 text-sm",children:[n.jsx(Sn,{className:"h-4 w-4 mr-1"}),x.password.message]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{...d("rememberMe"),type:"checkbox",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),n.jsx("label",{htmlFor:"rememberMe",className:"ml-2 block text-sm text-gray-700",children:"Remember me for 30 days"})]}),n.jsx("button",{type:"button",className:"text-sm text-primary-600 hover:text-primary-500 font-medium transition-colors",children:"Forgot password?"})]})]}),n.jsx("button",{type:"submit",disabled:e||!m,className:"w-full flex justify-center items-center space-x-2 bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 transform hover:scale-[1.02] disabled:scale-100 disabled:cursor-not-allowed shadow-lg hover:shadow-xl disabled:shadow-md",children:e?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),n.jsx("span",{children:"Signing in..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Zy,{size:18}),n.jsx("span",{children:"Sign In Securely"})]})})]}),n.jsxs("div",{className:"mt-8",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx("div",{className:"w-full border-t border-gray-200"})}),n.jsx("div",{className:"relative flex justify-center text-sm",children:n.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Quick Demo Access"})})]}),n.jsx("div",{className:"mt-6 grid grid-cols-2 gap-3",children:O2.map(k=>{const y=k.icon,N=(i==null?void 0:i.role)===k.role;return n.jsxs("button",{type:"button",onClick:()=>g(k),className:`${k.color} ${N?"ring-2 ring-primary-500 ring-offset-2":"hover:shadow-md"} p-3 rounded-lg border transition-all duration-200 text-left group hover:scale-105`,children:[n.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[n.jsx(y,{className:"h-4 w-4 text-gray-600"}),n.jsx("span",{className:"font-semibold text-sm text-gray-800",children:k.role})]}),n.jsxs("div",{className:"text-xs text-gray-600 space-y-0.5",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"User:"})," ",k.username]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Pass:"})," ",k.password]})]})]},k.role)})}),n.jsx("p",{className:"mt-4 text-xs text-gray-500 text-center",children:"Click any demo card to auto-fill credentials  For testing purposes only"})]}),c&&n.jsxs("div",{className:"mt-6 flex items-center space-x-2 text-xs text-gray-500 bg-gray-50 p-3 rounded-lg",children:[n.jsx(io,{className:"h-4 w-4 text-gray-400"}),n.jsx("span",{children:"Your login attempt is secured with end-to-end encryption"})]})]})]})})})},P2={departments:[],loading:!1,error:null},Lr=He("departments/fetchDepartments",async()=>await sd.getAll()),pg=He("departments/createDepartment",async t=>await sd.create(t)),gg=He("departments/updateDepartment",async({id:t,...e})=>await sd.update(t,e)),vg=He("departments/deleteDepartment",async t=>(await sd.delete(t),t)),M2=Oa({name:"departments",initialState:P2,reducers:{clearError:t=>{t.error=null}},extraReducers:t=>{t.addCase(Lr.pending,e=>{e.loading=!0,e.error=null}).addCase(Lr.fulfilled,(e,s)=>{e.loading=!1,e.departments=s.payload}).addCase(Lr.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch departments"}).addCase(pg.fulfilled,(e,s)=>{e.departments.push(s.payload)}).addCase(gg.fulfilled,(e,s)=>{const r=e.departments.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.departments[r]=s.payload)}).addCase(vg.fulfilled,(e,s)=>{e.departments=e.departments.filter(r=>r.id!==s.payload)})}}),R2=M2.reducer,I2={users:[],loading:!1,error:null},gs=He("users/fetchUsers",async()=>await Jl.getAll()),kf=He("users/createUser",async t=>await Jl.create(t)),Sf=He("users/updateUser",async({id:t,...e})=>await Jl.update(t,e)),Ef=He("users/deleteUser",async t=>(await Jl.delete(t),t)),L2=Oa({name:"users",initialState:I2,reducers:{clearError:t=>{t.error=null}},extraReducers:t=>{t.addCase(gs.pending,e=>{e.loading=!0,e.error=null}).addCase(gs.fulfilled,(e,s)=>{e.loading=!1,e.users=s.payload}).addCase(gs.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch users"}).addCase(kf.fulfilled,(e,s)=>{e.users.push(s.payload)}).addCase(Sf.fulfilled,(e,s)=>{const r=e.users.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.users[r]=s.payload)}).addCase(Ef.fulfilled,(e,s)=>{e.users=e.users.filter(r=>r.id!==s.payload)})}}),B2=L2.reducer,U2={classes:[],loading:!1,error:null},ir=He("classes/fetchClasses",async()=>await rd.getAll()),Tf=He("classes/createClass",async t=>await rd.create(t)),Cf=He("classes/updateClass",async({id:t,...e})=>await rd.update(t,e)),Af=He("classes/deleteClass",async t=>(await rd.delete(t),t)),$2=Oa({name:"classes",initialState:U2,reducers:{clearError:t=>{t.error=null}},extraReducers:t=>{t.addCase(ir.pending,e=>{e.loading=!0,e.error=null}).addCase(ir.fulfilled,(e,s)=>{e.loading=!1,e.classes=s.payload}).addCase(ir.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch classes"}).addCase(Tf.fulfilled,(e,s)=>{e.classes.push(s.payload)}).addCase(Cf.fulfilled,(e,s)=>{const r=e.classes.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.classes[r]=s.payload)}).addCase(Af.fulfilled,(e,s)=>{e.classes=e.classes.filter(r=>r.id!==s.payload)})}}),W2=$2.reducer,V2={subjects:[],loading:!1,error:null},It=He("subjects/fetchSubjects",async()=>await ad.getAll()),Ff=He("subjects/createSubject",async t=>await ad.create(t)),Of=He("subjects/updateSubject",async({id:t,...e})=>await ad.update(t,e)),Df=He("subjects/deleteSubject",async t=>(await ad.delete(t),t)),z2=Oa({name:"subjects",initialState:V2,reducers:{clearError:t=>{t.error=null}},extraReducers:t=>{t.addCase(It.pending,e=>{e.loading=!0,e.error=null}).addCase(It.fulfilled,(e,s)=>{e.loading=!1,e.subjects=s.payload}).addCase(It.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch subjects"}).addCase(Ff.fulfilled,(e,s)=>{e.subjects.push(s.payload)}).addCase(Of.fulfilled,(e,s)=>{const r=e.subjects.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.subjects[r]=s.payload)}).addCase(Df.fulfilled,(e,s)=>{e.subjects=e.subjects.filter(r=>r.id!==s.payload)})}}),H2=z2.reducer,G2=()=>{const t=vt(),{departments:e}=ge(m=>m.departments);ge(m=>m.users),ge(m=>m.classes),ge(m=>m.subjects);const[s,r]=G.useState(null),[a,i]=G.useState([]),[l,c]=G.useState(!1),[o,d]=G.useState(null),f=async()=>{try{c(!0),d(null);const m=await iw.getStats();r(m),i(m.recent_activity||[])}catch(m){console.error("Error fetching dashboard stats:",m),d("Failed to fetch dashboard statistics")}finally{c(!1)}};G.useEffect(()=>{t(Lr()),t(gs()),t(ir()),t(It()),f()},[t]);const u=[{name:"Total Departments",value:(s==null?void 0:s.total_departments)??0,icon:Sr,color:"bg-blue-500",change:"Active departments",href:"/admin/departments"},{name:"Total Users",value:(s==null?void 0:s.total_users)??0,icon:Ct,color:"bg-green-500",change:`${(s==null?void 0:s.active_users)??0} active`,href:"/admin/users"},{name:"Total Classes",value:(s==null?void 0:s.total_classes)??0,icon:ia,color:"bg-purple-500",change:"Active classes",href:"/admin/classes"},{name:"Total Subjects",value:(s==null?void 0:s.total_subjects)??0,icon:gt,color:"bg-orange-500",change:"Course subjects",href:"/admin/subjects"}],h=a.map(m=>({action:m.message,time:new Date(m.timestamp).toLocaleString(),type:m.type==="user_created"?"success":"info",details:m.message})),x=[{message:"System running optimally",type:"success",count:0}];return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map(m=>{const p=m.icon;return n.jsxs(Ps,{to:m.href,className:"card hover:shadow-lg transition-shadow cursor-pointer",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`${m.color} p-3 rounded-lg`,children:n.jsx(p,{className:"h-6 w-6 text-white"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.name}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:m.value})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:m.change})})]},m.name)})}),x.some(m=>m.count>0)&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Alerts"}),n.jsx("div",{className:"space-y-3",children:x.filter(m=>m.count>0||m.type==="success").map((m,p)=>n.jsxs("div",{className:`flex items-center space-x-3 p-3 rounded-lg ${m.type==="warning"?"bg-yellow-50 border-l-4 border-yellow-400":m.type==="info"?"bg-blue-50 border-l-4 border-blue-400":"bg-green-50 border-l-4 border-green-400"}`,children:[n.jsx(Cs,{className:`h-5 w-5 ${m.type==="warning"?"text-yellow-500":m.type==="info"?"text-blue-500":"text-green-500"}`}),n.jsx("div",{className:"flex-1",children:n.jsx("p",{className:"text-sm font-medium text-gray-900",children:m.message})})]},p))})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[n.jsxs(Ps,{to:"/admin/departments",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[n.jsx(Sr,{className:"h-8 w-8 text-blue-500 mx-auto mb-2 group-hover:scale-110 transition-transform"}),n.jsx("p",{className:"text-sm font-medium text-center",children:"Manage Departments"}),n.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:"Create & configure departments"})]}),n.jsxs(Ps,{to:"/admin/users",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[n.jsx(Ct,{className:"h-8 w-8 text-green-500 mx-auto mb-2 group-hover:scale-110 transition-transform"}),n.jsx("p",{className:"text-sm font-medium text-center",children:"Manage Users"}),n.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:"Add & manage all users"})]}),n.jsxs(Ps,{to:"/admin/classes",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[n.jsx(ia,{className:"h-8 w-8 text-purple-500 mx-auto mb-2 group-hover:scale-110 transition-transform"}),n.jsx("p",{className:"text-sm font-medium text-center",children:"Manage Classes"}),n.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:"Create & organize classes"})]}),n.jsxs(Ps,{to:"/admin/subjects",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[n.jsx(gt,{className:"h-8 w-8 text-orange-500 mx-auto mb-2 group-hover:scale-110 transition-transform"}),n.jsx("p",{className:"text-sm font-medium text-center",children:"Manage Subjects"}),n.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:"Configure course subjects"})]}),n.jsxs(Ps,{to:"/admin/co-management",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[n.jsx(Rt,{className:"h-8 w-8 text-red-500 mx-auto mb-2 group-hover:scale-110 transition-transform"}),n.jsx("p",{className:"text-sm font-medium text-center",children:"CO Management"}),n.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:"Define course outcomes"})]}),n.jsxs(Ps,{to:"/admin/po-management",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[n.jsx(rs,{className:"h-8 w-8 text-indigo-500 mx-auto mb-2 group-hover:scale-110 transition-transform"}),n.jsx("p",{className:"text-sm font-medium text-center",children:"PO Management"}),n.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:"Define program outcomes"})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),l?n.jsx("div",{className:"space-y-3",children:[1,2,3,4].map(m=>n.jsx("div",{className:"animate-pulse",children:n.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-2 h-2 bg-gray-300 rounded-full"}),n.jsxs("div",{children:[n.jsx("div",{className:"h-4 bg-gray-300 rounded w-32 mb-1"}),n.jsx("div",{className:"h-3 bg-gray-300 rounded w-24"})]})]}),n.jsx("div",{className:"h-3 bg-gray-300 rounded w-16"})]})},m))}):o?n.jsxs("div",{className:"text-center py-8",children:[n.jsx("p",{className:"text-red-600 mb-2",children:"Failed to load recent activity"}),n.jsx("button",{onClick:f,className:"text-blue-600 hover:text-blue-800",children:"Retry"})]}):n.jsx("div",{className:"space-y-3",children:h.map((m,p)=>n.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${m.type==="success"?"bg-green-500":"bg-blue-500"}`}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-700",children:m.action}),n.jsx("p",{className:"text-xs text-gray-500",children:m.details})]})]}),n.jsx("p",{className:"text-xs text-gray-500",children:m.time})]},p))})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Department Overview"}),e.length>0?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.slice(0,4).map(m=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:m.name}),n.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Code: ",m.code]}),n.jsxs("div",{className:"space-y-1 text-xs",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Department ID:"}),n.jsx("span",{className:"font-medium",children:m.id})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Status:"}),n.jsx("span",{className:"font-medium text-green-600",children:"Active"})]})]})]},m.id))}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Sr,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),n.jsx("p",{children:"No departments found"}),n.jsx("p",{className:"text-sm",children:"Create departments to see overview"})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Health"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx(Pt,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"System Performance"}),n.jsx("p",{className:"text-xs text-green-600",children:"Optimal"}),n.jsx("div",{className:"mt-2 bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"95%"}})})]}),n.jsxs("div",{className:"text-center",children:[n.jsx(Ct,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Active Users"}),n.jsxs("p",{className:"text-xs text-gray-600",children:[(s==null?void 0:s.active_users)??0," active"]}),n.jsx("div",{className:"mt-2 bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${s&&s.total_users>0?s.active_users/s.total_users*100:0}%`}})})]}),n.jsxs("div",{className:"text-center",children:[n.jsx(gt,{className:"h-8 w-8 text-purple-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Subject Assignment"}),n.jsxs("p",{className:"text-xs text-purple-600",children:[(s==null?void 0:s.total_subjects)??0," subjects"]}),n.jsx("div",{className:"mt-2 bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:"100%"}})})]})]})]})]})},X2={studentAnalytics:null,teacherAnalytics:null,hodAnalytics:null,loading:!1,error:null},yi=He("analytics/fetchStudentAnalytics",async t=>await Qr.getStudentAnalytics(t)),cl=He("analytics/fetchTeacherAnalytics",async t=>await Qr.getTeacherAnalytics(t)),bi=He("analytics/fetchHODAnalytics",async t=>await Qr.getHODAnalytics(t)),q2=Oa({name:"analytics",initialState:X2,reducers:{clearError:t=>{t.error=null},clearAnalytics:t=>{t.studentAnalytics=null,t.teacherAnalytics=null,t.hodAnalytics=null}},extraReducers:t=>{t.addCase(yi.pending,e=>{e.loading=!0,e.error=null}).addCase(yi.fulfilled,(e,s)=>{e.loading=!1,e.studentAnalytics=s.payload}).addCase(yi.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch student analytics"}).addCase(cl.pending,e=>{e.loading=!0,e.error=null}).addCase(cl.fulfilled,(e,s)=>{e.loading=!1,e.teacherAnalytics=s.payload}).addCase(cl.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch teacher analytics"}).addCase(bi.pending,e=>{e.loading=!0,e.error=null}).addCase(bi.fulfilled,(e,s)=>{e.loading=!1,e.hodAnalytics=s.payload}).addCase(bi.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch HOD analytics"})}}),Y2=q2.reducer,K2=()=>{var b,_,g,j,w,k,y;const t=vt(),{hodAnalytics:e,loading:s}=ge(N=>N.analytics),{user:r}=ge(N=>N.auth),{users:a}=ge(N=>N.users),{subjects:i}=ge(N=>N.subjects),{classes:l}=ge(N=>N.classes);G.useEffect(()=>{r!=null&&r.department_id&&t(bi(r.department_id)),t(gs()),t(It()),t(ir())},[t,r]);const c=a.filter(N=>N.department_id===(r==null?void 0:r.department_id)),o=l.filter(N=>N.department_id===(r==null?void 0:r.department_id)),d=i.filter(N=>{const S=l.find(T=>T.id===N.class_id);return(S==null?void 0:S.department_id)===(r==null?void 0:r.department_id)}),f=[{name:"Department Performance",value:e!=null&&e.department_overview.average_performance?`${e.department_overview.average_performance.toFixed(1)}%`:"0%",icon:rs,color:"bg-blue-500",trend:"Based on all assessments"},{name:"Total Students",value:(e==null?void 0:e.department_overview.total_students)||c.filter(N=>N.role==="student").length,icon:Ct,color:"bg-green-500",trend:`Across ${o.length} classes`},{name:"Faculty Members",value:(e==null?void 0:e.department_overview.total_teachers)||c.filter(N=>N.role==="teacher").length,icon:Ct,color:"bg-purple-500",trend:`Teaching ${d.length} subjects`},{name:"Active Subjects",value:(e==null?void 0:e.department_overview.total_subjects)||d.length,icon:gt,color:"bg-orange-500",trend:`${d.filter(N=>N.teacher_id).length} assigned`}],u=((b=e==null?void 0:e.subject_performance)==null?void 0:b.slice(0,5))||[],h=((_=e==null?void 0:e.teacher_performance)==null?void 0:_.slice(0,4))||[],x=[],m=d.filter(N=>!N.teacher_id);m.length>0&&x.push({type:"warning",message:`${m.length} subjects need teacher assignment`,action:"Assign teachers to pending subjects"});const p=u.filter(N=>N.average_percentage<70);p.length>0&&x.push({type:"alert",message:`${p.length} subjects below 70% average`,action:"Review teaching methods and provide support"});const v=h.filter(N=>N.subjects_taught>4);return v.length>0&&x.push({type:"info",message:`${v.length} faculty members teaching 4+ subjects`,action:"Consider workload redistribution"}),s?n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:f.map(N=>{const S=N.icon;return n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`${N.color} p-3 rounded-lg`,children:n.jsx(S,{className:"h-6 w-6 text-white"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:N.name}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:N.value})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:N.trend})})]},N.name)})}),x.length>0&&n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[n.jsx(Sn,{className:"h-5 w-5 text-red-500"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Action Required"})]}),n.jsx("div",{className:"space-y-3",children:x.map((N,S)=>n.jsxs("div",{className:`flex items-start space-x-3 p-3 rounded-lg ${N.type==="alert"?"bg-red-50 border-l-4 border-red-400":N.type==="warning"?"bg-yellow-50 border-l-4 border-yellow-400":"bg-blue-50 border-l-4 border-blue-400"}`,children:[n.jsx(Sn,{className:`h-5 w-5 mt-0.5 ${N.type==="alert"?"text-red-500":N.type==="warning"?"text-yellow-500":"text-blue-500"}`}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:N.message}),n.jsx("p",{className:"text-sm text-gray-600",children:N.action})]})]},S))})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Subject Performance"}),n.jsx("div",{className:"space-y-4",children:u.map((N,S)=>n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:N.subject_name}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:n.jsx("div",{className:`h-2 rounded-full ${N.average_percentage>=85?"bg-green-500":N.average_percentage>=75?"bg-blue-500":N.average_percentage>=65?"bg-yellow-500":"bg-red-500"}`,style:{width:`${N.average_percentage}%`}})})]}),n.jsxs("div",{className:"ml-4 text-right",children:[n.jsxs("p",{className:"text-sm font-semibold",children:[N.average_percentage,"%"]}),n.jsxs("p",{className:"text-xs text-gray-500",children:[N.pass_rate,"% pass rate"]})]})]},S))})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Faculty Performance"}),n.jsx("div",{className:"space-y-3",children:h.map((N,S)=>n.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:N.teacher_name}),n.jsxs("p",{className:"text-xs text-gray-600",children:[N.subjects_taught," subjects"]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-sm font-semibold",children:[N.average_class_performance,"%"]}),n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${N.status==="excellent"?"bg-green-100 text-green-800":N.status==="good"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:N.status==="excellent"?"Excellent":N.status==="good"?"Good":"Needs Support"})]})]},S))})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs(Ps,{to:"/hod/analytics",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-center",children:[n.jsx(rs,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium",children:"Department Analytics"})]}),n.jsxs(Ps,{to:"/hod/reports",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-center",children:[n.jsx(Mt,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium",children:"Generate Reports"})]}),n.jsxs(Ps,{to:"/hod/strategic-dashboard",className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-center",children:[n.jsx(Rt,{className:"h-8 w-8 text-purple-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium",children:"Strategic Dashboard"})]}),n.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50 text-center opacity-60",children:[n.jsx(lo,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Department Settings"}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Contact Admin"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"NBA Compliance"}),n.jsx(Mt,{className:"h-5 w-5 text-yellow-500"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Overall Compliance"}),n.jsxs("span",{className:"text-sm font-medium text-green-600",children:[((g=e==null?void 0:e.nba_compliance)==null?void 0:g.overall_compliance)||0,"%"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"CO Attainment"}),n.jsxs("span",{className:"text-sm font-medium",children:[((j=e==null?void 0:e.nba_compliance)==null?void 0:j.co_attainment)||0,"%"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"PO Attainment"}),n.jsxs("span",{className:"text-sm font-medium",children:[((w=e==null?void 0:e.nba_compliance)==null?void 0:w.po_attainment)||0,"%"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Threshold Status"}),n.jsx("span",{className:`text-sm font-medium ${(((k=e==null?void 0:e.nba_compliance)==null?void 0:k.overall_compliance)||0)>=70?"text-green-600":"text-red-600"}`,children:(((y=e==null?void 0:e.nba_compliance)==null?void 0:y.overall_compliance)||0)>=70?"Met":"Not Met"})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Student Wellness"}),n.jsx(Rt,{className:"h-5 w-5 text-blue-500"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-3xl font-bold text-blue-600",children:c.filter(N=>N.role==="student").length>0?Math.max(1,Math.floor(c.filter(N=>N.role==="student").length*.1)):0}),n.jsx("p",{className:"text-sm text-gray-600",children:"students need attention"}),n.jsx("button",{className:"mt-2 text-sm text-blue-600 hover:text-blue-800",children:"View Details "})]})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Updates"}),n.jsx(Pt,{className:"h-5 w-5 text-green-500"})]}),n.jsx("div",{className:"space-y-2 text-sm",children:e!=null&&e.recent_updates&&e.recent_updates.length>0?e.recent_updates.slice(0,4).map((N,S)=>n.jsxs("p",{className:"text-gray-600",children:[" ",N.message]},S)):n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-gray-600",children:" No recent updates available"}),n.jsx("p",{className:"text-gray-600",children:" Check back later for updates"})]})})]})]})]})},J2={exams:[],loading:!1,error:null},Br=He("exams/fetchExams",async()=>await nd.getAll()),yg=He("exams/createExam",async t=>await nd.create(t)),bg=He("exams/updateExam",async({id:t,...e})=>await nd.update(t,e)),_g=He("exams/deleteExam",async t=>(await nd.delete(t),t)),Z2=Oa({name:"exams",initialState:J2,reducers:{clearError:t=>{t.error=null}},extraReducers:t=>{t.addCase(Br.pending,e=>{e.loading=!0,e.error=null}).addCase(Br.fulfilled,(e,s)=>{e.loading=!1,e.exams=s.payload}).addCase(Br.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch exams"}).addCase(yg.fulfilled,(e,s)=>{e.exams.push(s.payload)}).addCase(bg.fulfilled,(e,s)=>{const r=e.exams.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.exams[r]=s.payload)}).addCase(_g.fulfilled,(e,s)=>{e.exams=e.exams.filter(r=>r.id!==s.payload)})}}),Q2=Z2.reducer,eN=()=>{const t=vt(),{teacherAnalytics:e,loading:s}=ge(m=>m.analytics),{user:r}=ge(m=>m.auth),{subjects:a}=ge(m=>m.subjects),{exams:i}=ge(m=>m.exams),{users:l}=ge(m=>m.users);G.useEffect(()=>{r!=null&&r.id&&t(cl(r.id)),t(It()),t(Br()),t(gs())},[t,r]);const c=a.filter(m=>m.teacher_id===(r==null?void 0:r.id)),o=i.filter(m=>{const p=a.find(v=>v.id===m.subject_id);return(p==null?void 0:p.teacher_id)===(r==null?void 0:r.id)}),d=c.reduce((m,p)=>{const v=l.filter(b=>b.role==="student"&&b.class_id===p.class_id).length;return m+v},0),f=[{name:"Subjects Assigned",value:c.length,icon:gt,color:"bg-blue-500",detail:`Across ${new Set(c.map(m=>m.class_id)).size} classes`,href:"/teacher/subjects"},{name:"Total Students",value:d,icon:Ct,color:"bg-green-500",detail:"Under your guidance",href:"/teacher/students"},{name:"Exams Configured",value:o.length,icon:j0,color:"bg-orange-500",detail:`${o.filter(m=>m.exam_date&&new Date(m.exam_date)>new Date).length} upcoming`,href:"/teacher/exam-config"},{name:"Average Performance",value:e!=null&&e.class_performance.average_percentage?`${e.class_performance.average_percentage.toFixed(1)}%`:"N/A",icon:rs,color:"bg-purple-500",detail:e!=null&&e.class_performance.pass_rate?`${e.class_performance.pass_rate.toFixed(1)}% pass rate`:"No data",href:"/teacher/analytics"}],u=at.useMemo(()=>{const m=[];return o.filter(v=>{const b=new Date(v.exam_date||v.created_at),_=Math.ceil((b.getTime()-new Date().getTime())/(1e3*60*60*24));return _>0&&_<=7}).forEach(v=>{const b=new Date(v.exam_date||v.created_at),_=Math.ceil((b.getTime()-new Date().getTime())/(1e3*60*60*24));a.find(g=>g.id===v.subject_id),m.push({task:`Grade ${v.name}`,deadline:_===1?"1 day":`${_} days`,priority:_<=2?"high":"medium",type:"grading"})}),c.length>0&&m.push({task:"Submit CO-PO mapping report",deadline:"5 days",priority:"medium",type:"report"}),c.length>0&&m.push({task:"Prepare question bank",deadline:"1 week",priority:"medium",type:"preparation"}),m.slice(0,4)},[o,a,c]),h=at.useMemo(()=>c.map(m=>{const p=l.filter(_=>_.role==="student"&&_.class_id===m.class_id),v=o.filter(_=>_.subject_id===m.id);let b=0;if(v.length>0){const _=v.reduce((j,w)=>j+(w.total_marks||0),0),g=v.reduce((j,w)=>j+(w.total_marks||0),0);b=g>0?Math.round(_/g*100):0}return{class:`Class ${m.class_id}`,subject:m.name,average:b,students:p.length,status:b>=85?"excellent":b>=75?"good":"average"}}),[c,l,o]),x=at.useMemo(()=>{const m=[];return l.filter(v=>v.role==="student"&&c.some(b=>b.class_id===v.class_id)).forEach(v=>{const b=c.filter(k=>k.class_id===v.class_id);let _=0,g=0;const j=[];b.forEach(k=>{const y=o.filter(N=>N.subject_id===k.id);if(y.length>0){const N=y.reduce((T,E)=>T+(E.total_marks||0),0),S=y.reduce((T,E)=>T+(E.total_marks||0),0);if(S>0){const T=N/S*100;_+=T,g++,T<50&&j.push({name:k.name,performance:T})}}});const w=g>0?_/g:0;w<60&&j.length>0&&m.push({student:`${v.first_name} ${v.last_name}`,name:`${v.first_name} ${v.last_name}`,class:`Class ${v.class_id}`,average:Math.round(w),percentage:Math.round(w),subjects:j,riskLevel:w<40?"high":"medium"})}),m.slice(0,3)},[l,c,o]);return s&&!e?n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:f.map(m=>{const p=m.icon;return n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`${m.color} p-3 rounded-lg`,children:n.jsx(p,{className:"h-6 w-6 text-white"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.name}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:m.value})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:m.detail})})]},m.name)})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upcoming Tasks"}),n.jsx("div",{className:"space-y-3",children:u.map((m,p)=>n.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${m.priority==="high"?"bg-red-500":"bg-yellow-500"}`}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:m.task}),n.jsxs("p",{className:"text-xs text-gray-600",children:["Due in ",m.deadline]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Si,{className:"h-4 w-4 text-gray-400"}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m.priority==="high"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:m.priority})]})]},p))})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Class Performance"}),n.jsx("div",{className:"space-y-3",children:h.slice(0,4).map((m,p)=>n.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:m.subject}),n.jsxs("p",{className:"text-xs text-gray-600",children:[m.class,"  ",m.students," students"]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-sm font-semibold",children:[m.average,"%"]}),n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${m.status==="excellent"?"bg-green-100 text-green-800":m.status==="good"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:m.status})]})]},p))})]})]}),(e==null?void 0:e.class_performance.at_risk_students)&&e.class_performance.at_risk_students>0&&n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Students Needing Attention"}),n.jsx(Cs,{className:"h-5 w-5 text-red-500"})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:x.slice(0,3).map((m,p)=>n.jsxs("div",{className:"border border-red-200 bg-red-50 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("p",{className:"font-medium text-gray-900",children:m.name}),n.jsxs("span",{className:"text-sm font-medium text-red-600",children:[m.percentage,"%"]})]}),n.jsx("p",{className:"text-xs text-gray-600 mb-2",children:m.class}),n.jsx("div",{className:"space-y-1",children:m.subjects.map((v,b)=>n.jsx("span",{className:"inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded mr-1",children:v},b))}),n.jsx("button",{className:"mt-3 w-full text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition-colors",children:"Schedule Mentoring"})]},p))})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs(Ps,{to:"/teacher/marks-entry",className:"card text-center hover:bg-gray-50 transition-colors",children:[n.jsx(j0,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium",children:"Enter Marks"})]}),n.jsxs(Ps,{to:"/teacher/analytics",className:"card text-center hover:bg-gray-50 transition-colors",children:[n.jsx(rs,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium",children:"View Analytics"})]}),n.jsxs(Ps,{to:"/teacher/exam-config",className:"card text-center hover:bg-gray-50 transition-colors",children:[n.jsx(Ot,{className:"h-8 w-8 text-purple-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium",children:"Configure Exam"})]}),n.jsxs("div",{className:"card text-center hover:bg-gray-50 transition-colors cursor-pointer",children:[n.jsx(Ct,{className:"h-8 w-8 text-orange-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium",children:"Student Reports"})]})]}),e&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teaching Insights"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Achievements"}),n.jsxs("div",{className:"space-y-2",children:[e.class_performance.average_percentage>=75&&n.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[n.jsx(Ot,{size:16}),n.jsx("span",{className:"text-sm",children:"Strong class performance"})]}),e.class_performance.pass_rate>=85&&n.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[n.jsx(Ot,{size:16}),n.jsx("span",{className:"text-sm",children:"High pass rate achieved"})]}),e.class_performance.top_performers>0&&n.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[n.jsx(Ot,{size:16}),n.jsxs("span",{className:"text-sm",children:[e.class_performance.top_performers," top performers"]})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Focus Areas"}),n.jsxs("div",{className:"space-y-2",children:[e.class_performance.at_risk_students>0&&n.jsxs("div",{className:"flex items-center space-x-2 text-amber-600",children:[n.jsx(Cs,{size:16}),n.jsx("span",{className:"text-sm",children:"Monitor at-risk students"})]}),e.class_performance.average_percentage<70&&n.jsxs("div",{className:"flex items-center space-x-2 text-amber-600",children:[n.jsx(Cs,{size:16}),n.jsx("span",{className:"text-sm",children:"Improve overall class average"})]}),n.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[n.jsx(gt,{size:16}),n.jsx("span",{className:"text-sm",children:"Continue effective teaching methods"})]})]})]})]})]})]})},tN=()=>{var v;const t=vt(),{studentAnalytics:e,loading:s}=ge(b=>b.analytics),{user:r}=ge(b=>b.auth),{subjects:a}=ge(b=>b.subjects),{exams:i}=ge(b=>b.exams);G.useEffect(()=>{r!=null&&r.id&&t(yi(r.id)),t(It()),t(Br())},[t,r]);const l=a.filter(b=>b.class_id===(r==null?void 0:r.class_id)),c=i.filter(b=>l.find(g=>g.id===b.subject_id)&&b.exam_date&&new Date(b.exam_date)>new Date).slice(0,3),o=b=>b>=85?"text-green-600":b>=70?"text-blue-600":b>=50?"text-yellow-600":"text-red-600",d=b=>b>=85?"bg-green-100":b>=70?"bg-blue-100":b>=50?"bg-yellow-100":"bg-red-100",f=b=>b>=90?"A+":b>=80?"A":b>=70?"B+":b>=60?"B":b>=50?"C":"F",u=[{name:"Overall Percentage",value:e!=null&&e.percentage?`${e.percentage.toFixed(1)}%`:"N/A",icon:Pt,color:e?d(e.percentage):"bg-gray-100",trend:"Current semester",href:"/student/analytics"},{name:"Current Grade",value:e?f(e.percentage):"N/A",icon:Mt,color:"bg-purple-100",trend:"Based on performance",href:"/student/analytics"},{name:"Class Rank",value:e?`#${e.rank}`:"N/A",icon:co,color:"bg-yellow-100",trend:"Out of classmates",href:"/student/progress"},{name:"Subjects Enrolled",value:l.length,icon:gt,color:"bg-blue-100",trend:`${l.length} enrolled`,href:"/student/subjects"}],h=((v=e==null?void 0:e.performance_trend)==null?void 0:v.slice(-4))||[],x=[{name:"View Analytics",icon:Pt,href:"/student/analytics",color:"bg-blue-500"},{name:"Track Progress",icon:Rt,href:"/student/progress",color:"bg-green-500"},{name:"Study Plan",icon:ba,href:"/student/study-plan",color:"bg-purple-500"},{name:"Exam Schedule",icon:oo,href:"/student/exams",color:"bg-orange-500"}],m=at.useMemo(()=>{const b=[];return c.forEach(_=>{const g=l.find(j=>j.id===_.subject_id);if(g){const j=new Date(_.exam_date||_.created_at),w=Math.ceil((j.getTime()-new Date().getTime())/(1e3*60*60*24));let k="medium",y="Prepare for exam";w<=2?(k="high",y="Final exam preparation"):w<=5?(k="high",y="Intensive study session"):y="Start exam preparation",b.push({subject:g.name,message:`Study for ${_.name}`,task:y,priority:k,dueDate:w===1?"Tomorrow":`${w} days`})}}),e!=null&&e.co_attainment&&Object.entries(e.co_attainment).forEach(([_,g])=>{if(g<60){const j=l.find(w=>w.name.toLowerCase().includes(_.toLowerCase())||_.toLowerCase().includes(w.name.toLowerCase()));j&&!b.some(w=>w.subject===j.name)&&b.push({subject:j.name,message:"Focus on weak areas to improve performance",task:"Focus on weak areas",priority:"high",dueDate:"This week"})}}),b.slice(0,3)},[c,l,e]),p=[];if(e&&(e.percentage>=90&&p.push({name:"Excellence Award",description:"90%+ Overall",icon:co,color:"text-yellow-500"}),Object.values(e.co_attainment).filter(b=>b>=80).length>=3&&p.push({name:"CO Champion",description:"3+ COs Above 80%",icon:Qa,color:"text-green-500"}),e.rank<=3&&p.push({name:"Top Performer",description:"Top 3 in Class",icon:Mt,color:"text-purple-500"}),e.performance_trend.length>=2)){const b=e.performance_trend[e.performance_trend.length-1],_=e.performance_trend[0];b.percentage>_.percentage&&p.push({name:"Rising Star",description:"Consistent Improvement",icon:Pt,color:"text-blue-500"})}return s&&!e?n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",r==null?void 0:r.first_name,"!"]}),n.jsx("p",{className:"text-gray-600",children:"Track your academic progress and stay motivated"})]}),e&&n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Current Rank"}),n.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:["#",e.rank]})]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map(b=>{const _=b.icon;return n.jsxs(Ps,{to:b.href,className:"card hover:shadow-lg transition-shadow",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`${b.color} p-3 rounded-lg`,children:n.jsx(_,{className:`h-6 w-6 ${b.name==="Overall Percentage"&&e?o(e.percentage):"text-gray-600"}`})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:b.name}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:b.value})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:b.trend})})]},b.name)})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Performance"}),h.length>0?n.jsx("div",{className:"space-y-3",children:h.map((b,_)=>n.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.exam}),n.jsx("div",{className:"w-48 bg-gray-200 rounded-full h-2 mt-1",children:n.jsx("div",{className:`h-2 rounded-full ${b.percentage>=80?"bg-green-500":b.percentage>=70?"bg-blue-500":b.percentage>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(b.percentage,100)}%`}})})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-lg font-semibold",children:[b.percentage.toFixed(1),"%"]}),n.jsx("p",{className:"text-xs text-gray-500",children:f(b.percentage)})]})]},_))}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(gt,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),n.jsx("p",{children:"No exam results available yet"}),n.jsx("p",{className:"text-sm",children:"Your performance will appear here after exams"})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upcoming Exams"}),c.length>0?n.jsx("div",{className:"space-y-3",children:c.map((b,_)=>{const g=l.find(j=>j.id===b.subject_id);return n.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[n.jsx("p",{className:"font-medium text-gray-900",children:b.name}),n.jsx("p",{className:"text-sm text-gray-600",children:g==null?void 0:g.name}),n.jsx("p",{className:"text-xs text-blue-600",children:b.exam_date?new Date(b.exam_date).toLocaleDateString():"TBD"})]},_)})}):n.jsxs("div",{className:"text-center py-4 text-gray-500",children:[n.jsx(oo,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),n.jsx("p",{className:"text-sm",children:"No upcoming exams"})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Study Reminders"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:m.map((b,_)=>n.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${b.priority==="high"?"bg-red-50 border-red-400":"bg-yellow-50 border-yellow-400"}`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("p",{className:"font-medium text-gray-900",children:b.subject}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b.priority==="high"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:b.priority})]}),n.jsx("p",{className:"text-sm text-gray-600 mb-2",children:b.task}),n.jsxs("p",{className:"text-xs text-gray-500",children:["Due: ",b.dueDate]})]},_))})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:x.map(b=>{const _=b.icon;return n.jsxs(Ps,{to:b.href,className:"p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-center",children:[n.jsx("div",{className:`${b.color} p-2 rounded-lg w-fit mx-auto mb-2`,children:n.jsx(_,{className:"h-5 w-5 text-white"})}),n.jsx("p",{className:"text-sm font-medium",children:b.name})]},b.name)})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Achievements"}),p.length>0?n.jsx("div",{className:"space-y-3",children:p.map((b,_)=>{const g=b.icon;return n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[n.jsx(g,{className:`h-6 w-6 ${b.color}`}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:b.name}),n.jsx("p",{className:"text-sm text-gray-600",children:b.description})]})]},_)})}):n.jsxs("div",{className:"text-center py-6 text-gray-500",children:[n.jsx(Qa,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),n.jsx("p",{className:"text-sm",children:"Achievements will appear here"}),n.jsx("p",{className:"text-xs",children:"Keep studying to unlock badges!"})]})]})]}),n.jsx("div",{className:"card bg-gradient-to-r from-blue-50 to-purple-50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Stay Motivated!"}),n.jsx("p",{className:"text-gray-600 mt-1",children:e&&e.percentage>=80?"Excellent work! Keep up the great performance.":e&&e.percentage>=60?"Good progress! A little more effort will get you to excellence.":"Every expert was once a beginner. Keep pushing forward!"}),e&&e.rank<=5&&n.jsx("p",{className:"text-sm text-blue-600 mt-2",children:" You're in the top 5 of your class!"})]}),n.jsx("div",{className:"hidden md:block",children:n.jsx(ba,{className:"h-16 w-16 text-blue-400"})})]})})]})},sN=()=>{const{user:t}=ge(e=>e.auth);switch(t==null?void 0:t.role){case"admin":return n.jsx(G2,{});case"hod":return n.jsx(K2,{});case"teacher":return n.jsx(eN,{});case"student":return n.jsx(tN,{});default:return n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-gray-500",children:"Welcome to the Internal Exam Management System"})})}},rN=()=>{const t=Wy(),{user:e}=ge(f=>f.auth),{isCollapsed:s,toggleSidebar:r,isMobileMenuOpen:a,toggleMobileMenu:i}=Bp(),l=()=>{const f=[{name:"Dashboard",href:"/",icon:ap,section:"main"}];switch(e==null?void 0:e.role){case"admin":return[...f,{name:"Departments",href:"/admin/departments",icon:Sr,section:"system"},{name:"Classes",href:"/admin/classes",icon:Ct,section:"system"},{name:"Subjects",href:"/admin/subjects",icon:gt,section:"system"},{name:"Users",href:"/admin/users",icon:ia,section:"system"},{name:"CO Management",href:"/admin/co-management",icon:Rt,section:"academic"},{name:"PO Management",href:"/admin/po-management",icon:fo,section:"academic"},{name:"CO Targets",href:"/admin/co-targets",icon:k0,section:"academic"},{name:"Analytics",href:"/admin/analytics",icon:rs,section:"analytics"},{name:"Reports",href:"/admin/reports",icon:Fr,section:"analytics"}];case"hod":return[...f,{name:"Department Users",href:"/hod/users",icon:sb,section:"department"},{name:"Department Classes",href:"/hod/classes",icon:Ct,section:"department"},{name:"Department Subjects",href:"/hod/subjects",icon:rb,section:"department"},{name:"CO Management",href:"/admin/co-management",icon:Rt,section:"academic"},{name:"PO Management",href:"/admin/po-management",icon:fo,section:"academic"},{name:"CO Targets",href:"/admin/co-targets",icon:k0,section:"academic"},{name:"Department Analytics",href:"/hod/analytics",icon:rp,section:"analytics"},{name:"Student Analytics",href:"/hod/student-analytics",icon:Pt,section:"analytics"},{name:"Teacher Analytics",href:"/hod/teacher-analytics",icon:ab,section:"analytics"},{name:"Strategic Dashboard",href:"/hod/strategic-dashboard",icon:ba,section:"analytics"},{name:"Reports & Analytics",href:"/hod/reports",icon:nb,section:"reports"}];case"teacher":return[...f,{name:"Exam Configuration",href:"/teacher/exam-config",icon:lo,section:"teaching"},{name:"Marks Entry",href:"/teacher/marks-entry",icon:j0,section:"teaching"},{name:"Analytics",href:"/teacher/analytics",icon:sp,section:"analytics"},{name:"Attainment Analytics",href:"/teacher/attainment-analytics",icon:rs,section:"analytics"},{name:"Comprehensive Analytics",href:"/teacher/comprehensive-analytics",icon:Pt,section:"analytics"},{name:"Report Management",href:"/teacher/reports",icon:Fr,section:"reports"}];case"student":return[...f,{name:"My Analytics",href:"/student/analytics",icon:Pt,section:"student"},{name:"Progress Tracking",href:"/student/progress",icon:Mt,section:"student"}];default:return f}},c=f=>({main:"Main",system:"System Management",department:"Department Management",academic:"Academic Management",teaching:"Teaching Tools",analytics:"Analytics & Insights",reports:"Reports & Documentation",student:"Student Tools"})[f]||f,d=l().reduce((f,u)=>{const h=u.section||"other";return f[h]||(f[h]=[]),f[h].push(u),f},{});return n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:i,className:"lg:hidden fixed top-4 left-4 z-50 p-2 rounded-md bg-white shadow-md border border-gray-200",children:a?n.jsx(tp,{size:20}):n.jsx(Qy,{size:20})}),a&&n.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:i}),n.jsxs("div",{className:`
        fixed left-0 top-16 h-full bg-white shadow-sm border-r border-gray-200 z-40 transition-all duration-300 ease-in-out
        ${s?"w-16":"w-64"}
        ${a?"translate-x-0":"lg:translate-x-0 -translate-x-full"}
      `,children:[n.jsx("div",{className:"flex justify-end p-2 border-b border-gray-200",children:n.jsx("button",{onClick:r,className:"p-2 rounded-md hover:bg-gray-100 transition-colors",title:s?"Expand sidebar":"Collapse sidebar",children:s?n.jsx(eb,{size:16}):n.jsx(tb,{size:16})})}),n.jsx("nav",{className:`p-4 space-y-4 overflow-y-auto h-full pb-20 ${s?"px-2":""}`,style:{maxHeight:"calc(100vh - 80px)"},children:Object.entries(d).map(([f,u])=>n.jsxs("div",{className:"space-y-2",children:[f!=="main"&&!s&&n.jsx("div",{className:"px-3 py-2",children:n.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:c(f)})}),n.jsx("div",{className:"space-y-1",children:u.map(h=>{const x=h.icon,m=t.pathname===h.href;return n.jsxs(Ps,{to:h.href,onClick:()=>i(),className:`
                        flex items-center rounded-lg transition-colors group relative
                        ${s?"justify-center px-3 py-2":"space-x-3 px-3 py-2"}
                        ${m?"bg-primary-50 text-primary-700 border-r-2 border-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
                      `,title:s?h.name:void 0,children:[n.jsx(x,{size:20,className:`transition-colors ${m?"text-primary-600":"text-gray-400 group-hover:text-gray-600"}`}),!s&&n.jsx("span",{className:"font-medium text-sm",children:h.name}),s&&n.jsx("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50",children:h.name})]},h.name)})})]},f))})]})]})},aN=()=>{var r;const t=vt(),{user:e}=ge(a=>a.auth),s=()=>{t(Rp())};return n.jsx("header",{className:"fixed top-0 left-0 right-0 bg-white shadow-sm border-b border-gray-200 px-6 py-4 z-50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{children:n.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Internal Exam Management System"})}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg",children:n.jsx(ib,{size:20})}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg px-3 py-2",children:[n.jsx(bn,{size:18,className:"text-gray-600"}),n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[e==null?void 0:e.first_name," ",e==null?void 0:e.last_name]}),n.jsx("span",{className:"text-xs bg-primary-100 text-primary-700 px-2 py-1 rounded-full",children:(r=e==null?void 0:e.role)==null?void 0:r.toUpperCase()})]}),n.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-red-600 rounded-lg transition-colors",title:"Logout",children:n.jsx(lb,{size:20})})]})]})]})})},nN=({children:t})=>{const{isCollapsed:e,isMobileMenuOpen:s}=Bp();return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx(aN,{}),n.jsxs("div",{className:"flex",children:[n.jsx(rN,{}),n.jsx("main",{className:`
            flex-1 p-6 pt-20 transition-all duration-300 ease-in-out
            ${e?"ml-16":"ml-64"}
            lg:ml-64
          `,children:t})]})]})},qt=({children:t,allowedRoles:e})=>{const{user:s,isAuthenticated:r}=ge(i=>i.auth),a=Vy();return G.useEffect(()=>{if(r&&s&&!e.includes(s.role)){const i=s.role==="admin"?"/admin/dashboard":s.role==="teacher"?"/teacher/dashboard":s.role==="student"?"/student/dashboard":s.role==="hod"?"/hod/dashboard":"/dashboard";a(i,{replace:!0})}},[r,s,e,a]),!r||!s?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-blue-600 border-t-transparent mx-auto mb-4"}),n.jsx("p",{className:"text-gray-500",children:"Please log in to access this page."})]})}):e.includes(s.role)?n.jsx(n.Fragment,{children:t}):n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[n.jsx("div",{className:"bg-orange-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:n.jsx(Cs,{className:"w-8 h-8 text-orange-600"})}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),n.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have permission to access this page. Redirecting you to your dashboard..."}),n.jsxs("button",{onClick:()=>{const i=s.role==="admin"?"/admin/dashboard":s.role==="teacher"?"/teacher/dashboard":s.role==="student"?"/student/dashboard":s.role==="hod"?"/hod/dashboard":"/dashboard";a(i)},className:"btn-primary flex items-center space-x-2 mx-auto",children:[n.jsx(ap,{size:18}),n.jsx("span",{children:"Go to Dashboard"})]})]})})},iN=ca({name:Vt().required("Department name is required"),code:Vt().required("Department code is required").max(10,"Code must be 10 characters or less"),hod_id:Ks().nullable().transform((t,e)=>e===""?null:t)}),lN=()=>{const t=vt(),{departments:e,loading:s}=ge(g=>g.departments),{users:r}=ge(g=>g.users),[a,i]=G.useState(!1),[l,c]=G.useState(null),{register:o,handleSubmit:d,formState:{errors:f},reset:u,setValue:h}=Mi({resolver:Ri(iN)});G.useEffect(()=>{t(Lr()),t(gs())},[t]);const x=r.filter(g=>g.role==="hod"||g.role==="admin"),m=async g=>{try{const j={...g,hod_id:g.hod_id||void 0};l?(await t(gg({id:l.id,...j})).unwrap(),Ue.success("Department updated successfully!")):(await t(pg(j)).unwrap(),Ue.success("Department created successfully!")),b()}catch(j){Ue.error(j.message||"An error occurred")}},p=g=>{c(g),h("name",g.name),h("code",g.code),h("hod_id",g.hod_id),i(!0)},v=async g=>{if(window.confirm("Are you sure you want to delete this department?"))try{await t(vg(g)).unwrap(),Ue.success("Department deleted successfully!")}catch(j){Ue.error(j.message||"Failed to delete department")}},b=()=>{i(!1),c(null),u()},_=g=>{const j=r.filter(w=>w.department_id===g);return{students:j.filter(w=>w.role==="student").length,teachers:j.filter(w=>w.role==="teacher").length,total:j.length}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Department Management"}),n.jsxs("button",{onClick:()=>i(!0),className:"btn-primary flex items-center space-x-2",children:[n.jsx(Na,{size:18}),n.jsx("span",{children:"Add Department"})]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(g=>{const j=r.find(k=>k.id===g.hod_id),w=_(g.id);return n.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:n.jsx(Sr,{className:"h-6 w-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:g.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Code: ",g.code]})]})]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:()=>p(g),className:"p-2 text-gray-400 hover:text-blue-600 rounded-lg",children:n.jsx(Xl,{size:16})}),n.jsx("button",{onClick:()=>v(g.id),className:"p-2 text-gray-400 hover:text-red-600 rounded-lg",children:n.jsx(la,{size:16})})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Head of Department:"}),n.jsx("span",{className:"font-medium",children:j?`${j.first_name} ${j.last_name}`:"Not assigned"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-1 text-blue-600 mb-1",children:[n.jsx(ia,{size:16}),n.jsx("span",{className:"text-lg font-semibold",children:w.students})]}),n.jsx("p",{className:"text-xs text-gray-600",children:"Students"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-1 text-green-600 mb-1",children:[n.jsx(Ct,{size:16}),n.jsx("span",{className:"text-lg font-semibold",children:w.teachers})]}),n.jsx("p",{className:"text-xs text-gray-600",children:"Teachers"})]})]})]})]},g.id)})}),e.length===0&&n.jsxs("div",{className:"card text-center py-8",children:[n.jsx(Sr,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Departments Found"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"Start by creating your first department."}),n.jsx("button",{onClick:()=>i(!0),className:"btn-primary",children:"Add First Department"})]}),a&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:l?"Edit Department":"Add New Department"}),n.jsxs("form",{onSubmit:d(m),className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department Name"}),n.jsx("input",{...o("name"),type:"text",className:"input-field w-full",placeholder:"e.g., Computer Science Engineering"}),f.name&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.name.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department Code"}),n.jsx("input",{...o("code"),type:"text",className:"input-field w-full",placeholder:"e.g., CSE"}),f.code&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.code.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Head of Department"}),n.jsxs("select",{...o("hod_id",{setValueAs:g=>g===""?null:Number(g)}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select HOD"}),x.map(g=>n.jsxs("option",{value:g.id,children:[g.first_name," ",g.last_name," (",g.role.toUpperCase(),")"]},g.id))]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:b,className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"btn-primary disabled:opacity-50",children:s?"Saving...":l?"Update":"Create"})]})]})]})}),s&&n.jsx("div",{className:"text-center py-4",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent mx-auto"})})]})},cN=ca({name:Vt().required("Class name is required"),department_id:Ks().required("Department is required"),semester:Ks().min(1,"Minimum semester 1").max(8,"Maximum semester 8").required("Semester is required"),section:Vt().required("Section is required")}),oN=()=>{const t=vt(),{classes:e,loading:s}=ge(g=>g.classes),{departments:r}=ge(g=>g.departments),{users:a}=ge(g=>g.users),[i,l]=G.useState(!1),[c,o]=G.useState(null),{register:d,handleSubmit:f,formState:{errors:u},reset:h,setValue:x}=Mi({resolver:Ri(cN)});G.useEffect(()=>{t(ir()),t(Lr()),t(gs())},[t]);const m=async g=>{try{c?(await t(Cf({id:c.id,...g})).unwrap(),Ue.success("Class updated successfully!")):(await t(Tf(g)).unwrap(),Ue.success("Class created successfully!")),b()}catch(j){Ue.error(j.message||"An error occurred")}},p=g=>{o(g),x("name",g.name),x("department_id",g.department_id),x("semester",g.semester),x("section",g.section),l(!0)},v=async g=>{if(window.confirm("Are you sure you want to delete this class?"))try{await t(Af(g)).unwrap(),Ue.success("Class deleted successfully!")}catch(j){Ue.error(j.message||"Failed to delete class")}},b=()=>{l(!1),o(null),h()},_=g=>{const j=a.filter(w=>w.class_id===g&&w.role==="student");return{students:j.length,activeStudents:j.filter(w=>w.is_active).length}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Management"}),n.jsxs("button",{onClick:()=>l(!0),className:"btn-primary flex items-center space-x-2",children:[n.jsx(Na,{size:18}),n.jsx("span",{children:"Add Class"})]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(g=>{const j=r.find(k=>k.id===g.department_id),w=_(g.id);return n.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:n.jsx(ia,{className:"h-6 w-6 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:g.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Semester ",g.semester," - Section ",g.section]})]})]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:()=>p(g),className:"p-2 text-gray-400 hover:text-blue-600 rounded-lg",children:n.jsx(Xl,{size:16})}),n.jsx("button",{onClick:()=>v(g.id),className:"p-2 text-gray-400 hover:text-red-600 rounded-lg",children:n.jsx(la,{size:16})})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Department:"}),n.jsx("span",{className:"font-medium",children:(j==null?void 0:j.name)||"Unknown"})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Department Code:"}),n.jsx("span",{className:"font-medium bg-gray-100 px-2 py-1 rounded text-xs",children:(j==null?void 0:j.code)||"N/A"})]}),n.jsx("div",{className:"pt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[n.jsx(Ct,{size:16}),n.jsx("span",{className:"text-lg font-semibold",children:w.students})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-gray-600",children:"Total Students"}),n.jsxs("p",{className:"text-xs text-green-600",children:[w.activeStudents," active"]})]})]})})]})]},g.id)})}),e.length===0&&n.jsxs("div",{className:"card text-center py-8",children:[n.jsx(ia,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Classes Found"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"Start by creating your first class."}),n.jsx("button",{onClick:()=>l(!0),className:"btn-primary",children:"Add First Class"})]}),i&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:c?"Edit Class":"Add New Class"}),n.jsxs("form",{onSubmit:f(m),className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class Name"}),n.jsx("input",{...d("name"),type:"text",className:"input-field w-full",placeholder:"e.g., CSE-A"}),u.name&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.name.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),n.jsxs("select",{...d("department_id",{valueAsNumber:!0}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Department"}),r.map(g=>n.jsx("option",{value:g.id,children:g.name},g.id))]}),u.department_id&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.department_id.message})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),n.jsxs("select",{...d("semester",{valueAsNumber:!0}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select"}),[1,2,3,4,5,6,7,8].map(g=>n.jsxs("option",{value:g,children:["Semester ",g]},g))]}),u.semester&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.semester.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),n.jsxs("select",{...d("section"),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select"}),["A","B","C","D"].map(g=>n.jsxs("option",{value:g,children:["Section ",g]},g))]}),u.section&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.section.message})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:b,className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"btn-primary disabled:opacity-50",children:s?"Saving...":c?"Update":"Create"})]})]})]})}),s&&n.jsx("div",{className:"text-center py-4",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent mx-auto"})})]})},dN=ca({name:Vt().required("Subject name is required"),code:Vt().required("Subject code is required"),class_id:Ks().required("Class is required"),teacher_id:Ks().nullable().transform((t,e)=>e===""?null:t),credits:Ks().min(1).max(6).required("Credits is required"),cos:kl().of(Vt()).default([]),pos:kl().of(Vt()).default([])}),fN=()=>{var g,j;const t=vt(),{subjects:e,loading:s}=ge(w=>w.subjects),{classes:r}=ge(w=>w.classes),{users:a}=ge(w=>w.users),[i,l]=G.useState(!1),[c,o]=G.useState(null),{register:d,handleSubmit:f,formState:{errors:u},reset:h,setValue:x}=Mi({resolver:Ri(dN)});G.useEffect(()=>{t(It()),t(ir()),t(gs())},[t]);const m=a.filter(w=>w.role==="teacher"),p=async w=>{try{const k={...w,cos:Array.isArray(w.cos)?w.cos.filter(y=>typeof y=="string"):[],pos:Array.isArray(w.pos)?w.pos.filter(y=>typeof y=="string"):[],teacher_id:w.teacher_id||void 0};c?(await t(Of({id:c.id,...k})).unwrap(),Ue.success("Subject updated successfully!")):(await t(Ff(k)).unwrap(),Ue.success("Subject created successfully!")),_()}catch(k){Ue.error(k.message||"An error occurred")}},v=w=>{o(w),x("name",w.name),x("code",w.code),x("class_id",w.class_id),x("teacher_id",w.teacher_id),x("credits",w.credits),x("cos",w.cos||[]),x("pos",w.pos||[]),l(!0)},b=async w=>{if(window.confirm("Are you sure you want to delete this subject?"))try{await t(Df(w)).unwrap(),Ue.success("Subject deleted successfully!")}catch(k){Ue.error(k.message||"Failed to delete subject")}},_=()=>{l(!1),o(null),h()};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),n.jsxs("button",{onClick:()=>l(!0),className:"btn-primary flex items-center space-x-2",children:[n.jsx(Na,{size:18}),n.jsx("span",{children:"Add Subject"})]})]}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Subject"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Class"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Teacher"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Credits"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"CO/PO Mapping"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Actions"})]})}),n.jsx("tbody",{children:e.map(w=>{const k=r.find(N=>N.id===w.class_id),y=m.find(N=>N.id===w.teacher_id);return n.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[n.jsx("td",{className:"py-3 px-4",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-orange-100 p-2 rounded-lg",children:n.jsx(gt,{size:16,className:"text-orange-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:w.name}),n.jsxs("p",{className:"text-sm text-gray-600",children:["Code: ",w.code]})]})]})}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("span",{className:"text-sm text-gray-900",children:(k==null?void 0:k.name)||"Unknown"}),k&&n.jsxs("p",{className:"text-xs text-gray-500",children:["Sem ",k.semester," - Sec ",k.section]})]}),n.jsx("td",{className:"py-3 px-4",children:y?n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(bn,{size:14,className:"text-gray-400"}),n.jsxs("span",{className:"text-sm text-gray-900",children:[y.first_name," ",y.last_name]})]}):n.jsx("span",{className:"text-sm text-red-600",children:"Not Assigned"})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:w.credits})}),n.jsx("td",{className:"py-3 px-4",children:n.jsxs("div",{className:"space-y-1",children:[w.cos&&w.cos.length>0&&n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx("span",{className:"text-xs text-gray-600",children:"CO:"}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[w.cos.slice(0,3).map((N,S)=>n.jsx("span",{className:"bg-green-100 text-green-800 px-1.5 py-0.5 rounded text-xs",children:N},S)),w.cos.length>3&&n.jsxs("span",{className:"text-xs text-gray-500",children:["+",w.cos.length-3]})]})]}),w.pos&&w.pos.length>0&&n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx("span",{className:"text-xs text-gray-600",children:"PO:"}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[w.pos.slice(0,3).map((N,S)=>n.jsx("span",{className:"bg-purple-100 text-purple-800 px-1.5 py-0.5 rounded text-xs",children:N},S)),w.pos.length>3&&n.jsxs("span",{className:"text-xs text-gray-500",children:["+",w.pos.length-3]})]})]})]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("div",{className:"flex justify-center space-x-2",children:[n.jsx("button",{onClick:()=>v(w),className:"p-2 text-gray-400 hover:text-blue-600 rounded-lg",children:n.jsx(Xl,{size:16})}),n.jsx("button",{onClick:()=>b(w.id),className:"p-2 text-gray-400 hover:text-red-600 rounded-lg",children:n.jsx(la,{size:16})})]})})]},w.id)})})]})})}),e.length===0&&n.jsxs("div",{className:"card text-center py-8",children:[n.jsx(gt,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Subjects Found"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"Start by creating your first subject."}),n.jsx("button",{onClick:()=>l(!0),className:"btn-primary",children:"Add First Subject"})]}),i&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 my-8 max-h-[90vh] overflow-y-auto",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:c?"Edit Subject":"Add New Subject"}),n.jsxs("form",{onSubmit:f(p),className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),n.jsx("input",{...d("name"),type:"text",className:"input-field w-full",placeholder:"e.g., Data Structures"}),u.name&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.name.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Code"}),n.jsx("input",{...d("code"),type:"text",className:"input-field w-full",placeholder:"e.g., CS301"}),u.code&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.code.message})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),n.jsxs("select",{...d("class_id",{valueAsNumber:!0}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Class"}),r.map(w=>n.jsxs("option",{value:w.id,children:[w.name," (Sem ",w.semester," - Sec ",w.section,")"]},w.id))]}),u.class_id&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.class_id.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher"}),n.jsxs("select",{...d("teacher_id",{setValueAs:w=>w===""?null:Number(w)}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Teacher"}),m.map(w=>n.jsxs("option",{value:w.id,children:[w.first_name," ",w.last_name]},w.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credits"}),n.jsxs("select",{...d("credits",{valueAsNumber:!0}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Credits"}),[1,2,3,4,5,6].map(w=>n.jsxs("option",{value:w,children:[w," Credit",w>1?"s":""]},w))]}),u.credits&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.credits.message})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Course Outcomes (CO) - Comma separated"}),n.jsx("input",{type:"text",className:"input-field w-full",placeholder:"e.g., CO1, CO2, CO3",defaultValue:((g=c==null?void 0:c.cos)==null?void 0:g.join(", "))||"",onChange:w=>{const k=w.target.value.split(",").map(y=>y.trim()).filter(y=>y);x("cos",k)}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Program Outcomes (PO) - Comma separated"}),n.jsx("input",{type:"text",className:"input-field w-full",placeholder:"e.g., PO1, PO2, PO3",defaultValue:((j=c==null?void 0:c.pos)==null?void 0:j.join(", "))||"",onChange:w=>{const k=w.target.value.split(",").map(y=>y.trim()).filter(y=>y);x("pos",k)}})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:_,className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"btn-primary disabled:opacity-50",children:s?"Saving...":c?"Update":"Create"})]})]})]})}),s&&n.jsx("div",{className:"text-center py-4",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent mx-auto"})})]})},_h=ca({username:Vt().required("Username is required"),email:Vt().email("Invalid email").required("Email is required"),first_name:Vt().required("First name is required"),last_name:Vt().required("Last name is required"),role:Vt().oneOf(["admin","hod","teacher","student"]).required("Role is required"),department_id:Ks().nullable().transform((t,e)=>e===""?null:t),class_id:Ks().nullable().transform((t,e)=>e===""?null:t),is_active:Nf().default(!0)}),uN=ca({password:Vt().min(6,"Password must be at least 6 characters").required("Password is required")}),hN=()=>{const t=vt(),{users:e,loading:s}=ge(S=>S.users),{departments:r}=ge(S=>S.departments),{classes:a}=ge(S=>S.classes),[i,l]=G.useState(!1),[c,o]=G.useState(null),[d,f]=G.useState(""),u=c?_h:_h.concat(uN),{register:h,handleSubmit:x,formState:{errors:m},reset:p,setValue:v,watch:b}=Mi({resolver:Ri(u)}),_=b("role");G.useEffect(()=>{t(gs()),t(Lr()),t(ir())},[t]),G.useEffect(()=>{f(_)},[_]);const g=async S=>{try{if(c){const T={...S,department_id:S.department_id||void 0,class_id:S.class_id||void 0};T.password||delete T.password,await t(Sf({id:c.id,...T})).unwrap(),Ue.success("User updated successfully!")}else await t(kf(S)).unwrap(),Ue.success("User created successfully!");l(!1),o(null),p(),f("")}catch(T){Ue.error(T.message||"An error occurred")}},j=S=>{o(S),v("username",S.username),v("email",S.email),v("first_name",S.first_name),v("last_name",S.last_name),v("role",S.role),v("department_id",S.department_id),v("class_id",S.class_id),v("is_active",S.is_active),f(S.role),l(!0)},w=async S=>{if(window.confirm("Are you sure you want to delete this user?"))try{await t(Ef(S)).unwrap(),Ue.success("User deleted successfully!")}catch(T){Ue.error(T.message||"Failed to delete user")}},k=()=>{l(!1),o(null),p(),f("")},y=S=>{switch(S){case"admin":return"bg-red-100 text-red-800";case"hod":return"bg-purple-100 text-purple-800";case"teacher":return"bg-blue-100 text-blue-800";case"student":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},N=S=>{switch(S){case"admin":return io;case"hod":return io;case"teacher":return bn;case"student":return bn;default:return bn}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),n.jsxs("button",{onClick:()=>l(!0),className:"btn-primary flex items-center space-x-2",children:[n.jsx(Na,{size:18}),n.jsx("span",{children:"Add User"})]})]}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"User"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Role"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Department"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Class"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Status"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Actions"})]})}),n.jsx("tbody",{children:e.map(S=>{const T=r.find(H=>H.id===S.department_id),E=a.find(H=>H.id===S.class_id),A=N(S.role);return n.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[n.jsx("td",{className:"py-3 px-4",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-gray-100 p-2 rounded-full",children:n.jsx(bn,{size:16,className:"text-gray-600"})}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium text-gray-900",children:[S.first_name," ",S.last_name]}),n.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[n.jsx(cb,{size:14}),n.jsx("span",{children:S.email})]})]})]})}),n.jsx("td",{className:"py-3 px-4",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(A,{size:16,className:"text-gray-600"}),n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${y(S.role)}`,children:S.role.toUpperCase()})]})}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("span",{className:"text-sm text-gray-900",children:(T==null?void 0:T.name)||"-"})}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("span",{className:"text-sm text-gray-900",children:(E==null?void 0:E.name)||"-"})}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${S.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.is_active?"Active":"Inactive"})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("div",{className:"flex justify-center space-x-2",children:[n.jsx("button",{onClick:()=>j(S),className:"p-2 text-gray-400 hover:text-blue-600 rounded-lg",children:n.jsx(Xl,{size:16})}),n.jsx("button",{onClick:()=>w(S.id),className:"p-2 text-gray-400 hover:text-red-600 rounded-lg",children:n.jsx(la,{size:16})})]})})]},S.id)})})]})})}),i&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 my-8 max-h-[90vh] overflow-y-auto",children:[n.jsx("h2",{className:"text-lg font-semibold mb-4",children:c?"Edit User":"Add New User"}),n.jsxs("form",{onSubmit:x(g),className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),n.jsx("input",{...h("username"),type:"text",className:"input-field w-full",placeholder:"Enter username"}),m.username&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.username.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{...h("email"),type:"email",className:"input-field w-full",placeholder:"Enter email"}),m.email&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.email.message})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),n.jsx("input",{...h("first_name"),type:"text",className:"input-field w-full",placeholder:"Enter first name"}),m.first_name&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.first_name.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),n.jsx("input",{...h("last_name"),type:"text",className:"input-field w-full",placeholder:"Enter last name"}),m.last_name&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.last_name.message})]})]}),!c&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),n.jsx("input",{...h("password"),type:"password",className:"input-field w-full",placeholder:"Enter password"}),m.password&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.password.message})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),n.jsxs("select",{...h("role"),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Role"}),n.jsx("option",{value:"admin",children:"Admin"}),n.jsx("option",{value:"hod",children:"HOD"}),n.jsx("option",{value:"teacher",children:"Teacher"}),n.jsx("option",{value:"student",children:"Student"})]}),m.role&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.role.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),n.jsxs("select",{...h("department_id",{setValueAs:S=>S===""?null:Number(S)}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Department"}),r.map(S=>n.jsx("option",{value:S.id,children:S.name},S.id))]})]})]}),d==="student"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),n.jsxs("select",{...h("class_id",{setValueAs:S=>S===""?null:Number(S)}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Class"}),a.map(S=>n.jsx("option",{value:S.id,children:S.name},S.id))]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("input",{...h("is_active"),type:"checkbox",className:"rounded border-gray-300"}),n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Active User"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n.jsx("button",{type:"button",onClick:k,className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"btn-primary disabled:opacity-50",children:s?"Saving...":c?"Update":"Create"})]})]})]})}),s&&n.jsx("div",{className:"text-center py-4",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent mx-auto"})})]})},mN={coDefinitions:[],coDefinitionsLoading:!1,coDefinitionsError:null,poDefinitions:[],poDefinitionsLoading:!1,poDefinitionsError:null,coTargets:[],coTargetsLoading:!1,coTargetsError:null,assessmentWeights:[],assessmentWeightsLoading:!1,assessmentWeightsError:null,coPoMatrix:[],coPoMatrixLoading:!1,coPoMatrixError:null,questionCoWeights:[],questionCoWeightsLoading:!1,questionCoWeightsError:null,indirectAttainment:[],indirectAttainmentLoading:!1,indirectAttainmentError:null,attainmentAudit:[],attainmentAuditLoading:!1,attainmentAuditError:null,subjectAttainment:null,subjectAttainmentLoading:!1,subjectAttainmentError:null,selectedSubjectId:null,selectedDepartmentId:null,selectedQuestionId:null},ol=He("copo/fetchCODefinitions",async t=>await Zl.getBySubject(t)),wg=He("copo/createCODefinition",async({subjectId:t,coData:e})=>await Zl.create(t,e)),Ng=He("copo/updateCODefinition",async({coId:t,coData:e})=>await Zl.update(t,e)),jg=He("copo/deleteCODefinition",async t=>(await Zl.delete(t),t)),dl=He("copo/fetchPODefinitions",async t=>await Ql.getByDepartment(t)),kg=He("copo/createPODefinition",async({departmentId:t,poData:e})=>await Ql.create(t,e)),Sg=He("copo/updatePODefinition",async({poId:t,poData:e})=>await Ql.update(t,e)),Eg=He("copo/deletePODefinition",async t=>(await Ql.delete(t),t)),Zc=He("copo/fetchCOTargets",async t=>await Op.getBySubject(t)),Tg=He("copo/bulkUpdateCOTargets",async({subjectId:t,coTargets:e})=>await Op.bulkUpdate(t,e)),Gd=He("copo/fetchAssessmentWeights",async t=>await Dp.getBySubject(t)),xN=He("copo/bulkUpdateAssessmentWeights",async({subjectId:t,assessmentWeights:e})=>await Dp.bulkUpdate(t,e)),Xd=He("copo/fetchCOPOMatrix",async t=>await po.getBySubject(t)),pN=He("copo/bulkUpdateCOPOMatrix",async({subjectId:t,coPoMatrix:e})=>await po.bulkUpdate(t,e)),qd=He("copo/fetchQuestionCOWeights",async t=>await Pp.getByQuestion(t)),gN=He("copo/bulkUpdateQuestionCOWeights",async({questionId:t,coWeights:e})=>await Pp.bulkUpdate(t,e)),Yd=He("copo/fetchIndirectAttainment",async t=>await ld.getBySubject(t)),vN=He("copo/createIndirectAttainment",async({subjectId:t,attainmentData:e})=>await ld.create(t,e)),yN=He("copo/updateIndirectAttainment",async({attainmentId:t,attainmentData:e})=>await ld.update(t,e)),bN=He("copo/deleteIndirectAttainment",async t=>(await ld.delete(t),t)),Kd=He("copo/fetchAttainmentAudit",async t=>await lw.getBySubject(t)),Qc=He("copo/fetchSubjectAttainment",async({subjectId:t,examType:e})=>await Mp.getSubjectAttainment(t,e)),Cg=Oa({name:"copo",initialState:mN,reducers:{setSelectedSubject:(t,e)=>{t.selectedSubjectId=e.payload},setSelectedDepartment:(t,e)=>{t.selectedDepartmentId=e.payload},setSelectedQuestion:(t,e)=>{t.selectedQuestionId=e.payload},clearErrors:t=>{t.coDefinitionsError=null,t.poDefinitionsError=null,t.coTargetsError=null,t.assessmentWeightsError=null,t.coPoMatrixError=null,t.questionCoWeightsError=null,t.indirectAttainmentError=null,t.attainmentAuditError=null,t.subjectAttainmentError=null}},extraReducers:t=>{t.addCase(ol.pending,e=>{e.coDefinitionsLoading=!0,e.coDefinitionsError=null}).addCase(ol.fulfilled,(e,s)=>{e.coDefinitionsLoading=!1,e.coDefinitions=s.payload}).addCase(ol.rejected,(e,s)=>{e.coDefinitionsLoading=!1,e.coDefinitionsError=s.error.message||"Failed to fetch CO definitions"}).addCase(wg.fulfilled,(e,s)=>{e.coDefinitions.push(s.payload)}).addCase(Ng.fulfilled,(e,s)=>{const r=e.coDefinitions.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.coDefinitions[r]=s.payload)}).addCase(jg.fulfilled,(e,s)=>{e.coDefinitions=e.coDefinitions.filter(r=>r.id!==s.payload)}),t.addCase(dl.pending,e=>{e.poDefinitionsLoading=!0,e.poDefinitionsError=null}).addCase(dl.fulfilled,(e,s)=>{e.poDefinitionsLoading=!1,e.poDefinitions=s.payload}).addCase(dl.rejected,(e,s)=>{e.poDefinitionsLoading=!1,e.poDefinitionsError=s.error.message||"Failed to fetch PO definitions"}).addCase(kg.fulfilled,(e,s)=>{e.poDefinitions.push(s.payload)}).addCase(Sg.fulfilled,(e,s)=>{const r=e.poDefinitions.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.poDefinitions[r]=s.payload)}).addCase(Eg.fulfilled,(e,s)=>{e.poDefinitions=e.poDefinitions.filter(r=>r.id!==s.payload)}),t.addCase(Zc.pending,e=>{e.coTargetsLoading=!0,e.coTargetsError=null}).addCase(Zc.fulfilled,(e,s)=>{e.coTargetsLoading=!1,e.coTargets=s.payload}).addCase(Zc.rejected,(e,s)=>{e.coTargetsLoading=!1,e.coTargetsError=s.error.message||"Failed to fetch CO targets"}).addCase(Tg.fulfilled,(e,s)=>{e.coTargets=s.payload}),t.addCase(Gd.pending,e=>{e.assessmentWeightsLoading=!0,e.assessmentWeightsError=null}).addCase(Gd.fulfilled,(e,s)=>{e.assessmentWeightsLoading=!1,e.assessmentWeights=s.payload}).addCase(Gd.rejected,(e,s)=>{e.assessmentWeightsLoading=!1,e.assessmentWeightsError=s.error.message||"Failed to fetch assessment weights"}).addCase(xN.fulfilled,(e,s)=>{e.assessmentWeights=s.payload}),t.addCase(Xd.pending,e=>{e.coPoMatrixLoading=!0,e.coPoMatrixError=null}).addCase(Xd.fulfilled,(e,s)=>{e.coPoMatrixLoading=!1,e.coPoMatrix=s.payload}).addCase(Xd.rejected,(e,s)=>{e.coPoMatrixLoading=!1,e.coPoMatrixError=s.error.message||"Failed to fetch CO-PO matrix"}).addCase(pN.fulfilled,(e,s)=>{e.coPoMatrix=s.payload}),t.addCase(qd.pending,e=>{e.questionCoWeightsLoading=!0,e.questionCoWeightsError=null}).addCase(qd.fulfilled,(e,s)=>{e.questionCoWeightsLoading=!1,e.questionCoWeights=s.payload}).addCase(qd.rejected,(e,s)=>{e.questionCoWeightsLoading=!1,e.questionCoWeightsError=s.error.message||"Failed to fetch question CO weights"}).addCase(gN.fulfilled,(e,s)=>{e.questionCoWeights=s.payload}),t.addCase(Yd.pending,e=>{e.indirectAttainmentLoading=!0,e.indirectAttainmentError=null}).addCase(Yd.fulfilled,(e,s)=>{e.indirectAttainmentLoading=!1,e.indirectAttainment=s.payload}).addCase(Yd.rejected,(e,s)=>{e.indirectAttainmentLoading=!1,e.indirectAttainmentError=s.error.message||"Failed to fetch indirect attainment"}).addCase(vN.fulfilled,(e,s)=>{e.indirectAttainment.push(s.payload)}).addCase(yN.fulfilled,(e,s)=>{const r=e.indirectAttainment.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.indirectAttainment[r]=s.payload)}).addCase(bN.fulfilled,(e,s)=>{e.indirectAttainment=e.indirectAttainment.filter(r=>r.id!==s.payload)}),t.addCase(Kd.pending,e=>{e.attainmentAuditLoading=!0,e.attainmentAuditError=null}).addCase(Kd.fulfilled,(e,s)=>{e.attainmentAuditLoading=!1,e.attainmentAudit=s.payload}).addCase(Kd.rejected,(e,s)=>{e.attainmentAuditLoading=!1,e.attainmentAuditError=s.error.message||"Failed to fetch attainment audit"}),t.addCase(Qc.pending,e=>{e.subjectAttainmentLoading=!0,e.subjectAttainmentError=null}).addCase(Qc.fulfilled,(e,s)=>{e.subjectAttainmentLoading=!1,e.subjectAttainment=s.payload}).addCase(Qc.rejected,(e,s)=>{e.subjectAttainmentLoading=!1,e.subjectAttainmentError=s.error.message||"Failed to fetch subject attainment"})}}),{setSelectedSubject:wo,setSelectedDepartment:_N,setSelectedQuestion:YR,clearErrors:Ka}=Cg.actions,wN=Cg.reducer,NN=()=>{var V;const t=vt(),{subjects:e}=ge(L=>L.subjects),{classes:s}=ge(L=>L.classes),{coDefinitions:r,coDefinitionsLoading:a,coDefinitionsError:i,selectedSubjectId:l,poDefinitions:c,poDefinitionsLoading:o}=ge(L=>L.copo),[d,f]=G.useState(!1),[u,h]=G.useState(!1),[x,m]=G.useState(null),[p,v]=G.useState(null),[b,_]=G.useState({code:"",title:"",description:""}),[g,j]=G.useState({coId:null,mappedPOs:[]});G.useEffect(()=>{t(It()),t(Lr())},[t]),G.useEffect(()=>{if(l){t(ol(l));const L=e.find(P=>P.id===l);if(L){const P=s.find(J=>J.id===L.class_id);P!=null&&P.department_id&&t(dl(P.department_id))}}},[t,l,e,s]);const w=L=>{t(wo(L))},k=async L=>{if(L.preventDefault(),!!l)try{x?await t(Ng({coId:x.id,coData:b})).unwrap():await t(wg({subjectId:l,coData:b})).unwrap(),f(!1),m(null),_({code:"",title:"",description:""}),t(Ka())}catch(P){console.error("Error saving CO:",P)}},y=L=>{m(L),_({code:L.code,title:L.title,description:L.description||""}),f(!0)},N=async L=>{if(window.confirm("Are you sure you want to delete this CO?"))try{await t(jg(L)).unwrap(),t(Ka())}catch(P){console.error("Error deleting CO:",P)}},S=()=>{f(!1),m(null),_({code:"",title:"",description:""}),t(Ka())},T=async L=>{if(v(L),j({coId:L.id,mappedPOs:[]}),h(!0),l)try{const J=(await po.getBySubject(l)).find(Ee=>Ee.co_id===L.id);j(Ee=>{var Y;return{...Ee,mappedPOs:((Y=J==null?void 0:J.mapped_pos)==null?void 0:Y.map(de=>de.po_id))||[]}})}catch(P){console.error("Error loading existing mappings:",P)}},E=()=>{h(!1),v(null),j({coId:null,mappedPOs:[]})},A=L=>{j(P=>({...P,mappedPOs:P.mappedPOs.includes(L)?P.mappedPOs.filter(J=>J!==L):[...P.mappedPOs,L]}))},H=async()=>{if(!(!l||!g.coId||!p))try{const L=g.mappedPOs.map(P=>({co_id:p.id,po_id:P,strength:2}));await po.bulkUpdate(l,L),alert("CO-PO mapping saved successfully!"),h(!1),v(null),j({coId:null,mappedPOs:[]})}catch(L){console.error("Error saving CO-PO mapping:",L),alert("Failed to save CO-PO mapping")}};return n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Course Outcomes (CO) Management"}),n.jsx("p",{className:"text-gray-600",children:"Define and manage Course Outcomes for each subject"})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Subject"}),n.jsxs("select",{value:l||"",onChange:L=>w(Number(L.target.value)),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Choose a subject..."}),e.map(L=>n.jsxs("option",{value:L.id,children:[L.name," (",L.code,")"]},L.id))]})]}),i&&n.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:n.jsx("p",{className:"text-red-600",children:i})}),l&&n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[n.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["CO Definitions for ",(V=e.find(L=>L.id===l))==null?void 0:V.name]}),n.jsx("button",{onClick:()=>f(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Add CO"})]}),a?n.jsxs("div",{className:"p-6 text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),n.jsx("p",{className:"mt-2 text-gray-600",children:"Loading CO definitions..."})]}):r.length===0?n.jsxs("div",{className:"p-6 text-center text-gray-500",children:[n.jsx("p",{children:"No CO definitions found for this subject."}),n.jsx("p",{className:"mt-2",children:'Click "Add CO" to create the first Course Outcome.'})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CO Code"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(L=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:L.code}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:L.title}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:L.description||"No description"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>y(L),className:"text-blue-600 hover:text-blue-900 flex items-center",title:"Edit CO",children:[n.jsx(Xo,{className:"h-4 w-4 mr-1"}),"Edit"]}),n.jsxs("button",{onClick:()=>T(L),className:"text-green-600 hover:text-green-900 flex items-center",title:"Map to POs",children:[n.jsx(Rt,{className:"h-4 w-4 mr-1"}),"Map POs"]}),n.jsxs("button",{onClick:()=>N(L.id),className:"text-red-600 hover:text-red-900 flex items-center",title:"Delete CO",children:[n.jsx(la,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},L.id))})]})})]}),d&&n.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:n.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:n.jsxs("div",{className:"mt-3",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:x?"Edit CO":"Add New CO"}),n.jsxs("form",{onSubmit:k,children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CO Code"}),n.jsx("input",{type:"text",value:b.code,onChange:L=>_({...b,code:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., CO1",required:!0})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),n.jsx("input",{type:"text",value:b.title,onChange:L=>_({...b,title:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Understand basic concepts",required:!0})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),n.jsx("textarea",{value:b.description,onChange:L=>_({...b,description:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Detailed description of the CO...",rows:3})]}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:x?"Update":"Create"})]})]})]})})}),u&&p&&n.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:n.jsx("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white",children:n.jsxs("div",{className:"mt-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Map CO to Program Outcomes"}),n.jsxs("button",{onClick:E,className:"text-gray-400 hover:text-gray-600",children:[n.jsx("span",{className:"sr-only",children:"Close"}),n.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),n.jsxs("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Selected Course Outcome"}),n.jsxs("p",{className:"text-sm text-blue-800",children:[n.jsxs("span",{className:"font-semibold",children:[p.code,":"]})," ",p.title]}),n.jsx("p",{className:"text-xs text-blue-600 mt-1",children:p.description})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Select Program Outcomes to Map"}),o?n.jsxs("div",{className:"text-center py-4",children:[n.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"}),n.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading POs..."})]}):c.length===0?n.jsxs("div",{className:"text-center py-4 text-gray-500",children:[n.jsx("p",{children:"No Program Outcomes found for this department."}),n.jsx("p",{className:"text-sm mt-1",children:"Please create POs first in the PO Management section."})]}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-64 overflow-y-auto",children:c.map(L=>n.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded-lg border cursor-pointer transition-colors ${g.mappedPOs.includes(L.id)?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:[n.jsx("input",{type:"checkbox",checked:g.mappedPOs.includes(L.id),onChange:()=>A(L.id),className:"mt-1 h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.type==="PO"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:L.code}),n.jsx("span",{className:"text-sm font-medium text-gray-900",children:L.title})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:L.description})]})]},L.id))})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:[g.mappedPOs.length," PO(s) selected"]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:E,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"}),n.jsxs("button",{onClick:H,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center",children:[n.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Save Mapping"]})]})]})]})})})]})},jN=()=>{var b;const t=vt(),{departments:e}=ge(_=>_.departments),{poDefinitions:s,poDefinitionsLoading:r,poDefinitionsError:a,selectedDepartmentId:i}=ge(_=>_.copo),[l,c]=G.useState(!1),[o,d]=G.useState(null),[f,u]=G.useState({code:"",title:"",description:"",type:"PO"});G.useEffect(()=>{t(Lr())},[t]),G.useEffect(()=>{i&&t(dl(i))},[t,i]);const h=_=>{t(_N(_))},x=async _=>{if(_.preventDefault(),!!i)try{o?await t(Sg({poId:o.id,poData:f})).unwrap():await t(kg({departmentId:i,poData:f})).unwrap(),c(!1),d(null),u({code:"",title:"",description:"",type:"PO"}),t(Ka())}catch(g){console.error("Error saving PO:",g)}},m=_=>{d(_),u({code:_.code,title:_.title,description:_.description||"",type:_.type}),c(!0)},p=async _=>{if(window.confirm("Are you sure you want to delete this PO?"))try{await t(Eg(_)).unwrap(),t(Ka())}catch(g){console.error("Error deleting PO:",g)}},v=()=>{c(!1),d(null),u({code:"",title:"",description:"",type:"PO"}),t(Ka())};return n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Program Outcomes (PO) Management"}),n.jsx("p",{className:"text-gray-600",children:"Define and manage Program Outcomes and Program Specific Outcomes for each department"})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Department"}),n.jsxs("select",{value:i||"",onChange:_=>h(Number(_.target.value)),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Choose a department..."}),e.map(_=>n.jsxs("option",{value:_.id,children:[_.name," (",_.code,")"]},_.id))]})]}),a&&n.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:n.jsx("p",{className:"text-red-600",children:a})}),i&&n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[n.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["PO/PSO Definitions for ",(b=e.find(_=>_.id===i))==null?void 0:b.name]}),n.jsx("button",{onClick:()=>c(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Add PO/PSO"})]}),r?n.jsxs("div",{className:"p-6 text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),n.jsx("p",{className:"mt-2 text-gray-600",children:"Loading PO definitions..."})]}):s.length===0?n.jsxs("div",{className:"p-6 text-center text-gray-500",children:[n.jsx("p",{children:"No PO definitions found for this department."}),n.jsx("p",{className:"mt-2",children:'Click "Add PO/PSO" to create the first Program Outcome.'})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(_=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${_.type==="PO"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:_.type})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:_.code}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:_.title}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:_.description||"No description"}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[n.jsx("button",{onClick:()=>m(_),className:"text-blue-600 hover:text-blue-900 mr-3",children:"Edit"}),n.jsx("button",{onClick:()=>p(_.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},_.id))})]})})]}),l&&n.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:n.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:n.jsxs("div",{className:"mt-3",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:o?"Edit PO/PSO":"Add New PO/PSO"}),n.jsxs("form",{onSubmit:x,children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),n.jsxs("select",{value:f.type,onChange:_=>u({...f,type:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"PO",children:"Program Outcome (PO)"}),n.jsx("option",{value:"PSO",children:"Program Specific Outcome (PSO)"})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Code"}),n.jsx("input",{type:"text",value:f.code,onChange:_=>u({...f,code:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., PO1 or PSO1",required:!0})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),n.jsx("input",{type:"text",value:f.title,onChange:_=>u({...f,title:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Engineering Knowledge",required:!0})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),n.jsx("textarea",{value:f.description,onChange:_=>u({...f,description:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Detailed description of the PO/PSO...",rows:3})]}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx("button",{type:"button",onClick:v,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:o?"Update":"Create"})]})]})]})})})]})},kN=()=>{var j;const t=vt(),{subjects:e}=ge(w=>w.subjects),{coTargets:s,coTargetsLoading:r,coTargetsError:a,selectedSubjectId:i,coDefinitions:l,coDefinitionsLoading:c}=ge(w=>w.copo),[o,d]=G.useState([]),[f,u]=G.useState(!1),[h,x]=G.useState(!1);G.useEffect(()=>{t(It())},[t]),G.useEffect(()=>{i&&(t(ol(i)),t(Zc(i)))},[t,i]),G.useEffect(()=>{d(s)},[s]);const m=w=>{t(wo(w))},p=(w,k,y)=>{const N=[...o];N[w]={...N[w],[k]:y},d(N)},v=()=>{if(l.length===0){alert("Please create CO definitions first");return}const w=o.map(N=>N.co_id),k=l.filter(N=>!w.includes(N.id));if(k.length===0){alert("All COs already have targets");return}const y={co_id:k[0].id,target_pct:70,l1_threshold:60,l2_threshold:70,l3_threshold:80};d([...o,y])},b=w=>{const k=o.filter((y,N)=>N!==w);d(k)},_=async()=>{if(i){x(!0);try{await t(Tg({subjectId:i,coTargets:o})).unwrap(),u(!1),t(Ka())}catch(w){console.error("Error saving CO targets:",w)}finally{x(!1)}}},g=()=>{d(s),u(!1),t(Ka())};return n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"CO Targets Management"}),n.jsx("p",{className:"text-gray-600",children:"Set target percentages and level thresholds for Course Outcomes"})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Subject"}),n.jsxs("select",{value:i||"",onChange:w=>m(Number(w.target.value)),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Choose a subject..."}),e.map(w=>n.jsxs("option",{value:w.id,children:[w.name," (",w.code,")"]},w.id))]})]}),a&&n.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:n.jsx("p",{className:"text-red-600",children:a})}),i&&n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[n.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["CO Targets for ",(j=e.find(w=>w.id===i))==null?void 0:j.name]}),n.jsx("div",{className:"space-x-3",children:f?n.jsxs("div",{className:"space-x-2",children:[n.jsx("button",{onClick:v,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",children:"Add Target"}),n.jsx("button",{onClick:_,disabled:h,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:h?"Saving...":"Save Changes"}),n.jsx("button",{onClick:g,className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"})]}):n.jsx("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Edit Targets"})})]}),r?n.jsxs("div",{className:"p-6 text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),n.jsx("p",{className:"mt-2 text-gray-600",children:"Loading CO targets..."})]}):o.length===0?n.jsxs("div",{className:"p-6 text-center text-gray-500",children:[n.jsx("p",{children:"No CO targets found for this subject."}),n.jsx("p",{className:"mt-2",children:'Click "Edit Targets" to add CO targets.'})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CO"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Target %"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"L1 Threshold"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"L2 Threshold"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"L3 Threshold"}),f&&n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map((w,k)=>{var y;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f?n.jsxs("select",{value:w.co_id||"",onChange:N=>p(k,"co_id",Number(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select CO"}),l.map(N=>n.jsxs("option",{value:N.id,children:[N.code," - ",N.title]},N.id))]}):n.jsx("span",{className:"text-sm font-medium text-gray-900",children:((y=l.find(N=>N.id===w.co_id))==null?void 0:y.code)||"N/A"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f?n.jsx("input",{type:"number",min:"0",max:"100",value:w.target_pct,onChange:N=>p(k,"target_pct",Number(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):n.jsxs("span",{className:"text-sm text-gray-900",children:[w.target_pct,"%"]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f?n.jsx("input",{type:"number",min:"0",max:"100",value:w.l1_threshold,onChange:N=>p(k,"l1_threshold",Number(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):n.jsxs("span",{className:"text-sm text-gray-900",children:[w.l1_threshold,"%"]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f?n.jsx("input",{type:"number",min:"0",max:"100",value:w.l2_threshold,onChange:N=>p(k,"l2_threshold",Number(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):n.jsxs("span",{className:"text-sm text-gray-900",children:[w.l2_threshold,"%"]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f?n.jsx("input",{type:"number",min:"0",max:"100",value:w.l3_threshold,onChange:N=>p(k,"l3_threshold",Number(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):n.jsxs("span",{className:"text-sm text-gray-900",children:[w.l3_threshold,"%"]})}),f&&n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsx("button",{onClick:()=>b(k),className:"text-red-600 hover:text-red-900",children:"Remove"})})]},k)})})]})}),n.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Level Thresholds Explanation"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium text-gray-900",children:"L1 (Basic):"})," Students demonstrate basic understanding and knowledge"]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium text-gray-900",children:"L2 (Intermediate):"})," Students can apply knowledge to solve problems"]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium text-gray-900",children:"L3 (Advanced):"})," Students can analyze, evaluate, and create solutions"]})]})]})]})]})},SN=ca({question_number:Vt().required("Question number is required"),max_marks:Ks().min(.5,"Minimum 0.5 marks").required("Marks required"),section:Vt().oneOf(["A","B","C"]).required("Section is required"),blooms_level:Vt().required("Blooms level is required"),difficulty:Vt().oneOf(["easy","medium","hard"]).required("Difficulty is required"),co_weights:kl().of(ca({co_id:Ks().required(),co_code:Vt().required(),weight_pct:Ks().min(0).max(100).required()}))}),EN=ca({name:Vt().required("Exam name is required"),subject_id:Ks().required("Subject is required"),exam_type:Vt().oneOf(["internal1","internal2","final"]).required("Exam type is required"),exam_date:jf().nullable(),duration:Ks().min(30).max(300).nullable(),total_marks:Ks().min(1).required("Total marks is required"),questions:kl().of(SN).min(1,"At least one question is required")}),TN=()=>{const t=vt(),{exams:e,loading:s}=ge(F=>F.exams),{subjects:r}=ge(F=>F.subjects),{classes:a}=ge(F=>F.classes),{user:i}=ge(F=>F.auth),[l,c]=G.useState(!1),[o,d]=G.useState(null),[f,u]=G.useState(null),[h,x]=G.useState([]),[m,p]=G.useState([]),[v,b]=G.useState(!1),[_,g]=G.useState(!1),[j,w]=G.useState([]),[k,y]=G.useState(!0),[N,S]=G.useState(new Set),{register:T,handleSubmit:E,formState:{errors:A},reset:H,control:V,watch:L,setValue:P}=Mi({resolver:Ri(EN),defaultValues:{questions:[]}}),{fields:J,append:Ee,remove:Y}=Rw({control:V,name:"questions"}),de=L("questions"),De=(de==null?void 0:de.reduce((F,ye)=>F+(ye.max_marks||0),0))||0;G.useEffect(()=>{t(Br()),t(It())},[t]),G.useEffect(()=>{P("total_marks",De)},[De,P]);const B=G.useMemo(()=>r.filter(F=>F.teacher_id===(i==null?void 0:i.id)),[r,i==null?void 0:i.id]),X=async F=>{if(!F){x([]),p([]),w([]);return}try{b(!0),g(!0);const ye=await Zl.getBySubject(F);x(ye||[]);const Ie=r.find(Le=>Le.id===F);if(Ie!=null&&Ie.class_id){const Le=a.find(K=>K.id===Ie.class_id);if(Le!=null&&Le.department_id){const K=await Ql.getByDepartment(Le.department_id);p(K||[])}try{const K=await Mp.getCOPOMapping(F);w(K)}catch(K){console.warn("Could not fetch CO-PO mapping:",K),w([])}}}catch(ye){console.error("Error fetching COs and POs:",ye),Ue.error("Failed to load CO/PO data")}finally{b(!1),g(!1)}},W=L("subject_id");G.useEffect(()=>{W&&(u(W),X(W))},[W,r]);const z=async F=>{var ye;try{const Ie={...F,exam_date:F.exam_date?new Date(F.exam_date).toISOString():void 0,duration:F.duration||void 0,questions:((ye=F.questions)==null?void 0:ye.map((Le,K)=>{var Z;return{...Le,id:Le.id||K+1,co_weights:((Z=Le.co_weights)==null?void 0:Z.filter(Oe=>Oe!==void 0))||[]}}))||[]};o?(await t(bg({id:o.id,...Ie})).unwrap(),Ue.success("Exam updated successfully!")):(await t(yg(Ie)).unwrap(),Ue.success("Exam created successfully!")),xe()}catch(Ie){Ue.error(Ie.message||"An error occurred")}},ae=F=>{var ye;d(F),H({name:F.name,subject_id:F.subject_id,exam_type:F.exam_type,exam_date:F.exam_date?new Date(F.exam_date):void 0,duration:F.duration,total_marks:F.total_marks,questions:((ye=F.questions)==null?void 0:ye.length)>0?F.questions:[{question_number:"1a",max_marks:10,section:"A",blooms_level:"Remember",difficulty:"easy",co_weights:[]}]}),c(!0)},me=async F=>{if(window.confirm("Are you sure you want to delete this exam?"))try{await t(_g(F)).unwrap(),Ue.success("Exam deleted successfully!")}catch(ye){Ue.error(ye.message||"Failed to delete exam")}},xe=()=>{c(!1),d(null),H({questions:[{question_number:"1a",max_marks:10,section:"A",blooms_level:"Remember",difficulty:"easy",co_weights:[]}]})},ue=()=>{Ee({question_number:"",max_marks:10,section:"A",blooms_level:"Remember",difficulty:"easy"}),setTimeout(()=>{const F=document.querySelector(".flex-1.overflow-y-auto.space-y-4");F&&F.scrollTo({top:F.scrollHeight,behavior:"smooth"})},100)},oe=F=>{const ye=new Set(N);ye.has(F)?ye.delete(F):ye.add(F),S(ye)},ze=e.filter(F=>B.some(ye=>ye.id===F.subject_id));return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Exam Configuration"}),n.jsxs("button",{onClick:()=>c(!0),className:"btn-primary flex items-center space-x-2",children:[n.jsx(Na,{size:18}),n.jsx("span",{children:"Create Exam"})]})]}),n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:ze.map(F=>{var Ie;const ye=r.find(Le=>Le.id===F.subject_id);return n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:F.name}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx("button",{onClick:()=>ae(F),className:"p-1 text-gray-400 hover:text-blue-600",children:n.jsx(Xl,{size:16})}),n.jsx("button",{onClick:()=>me(F.id),className:"p-1 text-gray-400 hover:text-red-600",children:n.jsx(la,{size:16})})]})]}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Fr,{size:16,className:"text-gray-400"}),n.jsx("span",{children:ye==null?void 0:ye.name})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(lo,{size:16,className:"text-gray-400"}),n.jsx("span",{className:"capitalize",children:F.exam_type.replace("internal","Internal ")})]}),F.exam_date&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(oo,{size:16,className:"text-gray-400"}),n.jsx("span",{children:new Date(F.exam_date).toLocaleDateString()})]}),F.duration&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Si,{size:16,className:"text-gray-400"}),n.jsxs("span",{children:[F.duration," minutes"]})]})]}),n.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[n.jsxs("span",{children:["Questions: ",((Ie=F.questions)==null?void 0:Ie.length)||0]}),n.jsxs("span",{className:"font-medium",children:["Total: ",F.total_marks," marks"]})]}),F.questions&&F.questions.length>0&&n.jsxs("div",{className:"text-xs text-gray-500",children:[n.jsxs("div",{className:"flex flex-wrap gap-1 mb-1",children:[n.jsx("span",{className:"font-medium",children:"COs:"}),Array.from(new Set(F.questions.flatMap(Le=>{var K;return((K=Le.co_weights)==null?void 0:K.map(Z=>Z.co_code))||[]}))).slice(0,3).map(Le=>n.jsx("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-xs",children:Le},Le)),Array.from(new Set(F.questions.flatMap(Le=>{var K;return((K=Le.co_weights)==null?void 0:K.map(Z=>Z.co_code))||[]}))).length>3&&n.jsxs("span",{className:"text-gray-400",children:["+",Array.from(new Set(F.questions.flatMap(Le=>{var K;return((K=Le.co_weights)==null?void 0:K.map(Z=>Z.co_code))||[]}))).length-3," more"]})]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.jsx("span",{className:"font-medium",children:"CO Weights:"}),n.jsxs("span",{className:"text-gray-600 text-xs",children:[F.questions.reduce((Le,K)=>{var Z;return Le+(((Z=K.co_weights)==null?void 0:Z.length)||0)},0)," mappings"]})]})]})]})]},F.id)})}),ze.length===0&&n.jsxs("div",{className:"card text-center py-8",children:[n.jsx(lo,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Exams Configured"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"Start by creating your first exam configuration."}),n.jsx("button",{onClick:()=>c(!0),className:"btn-primary",children:"Create First Exam"})]}),l&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:n.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 my-8 max-h-[90vh] flex flex-col shadow-xl overflow-y-auto",children:[n.jsx("div",{className:"p-6 bg-white",children:n.jsx("h2",{className:"text-lg font-semibold mb-4",children:o?"Edit Exam":"Create New Exam"})}),n.jsxs("form",{onSubmit:E(z),className:"flex-1 flex flex-col bg-white",children:[n.jsx("div",{className:"px-6 pt-6 pb-4 bg-white",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Name"}),n.jsx("input",{...T("name"),type:"text",className:"input-field w-full",placeholder:"e.g., Internal Exam 1"}),A.name&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:A.name.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),n.jsxs("select",{...T("subject_id",{valueAsNumber:!0}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Subject"}),B.map(F=>n.jsx("option",{value:F.id,children:F.name},F.id))]}),A.subject_id&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:A.subject_id.message})]})]})}),n.jsx("div",{className:"px-6 py-4 bg-white",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Type"}),n.jsxs("select",{...T("exam_type"),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select Type"}),n.jsx("option",{value:"internal1",children:"Internal 1"}),n.jsx("option",{value:"internal2",children:"Internal 2"}),n.jsx("option",{value:"final",children:"Final Exam"})]}),A.exam_type&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:A.exam_type.message})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Date"}),n.jsx("input",{...T("exam_date"),type:"date",className:"input-field w-full"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (minutes)"}),n.jsx("input",{...T("duration",{valueAsNumber:!0}),type:"number",className:"input-field w-full",placeholder:"180"})]})]})}),n.jsxs("div",{className:"border-t pt-6 flex-1 flex flex-col bg-white px-6 min-h-0",children:[n.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 pb-4 mb-6 z-20 shadow-sm rounded-t-lg -mx-6 px-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Questions"}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsxs("span",{className:"font-medium",children:["Total Marks: ",De]}),f&&(h.length>0||m.length>0)&&n.jsxs("span",{className:"ml-4 text-xs text-gray-500",children:[h.length," COs  ",m.length," POs available"]})]}),n.jsxs("button",{type:"button",onClick:ue,className:"btn-primary text-sm",children:[n.jsx(Na,{size:16,className:"mr-1"}),"Add Question"]})]})]}),de&&de.length>0&&n.jsx("div",{className:"bg-blue-50 rounded-lg p-3 mt-3",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Total Questions:"}),n.jsx("span",{className:"ml-2 font-medium",children:de.length})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Unique COs:"}),n.jsx("span",{className:"ml-2 font-medium",children:Array.from(new Set(de.flatMap(F=>{var ye;return((ye=F.co_weights)==null?void 0:ye.map(Ie=>Ie.co_code))||[]}))).length})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Unique POs:"}),n.jsx("span",{className:"ml-2 font-medium",children:de.reduce((F,ye)=>{var Ie;return F+(((Ie=ye.co_weights)==null?void 0:Ie.length)||0)},0)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Avg Marks:"}),n.jsx("span",{className:"ml-2 font-medium",children:(De/de.length).toFixed(1)})]})]})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto space-y-4 bg-gray-50 rounded-lg p-4 min-h-0",children:J.map((F,ye)=>{var Ie,Le,K,Z,Oe,Te,M,q,Q,_e,ve;return n.jsxs("div",{id:`question-${ye}`,className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200 hover:border-blue-300 shadow-sm",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",ye+1]}),n.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[n.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded",children:((Ie=de==null?void 0:de[ye])==null?void 0:Ie.section)||"A"}),n.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded",children:[((Le=de==null?void 0:de[ye])==null?void 0:Le.max_marks)||0," marks"]}),n.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded",children:((K=de==null?void 0:de[ye])==null?void 0:K.difficulty)||"medium"})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{type:"button",onClick:()=>{const fe=document.getElementById(`question-${ye}`);fe==null||fe.scrollIntoView({behavior:"smooth",block:"center"})},className:"text-blue-600 hover:text-blue-800 text-sm",title:"Scroll to question",children:n.jsx(Rt,{size:16})}),J.length>1&&n.jsx("button",{type:"button",onClick:()=>Y(ye),className:"text-red-600 hover:text-red-800",title:"Delete question",children:n.jsx(la,{size:16})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question No."}),n.jsx("input",{...T(`questions.${ye}.question_number`),type:"text",className:"input-field w-full",placeholder:"1a"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Marks"}),n.jsx("input",{...T(`questions.${ye}.max_marks`,{valueAsNumber:!0}),type:"number",step:"0.5",className:"input-field w-full",placeholder:"10"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),n.jsxs("select",{...T(`questions.${ye}.section`),className:"input-field w-full",children:[n.jsx("option",{value:"A",children:"Section A"}),n.jsx("option",{value:"B",children:"Section B"}),n.jsx("option",{value:"C",children:"Section C"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bloom's Level"}),n.jsxs("select",{...T(`questions.${ye}.blooms_level`),className:"input-field w-full",children:[n.jsx("option",{value:"Remember",children:"Remember"}),n.jsx("option",{value:"Understand",children:"Understand"}),n.jsx("option",{value:"Apply",children:"Apply"}),n.jsx("option",{value:"Analyze",children:"Analyze"}),n.jsx("option",{value:"Evaluate",children:"Evaluate"}),n.jsx("option",{value:"Create",children:"Create"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Difficulty"}),n.jsxs("select",{...T(`questions.${ye}.difficulty`),className:"input-field w-full",children:[n.jsx("option",{value:"easy",children:"Easy"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"hard",children:"Hard"})]})]})]}),n.jsx("div",{className:"mt-4",children:n.jsxs("div",{className:"border-t pt-4 bg-gray-50 rounded-lg p-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"CO/PO Mapping"}),(((Oe=(Z=de==null?void 0:de[ye])==null?void 0:Z.co_weights)==null?void 0:Oe.length)||0)>0&&n.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[((M=(Te=de==null?void 0:de[ye])==null?void 0:Te.co_weights)==null?void 0:M.length)||0," CO weights"]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("label",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[n.jsx("input",{type:"checkbox",checked:k,onChange:fe=>y(fe.target.checked),className:"rounded"}),n.jsx("span",{children:"Auto-map POs"})]}),n.jsx("button",{type:"button",onClick:()=>oe(ye),className:"text-xs text-blue-600 hover:text-blue-800",children:N.has(ye)?"Hide Details":"Show Details"})]})]}),n.jsx("div",{className:"mb-3",children:n.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[(((q=de==null?void 0:de[ye])==null?void 0:q.co_weights)||[]).map(fe=>n.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded",children:[fe.co_code," (",fe.weight_pct,"%)"]},fe.co_id)),!((_e=(Q=de==null?void 0:de[ye])==null?void 0:Q.co_weights)!=null&&_e.length)&&n.jsx("span",{className:"text-gray-500",children:"No CO weights selected"})]})}),N.has(ye)&&n.jsx("div",{className:"mt-3",children:f?n.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 rounded-lg p-4 text-center",children:"CO/PO mapping is now handled separately in the CO Management section"}):n.jsx("div",{className:"text-sm text-gray-500 bg-gray-50 rounded-lg p-4 text-center",children:"Please select a subject first to configure CO/PO mappings"})})]})}),((ve=A.questions)==null?void 0:ve[ye])&&n.jsx("div",{className:"mt-2 text-red-500 text-sm",children:Object.entries(A.questions[ye]||{}).map(([fe,Fe])=>n.jsx("p",{children:typeof Fe=="object"&&"message"in Fe?Fe.message:String(Fe)},fe))})]},F.id)})}),A.questions&&n.jsx("p",{className:"text-red-500 text-sm mt-2",children:A.questions.message})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t bg-white px-6 pb-6",children:[n.jsx("button",{type:"button",onClick:xe,className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:s,className:"btn-primary disabled:opacity-50",children:s?"Saving...":o?"Update Exam":"Create Exam"})]})]})]})}),s&&n.jsx("div",{className:"text-center py-4",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent mx-auto"})}),l&&de&&de.length>3&&n.jsx("div",{className:"fixed left-6 top-1/2 transform -translate-y-1/2 z-[60]",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 p-3 max-h-96 overflow-y-auto",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Questions"}),n.jsx("div",{className:"space-y-1",children:de.map((F,ye)=>{var Ie,Le;return n.jsxs("button",{type:"button",onClick:()=>{const K=document.getElementById(`question-${ye}`);K==null||K.scrollIntoView({behavior:"smooth",block:"center"})},className:"w-full text-left px-2 py-1 text-xs rounded hover:bg-gray-100 flex items-center justify-between",children:[n.jsxs("span",{children:["Q",ye+1]}),n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx("span",{className:"text-gray-400",children:((Ie=de[ye])==null?void 0:Ie.section)||"A"}),n.jsxs("span",{className:"text-blue-600",children:[((Le=de[ye])==null?void 0:Le.max_marks)||0,"m"]})]})]},ye)})})]})}),l&&n.jsx("div",{className:"fixed bottom-6 right-6 z-[70]",children:n.jsxs("button",{type:"button",onClick:ue,className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg hover:shadow-xl transition-all duration-200 flex items-center space-x-2",title:"Add New Question",children:[n.jsx(Na,{size:24}),n.jsx("span",{className:"hidden sm:inline",children:"Add Question"})]})})]})},CN={marks:[],loading:!1,error:null},eo=He("marks/fetchMarksByExam",async t=>await id.getByExam(t)),fl=He("marks/saveMarks",async t=>await id.bulkCreate(t)),AN=He("marks/updateMark",async({id:t,marks_obtained:e})=>await id.update(t,{marks_obtained:e})),FN=Oa({name:"marks",initialState:CN,reducers:{clearError:t=>{t.error=null}},extraReducers:t=>{t.addCase(eo.pending,e=>{e.loading=!0,e.error=null}).addCase(eo.fulfilled,(e,s)=>{e.loading=!1,e.marks=s.payload}).addCase(eo.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to fetch marks"}).addCase(fl.pending,e=>{e.loading=!0,e.error=null}).addCase(fl.fulfilled,(e,s)=>{e.loading=!1,e.marks=s.payload}).addCase(fl.rejected,(e,s)=>{e.loading=!1,e.error=s.error.message||"Failed to save marks"}).addCase(AN.fulfilled,(e,s)=>{const r=e.marks.findIndex(a=>a.id===s.payload.id);r!==-1&&(e.marks[r]=s.payload)})}}),ON=FN.reducer;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var No={};No.version="0.18.5";var Ag=1252,DN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Pf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Mf=function(t){DN.indexOf(t)!=-1&&(Ag=Pf[0]=t)};function PN(){Mf(1252)}var Pr=function(t){Mf(t)};function Rf(){Pr(1200),PN()}function wh(t){for(var e=[],s=0,r=t.length;s<r;++s)e[s]=t.charCodeAt(s);return e}function MN(t){for(var e=[],s=0;s<t.length>>1;++s)e[s]=String.fromCharCode(t.charCodeAt(2*s)+(t.charCodeAt(2*s+1)<<8));return e.join("")}function Fg(t){for(var e=[],s=0;s<t.length>>1;++s)e[s]=String.fromCharCode(t.charCodeAt(2*s+1)+(t.charCodeAt(2*s)<<8));return e.join("")}var tl=function(t){var e=t.charCodeAt(0),s=t.charCodeAt(1);return e==255&&s==254?MN(t.slice(2)):e==254&&s==255?Fg(t.slice(2)):e==65279?t.slice(1):t},pc=function(e){return String.fromCharCode(e)},Nh=function(e){return String.fromCharCode(e)},Va,za="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Sl(t){for(var e="",s=0,r=0,a=0,i=0,l=0,c=0,o=0,d=0;d<t.length;)s=t.charCodeAt(d++),i=s>>2,r=t.charCodeAt(d++),l=(s&3)<<4|r>>4,a=t.charCodeAt(d++),c=(r&15)<<2|a>>6,o=a&63,isNaN(r)?c=o=64:isNaN(a)&&(o=64),e+=za.charAt(i)+za.charAt(l)+za.charAt(c)+za.charAt(o);return e}function xr(t){var e="",s=0,r=0,a=0,i=0,l=0,c=0,o=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=za.indexOf(t.charAt(d++)),l=za.indexOf(t.charAt(d++)),s=i<<2|l>>4,e+=String.fromCharCode(s),c=za.indexOf(t.charAt(d++)),r=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(r)),o=za.indexOf(t.charAt(d++)),a=(c&3)<<6|o,o!==64&&(e+=String.fromCharCode(a));return e}var it=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Da=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,s){return s?new Buffer(e,s):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function en(t){return it?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function jh(t){return it?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ur=function(e){return it?Da(e,"binary"):e.split("").map(function(s){return s.charCodeAt(0)&255})};function hd(t){if(typeof ArrayBuffer>"u")return ur(t);for(var e=new ArrayBuffer(t.length),s=new Uint8Array(e),r=0;r!=t.length;++r)s[r]=t.charCodeAt(r)&255;return e}function ln(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],s=0;s<t.length;++s)e[s]=String.fromCharCode(t[s]);return e.join("")}function RN(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function If(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return If(new Uint8Array(t));for(var e=new Array(t.length),s=0;s<t.length;++s)e[s]=t[s];return e}var Ns=it?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Da(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,s=0;for(e=0;e<t.length;++e)s+=t[e].length;var r=new Uint8Array(s),a=0;for(e=0,s=0;e<t.length;s+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],s);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),s)}return r}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function IN(t){for(var e=[],s=0,r=t.length+250,a=en(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)a[s++]=l;else if(l<2048)a[s++]=192|l>>6&31,a[s++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++i)&1023;a[s++]=240|l>>8&7,a[s++]=128|l>>2&63,a[s++]=128|c>>6&15|(l&3)<<4,a[s++]=128|c&63}else a[s++]=224|l>>12&15,a[s++]=128|l>>6&63,a[s++]=128|l&63;s>r&&(e.push(a.slice(0,s)),s=0,a=en(65535),r=65530)}return e.push(a.slice(0,s)),Ns(e)}var Js=/\u0000/g,sl=/[\u0001-\u0006]/g;function _i(t){for(var e="",s=t.length-1;s>=0;)e+=t.charAt(s--);return e}function Mr(t,e){var s=""+t;return s.length>=e?s:Jt("0",e-s.length)+s}function Lf(t,e){var s=""+t;return s.length>=e?s:Jt(" ",e-s.length)+s}function jo(t,e){var s=""+t;return s.length>=e?s:s+Jt(" ",e-s.length)}function LN(t,e){var s=""+Math.round(t);return s.length>=e?s:Jt("0",e-s.length)+s}function BN(t,e){var s=""+t;return s.length>=e?s:Jt("0",e-s.length)+s}var kh=Math.pow(2,32);function ni(t,e){if(t>kh||t<-kh)return LN(t,e);var s=Math.round(t);return BN(s,e)}function ko(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Sh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Jd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function UN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Eh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$N={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function So(t,e,s){for(var r=t<0?-1:1,a=t*r,i=0,l=1,c=0,o=1,d=0,f=0,u=Math.floor(a);d<e&&(u=Math.floor(a),c=u*l+i,f=u*d+o,!(a-u<5e-8));)a=1/(a-u),i=l,l=c,o=d,d=f;if(f>e&&(d>e?(f=o,c=i):(f=d,c=l)),!s)return[0,r*c,f];var h=Math.floor(r*c/f);return[h,r*c-h*f,f]}function Nn(t,e,s){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),i=0,l=[],c={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=s?[1317,10,29]:[1900,2,29],i=3;else if(r===0)l=s?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var o=new Date(1900,0,1);o.setDate(o.getDate()+r-1),l=[o.getFullYear(),o.getMonth()+1,o.getDate()],i=o.getDay(),r<60&&(i=(i+6)%7),s&&(i=XN(o,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var Og=new Date(1899,11,31,0,0,0),WN=Og.getTime(),VN=new Date(1900,2,1,0,0,0);function Dg(t,e){var s=t.getTime();return e?s-=1461*24*60*60*1e3:t>=VN&&(s+=24*60*60*1e3),(s-(WN+(t.getTimezoneOffset()-Og.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Bf(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function zN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function HN(t){var e=t<0?12:11,s=Bf(t.toFixed(12));return s.length<=e||(s=t.toPrecision(10),s.length<=e)?s:t.toExponential(5)}function GN(t){var e=Bf(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function El(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),s;return e>=-4&&e<=-1?s=t.toPrecision(10+e):Math.abs(e)<=9?s=HN(t):e===10?s=t.toFixed(10).substr(0,12):s=GN(t),Bf(zN(s.toUpperCase()))}function Rn(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):El(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Tr(14,Dg(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function XN(t,e){e[0]-=581;var s=t.getDay();return t<60&&(s=(s+6)%7),s}function qN(t,e,s,r){var a="",i=0,l=0,c=s.y,o,d=0;switch(t){case 98:c=s.y+543;case 121:switch(e.length){case 1:case 2:o=c%100,d=2;break;default:o=c%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:o=s.m,d=e.length;break;case 3:return Jd[s.m-1][1];case 5:return Jd[s.m-1][0];default:return Jd[s.m-1][2]}break;case 100:switch(e.length){case 1:case 2:o=s.d,d=e.length;break;case 3:return Sh[s.q][0];default:return Sh[s.q][1]}break;case 104:switch(e.length){case 1:case 2:o=1+(s.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:o=s.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:o=s.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return s.u===0&&(e=="s"||e=="ss")?Mr(s.S,e.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,i=Math.round(l*(s.S+s.u)),i>=60*l&&(i=0),e==="s"?i===0?"0":""+i/l:(a=Mr(i,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":o=s.D*24+s.H;break;case"[m]":case"[mm]":o=(s.D*24+s.H)*60+s.M;break;case"[s]":case"[ss]":o=((s.D*24+s.H)*60+s.M)*60+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:o=c,d=1;break}var f=d>0?Mr(o,d):"";return f}function Ha(t){var e=3;if(t.length<=e)return t;for(var s=t.length%e,r=t.substr(0,s);s!=t.length;s+=e)r+=(r.length>0?",":"")+t.substr(s,e);return r}var Pg=/%/g;function YN(t,e,s){var r=e.replace(Pg,""),a=e.length-r.length;return ka(t,r,s*Math.pow(10,2*a))+Jt("%",a)}function KN(t,e,s){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return ka(t,e.substr(0,r),s/Math.pow(10,3*(e.length-r)))}function Mg(t,e){var s,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Mg(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),s=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),s.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(l-s.length+i):s+="E+"+(l-i);s.substr(0,2)==="0.";)s=s.charAt(0)+s.substr(2,a)+"."+s.substr(2+a),s=s.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,d,f){return o+d+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else s=e.toExponential(r);return t.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),t.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}var Rg=/# (\?+)( ?)\/( ?)(\d+)/;function JN(t,e,s){var r=parseInt(t[4],10),a=Math.round(e*r),i=Math.floor(a/r),l=a-i*r,c=r;return s+(i===0?"":""+i)+" "+(l===0?Jt(" ",t[1].length+1+t[4].length):Lf(l,t[1].length)+t[2]+"/"+t[3]+Mr(c,t[4].length))}function ZN(t,e,s){return s+(e===0?"":""+e)+Jt(" ",t[1].length+2+t[4].length)}var Ig=/^#*0*\.([0#]+)/,Lg=/\).*[0#]/,Bg=/\(###\) ###\\?-####/;function Xs(t){for(var e="",s,r=0;r!=t.length;++r)switch(s=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(s)}return e}function Th(t,e){var s=Math.pow(10,e);return""+Math.round(t*s)/s}function Ch(t,e){var s=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(s*r)).length?0:Math.round(s*r)}function QN(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function ej(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function vr(t,e,s){if(t.charCodeAt(0)===40&&!e.match(Lg)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?vr("n",r,s):"("+vr("n",r,-s)+")"}if(e.charCodeAt(e.length-1)===44)return KN(t,e,s);if(e.indexOf("%")!==-1)return YN(t,e,s);if(e.indexOf("E")!==-1)return Mg(e,s);if(e.charCodeAt(0)===36)return"$"+vr(t,e.substr(e.charAt(1)==" "?2:1),s);var a,i,l,c,o=Math.abs(s),d=s<0?"-":"";if(e.match(/^00+$/))return d+ni(o,e.length);if(e.match(/^[#?]+$/))return a=ni(s,0),a==="0"&&(a=""),a.length>e.length?a:Xs(e.substr(0,e.length-a.length))+a;if(i=e.match(Rg))return JN(i,o,d);if(e.match(/^#+0+$/))return d+ni(o,e.length-e.indexOf("0"));if(i=e.match(Ig))return a=Th(s,i[1].length).replace(/^([^\.]+)$/,"$1."+Xs(i[1])).replace(/\.$/,"."+Xs(i[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Jt("0",Xs(i[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+Th(o,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+Ha(ni(o,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+vr(t,e,-s):Ha(""+(Math.floor(s)+QN(s,i[1].length)))+"."+Mr(Ch(s,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return vr(t,e.replace(/^#,#*,/,""),s);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_i(vr(t,e.replace(/[\\-]/g,""),s)),l=0,_i(_i(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return l<a.length?a.charAt(l++):m==="0"?"0":""}));if(e.match(Bg))return a=vr(t,"##########",s),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=So(o,Math.pow(10,l)-1,!1),a=""+d,f=ka("n",i[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=jo(c[2],l),f.length<i[4].length&&(f=Xs(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=So(o,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Lf(c[1],l)+i[2]+"/"+i[3]+jo(c[2],l):Jt(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=ni(s,0),e.length<=a.length?a:Xs(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+s.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var u=e.indexOf(".")-l,h=e.length-a.length-u;return Xs(e.substr(0,u)+a+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return l=Ch(s,i[1].length),s<0?"-"+vr(t,e,-s):Ha(ej(s)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Mr(0,3-m.length):"")+m})+"."+Mr(l,i[1].length);switch(e){case"###,##0.00":return vr(t,"#,##0.00",s);case"###,###":case"##,###":case"#,###":var x=Ha(ni(o,0));return x!=="0"?d+x:"";case"###,###.00":return vr(t,"###,##0.00",s).replace(/^0\./,".");case"#,###.00":return vr(t,"#,##0.00",s).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function tj(t,e,s){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return ka(t,e.substr(0,r),s/Math.pow(10,3*(e.length-r)))}function sj(t,e,s){var r=e.replace(Pg,""),a=e.length-r.length;return ka(t,r,s*Math.pow(10,2*a))+Jt("%",a)}function Ug(t,e){var s,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ug(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),s=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),!s.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(l-s.length+i):s+="E+"+(l-i),s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,d,f){return o+d+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else s=e.toExponential(r);return t.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),t.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}function Xr(t,e,s){if(t.charCodeAt(0)===40&&!e.match(Lg)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?Xr("n",r,s):"("+Xr("n",r,-s)+")"}if(e.charCodeAt(e.length-1)===44)return tj(t,e,s);if(e.indexOf("%")!==-1)return sj(t,e,s);if(e.indexOf("E")!==-1)return Ug(e,s);if(e.charCodeAt(0)===36)return"$"+Xr(t,e.substr(e.charAt(1)==" "?2:1),s);var a,i,l,c,o=Math.abs(s),d=s<0?"-":"";if(e.match(/^00+$/))return d+Mr(o,e.length);if(e.match(/^[#?]+$/))return a=""+s,s===0&&(a=""),a.length>e.length?a:Xs(e.substr(0,e.length-a.length))+a;if(i=e.match(Rg))return ZN(i,o,d);if(e.match(/^#+0+$/))return d+Mr(o,e.length-e.indexOf("0"));if(i=e.match(Ig))return a=(""+s).replace(/^([^\.]+)$/,"$1."+Xs(i[1])).replace(/\.$/,"."+Xs(i[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+Jt("0",Xs(i[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+Ha(""+o);if(i=e.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+Xr(t,e,-s):Ha(""+s)+"."+Jt("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Xr(t,e.replace(/^#,#*,/,""),s);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_i(Xr(t,e.replace(/[\\-]/g,""),s)),l=0,_i(_i(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return l<a.length?a.charAt(l++):m==="0"?"0":""}));if(e.match(Bg))return a=Xr(t,"##########",s),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=So(o,Math.pow(10,l)-1,!1),a=""+d,f=ka("n",i[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=jo(c[2],l),f.length<i[4].length&&(f=Xs(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=So(o,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Lf(c[1],l)+i[2]+"/"+i[3]+jo(c[2],l):Jt(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+s,e.length<=a.length?a:Xs(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+s.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var u=e.indexOf(".")-l,h=e.length-a.length-u;return Xs(e.substr(0,u)+a+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return s<0?"-"+Xr(t,e,-s):Ha(""+s).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Mr(0,3-m.length):"")+m})+"."+Mr(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var x=Ha(""+o);return x!=="0"?d+x:"";default:if(e.match(/\.[0#?]*$/))return Xr(t,e.slice(0,e.lastIndexOf(".")),s)+Xs(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ka(t,e,s){return(s|0)===s?Xr(t,e,s):vr(t,e,s)}function rj(t){for(var e=[],s=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:s=!s;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),s===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var $g=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ii(t){for(var e=0,s="",r="";e<t.length;)switch(s=t.charAt(e)){case"G":ko(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=s;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match($g))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(s=t.charAt(++e))>-1||s=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===s;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function aj(t,e,s,r){for(var a=[],i="",l=0,c="",o="t",d,f,u,h="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!ko(t,l))throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(u=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(u);a[a.length]={t:"t",v:i},++l;break;case"\\":var x=t.charAt(++l),m=x==="("||x===")"?x:"t";a[a.length]={t:m,v:x},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=Nn(e,s,t.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},o=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Nn(e,s),d==null))return"";for(i=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&o.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),a[a.length]={t:c,v:i},o=c;break;case"A":case"a":case"":var p={t:c,v:c};if(d==null&&(d=Nn(e,s)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",h="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",l+=5,h="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(p.v=d.H>=12?"":""),p.t="T",l+=5,h="h"):(p.t="t",++l),d==null&&p.t==="T")return"";a[a.length]=p,o=c;break;case"[":for(i=c;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match($g)){if(d==null&&(d=Nn(e,s),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},o=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ii(t)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=c;++l<t.length&&(c=t.charAt(l))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++l)===c;)i+=c;a[a.length]={t:c,v:i},o=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"t",v:c},++l;break}var v=0,b=0,_;for(l=a.length-1,o="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=h,o="h",v<1&&(v=1);break;case"s":(_=a[l].v.match(/\.0+$/))&&(b=Math.max(b,_[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":o=a[l].t;break;case"m":o==="s"&&(a[l].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[l].v.match(/[Hh]/)&&(v=1),v<2&&a[l].v.match(/[Mm]/)&&(v=2),v<3&&a[l].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var g="",j;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=qN(a[l].t.charCodeAt(0),a[l].v,d,b),a[l].t="t";break;case"n":case"?":for(j=l+1;a[j]!=null&&((c=a[j].t)==="?"||c==="D"||(c===" "||c==="t")&&a[j+1]!=null&&(a[j+1].t==="?"||a[j+1].t==="t"&&a[j+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[j].v==="/"||a[j].v===" "&&a[j+1]!=null&&a[j+1].t=="?"));)a[l].v+=a[j].v,a[j]={v:"",t:";"},++j;g+=a[l].v,l=j-1;break;case"G":a[l].t="t",a[l].v=Rn(e,s);break}var w="",k,y;if(g.length>0){g.charCodeAt(0)==40?(k=e<0&&g.charCodeAt(0)===45?-e:e,y=ka("n",g,k)):(k=e<0&&r>1?-e:e,y=ka("n",g,k),k<0&&a[0]&&a[0].t=="t"&&(y=y.substr(1),a[0].v="-"+a[0].v)),j=y.length-1;var N=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){N=l;break}var S=a.length;if(N===a.length&&y.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(j>=a[l].v.length-1?(j-=a[l].v.length,a[l].v=y.substr(j+1,a[l].v.length)):j<0?a[l].v="":(a[l].v=y.substr(0,j+1),j=-1),a[l].t="t",S=l);j>=0&&S<a.length&&(a[S].v=y.substr(0,j+1)+a[S].v)}else if(N!==a.length&&y.indexOf("E")===-1){for(j=y.indexOf(".")-1,l=N;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(f=a[l].v.indexOf(".")>-1&&l===N?a[l].v.indexOf(".")-1:a[l].v.length-1,w=a[l].v.substr(f+1);f>=0;--f)j>=0&&(a[l].v.charAt(f)==="0"||a[l].v.charAt(f)==="#")&&(w=y.charAt(j--)+w);a[l].v=w,a[l].t="t",S=l}for(j>=0&&S<a.length&&(a[S].v=y.substr(0,j+1)+a[S].v),j=y.indexOf(".")+1,l=N;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==N)){for(f=a[l].v.indexOf(".")>-1&&l===N?a[l].v.indexOf(".")+1:0,w=a[l].v.substr(0,f);f<a[l].v.length;++f)j<y.length&&(w+=y.charAt(j++));a[l].v=w,a[l].t="t",S=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(k=r>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=ka(a[l].t,a[l].v,k),a[l].t="t");var T="";for(l=0;l!==a.length;++l)a[l]!=null&&(T+=a[l].v);return T}var Ah=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Fh(t,e){if(e==null)return!1;var s=parseFloat(e[2]);switch(e[1]){case"=":if(t==s)return!0;break;case">":if(t>s)return!0;break;case"<":if(t<s)return!0;break;case"<>":if(t!=s)return!0;break;case">=":if(t>=s)return!0;break;case"<=":if(t<=s)return!0;break}return!1}function nj(t,e){var s=rj(t),r=s.length,a=s[r-1].indexOf("@");if(r<4&&a>-1&&--r,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if(typeof e!="number")return[4,s.length===4||a>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=a>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=a>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=a>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"];break}var i=e>0?s[0]:e<0?s[1]:s[2];if(s[0].indexOf("[")===-1&&s[1].indexOf("[")===-1)return[r,i];if(s[0].match(/\[[=<>]/)!=null||s[1].match(/\[[=<>]/)!=null){var l=s[0].match(Ah),c=s[1].match(Ah);return Fh(e,l)?[r,s[0]]:Fh(e,c)?[r,s[1]]:[r,s[l!=null&&c!=null?2:1]]}return[r,i]}function Tr(t,e,s){s==null&&(s={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&s.dateNF?r=s.dateNF:r=t;break;case"number":t==14&&s.dateNF?r=s.dateNF:r=(s.table!=null?s.table:Ge)[t],r==null&&(r=s.table&&s.table[Eh[t]]||Ge[Eh[t]]),r==null&&(r=$N[t]||"General");break}if(ko(r,0))return Rn(e,s);e instanceof Date&&(e=Dg(e,s.date1904));var a=nj(r,e);if(ko(a[1]))return Rn(e,s);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return aj(a[1],e,s,a[0])}function Sa(t,e){if(typeof e!="number"){e=+e||-1;for(var s=0;s<392;++s){if(Ge[s]==null){e<0&&(e=s);continue}if(Ge[s]==t){e=s;break}}e<0&&(e=391)}return Ge[e]=t,e}function md(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Sa(t[e],e)}function Li(){Ge=UN()}var ij={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Wg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function lj(t){var e=typeof t=="number"?Ge[t]:t;return e=e.replace(Wg,"(\\d+)"),new RegExp("^"+e+"$")}function cj(t,e,s){var r=-1,a=-1,i=-1,l=-1,c=-1,o=-1;(e.match(Wg)||[]).forEach(function(u,h){var x=parseInt(s[h+1],10);switch(u.toLowerCase().charAt(0)){case"y":r=x;break;case"d":i=x;break;case"h":l=x;break;case"s":o=x;break;case"m":l>=0?c=x:a=x;break}}),o>=0&&c==-1&&a>=0&&(c=a,a=-1);var d=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var f=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return l==-1&&c==-1&&o==-1?d:r==-1&&a==-1&&i==-1?f:d+"T"+f}var oj=function(){var t={};t.version="1.2.0";function e(){for(var y=0,N=new Array(256),S=0;S!=256;++S)y=S,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,N[S]=y;return typeof Int32Array<"u"?new Int32Array(N):N}var s=e();function r(y){var N=0,S=0,T=0,E=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)E[T]=y[T];for(T=0;T!=256;++T)for(S=y[T],N=256+T;N<4096;N+=256)S=E[N]=S>>>8^y[S&255];var A=[];for(T=1;T!=16;++T)A[T-1]=typeof Int32Array<"u"?E.subarray(T*256,T*256+256):E.slice(T*256,T*256+256);return A}var a=r(s),i=a[0],l=a[1],c=a[2],o=a[3],d=a[4],f=a[5],u=a[6],h=a[7],x=a[8],m=a[9],p=a[10],v=a[11],b=a[12],_=a[13],g=a[14];function j(y,N){for(var S=N^-1,T=0,E=y.length;T<E;)S=S>>>8^s[(S^y.charCodeAt(T++))&255];return~S}function w(y,N){for(var S=N^-1,T=y.length-15,E=0;E<T;)S=g[y[E++]^S&255]^_[y[E++]^S>>8&255]^b[y[E++]^S>>16&255]^v[y[E++]^S>>>24]^p[y[E++]]^m[y[E++]]^x[y[E++]]^h[y[E++]]^u[y[E++]]^f[y[E++]]^d[y[E++]]^o[y[E++]]^c[y[E++]]^l[y[E++]]^i[y[E++]]^s[y[E++]];for(T+=15;E<T;)S=S>>>8^s[(S^y[E++])&255];return~S}function k(y,N){for(var S=N^-1,T=0,E=y.length,A=0,H=0;T<E;)A=y.charCodeAt(T++),A<128?S=S>>>8^s[(S^A)&255]:A<2048?(S=S>>>8^s[(S^(192|A>>6&31))&255],S=S>>>8^s[(S^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,H=y.charCodeAt(T++)&1023,S=S>>>8^s[(S^(240|A>>8&7))&255],S=S>>>8^s[(S^(128|A>>2&63))&255],S=S>>>8^s[(S^(128|H>>6&15|(A&3)<<4))&255],S=S>>>8^s[(S^(128|H&63))&255]):(S=S>>>8^s[(S^(224|A>>12&15))&255],S=S>>>8^s[(S^(128|A>>6&63))&255],S=S>>>8^s[(S^(128|A&63))&255]);return~S}return t.table=s,t.bstr=j,t.buf=w,t.str=k,t}(),We=function(){var e={};e.version="1.2.1";function s(C,R){for(var O=C.split("/"),D=R.split("/"),I=0,U=0,se=Math.min(O.length,D.length);I<se;++I){if(U=O[I].length-D[I].length)return U;if(O[I]!=D[I])return O[I]<D[I]?-1:1}return O.length-D.length}function r(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:r(C.slice(0,-1));var R=C.lastIndexOf("/");return R===-1?C:C.slice(0,R+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var R=C.lastIndexOf("/");return R===-1?C:C.slice(R+1)}function i(C,R){typeof R=="string"&&(R=new Date(R));var O=R.getHours();O=O<<6|R.getMinutes(),O=O<<5|R.getSeconds()>>>1,C.write_shift(2,O);var D=R.getFullYear()-1980;D=D<<4|R.getMonth()+1,D=D<<5|R.getDate(),C.write_shift(2,D)}function l(C){var R=C.read_shift(2)&65535,O=C.read_shift(2)&65535,D=new Date,I=O&31;O>>>=5;var U=O&15;O>>>=4,D.setMilliseconds(0),D.setFullYear(O+1980),D.setMonth(U-1),D.setDate(I);var se=R&31;R>>>=5;var ce=R&63;return R>>>=6,D.setHours(R),D.setMinutes(ce),D.setSeconds(se<<1),D}function c(C){Es(C,0);for(var R={},O=0;C.l<=C.length-4;){var D=C.read_shift(2),I=C.read_shift(2),U=C.l+I,se={};switch(D){case 21589:O=C.read_shift(1),O&1&&(se.mtime=C.read_shift(4)),I>5&&(O&2&&(se.atime=C.read_shift(4)),O&4&&(se.ctime=C.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}C.l=U,R[D]=se}return R}var o;function d(){return o||(o={})}function f(C,R){if(C[0]==80&&C[1]==75)return ot(C,R);if((C[0]|32)==109&&(C[1]|32)==105)return Tt(C,R);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var O=3,D=512,I=0,U=0,se=0,ce=0,te=0,re=[],ne=C.slice(0,512);Es(ne,0);var be=u(ne);switch(O=be[0],O){case 3:D=512;break;case 4:D=4096;break;case 0:if(be[1]==0)return ot(C,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}D!==512&&(ne=C.slice(0,D),Es(ne,28));var Ce=C.slice(0,D);h(ne,O);var Be=ne.read_shift(4,"i");if(O===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);ne.l+=4,se=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),ce=ne.read_shift(4,"i"),I=ne.read_shift(4,"i"),te=ne.read_shift(4,"i"),U=ne.read_shift(4,"i");for(var Ne=-1,Pe=0;Pe<109&&(Ne=ne.read_shift(4,"i"),!(Ne<0));++Pe)re[Pe]=Ne;var Qe=x(C,D);v(te,U,Qe,D,re);var Gt=_(Qe,se,re,D);Gt[se].name="!Directory",I>0&&ce!==H&&(Gt[ce].name="!MiniFAT"),Gt[re[0]].name="!FAT",Gt.fat_addrs=re,Gt.ssz=D;var Xt={},As=[],$i=[],Wi=[];g(se,Gt,Qe,As,I,Xt,$i,ce),m($i,Wi,As),As.shift();var Vi={FileIndex:$i,FullPaths:Wi};return R&&R.raw&&(Vi.raw={header:Ce,sectors:Qe}),Vi}function u(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(V,"Header Signature: "),C.l+=16;var R=C.read_shift(2,"u");return[C.read_shift(2,"u"),R]}function h(C,R){var O=9;switch(C.l+=2,O=C.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function x(C,R){for(var O=Math.ceil(C.length/R)-1,D=[],I=1;I<O;++I)D[I-1]=C.slice(I*R,(I+1)*R);return D[O-1]=C.slice(O*R),D}function m(C,R,O){for(var D=0,I=0,U=0,se=0,ce=0,te=O.length,re=[],ne=[];D<te;++D)re[D]=ne[D]=D,R[D]=O[D];for(;ce<ne.length;++ce)D=ne[ce],I=C[D].L,U=C[D].R,se=C[D].C,re[D]===D&&(I!==-1&&re[I]!==I&&(re[D]=re[I]),U!==-1&&re[U]!==U&&(re[D]=re[U])),se!==-1&&(re[se]=D),I!==-1&&D!=re[D]&&(re[I]=re[D],ne.lastIndexOf(I)<ce&&ne.push(I)),U!==-1&&D!=re[D]&&(re[U]=re[D],ne.lastIndexOf(U)<ce&&ne.push(U));for(D=1;D<te;++D)re[D]===D&&(U!==-1&&re[U]!==U?re[D]=re[U]:I!==-1&&re[I]!==I&&(re[D]=re[I]));for(D=1;D<te;++D)if(C[D].type!==0){if(ce=D,ce!=re[ce])do ce=re[ce],R[D]=R[ce]+"/"+R[D];while(ce!==0&&re[ce]!==-1&&ce!=re[ce]);re[D]=-1}for(R[0]+="/",D=1;D<te;++D)C[D].type!==2&&(R[D]+="/")}function p(C,R,O){for(var D=C.start,I=C.size,U=[],se=D;O&&I>0&&se>=0;)U.push(R.slice(se*A,se*A+A)),I-=A,se=yn(O,se*4);return U.length===0?le(0):Ns(U).slice(0,C.size)}function v(C,R,O,D,I){var U=H;if(C===H){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var se=O[C],ce=(D>>>2)-1;if(!se)return;for(var te=0;te<ce&&(U=yn(se,te*4))!==H;++te)I.push(U);v(yn(se,D-4),R-1,O,D,I)}}function b(C,R,O,D,I){var U=[],se=[];I||(I=[]);var ce=D-1,te=0,re=0;for(te=R;te>=0;){I[te]=!0,U[U.length]=te,se.push(C[te]);var ne=O[Math.floor(te*4/D)];if(re=te*4&ce,D<4+re)throw new Error("FAT boundary crossed: "+te+" 4 "+D);if(!C[ne])break;te=yn(C[ne],re)}return{nodes:U,data:Vh([se])}}function _(C,R,O,D){var I=C.length,U=[],se=[],ce=[],te=[],re=D-1,ne=0,be=0,Ce=0,Be=0;for(ne=0;ne<I;++ne)if(ce=[],Ce=ne+R,Ce>=I&&(Ce-=I),!se[Ce]){te=[];var Ne=[];for(be=Ce;be>=0;){Ne[be]=!0,se[be]=!0,ce[ce.length]=be,te.push(C[be]);var Pe=O[Math.floor(be*4/D)];if(Be=be*4&re,D<4+Be)throw new Error("FAT boundary crossed: "+be+" 4 "+D);if(!C[Pe]||(be=yn(C[Pe],Be),Ne[be]))break}U[Ce]={nodes:ce,data:Vh([te])}}return U}function g(C,R,O,D,I,U,se,ce){for(var te=0,re=D.length?2:0,ne=R[C].data,be=0,Ce=0,Be;be<ne.length;be+=128){var Ne=ne.slice(be,be+128);Es(Ne,64),Ce=Ne.read_shift(2),Be=Gf(Ne,0,Ce-re),D.push(Be);var Pe={name:Be,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0},Qe=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Qe!==0&&(Pe.ct=j(Ne,Ne.l-8));var Gt=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Gt!==0&&(Pe.mt=j(Ne,Ne.l-8)),Pe.start=Ne.read_shift(4,"i"),Pe.size=Ne.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=H,Pe.name=""),Pe.type===5?(te=Pe.start,I>0&&te!==H&&(R[te].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",R[Pe.start]===void 0&&(R[Pe.start]=b(O,Pe.start,R.fat_addrs,R.ssz)),R[Pe.start].name=Pe.name,Pe.content=R[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:te!==H&&Pe.start!==H&&R[te]&&(Pe.content=p(Pe,R[te].data,(R[ce]||{}).data))),Pe.content&&Es(Pe.content,0),U[Be]=Pe,se.push(Pe)}}function j(C,R){return new Date((fr(C,R+4)/1e7*Math.pow(2,32)+fr(C,R)/1e7-11644473600)*1e3)}function w(C,R){return d(),f(o.readFileSync(C),R)}function k(C,R){var O=R&&R.type;switch(O||it&&Buffer.isBuffer(C)&&(O="buffer"),O||"base64"){case"file":return w(C,R);case"base64":return f(ur(xr(C)),R);case"binary":return f(ur(C),R)}return f(C,R)}function y(C,R){var O=R||{},D=O.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=D+"/",C.FileIndex[0]={name:D,type:5}),O.CLSID&&(C.FileIndex[0].clsid=O.CLSID),N(C)}function N(C){var R="Sh33tJ5";if(!We.find(C,"/"+R)){var O=le(4);O[0]=55,O[1]=O[3]=50,O[2]=54,C.FileIndex.push({name:R,type:2,content:O,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+R),S(C)}}function S(C,R){y(C);for(var O=!1,D=!1,I=C.FullPaths.length-1;I>=0;--I){var U=C.FileIndex[I];switch(U.type){case 0:D?O=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(U.R*U.L*U.C)&&(O=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!R)){var se=new Date(1987,1,19),ce=0,te=Object.create?Object.create(null):{},re=[];for(I=0;I<C.FullPaths.length;++I)te[C.FullPaths[I]]=!0,C.FileIndex[I].type!==0&&re.push([C.FullPaths[I],C.FileIndex[I]]);for(I=0;I<re.length;++I){var ne=r(re[I][0]);D=te[ne],D||(re.push([ne,{name:a(ne).replace("/",""),type:1,clsid:P,ct:se,mt:se,content:null}]),te[ne]=!0)}for(re.sort(function(Be,Ne){return s(Be[0],Ne[0])}),C.FullPaths=[],C.FileIndex=[],I=0;I<re.length;++I)C.FullPaths[I]=re[I][0],C.FileIndex[I]=re[I][1];for(I=0;I<re.length;++I){var be=C.FileIndex[I],Ce=C.FullPaths[I];if(be.name=a(Ce).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||P,I===0)be.C=re.length>1?1:-1,be.size=0,be.type=5;else if(Ce.slice(-1)=="/"){for(ce=I+1;ce<re.length&&r(C.FullPaths[ce])!=Ce;++ce);for(be.C=ce>=re.length?-1:ce,ce=I+1;ce<re.length&&r(C.FullPaths[ce])!=r(Ce);++ce);be.R=ce>=re.length?-1:ce,be.type=1}else r(C.FullPaths[I+1]||"")==r(Ce)&&(be.R=I+1),be.type=2}}}function T(C,R){var O=R||{};if(O.fileType=="mad")return zs(C,O);switch(S(C),O.fileType){case"zip":return ys(C,O)}var D=function(Be){for(var Ne=0,Pe=0,Qe=0;Qe<Be.FileIndex.length;++Qe){var Gt=Be.FileIndex[Qe];if(Gt.content){var Xt=Gt.content.length;Xt>0&&(Xt<4096?Ne+=Xt+63>>6:Pe+=Xt+511>>9)}}for(var As=Be.FullPaths.length+3>>2,$i=Ne+7>>3,Wi=Ne+127>>7,Vi=$i+Pe+As+Wi,fn=Vi+127>>7,Cd=fn<=109?0:Math.ceil((fn-109)/127);Vi+fn+Cd+127>>7>fn;)Cd=++fn<=109?0:Math.ceil((fn-109)/127);var ha=[1,Cd,fn,Wi,As,Pe,Ne,0];return Be.FileIndex[0].size=Ne<<6,ha[7]=(Be.FileIndex[0].start=ha[0]+ha[1]+ha[2]+ha[3]+ha[4]+ha[5])+(ha[6]+7>>3),ha}(C),I=le(D[7]<<9),U=0,se=0;{for(U=0;U<8;++U)I.write_shift(1,L[U]);for(U=0;U<8;++U)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),U=0;U<3;++U)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,D[2]),I.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:H),I.write_shift(4,D[3]),I.write_shift(-4,D[1]?D[0]-1:H),I.write_shift(4,D[1]),U=0;U<109;++U)I.write_shift(-4,U<D[2]?D[1]+U:-1)}if(D[1])for(se=0;se<D[1];++se){for(;U<236+se*127;++U)I.write_shift(-4,U<D[2]?D[1]+U:-1);I.write_shift(-4,se===D[1]-1?H:se+1)}var ce=function(Be){for(se+=Be;U<se-1;++U)I.write_shift(-4,U+1);Be&&(++U,I.write_shift(-4,H))};for(se=U=0,se+=D[1];U<se;++U)I.write_shift(-4,J.DIFSECT);for(se+=D[2];U<se;++U)I.write_shift(-4,J.FATSECT);ce(D[3]),ce(D[4]);for(var te=0,re=0,ne=C.FileIndex[0];te<C.FileIndex.length;++te)ne=C.FileIndex[te],ne.content&&(re=ne.content.length,!(re<4096)&&(ne.start=se,ce(re+511>>9)));for(ce(D[6]+7>>3);I.l&511;)I.write_shift(-4,J.ENDOFCHAIN);for(se=U=0,te=0;te<C.FileIndex.length;++te)ne=C.FileIndex[te],ne.content&&(re=ne.content.length,!(!re||re>=4096)&&(ne.start=se,ce(re+63>>6)));for(;I.l&511;)I.write_shift(-4,J.ENDOFCHAIN);for(U=0;U<D[4]<<2;++U){var be=C.FullPaths[U];if(!be||be.length===0){for(te=0;te<17;++te)I.write_shift(4,0);for(te=0;te<3;++te)I.write_shift(4,-1);for(te=0;te<12;++te)I.write_shift(4,0);continue}ne=C.FileIndex[U],U===0&&(ne.start=ne.size?ne.start-1:H);var Ce=U===0&&O.root||ne.name;if(re=2*(Ce.length+1),I.write_shift(64,Ce,"utf16le"),I.write_shift(2,re),I.write_shift(1,ne.type),I.write_shift(1,ne.color),I.write_shift(-4,ne.L),I.write_shift(-4,ne.R),I.write_shift(-4,ne.C),ne.clsid)I.write_shift(16,ne.clsid,"hex");else for(te=0;te<4;++te)I.write_shift(4,0);I.write_shift(4,ne.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,ne.start),I.write_shift(4,ne.size),I.write_shift(4,0)}for(U=1;U<C.FileIndex.length;++U)if(ne=C.FileIndex[U],ne.size>=4096)if(I.l=ne.start+1<<9,it&&Buffer.isBuffer(ne.content))ne.content.copy(I,I.l,0,ne.size),I.l+=ne.size+511&-512;else{for(te=0;te<ne.size;++te)I.write_shift(1,ne.content[te]);for(;te&511;++te)I.write_shift(1,0)}for(U=1;U<C.FileIndex.length;++U)if(ne=C.FileIndex[U],ne.size>0&&ne.size<4096)if(it&&Buffer.isBuffer(ne.content))ne.content.copy(I,I.l,0,ne.size),I.l+=ne.size+63&-64;else{for(te=0;te<ne.size;++te)I.write_shift(1,ne.content[te]);for(;te&63;++te)I.write_shift(1,0)}if(it)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function E(C,R){var O=C.FullPaths.map(function(te){return te.toUpperCase()}),D=O.map(function(te){var re=te.split("/");return re[re.length-(te.slice(-1)=="/"?2:1)]}),I=!1;R.charCodeAt(0)===47?(I=!0,R=O[0].slice(0,-1)+R):I=R.indexOf("/")!==-1;var U=R.toUpperCase(),se=I===!0?O.indexOf(U):D.indexOf(U);if(se!==-1)return C.FileIndex[se];var ce=!U.match(sl);for(U=U.replace(Js,""),ce&&(U=U.replace(sl,"!")),se=0;se<O.length;++se)if((ce?O[se].replace(sl,"!"):O[se]).replace(Js,"")==U||(ce?D[se].replace(sl,"!"):D[se]).replace(Js,"")==U)return C.FileIndex[se];return null}var A=64,H=-2,V="d0cf11e0a1b11ae1",L=[208,207,17,224,161,177,26,225],P="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:V,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:P,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ee(C,R,O){d();var D=T(C,O);o.writeFileSync(R,D)}function Y(C){for(var R=new Array(C.length),O=0;O<C.length;++O)R[O]=String.fromCharCode(C[O]);return R.join("")}function de(C,R){var O=T(C,R);switch(R&&R.type||"buffer"){case"file":return d(),o.writeFileSync(R.filename,O),O;case"binary":return typeof O=="string"?O:Y(O);case"base64":return Sl(typeof O=="string"?O:Y(O));case"buffer":if(it)return Buffer.isBuffer(O)?O:Da(O);case"array":return typeof O=="string"?ur(O):O}return O}var De;function B(C){try{var R=C.InflateRaw,O=new R;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)De=C;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function X(C,R){if(!De)return Ve(C,R);var O=De.InflateRaw,D=new O,I=D._processChunk(C.slice(C.l),D._finishFlushFlag);return C.l+=D.bytesRead,I}function W(C){return De?De.deflateRawSync(C):Ke(C)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(C){var R=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(R>>16|R>>8|R)&255}for(var ue=typeof Uint8Array<"u",oe=ue?new Uint8Array(256):[],ze=0;ze<256;++ze)oe[ze]=xe(ze);function F(C,R){var O=oe[C&255];return R<=8?O>>>8-R:(O=O<<8|oe[C>>8&255],R<=16?O>>>16-R:(O=O<<8|oe[C>>16&255],O>>>24-R))}function ye(C,R){var O=R&7,D=R>>>3;return(C[D]|(O<=6?0:C[D+1]<<8))>>>O&3}function Ie(C,R){var O=R&7,D=R>>>3;return(C[D]|(O<=5?0:C[D+1]<<8))>>>O&7}function Le(C,R){var O=R&7,D=R>>>3;return(C[D]|(O<=4?0:C[D+1]<<8))>>>O&15}function K(C,R){var O=R&7,D=R>>>3;return(C[D]|(O<=3?0:C[D+1]<<8))>>>O&31}function Z(C,R){var O=R&7,D=R>>>3;return(C[D]|(O<=1?0:C[D+1]<<8))>>>O&127}function Oe(C,R,O){var D=R&7,I=R>>>3,U=(1<<O)-1,se=C[I]>>>D;return O<8-D||(se|=C[I+1]<<8-D,O<16-D)||(se|=C[I+2]<<16-D,O<24-D)||(se|=C[I+3]<<24-D),se&U}function Te(C,R,O){var D=R&7,I=R>>>3;return D<=5?C[I]|=(O&7)<<D:(C[I]|=O<<D&255,C[I+1]=(O&7)>>8-D),R+3}function M(C,R,O){var D=R&7,I=R>>>3;return O=(O&1)<<D,C[I]|=O,R+1}function q(C,R,O){var D=R&7,I=R>>>3;return O<<=D,C[I]|=O&255,O>>>=8,C[I+1]=O,R+8}function Q(C,R,O){var D=R&7,I=R>>>3;return O<<=D,C[I]|=O&255,O>>>=8,C[I+1]=O&255,C[I+2]=O>>>8,R+16}function _e(C,R){var O=C.length,D=2*O>R?2*O:R+5,I=0;if(O>=R)return C;if(it){var U=jh(D);if(C.copy)C.copy(U);else for(;I<C.length;++I)U[I]=C[I];return U}else if(ue){var se=new Uint8Array(D);if(se.set)se.set(C);else for(;I<O;++I)se[I]=C[I];return se}return C.length=D,C}function ve(C){for(var R=new Array(C),O=0;O<C;++O)R[O]=0;return R}function fe(C,R,O){var D=1,I=0,U=0,se=0,ce=0,te=C.length,re=ue?new Uint16Array(32):ve(32);for(U=0;U<32;++U)re[U]=0;for(U=te;U<O;++U)C[U]=0;te=C.length;var ne=ue?new Uint16Array(te):ve(te);for(U=0;U<te;++U)re[I=C[U]]++,D<I&&(D=I),ne[U]=0;for(re[0]=0,U=1;U<=D;++U)re[U+16]=ce=ce+re[U-1]<<1;for(U=0;U<te;++U)ce=C[U],ce!=0&&(ne[U]=re[ce+16]++);var be=0;for(U=0;U<te;++U)if(be=C[U],be!=0)for(ce=F(ne[U],D)>>D-be,se=(1<<D+4-be)-1;se>=0;--se)R[ce|se<<be]=be&15|U<<4;return D}var Fe=ue?new Uint16Array(512):ve(512),rt=ue?new Uint16Array(32):ve(32);if(!ue){for(var Ze=0;Ze<512;++Ze)Fe[Ze]=0;for(Ze=0;Ze<32;++Ze)rt[Ze]=0}(function(){for(var C=[],R=0;R<32;R++)C.push(5);fe(C,rt,32);var O=[];for(R=0;R<=143;R++)O.push(8);for(;R<=255;R++)O.push(9);for(;R<=279;R++)O.push(7);for(;R<=287;R++)O.push(8);fe(O,Fe,288)})();var St=function(){for(var R=ue?new Uint8Array(32768):[],O=0,D=0;O<me.length-1;++O)for(;D<me[O+1];++D)R[D]=O;for(;D<32768;++D)R[D]=29;var I=ue?new Uint8Array(259):[];for(O=0,D=0;O<ae.length-1;++O)for(;D<ae[O+1];++D)I[D]=O;function U(ce,te){for(var re=0;re<ce.length;){var ne=Math.min(65535,ce.length-re),be=re+ne==ce.length;for(te.write_shift(1,+be),te.write_shift(2,ne),te.write_shift(2,~ne&65535);ne-- >0;)te[te.l++]=ce[re++]}return te.l}function se(ce,te){for(var re=0,ne=0,be=ue?new Uint16Array(32768):[];ne<ce.length;){var Ce=Math.min(65535,ce.length-ne);if(Ce<10){for(re=Te(te,re,+(ne+Ce==ce.length)),re&7&&(re+=8-(re&7)),te.l=re/8|0,te.write_shift(2,Ce),te.write_shift(2,~Ce&65535);Ce-- >0;)te[te.l++]=ce[ne++];re=te.l*8;continue}re=Te(te,re,+(ne+Ce==ce.length)+2);for(var Be=0;Ce-- >0;){var Ne=ce[ne];Be=(Be<<5^Ne)&32767;var Pe=-1,Qe=0;if((Pe=be[Be])&&(Pe|=ne&-32768,Pe>ne&&(Pe-=32768),Pe<ne))for(;ce[Pe+Qe]==ce[ne+Qe]&&Qe<250;)++Qe;if(Qe>2){Ne=I[Qe],Ne<=22?re=q(te,re,oe[Ne+1]>>1)-1:(q(te,re,3),re+=5,q(te,re,oe[Ne-23]>>5),re+=3);var Gt=Ne<8?0:Ne-4>>2;Gt>0&&(Q(te,re,Qe-ae[Ne]),re+=Gt),Ne=R[ne-Pe],re=q(te,re,oe[Ne]>>3),re-=3;var Xt=Ne<4?0:Ne-2>>1;Xt>0&&(Q(te,re,ne-Pe-me[Ne]),re+=Xt);for(var As=0;As<Qe;++As)be[Be]=ne&32767,Be=(Be<<5^ce[ne])&32767,++ne;Ce-=Qe-1}else Ne<=143?Ne=Ne+48:re=M(te,re,1),re=q(te,re,oe[Ne]),be[Be]=ne&32767,++ne}re=q(te,re,0)-1}return te.l=(re+7)/8|0,te.l}return function(te,re){return te.length<8?U(te,re):se(te,re)}}();function Ke(C){var R=le(50+Math.floor(C.length*1.1)),O=St(C,R);return R.slice(0,O)}var ct=ue?new Uint16Array(32768):ve(32768),cs=ue?new Uint16Array(32768):ve(32768),yt=ue?new Uint16Array(128):ve(128),ee=1,je=1;function Ae(C,R){var O=K(C,R)+257;R+=5;var D=K(C,R)+1;R+=5;var I=Le(C,R)+4;R+=4;for(var U=0,se=ue?new Uint8Array(19):ve(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,re=ue?new Uint8Array(8):ve(8),ne=ue?new Uint8Array(8):ve(8),be=se.length,Ce=0;Ce<I;++Ce)se[z[Ce]]=U=Ie(C,R),te<U&&(te=U),re[U]++,R+=3;var Be=0;for(re[0]=0,Ce=1;Ce<=te;++Ce)ne[Ce]=Be=Be+re[Ce-1]<<1;for(Ce=0;Ce<be;++Ce)(Be=se[Ce])!=0&&(ce[Ce]=ne[Be]++);var Ne=0;for(Ce=0;Ce<be;++Ce)if(Ne=se[Ce],Ne!=0){Be=oe[ce[Ce]]>>8-Ne;for(var Pe=(1<<7-Ne)-1;Pe>=0;--Pe)yt[Be|Pe<<Ne]=Ne&7|Ce<<3}var Qe=[];for(te=1;Qe.length<O+D;)switch(Be=yt[Z(C,R)],R+=Be&7,Be>>>=3){case 16:for(U=3+ye(C,R),R+=2,Be=Qe[Qe.length-1];U-- >0;)Qe.push(Be);break;case 17:for(U=3+Ie(C,R),R+=3;U-- >0;)Qe.push(0);break;case 18:for(U=11+Z(C,R),R+=7;U-- >0;)Qe.push(0);break;default:Qe.push(Be),te<Be&&(te=Be);break}var Gt=Qe.slice(0,O),Xt=Qe.slice(O);for(Ce=O;Ce<286;++Ce)Gt[Ce]=0;for(Ce=D;Ce<30;++Ce)Xt[Ce]=0;return ee=fe(Gt,ct,286),je=fe(Xt,cs,30),R}function $e(C,R){if(C[0]==3&&!(C[1]&3))return[en(R),2];for(var O=0,D=0,I=jh(R||1<<18),U=0,se=I.length>>>0,ce=0,te=0;!(D&1);){if(D=Ie(C,O),O+=3,D>>>1)D>>1==1?(ce=9,te=5):(O=Ae(C,O),ce=ee,te=je);else{O&7&&(O+=8-(O&7));var re=C[O>>>3]|C[(O>>>3)+1]<<8;if(O+=32,re>0)for(!R&&se<U+re&&(I=_e(I,U+re),se=I.length);re-- >0;)I[U++]=C[O>>>3],O+=8;continue}for(;;){!R&&se<U+32767&&(I=_e(I,U+32767),se=I.length);var ne=Oe(C,O,ce),be=D>>>1==1?Fe[ne]:ct[ne];if(O+=be&15,be>>>=4,!(be>>>8&255))I[U++]=be;else{if(be==256)break;be-=257;var Ce=be<8?0:be-4>>2;Ce>5&&(Ce=0);var Be=U+ae[be];Ce>0&&(Be+=Oe(C,O,Ce),O+=Ce),ne=Oe(C,O,te),be=D>>>1==1?rt[ne]:cs[ne],O+=be&15,be>>>=4;var Ne=be<4?0:be-2>>1,Pe=me[be];for(Ne>0&&(Pe+=Oe(C,O,Ne),O+=Ne),!R&&se<Be&&(I=_e(I,Be+100),se=I.length);U<Be;)I[U]=I[U-Pe],++U}}}return R?[I,O+7>>>3]:[I.slice(0,U),O+7>>>3]}function Ve(C,R){var O=C.slice(C.l||0),D=$e(O,R);return C.l+=D[1],D[0]}function Xe(C,R){if(C)typeof console<"u"&&console.error(R);else throw new Error(R)}function ot(C,R){var O=C;Es(O,0);var D=[],I=[],U={FileIndex:D,FullPaths:I};y(U,{root:R.root});for(var se=O.length-4;(O[se]!=80||O[se+1]!=75||O[se+2]!=5||O[se+3]!=6)&&se>=0;)--se;O.l=se+4,O.l+=4;var ce=O.read_shift(2);O.l+=6;var te=O.read_shift(4);for(O.l=te,se=0;se<ce;++se){O.l+=20;var re=O.read_shift(4),ne=O.read_shift(4),be=O.read_shift(2),Ce=O.read_shift(2),Be=O.read_shift(2);O.l+=8;var Ne=O.read_shift(4),Pe=c(O.slice(O.l+be,O.l+be+Ce));O.l+=be+Ce+Be;var Qe=O.l;O.l=Ne+4,qe(O,re,ne,U,Pe),O.l=Qe}return U}function qe(C,R,O,D,I){C.l+=2;var U=C.read_shift(2),se=C.read_shift(2),ce=l(C);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var te=C.read_shift(4),re=C.read_shift(4),ne=C.read_shift(4),be=C.read_shift(2),Ce=C.read_shift(2),Be="",Ne=0;Ne<be;++Ne)Be+=String.fromCharCode(C[C.l++]);if(Ce){var Pe=c(C.slice(C.l,C.l+Ce));(Pe[21589]||{}).mt&&(ce=Pe[21589].mt),((I||{})[21589]||{}).mt&&(ce=I[21589].mt)}C.l+=Ce;var Qe=C.slice(C.l,C.l+re);switch(se){case 8:Qe=X(C,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var Gt=!1;U&8&&(te=C.read_shift(4),te==134695760&&(te=C.read_shift(4),Gt=!0),re=C.read_shift(4),ne=C.read_shift(4)),re!=R&&Xe(Gt,"Bad compressed size: "+R+" != "+re),ne!=O&&Xe(Gt,"Bad uncompressed size: "+O+" != "+ne),Ra(D,Be,Qe,{unsafe:!0,mt:ce})}function ys(C,R){var O=R||{},D=[],I=[],U=le(1),se=O.compression?8:0,ce=0,te=0,re=0,ne=0,be=0,Ce=C.FullPaths[0],Be=Ce,Ne=C.FileIndex[0],Pe=[],Qe=0;for(te=1;te<C.FullPaths.length;++te)if(Be=C.FullPaths[te].slice(Ce.length),Ne=C.FileIndex[te],!(!Ne.size||!Ne.content||Be=="Sh33tJ5")){var Gt=ne,Xt=le(Be.length);for(re=0;re<Be.length;++re)Xt.write_shift(1,Be.charCodeAt(re)&127);Xt=Xt.slice(0,Xt.l),Pe[be]=oj.buf(Ne.content,0);var As=Ne.content;se==8&&(As=W(As)),U=le(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,ce),U.write_shift(2,se),Ne.mt?i(U,Ne.mt):U.write_shift(4,0),U.write_shift(-4,Pe[be]),U.write_shift(4,As.length),U.write_shift(4,Ne.content.length),U.write_shift(2,Xt.length),U.write_shift(2,0),ne+=U.length,D.push(U),ne+=Xt.length,D.push(Xt),ne+=As.length,D.push(As),U=le(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,ce),U.write_shift(2,se),U.write_shift(4,0),U.write_shift(-4,Pe[be]),U.write_shift(4,As.length),U.write_shift(4,Ne.content.length),U.write_shift(2,Xt.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,Gt),Qe+=U.l,I.push(U),Qe+=Xt.length,I.push(Xt),++be}return U=le(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,be),U.write_shift(2,be),U.write_shift(4,Qe),U.write_shift(4,ne),U.write_shift(2,0),Ns([Ns(D),Ns(I),U])}var Ut={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function os(C,R){if(C.ctype)return C.ctype;var O=C.name||"",D=O.match(/\.([^\.]+)$/);return D&&Ut[D[1]]||R&&(D=(O=R).match(/[\.\\]([^\.\\])+$/),D&&Ut[D[1]])?Ut[D[1]]:"application/octet-stream"}function ds(C){for(var R=Sl(C),O=[],D=0;D<R.length;D+=76)O.push(R.slice(D,D+76));return O.join(`\r
`)+`\r
`}function bs(C){var R=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ne=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],D=R.split(`\r
`),I=0;I<D.length;++I){var U=D[I];if(U.length==0){O.push("");continue}for(var se=0;se<U.length;){var ce=76,te=U.slice(se,se+ce);te.charAt(ce-1)=="="?ce--:te.charAt(ce-2)=="="?ce-=2:te.charAt(ce-3)=="="&&(ce-=3),te=U.slice(se,se+ce),se+=ce,se<U.length&&(te+="="),O.push(te)}}return O.join(`\r
`)}function pe(C){for(var R=[],O=0;O<C.length;++O){for(var D=C[O];O<=C.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+C[++O];R.push(D)}for(var I=0;I<R.length;++I)R[I]=R[I].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return ur(R.join(`\r
`))}function dt(C,R,O){for(var D="",I="",U="",se,ce=0;ce<10;++ce){var te=R[ce];if(!te||te.match(/^\s*$/))break;var re=te.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":D=re[2].trim();break;case"content-type":U=re[2].trim();break;case"content-transfer-encoding":I=re[2].trim();break}}switch(++ce,I.toLowerCase()){case"base64":se=ur(xr(R.slice(ce).join("")));break;case"quoted-printable":se=pe(R.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var ne=Ra(C,D.slice(O.length),se,{unsafe:!0});U&&(ne.ctype=U)}function Tt(C,R){if(Y(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=R&&R.root||"",D=(it&&Buffer.isBuffer(C)?C.toString("binary"):Y(C)).split(`\r
`),I=0,U="";for(I=0;I<D.length;++I)if(U=D[I],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),O||(O=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),U.slice(0,O.length)!=O););var se=(D[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ce="--"+(se[1]||""),te=[],re=[],ne={FileIndex:te,FullPaths:re};y(ne);var be,Ce=0;for(I=0;I<D.length;++I){var Be=D[I];Be!==ce&&Be!==ce+"--"||(Ce++&&dt(ne,D.slice(be,I),O),be=I)}return ne}function zs(C,R){var O=R||{},D=O.boundary||"SheetJS";D="------="+D;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],U=C.FullPaths[0],se=U,ce=C.FileIndex[0],te=1;te<C.FullPaths.length;++te)if(se=C.FullPaths[te].slice(U.length),ce=C.FileIndex[te],!(!ce.size||!ce.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var re=ce.content,ne=it&&Buffer.isBuffer(re)?re.toString("binary"):Y(re),be=0,Ce=Math.min(1024,ne.length),Be=0,Ne=0;Ne<=Ce;++Ne)(Be=ne.charCodeAt(Ne))>=32&&Be<128&&++be;var Pe=be>=Ce*4/5;I.push(D),I.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+se),I.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),I.push("Content-Type: "+os(ce,se)),I.push(""),I.push(Pe?bs(ne):ds(ne))}return I.push(D+`--\r
`),I.join(`\r
`)}function _s(C){var R={};return y(R,C),R}function Ra(C,R,O,D){var I=D&&D.unsafe;I||y(C);var U=!I&&We.find(C,R);if(!U){var se=C.FullPaths[0];R.slice(0,se.length)==se?se=R:(se.slice(-1)!="/"&&(se+="/"),se=(se+R).replace("//","/")),U={name:a(R),type:2},C.FileIndex.push(U),C.FullPaths.push(se),I||We.utils.cfb_gc(C)}return U.content=O,U.size=O?O.length:0,D&&(D.CLSID&&(U.clsid=D.CLSID),D.mt&&(U.mt=D.mt),D.ct&&(U.ct=D.ct)),U}function Dy(C,R){y(C);var O=We.find(C,R);if(O){for(var D=0;D<C.FileIndex.length;++D)if(C.FileIndex[D]==O)return C.FileIndex.splice(D,1),C.FullPaths.splice(D,1),!0}return!1}function Py(C,R,O){y(C);var D=We.find(C,R);if(D){for(var I=0;I<C.FileIndex.length;++I)if(C.FileIndex[I]==D)return C.FileIndex[I].name=a(O),C.FullPaths[I]=O,!0}return!1}function My(C){S(C,!0)}return e.find=E,e.read=k,e.parse=f,e.write=de,e.writeFile=Ee,e.utils={cfb_new:_s,cfb_add:Ra,cfb_del:Dy,cfb_mov:Py,cfb_gc:My,ReadShift:ul,CheckField:f1,prep_blob:Es,bconcat:Ns,use_zlib:B,_deflateRaw:Ke,_inflateRaw:Ve,consts:J},e}();function dj(t){return typeof t=="string"?hd(t):Array.isArray(t)?RN(t):t}function sc(t,e,s){if(typeof Deno<"u"){if(s&&typeof e=="string")switch(s){case"utf8":e=new TextEncoder(s).encode(e);break;case"binary":e=hd(e);break;default:throw new Error("Unsupported encoding "+s)}return Deno.writeFileSync(t,e)}var r=s=="utf8"?ta(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var a=new Blob([dj(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=ln(e)),c.write(e),c.close(),e}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("cannot save file "+t)}function fj(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var s=e.read();return e.close(),s}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}function es(t){for(var e=Object.keys(t),s=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&s.push(e[r]);return s}function Oh(t,e){for(var s=[],r=es(t),a=0;a!==r.length;++a)s[t[r[a]][e]]==null&&(s[t[r[a]][e]]=r[a]);return s}function xd(t){for(var e=[],s=es(t),r=0;r!==s.length;++r)e[t[s[r]]]=s[r];return e}function pd(t){for(var e=[],s=es(t),r=0;r!==s.length;++r)e[t[s[r]]]=parseInt(s[r],10);return e}function uj(t){for(var e=[],s=es(t),r=0;r!==s.length;++r)e[t[s[r]]]==null&&(e[t[s[r]]]=[]),e[t[s[r]]].push(s[r]);return e}var Eo=new Date(1899,11,30,0,0,0);function vs(t,e){var s=t.getTime();e&&(s-=1462*24*60*60*1e3);var r=Eo.getTime()+(t.getTimezoneOffset()-Eo.getTimezoneOffset())*6e4;return(s-r)/(24*60*60*1e3)}var Vg=new Date,hj=Eo.getTime()+(Vg.getTimezoneOffset()-Eo.getTimezoneOffset())*6e4,Dh=Vg.getTimezoneOffset();function gd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+hj),e.getTimezoneOffset()!==Dh&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Dh)*6e4),e}function mj(t){var e=0,s=0,r=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(s=1,i>3&&(r=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":s*=24;case"H":s*=60;case"M":if(r)s*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=s*parseInt(a[i],10)}return e}var Ph=new Date("2017-02-19T19:06:09.000Z"),zg=isNaN(Ph.getFullYear())?new Date("2/19/17"):Ph,xj=zg.getFullYear()==2017;function Lt(t,e){var s=new Date(t);if(xj)return e>0?s.setTime(s.getTime()+s.getTimezoneOffset()*60*1e3):e<0&&s.setTime(s.getTime()-s.getTimezoneOffset()*60*1e3),s;if(t instanceof Date)return t;if(zg.getFullYear()==1917&&!isNaN(s.getFullYear())){var r=s.getFullYear();return t.indexOf(""+r)>-1||s.setFullYear(s.getFullYear()+100),s}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function In(t,e){if(it&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ta(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ta(Fg(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ta(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ta(new TextDecoder("utf-16be").decode(t.slice(2)))}var s={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return s[i]||i})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function Bt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=Bt(t[s]));return e}function Jt(t,e){for(var s="";s.length<e;)s+=t;return s}function Ur(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var s=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return s*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,i){return s=-s,i}),!isNaN(e=Number(r)))?e/s:e}var pj=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ei(t){var e=new Date(t),s=new Date(NaN),r=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return s;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&pj.indexOf(l)==-1)return s}else if(l.match(/[a-z]/))return s;return r<0||r>8099?s:(a>0||i>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?s:e}var gj=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(s,r,a){if(t||typeof r=="string")return s.split(r);for(var i=s.split(r),l=[i[0]],c=1;c<i.length;++c)l.push(a),l.push(i[c]);return l}}();function Hg(t){return t?t.content&&t.type?In(t.content,!0):t.data?tl(t.data):t.asNodeBuffer&&it?tl(t.asNodeBuffer().toString("binary")):t.asBinary?tl(t.asBinary()):t._data&&t._data.getContent?tl(In(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Gg(t){if(!t)return null;if(t.data)return wh(t.data);if(t.asNodeBuffer&&it)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?wh(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function vj(t){return t&&t.name.slice(-4)===".bin"?Gg(t):Hg(t)}function _r(t,e){for(var s=t.FullPaths||es(t.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),i=0;i<s.length;++i){var l=s[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return t.files?t.files[s[i]]:t.FileIndex[i]}return null}function Uf(t,e){var s=_r(t,e);if(s==null)throw new Error("Cannot find file "+e+" in zip");return s}function us(t,e,s){if(!s)return vj(Uf(t,e));if(!e)return null;try{return us(t,e)}catch{return null}}function hr(t,e,s){if(!s)return Hg(Uf(t,e));if(!e)return null;try{return hr(t,e)}catch{return null}}function Xg(t,e,s){if(!s)return Gg(Uf(t,e));if(!e)return null;try{return Xg(t,e)}catch{return null}}function Mh(t){for(var e=t.FullPaths||es(t.files),s=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&s.push(e[r].replace(/^Root Entry[\/]/,""));return s.sort()}function st(t,e,s){if(t.FullPaths){if(typeof s=="string"){var r;return it?r=Da(s):r=IN(s),We.utils.cfb_add(t,e,r)}We.utils.cfb_add(t,e,s)}else t.file(e,s)}function $f(){return We.utils.cfb_new()}function qg(t,e){switch(e.type){case"base64":return We.read(t,{type:"base64"});case"binary":return We.read(t,{type:"binary"});case"buffer":case"array":return We.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function rl(t,e){if(t.charAt(0)=="/")return t.slice(1);var s=e.split("/");e.slice(-1)!="/"&&s.pop();for(var r=t.split("/");r.length!==0;){var a=r.shift();a===".."?s.pop():a!=="."&&s.push(a)}return s.join("/")}var ls=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Rh=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,bj=/<[^>]*>/g,Vs=ls.match(Rh)?Rh:bj,_j=/<\w*:/,wj=/<(\/?)\w+:/;function Je(t,e,s){for(var r={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(r[0]=t.slice(0,a)),a===t.length)return r;var l=t.match(yj),c=0,o="",d=0,f="",u="",h=1;if(l)for(d=0;d!=l.length;++d){for(u=l[d],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(f=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(h=(a=u.charCodeAt(i+1))==34||a==39?1:0,o=u.slice(i+1+h,u.length-h),c=0;c!=f.length&&f.charCodeAt(c)!==58;++c);if(c===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),r[f]=o,s||(r[f.toLowerCase()]=o);else{var x=(c===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(c+1);if(r[x]&&f.slice(c-3,c)=="ext")continue;r[x]=o,s||(r[x.toLowerCase()]=o)}}return r}function oa(t){return t.replace(wj,"<$1")}var Yg={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Wf=xd(Yg),ft=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function s(r){var a=r+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(c,o){return Yg[c]||String.fromCharCode(parseInt(o,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,o){return String.fromCharCode(parseInt(o,16))});var l=a.indexOf("]]>");return s(a.slice(0,i))+a.slice(i+9,l)+s(a.slice(l+3))}}(),Vf=/[&<>'"]/g,Nj=/[\u0000-\u0008\u000b-\u001f]/g;function kt(t){var e=t+"";return e.replace(Vf,function(s){return Wf[s]}).replace(Nj,function(s){return"_x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ih(t){return kt(t).replace(/ /g,"_x0020_")}var Kg=/[\u0000-\u001f]/g;function zf(t){var e=t+"";return e.replace(Vf,function(s){return Wf[s]}).replace(/\n/g,"<br/>").replace(Kg,function(s){return"&#x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+";"})}function jj(t){var e=t+"";return e.replace(Vf,function(s){return Wf[s]}).replace(Kg,function(s){return"&#x"+s.charCodeAt(0).toString(16).toUpperCase()+";"})}var Lh=function(){var t=/&#(\d+);/g;function e(s,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,e)}}();function kj(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Dt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Zd(t){for(var e="",s=0,r=0,a=0,i=0,l=0,c=0;s<t.length;){if(r=t.charCodeAt(s++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(s++),r>191&&r<224){l=(r&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(i=t.charCodeAt(s++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|i&63);continue}l=t.charCodeAt(s++),c=((r&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Bh(t){var e=en(2*t.length),s,r,a=1,i=0,l=0,c;for(r=0;r<t.length;r+=a)a=1,(c=t.charCodeAt(r))<128?s=c:c<224?(s=(c&31)*64+(t.charCodeAt(r+1)&63),a=2):c<240?(s=(c&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,s=(c&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),s-=65536,l=55296+(s>>>10&1023),s=56320+(s&1023)),l!==0&&(e[i++]=l&255,e[i++]=l>>>8,l=0),e[i++]=s%256,e[i++]=s>>>8;return e.slice(0,i).toString("ucs2")}function Uh(t){return Da(t,"binary").toString("utf8")}var gc="foo bar baz",Et=it&&(Uh(gc)==Zd(gc)&&Uh||Bh(gc)==Zd(gc)&&Bh)||Zd,ta=it?function(t){return Da(t,"utf8").toString("binary")}:function(t){for(var e=[],s=0,r=0,a=0;s<t.length;)switch(r=t.charCodeAt(s++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(s++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Tl=function(){var t={};return function(s,r){var a=s+"|"+(r||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+s+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+s+">",r||"")}}(),Jg=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(s){for(var r=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),Sj=function(){var t={};return function(s){return t[s]!==void 0?t[s]:t[s]=new RegExp("<(?:vt:)?"+s+">([\\s\\S]*?)</(?:vt:)?"+s+">","g")}}(),Ej=/<\/?(?:vt:)?variant>/g,Tj=/<(?:vt:)([^>]*)>([\s\S]*)</;function $h(t,e){var s=Je(t),r=t.match(Sj(s.baseType))||[],a=[];if(r.length!=s.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+s.size);return a}return r.forEach(function(i){var l=i.replace(Ej,"").match(Tj);l&&a.push({v:Et(l[2]),t:l[1]})}),a}var Zg=/(^\s|\s$|\n)/;function Ts(t,e){return"<"+t+(e.match(Zg)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Cl(t){return es(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ke(t,e,s){return"<"+t+(s!=null?Cl(s):"")+(e!=null?(e.match(Zg)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function $0(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(s){if(e)throw s}return""}function Cj(t,e){switch(typeof t){case"string":var s=ke("vt:lpwstr",kt(t));return e&&(s=s.replace(/&quot;/g,"_x0022_")),s;case"number":return ke((t|0)==t?"vt:i4":"vt:r8",kt(String(t)));case"boolean":return ke("vt:bool",t?"true":"false")}if(t instanceof Date)return ke("vt:filetime",$0(t));throw new Error("Unable to serialize "+t)}function Hf(t){if(it&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Et(ln(If(t)));throw new Error("Bad input format: expected Buffer or string")}var Al=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,xs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Xn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],dr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Aj(t,e){for(var s=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return r==2047?a==0?s*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),s*Math.pow(2,r-52)*a)}function Fj(t,e,s){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,l=r?-e:e;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[s+c]=i&255;t[s+6]=(a&15)<<4|i&15,t[s+7]=a>>4|r}var Wh=function(t){for(var e=[],s=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,i=t[0][r].length;a<i;a+=s)e.push.apply(e,t[0][r].slice(a,a+s));return e},Vh=it?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Da(e)})):Wh(t)}:Wh,zh=function(t,e,s){for(var r=[],a=e;a<s;a+=2)r.push(String.fromCharCode(_a(t,a)));return r.join("").replace(Js,"")},Gf=it?function(t,e,s){return Buffer.isBuffer(t)?t.toString("utf16le",e,s).replace(Js,""):zh(t,e,s)}:zh,Hh=function(t,e,s){for(var r=[],a=e;a<e+s;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},Qg=it?function(t,e,s){return Buffer.isBuffer(t)?t.toString("hex",e,e+s):Hh(t,e,s)}:Hh,Gh=function(t,e,s){for(var r=[],a=e;a<s;a++)r.push(String.fromCharCode(fi(t,a)));return r.join("")},rc=it?function(e,s,r){return Buffer.isBuffer(e)?e.toString("utf8",s,r):Gh(e,s,r)}:Gh,e1=function(t,e){var s=fr(t,e);return s>0?rc(t,e+4,e+4+s-1):""},t1=e1,s1=function(t,e){var s=fr(t,e);return s>0?rc(t,e+4,e+4+s-1):""},r1=s1,a1=function(t,e){var s=2*fr(t,e);return s>0?rc(t,e+4,e+4+s-1):""},n1=a1,i1=function(e,s){var r=fr(e,s);return r>0?Gf(e,s+4,s+4+r):""},l1=i1,c1=function(t,e){var s=fr(t,e);return s>0?rc(t,e+4,e+4+s):""},o1=c1,d1=function(t,e){return Aj(t,e)},To=d1,Xf=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};it&&(t1=function(e,s){if(!Buffer.isBuffer(e))return e1(e,s);var r=e.readUInt32LE(s);return r>0?e.toString("utf8",s+4,s+4+r-1):""},r1=function(e,s){if(!Buffer.isBuffer(e))return s1(e,s);var r=e.readUInt32LE(s);return r>0?e.toString("utf8",s+4,s+4+r-1):""},n1=function(e,s){if(!Buffer.isBuffer(e))return a1(e,s);var r=2*e.readUInt32LE(s);return e.toString("utf16le",s+4,s+4+r-1)},l1=function(e,s){if(!Buffer.isBuffer(e))return i1(e,s);var r=e.readUInt32LE(s);return e.toString("utf16le",s+4,s+4+r)},o1=function(e,s){if(!Buffer.isBuffer(e))return c1(e,s);var r=e.readUInt32LE(s);return e.toString("utf8",s+4,s+4+r)},To=function(e,s){return Buffer.isBuffer(e)?e.readDoubleLE(s):d1(e,s)},Xf=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var fi=function(t,e){return t[e]},_a=function(t,e){return t[e+1]*256+t[e]},Oj=function(t,e){var s=t[e+1]*256+t[e];return s<32768?s:(65535-s+1)*-1},fr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},yn=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Dj=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function ul(t,e){var s="",r,a,i=[],l,c,o,d;switch(e){case"dbcs":if(d=this.l,it&&Buffer.isBuffer(this))s=this.slice(this.l,this.l+2*t).toString("utf16le");else for(o=0;o<t;++o)s+=String.fromCharCode(_a(this,d)),d+=2;t*=2;break;case"utf8":s=rc(this,this.l,this.l+t);break;case"utf16le":t*=2,s=Gf(this,this.l,this.l+t);break;case"wstr":return ul.call(this,t,"dbcs");case"lpstr-ansi":s=t1(this,this.l),t=4+fr(this,this.l);break;case"lpstr-cp":s=r1(this,this.l),t=4+fr(this,this.l);break;case"lpwstr":s=n1(this,this.l),t=4+2*fr(this,this.l);break;case"lpp4":t=4+fr(this,this.l),s=l1(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+fr(this,this.l),s=o1(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,s="";(l=fi(this,this.l+t++))!==0;)i.push(pc(l));s=i.join("");break;case"_wstr":for(t=0,s="";(l=_a(this,this.l+t))!==0;)i.push(pc(l)),t+=2;t+=2,s=i.join("");break;case"dbcs-cont":for(s="",d=this.l,o=0;o<t;++o){if(this.lens&&this.lens.indexOf(d)!==-1)return l=fi(this,d),this.l=d+1,c=ul.call(this,t-o,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(pc(_a(this,d))),d+=2}s=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(s="",d=this.l,o=0;o!=t;++o){if(this.lens&&this.lens.indexOf(d)!==-1)return l=fi(this,d),this.l=d+1,c=ul.call(this,t-o,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(pc(fi(this,d))),d+=1}s=i.join("");break;default:switch(t){case 1:return r=fi(this,this.l),this.l++,r;case 2:return r=(e==="i"?Oj:_a)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(r=(t>0?yn:Dj)(this,this.l),this.l+=4,r):(a=fr(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=To(this,this.l):a=To([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:s=Qg(this,this.l,t);break}}return this.l+=t,s}var Pj=function(t,e,s){t[s]=e&255,t[s+1]=e>>>8&255,t[s+2]=e>>>16&255,t[s+3]=e>>>24&255},Mj=function(t,e,s){t[s]=e&255,t[s+1]=e>>8&255,t[s+2]=e>>16&255,t[s+3]=e>>24&255},Rj=function(t,e,s){t[s]=e&255,t[s+1]=e>>>8&255};function Ij(t,e,s){var r=0,a=0;if(s==="dbcs"){for(a=0;a!=e.length;++a)Rj(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(s==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(s==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(s==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,Pj(this,e,this.l);break;case 8:if(r=8,s==="f"){Fj(this,e,this.l);break}case 16:break;case-4:r=4,Mj(this,e,this.l);break}return this.l+=r,this}function f1(t,e){var s=Qg(this,this.l,t.length>>1);if(s!==t)throw new Error(e+"Expected "+t+" saw "+s);this.l+=t.length>>1}function Es(t,e){t.l=e,t.read_shift=ul,t.chk=f1,t.write_shift=Ij}function $s(t,e){t.l+=e}function le(t){var e=en(t);return Es(e,0),e}function Pa(t,e,s){if(t){var r,a,i;Es(t,t.l||0);for(var l=t.length,c=0,o=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var d=Rl[c]||Rl[65535];for(r=t.read_shift(1),i=r&127,a=1;a<4&&r&128;++a)i+=((r=t.read_shift(1))&127)<<7*a;o=t.l+i;var f=d.f&&d.f(t,i,s);if(t.l=o,e(f,d,c))return}}}function lr(){var t=[],e=it?256:2048,s=function(d){var f=le(d);return Es(f,0),f},r=s(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},i=function(d){return r&&d<r.length-r.l?r:(a(),r=s(Math.max(d+1,e)))},l=function(){return a(),Ns(t)},c=function(d){a(),r=d,r.l==null&&(r.l=r.length),i(e)};return{next:i,push:c,end:l,_bufs:t}}function he(t,e,s,r){var a=+e,i;if(!isNaN(a)){r||(r=Rl[a].p||(s||[]).length||0),i=1+(a>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var l=t.next(i);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(r>=128)l.write_shift(1,(r&127)+128),r>>=7;else{l.write_shift(1,r);break}r>0&&Xf(s)&&t.push(s)}}function hl(t,e,s){var r=Bt(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!s||s.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Xh(t,e,s){var r=Bt(t);return r.s=hl(r.s,e.s,s),r.e=hl(r.e,e.s,s),r}function ml(t,e){if(t.cRel&&t.c<0)for(t=Bt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Bt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var s=Ye(t);return!t.cRel&&t.cRel!=null&&(s=Uj(s)),!t.rRel&&t.rRel!=null&&(s=Lj(s)),s}function Qd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Yt(t.s.c)+":"+(t.e.cRel?"":"$")+Yt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+is(t.s.r)+":"+(t.e.rRel?"":"$")+is(t.e.r):ml(t.s,e.biff)+":"+ml(t.e,e.biff)}function qf(t){return parseInt(Bj(t),10)-1}function is(t){return""+(t+1)}function Lj(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Bj(t){return t.replace(/\$(\d+)$/,"$1")}function Yf(t){for(var e=$j(t),s=0,r=0;r!==e.length;++r)s=26*s+e.charCodeAt(r)-64;return s-1}function Yt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Uj(t){return t.replace(/^([A-Z])/,"$$$1")}function $j(t){return t.replace(/^\$([A-Z])/,"$1")}function Wj(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kt(t){for(var e=0,s=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(s=26*s+(a-64))}return{c:s-1,r:e-1}}function Ye(t){for(var e=t.c+1,s="";e;e=(e-1)/26|0)s=String.fromCharCode((e-1)%26+65)+s;return s+(t.r+1)}function cr(t){var e=t.indexOf(":");return e==-1?{s:Kt(t),e:Kt(t)}:{s:Kt(t.slice(0,e)),e:Kt(t.slice(e+1))}}function tt(t,e){return typeof e>"u"||typeof e=="number"?tt(t.s,t.e):(typeof t!="string"&&(t=Ye(t)),typeof e!="string"&&(e=Ye(e)),t==e?t:t+":"+e)}function mt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},s=0,r=0,a=0,i=t.length;for(s=0;r<i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)s=26*s+a;for(e.s.c=--s,s=0;r<i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)s=10*s+a;if(e.s.r=--s,r===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,s=0;r!=i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)s=26*s+a;for(e.e.c=--s,s=0;r!=i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)s=10*s+a;return e.e.r=--s,e}function qh(t,e){var s=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Tr(t.z,s?vs(e):e)}catch{}try{return t.w=Tr((t.XF||{}).numFmtId||(s?14:0),s?vs(e):e)}catch{return""+e}}function Ta(t,e,s){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&s&&s.dateNF&&(t.z=s.dateNF),t.t=="e"?Ma[t.v]||t.v:e==null?qh(t,t.v):qh(t,e))}function cn(t,e){var s=e&&e.sheet?e.sheet:"Sheet1",r={};return r[s]=t,{SheetNames:[s],Sheets:r}}function u1(t,e,s){var r=s||{},a=t?Array.isArray(t):r.dense,i=t||(a?[]:{}),l=0,c=0;if(i&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var o=typeof r.origin=="string"?Kt(r.origin):r.origin;l=o.r,c=o.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=mt(i["!ref"]);d.s.c=f.s.c,d.s.r=f.s.r,d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(d.e.r=l=f.e.r+1)}for(var u=0;u!=e.length;++u)if(e[u]){if(!Array.isArray(e[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[u].length;++h)if(!(typeof e[u][h]>"u")){var x={v:e[u][h]},m=l+u,p=c+h;if(d.s.r>m&&(d.s.r=m),d.s.c>p&&(d.s.c=p),d.e.r<m&&(d.e.r=m),d.e.c<p&&(d.e.c=p),e[u][h]&&typeof e[u][h]=="object"&&!Array.isArray(e[u][h])&&!(e[u][h]instanceof Date))x=e[u][h];else if(Array.isArray(x.v)&&(x.f=e[u][h][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(r.nullError)x.t="e",x.v=0;else if(r.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=r.dateNF||Ge[14],r.cellDates?(x.t="d",x.w=Tr(x.z,vs(x.v))):(x.t="n",x.v=vs(x.v),x.w=Tr(x.z,x.v))):x.t="s";if(a)i[m]||(i[m]=[]),i[m][p]&&i[m][p].z&&(x.z=i[m][p].z),i[m][p]=x;else{var v=Ye({c:p,r:m});i[v]&&i[v].z&&(x.z=i[v].z),i[v]=x}}}return d.s.c<1e7&&(i["!ref"]=tt(d)),i}function Bi(t,e){return u1(null,t,e)}function Vj(t){return t.read_shift(4,"i")}function $r(t,e){return e||(e=le(4)),e.write_shift(4,t),e}function Us(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function js(t,e){var s=!1;return e==null&&(s=!0,e=le(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),s?e.slice(0,e.l):e}function zj(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Hj(t,e){return e||(e=le(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function Kf(t,e){var s=t.l,r=t.read_shift(1),a=Us(t),i=[],l={t:a,h:a};if(r&1){for(var c=t.read_shift(4),o=0;o!=c;++o)i.push(zj(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=s+e,l}function Gj(t,e){var s=!1;return e==null&&(s=!0,e=le(15+4*t.t.length)),e.write_shift(1,0),js(t.t,e),s?e.slice(0,e.l):e}var Xj=Kf;function qj(t,e){var s=!1;return e==null&&(s=!0,e=le(23+4*t.t.length)),e.write_shift(1,1),js(t.t,e),e.write_shift(4,1),Hj({ich:0,ifnt:0},e),s?e.slice(0,e.l):e}function Cr(t){var e=t.read_shift(4),s=t.read_shift(2);return s+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:s}}function qn(t,e){return e==null&&(e=le(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Yn(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Kn(t,e){return e==null&&(e=le(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Yj=Us,h1=js;function Jf(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Co(t,e){var s=!1;return e==null&&(s=!0,e=le(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),s?e.slice(0,e.l):e}var Kj=Us,W0=Jf,Zf=Co;function Qf(t){var e=t.slice(t.l,t.l+4),s=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?To([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):yn(e,0)>>2;return s?a/100:a}function m1(t,e){e==null&&(e=le(4));var s=0,r=0,a=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?r=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(r=1,s=1),r)e.write_shift(-4,((s?a:t)<<2)+(s+2));else throw new Error("unsupported RkNumber "+t)}function x1(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Jj(t,e){return e||(e=le(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Jn=x1,Ui=Jj;function Ls(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ln(t,e){return(e||le(8)).write_shift(8,t,"f")}function Zj(t){var e={},s=t.read_shift(1),r=s>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),o=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var d=Tn[a];d&&(e.rgb=Ol(d));break;case 2:e.rgb=Ol([l,c,o]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function Ao(t,e){if(e||(e=le(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var s=t.tint||0;if(s>0?s*=32767:s<0&&(s*=32768),e.write_shift(2,s),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=t.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function Qj(t){var e=t.read_shift(1);t.l++;var s={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return s}function ek(t,e){e||(e=le(2));var s=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,s),e.write_shift(1,0),e}function p1(t,e){var s={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return s[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function tk(t){return p1(t,1)}function sk(t){return p1(t,2)}var eu=2,tr=3,vc=11,Yh=12,Fo=19,yc=64,rk=65,ak=71,nk=4108,ik=4126,ws=80,g1=81,lk=[ws,g1],V0={1:{n:"CodePage",t:eu},2:{n:"Category",t:ws},3:{n:"PresentationFormat",t:ws},4:{n:"ByteCount",t:tr},5:{n:"LineCount",t:tr},6:{n:"ParagraphCount",t:tr},7:{n:"SlideCount",t:tr},8:{n:"NoteCount",t:tr},9:{n:"HiddenCount",t:tr},10:{n:"MultimediaClipCount",t:tr},11:{n:"ScaleCrop",t:vc},12:{n:"HeadingPairs",t:nk},13:{n:"TitlesOfParts",t:ik},14:{n:"Manager",t:ws},15:{n:"Company",t:ws},16:{n:"LinksUpToDate",t:vc},17:{n:"CharacterCount",t:tr},19:{n:"SharedDoc",t:vc},22:{n:"HyperlinksChanged",t:vc},23:{n:"AppVersion",t:tr,p:"version"},24:{n:"DigSig",t:rk},26:{n:"ContentType",t:ws},27:{n:"ContentStatus",t:ws},28:{n:"Language",t:ws},29:{n:"Version",t:ws},255:{},2147483648:{n:"Locale",t:Fo},2147483651:{n:"Behavior",t:Fo},1919054434:{}},z0={1:{n:"CodePage",t:eu},2:{n:"Title",t:ws},3:{n:"Subject",t:ws},4:{n:"Author",t:ws},5:{n:"Keywords",t:ws},6:{n:"Comments",t:ws},7:{n:"Template",t:ws},8:{n:"LastAuthor",t:ws},9:{n:"RevNumber",t:ws},10:{n:"EditTime",t:yc},11:{n:"LastPrinted",t:yc},12:{n:"CreatedDate",t:yc},13:{n:"ModifiedDate",t:yc},14:{n:"PageCount",t:tr},15:{n:"WordCount",t:tr},16:{n:"CharCount",t:tr},17:{n:"Thumbnail",t:ak},18:{n:"Application",t:ws},19:{n:"DocSecurity",t:tr},255:{},2147483648:{n:"Locale",t:Fo},2147483651:{n:"Behavior",t:Fo},1919054434:{}},Kh={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ck=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ok(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var dk=ok([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Tn=Bt(dk),Ma={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},v1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},H0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},bc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function tu(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fk(t){var e=tu();if(!t||!t.match)return e;var s={};if((t.match(Vs)||[]).forEach(function(r){var a=Je(r);switch(a[0].replace(_j,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":s[a.Extension]=a.ContentType;break;case"<Override":e[H0[a.ContentType]]!==void 0&&e[H0[a.ContentType]].push(a.PartName);break}}),e.xmlns!==xs.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=s,delete e.calcchains,e}function y1(t,e){var s=uj(H0),r=[],a;r[r.length]=ls,r[r.length]=ke("Types",null,{xmlns:xs.CT,"xmlns:xsd":xs.xsd,"xmlns:xsi":xs.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(o){return ke("Default",null,{Extension:o[0],ContentType:o[1]})}));var i=function(o){t[o]&&t[o].length>0&&(a=t[o][0],r[r.length]=ke("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:bc[o][e.bookType]||bc[o].xlsx}))},l=function(o){(t[o]||[]).forEach(function(d){r[r.length]=ke("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:bc[o][e.bookType]||bc[o].xlsx})})},c=function(o){(t[o]||[]).forEach(function(d){r[r.length]=ke("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:s[o][0]})})};return i("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var lt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Fl(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function xl(t,e){var s={"!id":{}};if(!t)return s;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(t.match(Vs)||[]).forEach(function(a){var i=Je(a);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:rl(i.Target,e);s[c]=l,r[i.Id]=l}}),s["!id"]=r,s}function wi(t){var e=[ls,ke("Relationships",null,{xmlns:xs.RELS})];return es(t["!id"]).forEach(function(s){e[e.length]=ke("Relationship",null,t["!id"][s])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Nt(t,e,s,r,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=r,a.Target=s,i?a.TargetMode=i:[lt.HLINK,lt.XPATH,lt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var uk="application/vnd.oasis.opendocument.spreadsheet";function hk(t,e){for(var s=Hf(t),r,a;r=Al.exec(s);)switch(r[3]){case"manifest":break;case"file-entry":if(a=Je(r[0],!1),a.path=="/"&&a.type!==uk)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}function mk(t){var e=[ls];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var s=0;s<t.length;++s)e.push('  <manifest:file-entry manifest:full-path="'+t[s][0]+'" manifest:media-type="'+t[s][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Jh(t,e,s){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(s||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function xk(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function pk(t){var e=[ls];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var s=0;s!=t.length;++s)e.push(Jh(t[s][0],t[s][1])),e.push(xk("",t[s][0]));return e.push(Jh("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function b1(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+No.version+"</meta:generator></office:meta></office:document-meta>"}var Er=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gk=function(){for(var t=new Array(Er.length),e=0;e<Er.length;++e){var s=Er[e],r="(?:"+s[0].slice(0,s[0].indexOf(":"))+":)"+s[0].slice(s[0].indexOf(":")+1);t[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function _1(t){var e={};t=Et(t);for(var s=0;s<Er.length;++s){var r=Er[s],a=t.match(gk[s]);a!=null&&a.length>0&&(e[r[1]]=ft(a[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=Lt(e[r[1]]))}return e}function e0(t,e,s,r,a){a[t]!=null||e==null||e===""||(a[t]=e,e=kt(e),r[r.length]=s?ke(t,e,s):Ts(t,e))}function w1(t,e){var s=e||{},r=[ls,ke("cp:coreProperties",null,{"xmlns:cp":xs.CORE_PROPS,"xmlns:dc":xs.dc,"xmlns:dcterms":xs.dcterms,"xmlns:dcmitype":xs.dcmitype,"xmlns:xsi":xs.xsi})],a={};if(!t&&!s.Props)return r.join("");t&&(t.CreatedDate!=null&&e0("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:$0(t.CreatedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),t.ModifiedDate!=null&&e0("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:$0(t.ModifiedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var i=0;i!=Er.length;++i){var l=Er[i],c=s.Props&&s.Props[l[1]]!=null?s.Props[l[1]]:t?t[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&e0(l[0],c,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Cn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],N1=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function j1(t,e,s,r){var a=[];if(typeof t=="string")a=$h(t,r);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(f){return{v:f}}));var l=typeof e=="string"?$h(e,r).map(function(f){return f.v}):e,c=0,o=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(o=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":s.Worksheets=o,s.SheetNames=l.slice(c,c+o);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":s.NamedRanges=o,s.DefinedNames=l.slice(c,c+o);break;case"Charts":case"Diagramme":s.Chartsheets=o,s.ChartNames=l.slice(c,c+o);break}c+=o}}function vk(t,e,s){var r={};return e||(e={}),t=Et(t),Cn.forEach(function(a){var i=(t.match(Tl(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=ft(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&j1(r.HeadingPairs,r.TitlesOfParts,e,s),e}function k1(t){var e=[],s=ke;return t||(t={}),t.Application="SheetJS",e[e.length]=ls,e[e.length]=ke("Properties",null,{xmlns:xs.EXT_PROPS,"xmlns:vt":xs.vt}),Cn.forEach(function(r){if(t[r[1]]!==void 0){var a;switch(r[2]){case"string":a=kt(String(t[r[1]]));break;case"bool":a=t[r[1]]?"true":"false";break}a!==void 0&&(e[e.length]=s(r[0],a))}}),e[e.length]=s("HeadingPairs",s("vt:vector",s("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+s("vt:variant",s("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=s("TitlesOfParts",s("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+kt(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yk=/<[^>]+>[^<]*/g;function bk(t,e){var s={},r="",a=t.match(yk);if(a)for(var i=0;i!=a.length;++i){var l=a[i],c=Je(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=ft(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var o=l.split(">"),d=o[0].slice(4),f=o[1];switch(d){case"lpstr":case"bstr":case"lpwstr":s[r]=ft(f);break;case"bool":s[r]=Dt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":s[r]=parseInt(f,10);break;case"r4":case"r8":case"decimal":s[r]=parseFloat(f);break;case"filetime":case"date":s[r]=Lt(f);break;case"cy":case"error":s[r]=ft(f);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,o)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return s}function S1(t){var e=[ls,ke("Properties",null,{xmlns:xs.CUST_PROPS,"xmlns:vt":xs.vt})];if(!t)return e.join("");var s=1;return es(t).forEach(function(a){++s,e[e.length]=ke("property",Cj(t[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:s,name:kt(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var G0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},t0;function _k(t,e,s){t0||(t0=xd(G0)),e=t0[e]||e,t[e]=s}function wk(t,e){var s=[];return es(G0).map(function(r){for(var a=0;a<Er.length;++a)if(Er[a][1]==r)return Er[a];for(a=0;a<Cn.length;++a)if(Cn[a][1]==r)return Cn[a];throw r}).forEach(function(r){if(t[r[1]]!=null){var a=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:t[r[1]];switch(r[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),s.push(Ts(G0[r[1]]||r[1],a))}}),ke("DocumentProperties",s.join(""),{xmlns:dr.o})}function Nk(t,e){var s=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return t&&es(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var l=0;l<Er.length;++l)if(i==Er[l][1])return;for(l=0;l<Cn.length;++l)if(i==Cn[l][1])return;for(l=0;l<s.length;++l)if(i==s[l])return;var c=t[i],o="string";typeof c=="number"?(o="float",c=String(c)):c===!0||c===!1?(o="boolean",c=c?"1":"0"):c=String(c),a.push(ke(Ih(i),c,{"dt:dt":o}))}}),e&&es(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),a.push(ke(Ih(i),l,{"dt:dt":c}))}}),"<"+r+' xmlns="'+dr.o+'">'+a.join("")+"</"+r+">"}function su(t){var e=t.read_shift(4),s=t.read_shift(4);return new Date((s/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function jk(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,s=e.getTime()/1e3+11644473600,r=s%Math.pow(2,32),a=(s-r)/Math.pow(2,32);r*=1e7,a*=1e7;var i=r/Math.pow(2,32)|0;i>0&&(r=r%Math.pow(2,32),a+=i);var l=le(8);return l.write_shift(4,r),l.write_shift(4,a),l}function E1(t,e,s){var r=t.l,a=t.read_shift(0,"lpstr-cp");if(s)for(;t.l-r&3;)++t.l;return a}function T1(t,e,s){var r=t.read_shift(0,"lpwstr");return s&&(t.l+=4-(r.length+1&3)&3),r}function C1(t,e,s){return e===31?T1(t):E1(t,e,s)}function X0(t,e,s){return C1(t,e,s===!1?0:4)}function kk(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return C1(t,e,0)}function Sk(t){for(var e=t.read_shift(4),s=[],r=0;r!=e;++r){var a=t.l;s[r]=t.read_shift(0,"lpwstr").replace(Js,""),t.l-a&2&&(t.l+=2)}return s}function Ek(t){for(var e=t.read_shift(4),s=[],r=0;r!=e;++r)s[r]=t.read_shift(0,"lpstr-cp").replace(Js,"");return s}function Tk(t){var e=t.l,s=Oo(t,g1);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var r=Oo(t,tr);return[s,r]}function Ck(t){for(var e=t.read_shift(4),s=[],r=0;r<e/2;++r)s.push(Tk(t));return s}function Zh(t,e){for(var s=t.read_shift(4),r={},a=0;a!=s;++a){var i=t.read_shift(4),l=t.read_shift(4);r[i]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Js,"").replace(sl,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>2+1<<2),r}function A1(t){var e=t.read_shift(4),s=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),s}function Ak(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Oo(t,e,s){var r=t.read_shift(2),a,i=s||{};if(t.l+=2,e!==Yh&&r!==e&&lk.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===Yh?r:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return E1(t,r,4).replace(Js,"");case 31:return T1(t);case 64:return su(t);case 65:return A1(t);case 71:return Ak(t);case 80:return X0(t,r,!i.raw).replace(Js,"");case 81:return kk(t,r).replace(Js,"");case 4108:return Ck(t);case 4126:case 4127:return r==4127?Sk(t):Ek(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function Qh(t,e){var s=le(4),r=le(4);switch(s.write_shift(4,t==80?31:t),t){case 3:r.write_shift(-4,e);break;case 5:r=le(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=jk(e);break;case 31:case 80:for(r=le(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Ns([s,r])}function em(t,e){var s=t.l,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0,c=0,o=-1,d={};for(l=0;l!=a;++l){var f=t.read_shift(4),u=t.read_shift(4);i[l]=[f,u+s]}i.sort(function(_,g){return _[1]-g[1]});var h={};for(l=0;l!=a;++l){if(t.l!==i[l][1]){var x=!0;if(l>0&&e)switch(e[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,x=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],x=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],x=!1);break}if((!e||l==0)&&t.l<=i[l][1]&&(x=!1,t.l=i[l][1]),x)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(e){var m=e[i[l][0]];if(h[m.n]=Oo(t,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Pr(c=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(i[l][0]===1){if(c=h.CodePage=Oo(t,eu),Pr(c),o!==-1){var p=t.l;t.l=i[o][1],d=Zh(t,c),t.l=p}}else if(i[l][0]===0){if(c===0){o=l,t.l=i[l+1][1];continue}d=Zh(t,c)}else{var v=d[i[l][0]],b;switch(t[t.l]){case 65:t.l+=4,b=A1(t);break;case 30:t.l+=4,b=X0(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,b=X0(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,b=t.read_shift(4,"i");break;case 19:t.l+=4,b=t.read_shift(4);break;case 5:t.l+=4,b=t.read_shift(8,"f");break;case 11:t.l+=4,b=ts(t,4);break;case 64:t.l+=4,b=Lt(su(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[v]=b}}return t.l=s+r,h}var F1=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Fk(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function tm(t,e,s){var r=le(8),a=[],i=[],l=8,c=0,o=le(8),d=le(8);if(o.write_shift(4,2),o.write_shift(4,1200),d.write_shift(4,1),i.push(o),a.push(d),l+=8+o.length,!e){d=le(8),d.write_shift(4,0),a.unshift(d);var f=[le(4)];for(f[0].write_shift(4,t.length),c=0;c<t.length;++c){var u=t[c][0];for(o=le(4+4+2*(u.length+1)+(u.length%2?0:2)),o.write_shift(4,c+2),o.write_shift(4,u.length+1),o.write_shift(0,u,"dbcs");o.l!=o.length;)o.write_shift(1,0);f.push(o)}o=Ns(f),i.unshift(o),l+=8+o.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(F1.indexOf(t[c][0])>-1||N1.indexOf(t[c][0])>-1)&&t[c][1]!=null){var h=t[c][1],x=0;if(e){x=+e[t[c][0]];var m=s[x];if(m.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}o=Qh(m.t,h)}else{var v=Fk(h);v==-1&&(v=31,h=String(h)),o=Qh(v,h)}i.push(o),d=le(8),d.write_shift(4,e?x:2+c),a.push(d),l+=8+o.length}var b=8*(i.length+1);for(c=0;c<i.length;++c)a[c].write_shift(4,b),b+=i[c].length;return r.write_shift(4,l),r.write_shift(4,i.length),Ns([r].concat(a).concat(i))}function sm(t,e,s){var r=t.content;if(!r)return{};Es(r,0);var a,i,l,c,o=0;r.chk("feff","Byte Order: "),r.read_shift(2);var d=r.read_shift(4),f=r.read_shift(16);if(f!==We.utils.consts.HEADER_CLSID&&f!==s)throw new Error("Bad PropertySet CLSID "+f);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),o=r.read_shift(4));var u=em(r,e),h={SystemIdentifier:d};for(var x in u)h[x]=u[x];if(h.FMTID=i,a===1)return h;if(o-r.l==2&&(r.l+=2),r.l!==o)throw new Error("Length mismatch 2: "+r.l+" !== "+o);var m;try{m=em(r,null)}catch{}for(x in m)h[x]=m[x];return h.FMTID=[i,l],h}function rm(t,e,s,r,a,i){var l=le(a?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,We.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var o=tm(t,s,r);if(c.push(o),a){var d=tm(a,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+o.length),c.push(d)}return Ns(c)}function La(t,e){return t.read_shift(e),null}function Ok(t,e){e||(e=le(t));for(var s=0;s<t;++s)e.write_shift(1,0);return e}function Dk(t,e,s){for(var r=[],a=t.l+e;t.l<a;)r.push(s(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return r}function ts(t,e){return t.read_shift(e)===1}function qs(t,e){return e||(e=le(2)),e.write_shift(2,+!!t),e}function hs(t){return t.read_shift(2,"u")}function wr(t,e){return e||(e=le(2)),e.write_shift(2,t),e}function O1(t,e){return Dk(t,e,hs)}function Pk(t){var e=t.read_shift(1),s=t.read_shift(1);return s===1?e:e===1}function D1(t,e,s){return s||(s=le(2)),s.write_shift(1,e=="e"?+t:+!!t),s.write_shift(1,e=="e"?1:0),s}function ac(t,e,s){var r=t.read_shift(s&&s.biff>=12?2:1),a="sbcs-cont";if(s&&s.biff>=8,!s||s.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else s.biff==12&&(a="wstr");s.biff>=2&&s.biff<=5&&(a="cpstr");var l=r?t.read_shift(r,a):"";return l}function Mk(t){var e=t.read_shift(2),s=t.read_shift(1),r=s&4,a=s&8,i=1+(s&1),l=0,c,o={};a&&(l=t.read_shift(2)),r&&(c=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*l),r&&(t.l+=c),o.t=f,a||(o.raw="<t>"+o.t+"</t>",o.r=o.t),o}function Rk(t){var e=t.t||"",s=le(3+0);s.write_shift(2,e.length),s.write_shift(1,1);var r=le(2*e.length);r.write_shift(2*e.length,e,"utf16le");var a=[s,r];return Ns(a)}function Bn(t,e,s){var r;if(s){if(s.biff>=2&&s.biff<=5)return t.read_shift(e,"cpstr");if(s.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function nc(t,e,s){var r=t.read_shift(s&&s.biff==2?1:2);return r===0?(t.l++,""):Bn(t,r,s)}function Zn(t,e,s){if(s.biff>5)return nc(t,e,s);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,s.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function P1(t,e,s){return s||(s=le(3+2*t.length)),s.write_shift(2,t.length),s.write_shift(1,1),s.write_shift(31,t,"utf16le"),s}function Ik(t){var e=t.read_shift(1);t.l++;var s=t.read_shift(2);return t.l+=2,[e,s]}function Lk(t){var e=t.read_shift(4),s=t.l,r=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),t.l=s);var a=t.read_shift((r?e-24:e)>>1,"utf16le").replace(Js,"");return r&&(t.l+=24),a}function Bk(t){for(var e=t.read_shift(2),s="";e-- >0;)s+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return s+r.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(Js,"");return s+l}function Uk(t,e){var s=t.read_shift(16);switch(s){case"e0c9ea79f9bace118c8200aa004ba90b":return Lk(t);case"0303000000000000c000000000000046":return Bk(t);default:throw new Error("Unsupported Moniker "+s)}}function _c(t){var e=t.read_shift(4),s=e>0?t.read_shift(e,"utf16le").replace(Js,""):"";return s}function am(t,e){e||(e=le(6+t.length*2)),e.write_shift(4,1+t.length);for(var s=0;s<t.length;++s)e.write_shift(2,t.charCodeAt(s));return e.write_shift(2,0),e}function $k(t,e){var s=t.l+e,r=t.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=t.read_shift(2);t.l+=2;var i,l,c,o,d="",f,u;a&16&&(i=_c(t,s-t.l)),a&128&&(l=_c(t,s-t.l)),(a&257)===257&&(c=_c(t,s-t.l)),(a&257)===1&&(o=Uk(t,s-t.l)),a&8&&(d=_c(t,s-t.l)),a&32&&(f=t.read_shift(16)),a&64&&(u=su(t)),t.l=s;var h=l||c||o||"";h&&d&&(h+="#"+d),h||(h="#"+d),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var x={Target:h};return f&&(x.guid=f),u&&(x.time=u),i&&(x.Tooltip=i),x}function Wk(t){var e=le(512),s=0,r=t.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var a=r.indexOf("#"),i=a>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(s=0;s<l.length;++s)e.write_shift(4,l[s]);if(i==28)r=r.slice(1),am(r,e);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<l.length;++s)e.write_shift(1,parseInt(l[s],16));var c=a>-1?r.slice(0,a):r;for(e.write_shift(4,2*(c.length+1)),s=0;s<c.length;++s)e.write_shift(2,c.charCodeAt(s));e.write_shift(2,0),i&8&&am(a>-1?r.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),s=0;s<l.length;++s)e.write_shift(1,parseInt(l[s],16));for(var o=0;r.slice(o*3,o*3+3)=="../"||r.slice(o*3,o*3+3)=="..\\";)++o;for(e.write_shift(2,o),e.write_shift(4,r.length-3*o+1),s=0;s<r.length-3*o;++s)e.write_shift(1,r.charCodeAt(s+3*o)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),s=0;s<6;++s)e.write_shift(4,0)}return e.slice(0,e.l)}function M1(t){var e=t.read_shift(1),s=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1);return[e,s,r,a]}function R1(t,e){var s=M1(t);return s[3]=0,s}function da(t){var e=t.read_shift(2),s=t.read_shift(2),r=t.read_shift(2);return{r:e,c:s,ixfe:r}}function Un(t,e,s,r){return r||(r=le(6)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,s||0),r}function Vk(t){var e=t.read_shift(2),s=t.read_shift(2);return t.l+=8,{type:e,flags:s}}function zk(t,e,s){return e===0?"":Zn(t,e,s)}function Hk(t,e,s){var r=s.biff>8?4:2,a=t.read_shift(r),i=t.read_shift(r,"i"),l=t.read_shift(r,"i");return[a,i,l]}function I1(t){var e=t.read_shift(2),s=Qf(t);return[e,s]}function Gk(t,e,s){t.l+=4,e-=4;var r=t.l+e,a=ac(t,e,s),i=t.read_shift(2);if(r-=t.l,i!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return t.l+=i,a}function vd(t){var e=t.read_shift(2),s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:s}}}function L1(t,e){return e||(e=le(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function B1(t){var e=t.read_shift(2),s=t.read_shift(2),r=t.read_shift(1),a=t.read_shift(1);return{s:{c:r,r:e},e:{c:a,r:s}}}var Xk=B1;function U1(t){t.l+=4;var e=t.read_shift(2),s=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[s,e,r]}function qk(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Yk(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Fs(t){t.l+=2,t.l+=t.read_shift(2)}var Kk={0:Fs,4:Fs,5:Fs,6:Fs,7:Yk,8:Fs,9:Fs,10:Fs,11:Fs,12:Fs,13:qk,14:Fs,15:Fs,16:Fs,17:Fs,18:Fs,19:Fs,20:Fs,21:U1};function Jk(t,e){for(var s=t.l+e,r=[];t.l<s;){var a=t.read_shift(2);t.l-=2;try{r.push(Kk[a](t,s-t.l))}catch{return t.l=s,r}}return t.l!=s&&(t.l=s),r}function wc(t,e){var s={BIFFVer:0,dt:0};switch(s.BIFFVer=t.read_shift(2),e-=2,e>=2&&(s.dt=t.read_shift(2),t.l-=2),s.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+s.BIFFVer)}return t.read_shift(e),s}function ru(t,e,s){var r=1536,a=16;switch(s.bookType){case"biff8":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=le(a);return i.write_shift(2,r),i.write_shift(2,e),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Zk(t,e){return e===0||t.read_shift(2),1200}function Qk(t,e,s){if(s.enc)return t.l+=e,"";var r=t.l,a=Zn(t,0,s);return t.read_shift(e+r-t.l),a}function eS(t,e){var s=!e||e.biff==8,r=le(s?112:54);for(r.write_shift(e.biff==8?2:1,7),s&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(s?0:536870912));r.l<r.length;)r.write_shift(1,s?0:32);return r}function tS(t,e,s){var r=s&&s.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function sS(t,e,s){var r=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=ac(t,0,s);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:i,name:l}}function rS(t,e){var s=!e||e.biff>=8?2:1,r=le(8+s*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(s*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function aS(t,e){for(var s=t.l+e,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0;l!=a&&t.l<s;++l)i.push(Mk(t));return i.Count=r,i.Unique=a,i}function nS(t,e){var s=le(8);s.write_shift(4,t.Count),s.write_shift(4,t.Unique);for(var r=[],a=0;a<t.length;++a)r[a]=Rk(t[a]);var i=Ns([s].concat(r));return i.parts=[s.length].concat(r.map(function(l){return l.length})),i}function iS(t,e){var s={};return s.dsst=t.read_shift(2),t.l+=e-2,s}function lS(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var s=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=s/20),e}function cS(t){var e=Vk(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var s=t.read_shift(4);return s!==0}function oS(t){return t.read_shift(2),t.read_shift(4)}function nm(t,e,s){var r=0;s&&s.biff==2||(r=t.read_shift(2));var a=t.read_shift(2);s&&s.biff==2&&(r=1-(a>>15),a&=32767);var i={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[i,a]}function dS(t){var e=t.read_shift(2),s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),o=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,s],Dim:[r,a],Flags:i,CurTab:l,FirstTab:c,Selected:o,TabRatio:d}}function fS(){var t=le(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function uS(t,e,s){if(s&&s.biff>=2&&s.biff<5)return{};var r=t.read_shift(2);return{RTL:r&64}}function hS(t){var e=le(18),s=1718;return t&&t.RTL&&(s|=64),e.write_shift(2,s),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function mS(){}function xS(t,e,s){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(s&&s.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return r.name=ac(t,0,s),r}function pS(t,e){var s=t.name||"Arial",r=e&&e.biff==5,a=r?15+s.length:16+2*s.length,i=le(a);return i.write_shift(2,(t.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,s.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*s.length,s,r?"sbcs":"utf16le"),i}function gS(t){var e=da(t);return e.isst=t.read_shift(4),e}function vS(t,e,s,r){var a=le(10);return Un(t,e,r,a),a.write_shift(4,s),a}function yS(t,e,s){s.biffguess&&s.biff==2&&(s.biff=5);var r=t.l+e,a=da(t);s.biff==2&&t.l++;var i=nc(t,r-t.l,s);return a.val=i,a}function bS(t,e,s,r,a){var i=!a||a.biff==8,l=le(6+2+ +i+(1+i)*s.length);return Un(t,e,r,l),l.write_shift(2,s.length),i&&l.write_shift(1,1),l.write_shift((1+i)*s.length,s,i?"utf16le":"sbcs"),l}function _S(t,e,s){var r=t.read_shift(2),a=Zn(t,0,s);return[r,a]}function wS(t,e,s,r){var a=s&&s.biff==5;r||(r=le(a?3+e.length:5+2*e.length)),r.write_shift(2,t),r.write_shift(a?1:2,e.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return i.l==null&&(i.l=i.length),i}var NS=Zn;function im(t,e,s){var r=t.l+e,a=s.biff==8||!s.biff?4:2,i=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(2),o=t.read_shift(2);return t.l=r,{s:{r:i,c},e:{r:l,c:o}}}function jS(t,e){var s=e.biff==8||!e.biff?4:2,r=le(2*s+6);return r.write_shift(s,t.s.r),r.write_shift(s,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}function kS(t){var e=t.read_shift(2),s=t.read_shift(2),r=I1(t);return{r:e,c:s,ixfe:r[0],rknum:r[1]}}function SS(t,e){for(var s=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<s;)i.push(I1(t));if(t.l!==s)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:i}}function ES(t,e){for(var s=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<s;)i.push(t.read_shift(2));if(t.l!==s)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:i}}function TS(t,e,s,r){var a={},i=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),o=t.read_shift(2);return a.patternType=ck[c>>26],r.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=o&127,a.icvBack=o>>7&127,a.fsxButton=o>>14&1),a}function CS(t,e,s){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=TS(t,e,r.fStyle,s),r}function lm(t,e,s,r){var a=s&&s.biff==5;r||(r=le(a?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function AS(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function FS(t){var e=le(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function cm(t,e,s){var r=da(t);(s.biff==2||e==9)&&++t.l;var a=Pk(t);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function OS(t,e,s,r,a,i){var l=le(8);return Un(t,e,r,l),D1(s,i,l),l}function DS(t,e,s){s.biffguess&&s.biff==2&&(s.biff=5);var r=da(t),a=Ls(t);return r.val=a,r}function PS(t,e,s,r){var a=le(14);return Un(t,e,r,a),Ln(s,a),a}var om=zk;function MS(t,e,s){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(s.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Bn(t,i),c=[];r>t.l;)c.push(nc(t));return[i,a,l,c]}function dm(t,e,s){var r=t.read_shift(2),a,i={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return s.sbcch===14849&&(a=Gk(t,e-2,s)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var RS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function fm(t,e,s){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(s&&s.biff==2?1:2),o=0;(!s||s.biff>=5)&&(s.biff!=5&&(t.l+=2),o=t.read_shift(2),s.biff==5&&(t.l+=2),t.l+=4);var d=Bn(t,l,s);a&32&&(d=RS[d.charCodeAt(0)]);var f=r-t.l;s&&s.biff==2&&--f;var u=r==t.l||c===0||!(f>0)?[]:JC(t,f,s,c);return{chKey:i,Name:d,itab:o,rgce:u}}function $1(t,e,s){if(s.biff<8)return IS(t,e,s);for(var r=[],a=t.l+e,i=t.read_shift(s.biff>8?4:2);i--!==0;)r.push(Hk(t,s.biff>8?12:6,s));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function IS(t,e,s){t[t.l+1]==3&&t[t.l]++;var r=ac(t,e,s);return r.charCodeAt(0)==3?r.slice(1):r}function LS(t,e,s){if(s.biff<8){t.l+=e;return}var r=t.read_shift(2),a=t.read_shift(2),i=Bn(t,r,s),l=Bn(t,a,s);return[i,l]}function BS(t,e,s){var r=B1(t);t.l++;var a=t.read_shift(1);return e-=8,[ZC(t,e,s),a,r]}function um(t,e,s){var r=Xk(t);switch(s.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[r,YC(t,e,s)]}function US(t){var e=t.read_shift(4)!==0,s=t.read_shift(4)!==0,r=t.read_shift(4);return[e,s,r]}function $S(t,e,s){if(!(s.biff<8)){var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=Zn(t,0,s);return s.biff<8&&t.read_shift(1),[{r,c:a},c,l,i]}}function WS(t,e,s){return $S(t,e,s)}function VS(t,e){for(var s=[],r=t.read_shift(2);r--;)s.push(vd(t));return s}function zS(t){var e=le(2+t.length*8);e.write_shift(2,t.length);for(var s=0;s<t.length;++s)L1(t[s],e);return e}function HS(t,e,s){if(s&&s.biff<8)return XS(t,e,s);var r=U1(t),a=Jk(t,e-22,r[1]);return{cmo:r,ft:a}}var GS={8:function(t,e){var s=t.l+e;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=s,{fmt:r}}};function XS(t,e,s){t.l+=4;var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((GS[r]||$s)(t,e,s)),{cmo:[a,r,i],ft:l}}function qS(t,e,s){var r=t.l,a="";try{t.l+=4;var i=(s.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=Ik(t,6,s);var c=t.read_shift(2);t.read_shift(2),hs(t,2);var o=t.read_shift(2);t.l+=o;for(var d=1;d<t.lens.length-1;++d){if(t.l-r!=t.lens[d])throw new Error("TxO: bad continue record");var f=t[t.l],u=Bn(t,t.lens[d+1]-t.lens[d]-1);if(a+=u,a.length>=(f?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return t.l=r+e,{t:a}}catch{return t.l=r+e,{t:a}}}function YS(t,e){var s=vd(t);t.l+=16;var r=$k(t,e-24);return[s,r]}function KS(t){var e=le(24),s=Kt(t[0]);e.write_shift(2,s.r),e.write_shift(2,s.r),e.write_shift(2,s.c),e.write_shift(2,s.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(r[a],16));return Ns([e,Wk(t[1])])}function JS(t,e){t.read_shift(2);var s=vd(t),r=t.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(Js,""),[s,r]}function ZS(t){var e=t[1].Tooltip,s=le(10+2*(e.length+1));s.write_shift(2,2048);var r=Kt(t[0]);s.write_shift(2,r.r),s.write_shift(2,r.r),s.write_shift(2,r.c),s.write_shift(2,r.c);for(var a=0;a<e.length;++a)s.write_shift(2,e.charCodeAt(a));return s.write_shift(2,0),s}function QS(t){var e=[0,0],s;return s=t.read_shift(2),e[0]=Kh[s]||s,s=t.read_shift(2),e[1]=Kh[s]||s,e}function e4(t){return t||(t=le(4)),t.write_shift(2,1),t.write_shift(2,1),t}function t4(t){for(var e=t.read_shift(2),s=[];e-- >0;)s.push(R1(t));return s}function s4(t){for(var e=t.read_shift(2),s=[];e-- >0;)s.push(R1(t));return s}function r4(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function W1(t,e,s){if(!s.cellStyles)return $s(t,e);var r=s&&s.biff>=12?4:2,a=t.read_shift(r),i=t.read_shift(r),l=t.read_shift(r),c=t.read_shift(r),o=t.read_shift(2);r==2&&(t.l+=2);var d={s:a,e:i,w:l,ixfe:c,flags:o};return(s.biff>=5||!s.biff)&&(d.level=o>>8&7),d}function a4(t,e){var s=le(12);s.write_shift(2,e),s.write_shift(2,e),s.write_shift(2,t.width*256),s.write_shift(2,0);var r=0;return t.hidden&&(r|=1),s.write_shift(1,r),r=t.level||0,s.write_shift(1,r),s.write_shift(2,0),s}function n4(t,e){var s={};return e<32||(t.l+=16,s.header=Ls(t),s.footer=Ls(t),t.l+=2),s}function i4(t,e,s){var r={area:!1};if(s.biff!=5)return t.l+=e,r;var a=t.read_shift(1);return t.l+=3,a&16&&(r.area=!0),r}function l4(t){for(var e=le(2*t),s=0;s<t;++s)e.write_shift(2,s+1);return e}var c4=da,o4=O1,d4=nc;function f4(t){var e=t.read_shift(2),s=t.read_shift(2),r=t.read_shift(4),a={fmt:e,env:s,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,a}function u4(t,e,s){s.biffguess&&s.biff==5&&(s.biff=2);var r=da(t);++t.l;var a=Zn(t,e-7,s);return r.t="str",r.val=a,r}function h4(t){var e=da(t);++t.l;var s=Ls(t);return e.t="n",e.val=s,e}function m4(t,e,s){var r=le(15);return oc(r,t,e),r.write_shift(8,s,"f"),r}function x4(t){var e=da(t);++t.l;var s=t.read_shift(2);return e.t="n",e.val=s,e}function p4(t,e,s){var r=le(9);return oc(r,t,e),r.write_shift(2,s),r}function g4(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function v4(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function y4(t,e,s){var r=t.l+e,a=da(t),i=t.read_shift(2),l=Bn(t,i,s);return t.l=r,a.t="str",a.val=l,a}var b4=[2,3,48,49,131,139,140,245],q0=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=xd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(c,o){var d=[],f=en(1);switch(o.type){case"base64":f=ur(xr(c));break;case"binary":f=ur(c);break;case"buffer":case"array":f=c;break}Es(f,0);var u=f.read_shift(1),h=!!(u&136),x=!1,m=!1;switch(u){case 2:break;case 3:break;case 48:x=!0,h=!0;break;case 49:x=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,v=521;u==2&&(p=f.read_shift(2)),f.l+=3,u!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(v=f.read_shift(2));var b=f.read_shift(2),_=o.codepage||1252;u!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(_=t[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var g=[],j={},w=Math.min(f.length,u==2?521:v-10-(x?264:0)),k=m?32:11;f.l<w&&f[f.l]!=13;)switch(j={},j.name=Va.utils.decode(_,f.slice(f.l,f.l+k)).replace(/[\u0000\r\n].*$/g,""),f.l+=k,j.type=String.fromCharCode(f.read_shift(1)),u!=2&&!m&&(j.offset=f.read_shift(4)),j.len=f.read_shift(1),u==2&&(j.offset=f.read_shift(2)),j.dec=f.read_shift(1),j.name.length&&g.push(j),u!=2&&(f.l+=m?13:14),j.type){case"B":(!x||j.len!=8)&&o.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(f[f.l]!==13&&(f.l=v-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=v;var y=0,N=0;for(d[0]=[],N=0;N!=g.length;++N)d[0][N]=g[N].name;for(;p-- >0;){if(f[f.l]===42){f.l+=b;continue}for(++f.l,d[++y]=[],N=0,N=0;N!=g.length;++N){var S=f.slice(f.l,f.l+g[N].len);f.l+=g[N].len,Es(S,0);var T=Va.utils.decode(_,S);switch(g[N].type){case"C":T.trim().length&&(d[y][N]=T.replace(/\s+$/,""));break;case"D":T.length===8?d[y][N]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):d[y][N]=T;break;case"F":d[y][N]=parseFloat(T.trim());break;case"+":case"I":d[y][N]=m?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":d[y][N]=!0;break;case"N":case"F":d[y][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));d[y][N]="##MEMO##"+(m?parseInt(T.trim(),10):S.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(d[y][N]=+T||0);break;case"@":d[y][N]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":d[y][N]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":d[y][N]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[y][N]=-S.read_shift(-8,"f");break;case"B":if(x&&g[N].len==8){d[y][N]=S.read_shift(8,"f");break}case"G":case"P":S.l+=g[N].len;break;case"0":if(g[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[N].type)}}}if(u!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),o.DBF=g,d}function r(c,o){var d=o||{};d.dateNF||(d.dateNF="yyyymmdd");var f=Bi(s(c,d),d);return f["!cols"]=d.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete d.DBF,f}function a(c,o){try{return cn(r(c,o),o)}catch(d){if(o&&o.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,o){var d=o||{};if(+d.codepage>=0&&Pr(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var f=lr(),u=Mo(c,{header:1,raw:!0,cellDates:!0}),h=u[0],x=u.slice(1),m=c["!cols"]||[],p=0,v=0,b=0,_=1;for(p=0;p<h.length;++p){if(((m[p]||{}).DBF||{}).name){h[p]=m[p].DBF.name,++b;continue}if(h[p]!=null){if(++b,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(v=0;v<1024;++v)if(h.indexOf(h[p]+"_"+v)==-1){h[p]+="_"+v;break}}}}var g=mt(c["!ref"]),j=[],w=[],k=[];for(p=0;p<=g.e.c-g.s.c;++p){var y="",N="",S=0,T=[];for(v=0;v<x.length;++v)x[v][p]!=null&&T.push(x[v][p]);if(T.length==0||h[p]==null){j[p]="?";continue}for(v=0;v<T.length;++v){switch(typeof T[v]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=T[v]instanceof Date?"D":"C";break;default:N="C"}S=Math.max(S,String(T[v]).length),y=y&&y!=N?"C":N}S>250&&(S=250),N=((m[p]||{}).DBF||{}).type,N=="C"&&m[p].DBF.len>S&&(S=m[p].DBF.len),y=="B"&&N=="N"&&(y="N",k[p]=m[p].DBF.dec,S=m[p].DBF.len),w[p]=y=="C"||N=="N"?S:i[y]||0,_+=w[p],j[p]=y}var E=f.next(32);for(E.write_shift(4,318902576),E.write_shift(4,x.length),E.write_shift(2,296+32*b),E.write_shift(2,_),p=0;p<4;++p)E.write_shift(4,0);for(E.write_shift(4,0|(+e[Ag]||3)<<8),p=0,v=0;p<h.length;++p)if(h[p]!=null){var A=f.next(32),H=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,H,"sbcs"),A.write_shift(1,j[p]=="?"?"C":j[p],"sbcs"),A.write_shift(4,v),A.write_shift(1,w[p]||i[j[p]]||0),A.write_shift(1,k[p]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),v+=w[p]||i[j[p]]||0}var V=f.next(264);for(V.write_shift(4,13),p=0;p<65;++p)V.write_shift(4,0);for(p=0;p<x.length;++p){var L=f.next(_);for(L.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(j[v]){case"L":L.write_shift(1,x[p][v]==null?63:x[p][v]?84:70);break;case"B":L.write_shift(8,x[p][v]||0,"f");break;case"N":var P="0";for(typeof x[p][v]=="number"&&(P=x[p][v].toFixed(k[v]||0)),b=0;b<w[v]-P.length;++b)L.write_shift(1,32);L.write_shift(1,P,"sbcs");break;case"D":x[p][v]?(L.write_shift(4,("0000"+x[p][v].getFullYear()).slice(-4),"sbcs"),L.write_shift(2,("00"+(x[p][v].getMonth()+1)).slice(-2),"sbcs"),L.write_shift(2,("00"+x[p][v].getDate()).slice(-2),"sbcs")):L.write_shift(8,"00000000","sbcs");break;case"C":var J=String(x[p][v]!=null?x[p][v]:"").slice(0,w[v]);for(L.write_shift(1,J,"sbcs"),b=0;b<w[v]-J.length;++b)L.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}}(),V1=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+es(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),s=function(h,x){var m=t[x];return typeof m=="number"?Nh(m):m},r=function(h,x,m){var p=x.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?h:Nh(p)};t["|"]=254;function a(h,x){switch(x.type){case"base64":return i(xr(h),x);case"binary":return i(h,x);case"buffer":return i(it&&Buffer.isBuffer(h)?h.toString("binary"):ln(h),x);case"array":return i(In(h),x)}throw new Error("Unrecognized type "+x.type)}function i(h,x){var m=h.split(/[\n\r]+/),p=-1,v=-1,b=0,_=0,g=[],j=[],w=null,k={},y=[],N=[],S=[],T=0,E;for(+x.codepage>=0&&Pr(+x.codepage);b!==m.length;++b){T=0;var A=m[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,s),H=A.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),V=H[0],L;if(A.length>0)switch(V){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&j.push(A.slice(3).replace(/;;/g,";"));break;case"C":var P=!1,J=!1,Ee=!1,Y=!1,de=-1,De=-1;for(_=1;_<H.length;++_)switch(H[_].charAt(0)){case"A":break;case"X":v=parseInt(H[_].slice(1))-1,J=!0;break;case"Y":for(p=parseInt(H[_].slice(1))-1,J||(v=0),E=g.length;E<=p;++E)g[E]=[];break;case"K":L=H[_].slice(1),L.charAt(0)==='"'?L=L.slice(1,L.length-1):L==="TRUE"?L=!0:L==="FALSE"?L=!1:isNaN(Ur(L))?isNaN(Ei(L).getDate())||(L=Lt(L)):(L=Ur(L),w!==null&&Ii(w)&&(L=gd(L))),P=!0;break;case"E":Y=!0;var B=Ni(H[_].slice(1),{r:p,c:v});g[p][v]=[g[p][v],B];break;case"S":Ee=!0,g[p][v]=[g[p][v],"S5S"];break;case"G":break;case"R":de=parseInt(H[_].slice(1))-1;break;case"C":De=parseInt(H[_].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+A)}if(P&&(g[p][v]&&g[p][v].length==2?g[p][v][0]=L:g[p][v]=L,w=null),Ee){if(Y)throw new Error("SYLK shared formula cannot have own formula");var X=de>-1&&g[de][De];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");g[p][v][1]=lv(X[1],{r:p-de,c:v-De})}break;case"F":var W=0;for(_=1;_<H.length;++_)switch(H[_].charAt(0)){case"X":v=parseInt(H[_].slice(1))-1,++W;break;case"Y":for(p=parseInt(H[_].slice(1))-1,E=g.length;E<=p;++E)g[E]=[];break;case"M":T=parseInt(H[_].slice(1))/20;break;case"F":break;case"G":break;case"P":w=j[parseInt(H[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=H[_].slice(1).split(" "),E=parseInt(S[0],10);E<=parseInt(S[1],10);++E)T=parseInt(S[2],10),N[E-1]=T===0?{hidden:!0}:{wch:T},tn(N[E-1]);break;case"C":v=parseInt(H[_].slice(1))-1,N[v]||(N[v]={});break;case"R":p=parseInt(H[_].slice(1))-1,y[p]||(y[p]={}),T>0?(y[p].hpt=T,y[p].hpx=Ci(T)):T===0&&(y[p].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+A)}W<1&&(w=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+A)}}return y.length>0&&(k["!rows"]=y),N.length>0&&(k["!cols"]=N),x&&x.sheetRows&&(g=g.slice(0,x.sheetRows)),[g,k]}function l(h,x){var m=a(h,x),p=m[0],v=m[1],b=Bi(p,x);return es(v).forEach(function(_){b[_]=v[_]}),b}function c(h,x){return cn(l(h,x),x)}function o(h,x,m,p){var v="C;Y"+(m+1)+";X"+(p+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+ou(h.f,{r:m,c:p}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function d(h,x){x.forEach(function(m,p){var v="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?v+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Dl(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Pl(m.wpx)),typeof m.wch=="number"&&(v+=Math.round(m.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function f(h,x){x.forEach(function(m,p){var v="F;";m.hidden?v+="M0;":m.hpt?v+="M"+20*m.hpt+";":m.hpx&&(v+="M"+20*Ml(m.hpx)+";"),v.length>2&&h.push(v+"R"+(p+1))})}function u(h,x){var m=["ID;PWXL;N;E"],p=[],v=mt(h["!ref"]),b,_=Array.isArray(h),g=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&d(m,h["!cols"]),h["!rows"]&&f(m,h["!rows"]),m.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var j=v.s.r;j<=v.e.r;++j)for(var w=v.s.c;w<=v.e.c;++w){var k=Ye({r:j,c:w});b=_?(h[j]||[])[w]:h[k],!(!b||b.v==null&&(!b.f||b.F))&&p.push(o(b,h,j,w))}return m.join(g)+g+p.join(g)+g+"E"+g}return{to_workbook:c,to_sheet:l,from_sheet:u}}(),z1=function(){function t(i,l){switch(l.type){case"base64":return e(xr(i),l);case"binary":return e(i,l);case"buffer":return e(it&&Buffer.isBuffer(i)?i.toString("binary"):ln(i),l);case"array":return e(In(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){for(var c=i.split(`
`),o=-1,d=-1,f=0,u=[];f!==c.length;++f){if(c[f].trim()==="BOT"){u[++o]=[],d=0;continue}if(!(o<0)){var h=c[f].trim().split(","),x=h[0],m=h[1];++f;for(var p=c[f]||"";(p.match(/["]/g)||[]).length&1&&f<c.length-1;)p+=`
`+c[++f];switch(p=p.trim(),+x){case-1:if(p==="BOT"){u[++o]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[o][d]=!0:p==="FALSE"?u[o][d]=!1:isNaN(Ur(m))?isNaN(Ei(m).getDate())?u[o][d]=m:u[o][d]=Lt(m):u[o][d]=Ur(m),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[o][d++]=p!==""?p:null;break}if(p==="EOD")break}}return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),u}function s(i,l){return Bi(t(i,l),l)}function r(i,l){return cn(s(i,l),l)}var a=function(){var i=function(o,d,f,u,h){o.push(d),o.push(f+","+u),o.push('"'+h.replace(/"/g,'""')+'"')},l=function(o,d,f,u){o.push(d+","+f),o.push(d==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(o){var d=[],f=mt(o["!ref"]),u,h=Array.isArray(o);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,f.e.r-f.s.r+1,""),i(d,"TUPLES",0,f.e.c-f.s.c+1,""),i(d,"DATA",0,0,"");for(var x=f.s.r;x<=f.e.r;++x){l(d,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var p=Ye({r:x,c:m});if(u=h?(o[x]||[])[m]:o[p],!u){l(d,1,0,"");continue}switch(u.t){case"n":var v=u.w;!v&&u.v!=null&&(v=u.v),v==null?u.f&&!u.F?l(d,1,0,"="+u.f):l(d,1,0,""):l(d,0,v,"V");break;case"b":l(d,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=Tr(u.z||Ge[14],vs(Lt(u.v)))),l(d,0,u.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var b=`\r
`,_=d.join(b);return _}}();return{to_workbook:r,to_sheet:s,from_sheet:a}}(),H1=function(){function t(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(u,h){for(var x=u.split(`
`),m=-1,p=-1,v=0,b=[];v!==x.length;++v){var _=x[v].trim().split(":");if(_[0]==="cell"){var g=Kt(_[1]);if(b.length<=g.r)for(m=b.length;m<=g.r;++m)b[m]||(b[m]=[]);switch(m=g.r,p=g.c,_[2]){case"t":b[m][p]=t(_[3]);break;case"v":b[m][p]=+_[3];break;case"vtf":var j=_[_.length-1];case"vtc":switch(_[3]){case"nl":b[m][p]=!!+_[4];break;default:b[m][p]=+_[4];break}_[2]=="vtf"&&(b[m][p]=[b[m][p],j])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function r(u,h){return Bi(s(u,h),h)}function a(u,h){return cn(r(u,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function d(u){if(!u||!u["!ref"])return"";for(var h=[],x=[],m,p="",v=cr(u["!ref"]),b=Array.isArray(u),_=v.s.r;_<=v.e.r;++_)for(var g=v.s.c;g<=v.e.c;++g)if(p=Ye({r:_,c:g}),m=b?(u[_]||[])[g]:u[p],!(!m||m.v==null||m.t==="z")){switch(x=["cell",p,"t"],m.t){case"s":case"str":x.push(e(m.v));break;case"n":m.f?(x[2]="vtf",x[3]="n",x[4]=m.v,x[5]=e(m.f)):(x[2]="v",x[3]=m.v);break;case"b":x[2]="vt"+(m.f?"f":"c"),x[3]="nl",x[4]=m.v?"1":"0",x[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var j=vs(Lt(m.v));x[2]="vtc",x[3]="nd",x[4]=""+j,x[5]=m.w||Tr(m.z||Ge[14],j);break;case"e":continue}h.push(x.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(u){return[i,l,c,l,d(u),o].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:f}}(),Ti=function(){function t(f,u,h,x,m){m.raw?u[h][x]=f:f===""||(f==="TRUE"?u[h][x]=!0:f==="FALSE"?u[h][x]=!1:isNaN(Ur(f))?isNaN(Ei(f).getDate())?u[h][x]=f:u[h][x]=Lt(f):u[h][x]=Ur(f))}function e(f,u){var h=u||{},x=[];if(!f||f.length===0)return x;for(var m=f.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var v=10,b=0,_=0;_<=p;++_)b=m[_].indexOf(" "),b==-1?b=m[_].length:b++,v=Math.max(v,b);for(_=0;_<=p;++_){x[_]=[];var g=0;for(t(m[_].slice(0,v).trim(),x,_,g,h),g=1;g<=(m[_].length-v)/10+1;++g)t(m[_].slice(v+(g-1)*10,v+g*10).trim(),x,_,g,h)}return h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}var s={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(f){for(var u={},h=!1,x=0,m=0;x<f.length;++x)(m=f.charCodeAt(x))==34?h=!h:!h&&m in s&&(u[m]=(u[m]||0)+1);m=[];for(x in u)Object.prototype.hasOwnProperty.call(u,x)&&m.push([u[x],x]);if(!m.length){u=r;for(x in u)Object.prototype.hasOwnProperty.call(u,x)&&m.push([u[x],x])}return m.sort(function(p,v){return p[0]-v[0]||r[p[1]]-r[v[1]]}),s[m.pop()[1]]||44}function i(f,u){var h=u||{},x="",m=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(x=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(x=f.charAt(4),f=f.slice(6)):x=a(f.slice(0,1024)):h&&h.FS?x=h.FS:x=a(f.slice(0,1024));var v=0,b=0,_=0,g=0,j=0,w=x.charCodeAt(0),k=!1,y=0,N=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?lj(h.dateNF):null;function T(){var E=f.slice(g,j),A={};if(E.charAt(0)=='"'&&E.charAt(E.length-1)=='"'&&(E=E.slice(1,-1).replace(/""/g,'"')),E.length===0)A.t="z";else if(h.raw)A.t="s",A.v=E;else if(E.trim().length===0)A.t="s",A.v=E;else if(E.charCodeAt(0)==61)E.charCodeAt(1)==34&&E.charCodeAt(E.length-1)==34?(A.t="s",A.v=E.slice(2,-1).replace(/""/g,'"')):MT(E)?(A.t="n",A.f=E.slice(1)):(A.t="s",A.v=E);else if(E=="TRUE")A.t="b",A.v=!0;else if(E=="FALSE")A.t="b",A.v=!1;else if(!isNaN(_=Ur(E)))A.t="n",h.cellText!==!1&&(A.w=E),A.v=_;else if(!isNaN(Ei(E).getDate())||S&&E.match(S)){A.z=h.dateNF||Ge[14];var H=0;S&&E.match(S)&&(E=cj(E,h.dateNF,E.match(S)||[]),H=1),h.cellDates?(A.t="d",A.v=Lt(E,H)):(A.t="n",A.v=vs(Lt(E,H))),h.cellText!==!1&&(A.w=Tr(A.z,A.v instanceof Date?vs(A.v):A.v)),h.cellNF||delete A.z}else A.t="s",A.v=E;if(A.t=="z"||(h.dense?(m[v]||(m[v]=[]),m[v][b]=A):m[Ye({c:b,r:v})]=A),g=j+1,N=f.charCodeAt(g),p.e.c<b&&(p.e.c=b),p.e.r<v&&(p.e.r=v),y==w)++b;else if(b=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;j<f.length;++j)switch(y=f.charCodeAt(j)){case 34:N===34&&(k=!k);break;case w:case 10:case 13:if(!k&&T())break e;break}return j-g>0&&T(),m["!ref"]=tt(p),m}function l(f,u){return!(u&&u.PRN)||u.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,u):Bi(e(f,u),u)}function c(f,u){var h="",x=u.type=="string"?[0,0,0,0]:gu(f,u);switch(u.type){case"base64":h=xr(f);break;case"binary":h=f;break;case"buffer":u.codepage==65001?h=f.toString("utf8"):u.codepage&&typeof Va<"u"?h=Va.utils.decode(u.codepage,f):h=it&&Buffer.isBuffer(f)?f.toString("binary"):ln(f);break;case"array":h=In(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+u.type)}return x[0]==239&&x[1]==187&&x[2]==191?h=Et(h.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?h=Et(h):u.type=="binary"&&typeof Va<"u"&&u.codepage&&(h=Va.utils.decode(u.codepage,Va.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?H1.to_sheet(u.type=="string"?h:Et(h),u):l(h,u)}function o(f,u){return cn(c(f,u),u)}function d(f){for(var u=[],h=mt(f["!ref"]),x,m=Array.isArray(f),p=h.s.r;p<=h.e.r;++p){for(var v=[],b=h.s.c;b<=h.e.c;++b){var _=Ye({r:p,c:b});if(x=m?(f[p]||[])[b]:f[_],!x||x.v==null){v.push("          ");continue}for(var g=(x.w||(Ta(x),x.w)||"").slice(0,10);g.length<10;)g+=" ";v.push(g+(b===0?" ":""))}u.push(v.join(""))}return u.join(`
`)}return{to_workbook:o,to_sheet:c,from_sheet:d}}();function _4(t,e){var s=e||{},r=!!s.WTF;s.WTF=!0;try{var a=V1.to_workbook(t,s);return s.WTF=r,a}catch(i){if(s.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return Ti.to_workbook(t,e)}}var An=function(){function t(B,X,W){if(B){Es(B,B.l||0);for(var z=W.Enum||de;B.l<B.length;){var ae=B.read_shift(2),me=z[ae]||z[65535],xe=B.read_shift(2),ue=B.l+xe,oe=me.f&&me.f(B,xe,W);if(B.l=ue,X(oe,me,ae))return}}}function e(B,X){switch(X.type){case"base64":return s(ur(xr(B)),X);case"binary":return s(ur(B),X);case"buffer":case"array":return s(B,X)}throw"Unsupported type "+X.type}function s(B,X){if(!B)return B;var W=X||{},z=W.dense?[]:{},ae="Sheet1",me="",xe=0,ue={},oe=[],ze=[],F={s:{r:0,c:0},e:{r:0,c:0}},ye=W.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)W.Enum=de,t(B,function(Z,Oe,Te){switch(Te){case 0:W.vers=Z,Z>=4096&&(W.qpro=!0);break;case 6:F=Z;break;case 204:Z&&(me=Z);break;case 222:me=Z;break;case 15:case 51:W.qpro||(Z[1].v=Z[1].v.slice(1));case 13:case 14:case 16:Te==14&&(Z[2]&112)==112&&(Z[2]&15)>1&&(Z[2]&15)<15&&(Z[1].z=W.dateNF||Ge[14],W.cellDates&&(Z[1].t="d",Z[1].v=gd(Z[1].v))),W.qpro&&Z[3]>xe&&(z["!ref"]=tt(F),ue[ae]=z,oe.push(ae),z=W.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},xe=Z[3],ae=me||"Sheet"+(xe+1),me="");var M=W.dense?(z[Z[0].r]||[])[Z[0].c]:z[Ye(Z[0])];if(M){M.t=Z[1].t,M.v=Z[1].v,Z[1].z!=null&&(M.z=Z[1].z),Z[1].f!=null&&(M.f=Z[1].f);break}W.dense?(z[Z[0].r]||(z[Z[0].r]=[]),z[Z[0].r][Z[0].c]=Z[1]):z[Ye(Z[0])]=Z[1];break}},W);else if(B[2]==26||B[2]==14)W.Enum=De,B[2]==14&&(W.qpro=!0,B.l=0),t(B,function(Z,Oe,Te){switch(Te){case 204:ae=Z;break;case 22:Z[1].v=Z[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Z[3]>xe&&(z["!ref"]=tt(F),ue[ae]=z,oe.push(ae),z=W.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},xe=Z[3],ae="Sheet"+(xe+1)),ye>0&&Z[0].r>=ye)break;W.dense?(z[Z[0].r]||(z[Z[0].r]=[]),z[Z[0].r][Z[0].c]=Z[1]):z[Ye(Z[0])]=Z[1],F.e.c<Z[0].c&&(F.e.c=Z[0].c),F.e.r<Z[0].r&&(F.e.r=Z[0].r);break;case 27:Z[14e3]&&(ze[Z[14e3][0]]=Z[14e3][1]);break;case 1537:ze[Z[0]]=Z[1],Z[0]==xe&&(ae=Z[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(z["!ref"]=tt(F),ue[me||ae]=z,oe.push(me||ae),!ze.length)return{SheetNames:oe,Sheets:ue};for(var Ie={},Le=[],K=0;K<ze.length;++K)ue[oe[K]]?(Le.push(ze[K]||oe[K]),Ie[ze[K]]=ue[ze[K]]||ue[oe[K]]):(Le.push(ze[K]),Ie[ze[K]]={"!ref":"A1"});return{SheetNames:Le,Sheets:Ie}}function r(B,X){var W=X||{};if(+W.codepage>=0&&Pr(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var z=lr(),ae=mt(B["!ref"]),me=Array.isArray(B),xe=[];Se(z,0,i(1030)),Se(z,6,o(ae));for(var ue=Math.min(ae.e.r,8191),oe=ae.s.r;oe<=ue;++oe)for(var ze=is(oe),F=ae.s.c;F<=ae.e.c;++F){oe===ae.s.r&&(xe[F]=Yt(F));var ye=xe[F]+ze,Ie=me?(B[oe]||[])[F]:B[ye];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")(Ie.v|0)==Ie.v&&Ie.v>=-32768&&Ie.v<=32767?Se(z,13,x(oe,F,Ie.v)):Se(z,14,p(oe,F,Ie.v));else{var Le=Ta(Ie);Se(z,15,u(oe,F,Le.slice(0,239)))}}return Se(z,1),z.end()}function a(B,X){var W=X||{};if(+W.codepage>=0&&Pr(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var z=lr();Se(z,0,l(B));for(var ae=0,me=0;ae<B.SheetNames.length;++ae)(B.Sheets[B.SheetNames[ae]]||{})["!ref"]&&Se(z,27,Y(B.SheetNames[ae],me++));var xe=0;for(ae=0;ae<B.SheetNames.length;++ae){var ue=B.Sheets[B.SheetNames[ae]];if(!(!ue||!ue["!ref"])){for(var oe=mt(ue["!ref"]),ze=Array.isArray(ue),F=[],ye=Math.min(oe.e.r,8191),Ie=oe.s.r;Ie<=ye;++Ie)for(var Le=is(Ie),K=oe.s.c;K<=oe.e.c;++K){Ie===oe.s.r&&(F[K]=Yt(K));var Z=F[K]+Le,Oe=ze?(ue[Ie]||[])[K]:ue[Z];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")Se(z,23,T(Ie,K,xe,Oe.v));else{var Te=Ta(Oe);Se(z,22,y(Ie,K,xe,Te.slice(0,239)))}}++xe}}return Se(z,1),z.end()}function i(B){var X=le(2);return X.write_shift(2,B),X}function l(B){var X=le(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var W=0,z=0,ae=0,me=0;me<B.SheetNames.length;++me){var xe=B.SheetNames[me],ue=B.Sheets[xe];if(!(!ue||!ue["!ref"])){++ae;var oe=cr(ue["!ref"]);W<oe.e.r&&(W=oe.e.r),z<oe.e.c&&(z=oe.e.c)}}return W>8191&&(W=8191),X.write_shift(2,W),X.write_shift(1,ae),X.write_shift(1,z),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function c(B,X,W){var z={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&W.qpro?(z.s.c=B.read_shift(1),B.l++,z.s.r=B.read_shift(2),z.e.c=B.read_shift(1),B.l++,z.e.r=B.read_shift(2),z):(z.s.c=B.read_shift(2),z.s.r=B.read_shift(2),X==12&&W.qpro&&(B.l+=2),z.e.c=B.read_shift(2),z.e.r=B.read_shift(2),X==12&&W.qpro&&(B.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function o(B){var X=le(8);return X.write_shift(2,B.s.c),X.write_shift(2,B.s.r),X.write_shift(2,B.e.c),X.write_shift(2,B.e.r),X}function d(B,X,W){var z=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(z[0].c=B.read_shift(1),z[3]=B.read_shift(1),z[0].r=B.read_shift(2),B.l+=2):(z[2]=B.read_shift(1),z[0].c=B.read_shift(2),z[0].r=B.read_shift(2)),z}function f(B,X,W){var z=B.l+X,ae=d(B,X,W);if(ae[1].t="s",W.vers==20768){B.l++;var me=B.read_shift(1);return ae[1].v=B.read_shift(me,"utf8"),ae}return W.qpro&&B.l++,ae[1].v=B.read_shift(z-B.l,"cstr"),ae}function u(B,X,W){var z=le(7+W.length);z.write_shift(1,255),z.write_shift(2,X),z.write_shift(2,B),z.write_shift(1,39);for(var ae=0;ae<z.length;++ae){var me=W.charCodeAt(ae);z.write_shift(1,me>=128?95:me)}return z.write_shift(1,0),z}function h(B,X,W){var z=d(B,X,W);return z[1].v=B.read_shift(2,"i"),z}function x(B,X,W){var z=le(7);return z.write_shift(1,255),z.write_shift(2,X),z.write_shift(2,B),z.write_shift(2,W,"i"),z}function m(B,X,W){var z=d(B,X,W);return z[1].v=B.read_shift(8,"f"),z}function p(B,X,W){var z=le(13);return z.write_shift(1,255),z.write_shift(2,X),z.write_shift(2,B),z.write_shift(8,W,"f"),z}function v(B,X,W){var z=B.l+X,ae=d(B,X,W);if(ae[1].v=B.read_shift(8,"f"),W.qpro)B.l=z;else{var me=B.read_shift(2);j(B.slice(B.l,B.l+me),ae),B.l+=me}return ae}function b(B,X,W){var z=X&32768;return X&=-32769,X=(z?B:0)+(X>=8192?X-16384:X),(z?"":"$")+(W?Yt(X):is(X))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(B,X){Es(B,0);for(var W=[],z=0,ae="",me="",xe="",ue="";B.l<B.length;){var oe=B[B.l++];switch(oe){case 0:W.push(B.read_shift(8,"f"));break;case 1:me=b(X[0].c,B.read_shift(2),!0),ae=b(X[0].r,B.read_shift(2),!1),W.push(me+ae);break;case 2:{var ze=b(X[0].c,B.read_shift(2),!0),F=b(X[0].r,B.read_shift(2),!1);me=b(X[0].c,B.read_shift(2),!0),ae=b(X[0].r,B.read_shift(2),!1),W.push(ze+F+":"+me+ae)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(B.read_shift(2));break;case 6:{for(var ye="";oe=B[B.l++];)ye+=String.fromCharCode(oe);W.push('"'+ye.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:ue=W.pop(),xe=W.pop(),W.push(["AND","OR"][oe-20]+"("+xe+","+ue+")");break;default:if(oe<32&&g[oe])ue=W.pop(),xe=W.pop(),W.push(xe+g[oe]+ue);else if(_[oe]){if(z=_[oe][1],z==69&&(z=B[B.l++]),z>W.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+W.join("|")+"|");return}var Ie=W.slice(-z);W.length-=z,W.push(_[oe][0]+"("+Ie.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}W.length==1?X[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function w(B){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=B.read_shift(2),X[3]=B[B.l++],X[0].c=B[B.l++],X}function k(B,X){var W=w(B);return W[1].t="s",W[1].v=B.read_shift(X-4,"cstr"),W}function y(B,X,W,z){var ae=le(6+z.length);ae.write_shift(2,B),ae.write_shift(1,W),ae.write_shift(1,X),ae.write_shift(1,39);for(var me=0;me<z.length;++me){var xe=z.charCodeAt(me);ae.write_shift(1,xe>=128?95:xe)}return ae.write_shift(1,0),ae}function N(B,X){var W=w(B);W[1].v=B.read_shift(2);var z=W[1].v>>1;if(W[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return W[1].v=z,W}function S(B,X){var W=w(B),z=B.read_shift(4),ae=B.read_shift(4),me=B.read_shift(2);if(me==65535)return z===0&&ae===3221225472?(W[1].t="e",W[1].v=15):z===0&&ae===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var xe=me&32768;return me=(me&32767)-16446,W[1].v=(1-xe*2)*(ae*Math.pow(2,me+32)+z*Math.pow(2,me)),W}function T(B,X,W,z){var ae=le(14);if(ae.write_shift(2,B),ae.write_shift(1,W),ae.write_shift(1,X),z==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var me=0,xe=0,ue=0,oe=0;return z<0&&(me=1,z=-z),xe=Math.log2(z)|0,z/=Math.pow(2,xe-31),oe=z>>>0,oe&2147483648||(z/=2,++xe,oe=z>>>0),z-=oe,oe|=2147483648,oe>>>=0,z*=Math.pow(2,32),ue=z>>>0,ae.write_shift(4,ue),ae.write_shift(4,oe),xe+=16383+(me?32768:0),ae.write_shift(2,xe),ae}function E(B,X){var W=S(B);return B.l+=X-14,W}function A(B,X){var W=w(B),z=B.read_shift(4);return W[1].v=z>>6,W}function H(B,X){var W=w(B),z=B.read_shift(8,"f");return W[1].v=z,W}function V(B,X){var W=H(B);return B.l+=X-10,W}function L(B,X){return B[B.l+X-1]==0?B.read_shift(X,"cstr"):""}function P(B,X){var W=B[B.l++];W>X-1&&(W=X-1);for(var z="";z.length<W;)z+=String.fromCharCode(B[B.l++]);return z}function J(B,X,W){if(!(!W.qpro||X<21)){var z=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ae=B.read_shift(X-21,"cstr");return[z,ae]}}function Ee(B,X){for(var W={},z=B.l+X;B.l<z;){var ae=B.read_shift(2);if(ae==14e3){for(W[ae]=[0,""],W[ae][0]=B.read_shift(2);B[B.l];)W[ae][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return W}function Y(B,X){var W=le(5+B.length);W.write_shift(2,14e3),W.write_shift(2,X);for(var z=0;z<B.length;++z){var ae=B.charCodeAt(z);W[W.l++]=ae>127?95:ae}return W[W.l++]=0,W}var de={0:{n:"BOF",f:hs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:L},222:{n:"SHEETNAMELP",f:P},65535:{n:""}},De={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:E},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:V},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:L},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}();function w4(t){var e={},s=t.match(Vs),r=0,a=!1;if(s)for(;r!=s.length;++r){var i=Je(s[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Pf[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var N4=function(){var t=Tl("t"),e=Tl("rPr");function s(i){var l=i.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:ft(l[1])},o=i.match(e);return o&&(c.s=w4(o[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(s).filter(function(c){return c.v})}}(),j4=function(){var e=/(\r\n|\n)/g;function s(a,i,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),l.push("</b>")),a.i&&(i.push("<i>"),l.push("</i>")),a.strike&&(i.push("<s>"),l.push("</s>"));var o=a.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(i.push("<"+o+">"),l.push("</"+o+">")),l.push("</span>"),a}function r(a){var i=[[],a.v,[]];return a.v?(a.s&&s(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(r).join("")}}(),k4=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,S4=/<(?:\w+:)?r>/,E4=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function au(t,e){var s=e?e.cellHTML:!0,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=ft(Et(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Et(t),s&&(r.h=zf(r.t))):t.match(S4)&&(r.r=Et(t),r.t=ft(Et((t.replace(E4,"").match(k4)||[]).join("").replace(Vs,""))),s&&(r.h=j4(N4(r.r)))),r):{t:""}}var T4=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,C4=/<(?:\w+:)?(?:si|sstItem)>/g,A4=/<\/(?:\w+:)?(?:si|sstItem)>/;function F4(t,e){var s=[],r="";if(!t)return s;var a=t.match(T4);if(a){r=a[2].replace(C4,"").split(A4);for(var i=0;i!=r.length;++i){var l=au(r[i].trim(),e);l!=null&&(s[s.length]=l)}a=Je(a[1]),s.Count=a.count,s.Unique=a.uniqueCount}return s}var O4=/^\s|\s$|[\t\n\r]/;function G1(t,e){if(!e.bookSST)return"";var s=[ls];s[s.length]=ke("sst",null,{xmlns:Xn[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(t[r]!=null){var a=t[r],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(O4)&&(i+=' xml:space="preserve"'),i+=">"+kt(a.t)+"</t>"),i+="</si>",s[s.length]=i}return s.length>2&&(s[s.length]="</sst>",s[1]=s[1].replace("/>",">")),s.join("")}function D4(t){return[t.read_shift(4),t.read_shift(4)]}function P4(t,e){var s=[],r=!1;return Pa(t,function(i,l,c){switch(c){case 159:s.Count=i[0],s.Unique=i[1];break;case 19:s.push(i);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),s}function M4(t,e){return e||(e=le(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var R4=Gj;function I4(t){var e=lr();he(e,159,M4(t));for(var s=0;s<t.length;++s)he(e,19,R4(t[s]));return he(e,160),e.end()}function X1(t){for(var e=[],s=t.split(""),r=0;r<s.length;++r)e[r]=s[r].charCodeAt(0);return e}function Ea(t,e){var s={};return s.Major=t.read_shift(2),s.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),s}function L4(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ea(t,4),e.U=Ea(t,4),e.W=Ea(t,4),e}function B4(t){for(var e=t.read_shift(4),s=t.l+e-4,r={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=i,t.l!=s)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+s);return r}function U4(t){var e=[];t.l+=4;for(var s=t.read_shift(4);s-- >0;)e.push(B4(t));return e}function $4(t){var e=[];t.l+=4;for(var s=t.read_shift(4);s-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function W4(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ea(t,4),e.U=Ea(t,4),e.W=Ea(t,4),e}function V4(t){var e=W4(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function q1(t,e){var s=t.l+e,r={};r.Flags=t.read_shift(4)&63,t.l+=4,r.AlgID=t.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(s-t.l>>1,"utf16le"),t.l=s,r}function Y1(t,e){var s={},r=t.l+e;return t.l+=4,s.Salt=t.slice(t.l,t.l+16),t.l+=16,s.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),s.VerifierHash=t.slice(t.l,r),t.l=r,s}function z4(t){var e=Ea(t);switch(e.Minor){case 2:return[e.Minor,H4(t)];case 3:return[e.Minor,G4()];case 4:return[e.Minor,X4(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function H4(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var s=t.read_shift(4),r=q1(t,s),a=Y1(t,t.length-t.l);return{t:"Std",h:r,v:a}}function G4(){throw new Error("File is password-protected: ECMA-376 Extensible")}function X4(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var s=t.read_shift(t.length-t.l,"utf8"),r={};return s.replace(Vs,function(i){var l=Je(i);switch(oa(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function q4(t,e){var s={},r=s.EncryptionVersionInfo=Ea(t,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);s.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,s.EncryptionHeader=q1(t,a),e-=a,s.EncryptionVerifier=Y1(t,e),s}function Y4(t){var e={},s=e.EncryptionVersionInfo=Ea(t,4);if(s.Major!=1||s.Minor!=1)throw"unrecognized version code "+s.Major+" : "+s.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function nu(t){var e=0,s,r=X1(t),a=r.length+1,i,l,c,o,d;for(s=en(a),s[0]=r.length,i=1;i!=a;++i)s[i]=r[i-1];for(i=a-1;i>=0;--i)l=s[i],c=e&16384?1:0,o=e<<1&32767,d=c|o,e=d^l;return e^52811}var K1=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],s=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},i=function(l){for(var c=e[l.length-1],o=104,d=l.length-1;d>=0;--d)for(var f=l[d],u=0;u!=7;++u)f&64&&(c^=s[o]),f*=2,--o;return c};return function(l){for(var c=X1(l),o=i(c),d=c.length,f=en(16),u=0;u!=16;++u)f[u]=0;var h,x,m;for((d&1)===1&&(h=o>>8,f[d]=a(t[0],h),--d,h=o&255,x=c[c.length-1],f[d]=a(x,h));d>0;)--d,h=o>>8,f[d]=a(c[d],h),--d,h=o&255,f[d]=a(c[d],h);for(d=15,m=15-c.length;m>0;)h=o>>8,f[d]=a(t[m],h),--d,--m,h=o&255,f[d]=a(c[d],h),--d,--m;return f}}(),K4=function(t,e,s,r,a){a||(a=e),r||(r=K1(t));var i,l;for(i=0;i!=e.length;++i)l=e[i],l^=r[s],l=(l>>5|l<<3)&255,a[i]=l,++s;return[a,s,r]},J4=function(t){var e=0,s=K1(t);return function(r){var a=K4("",r,e,s);return e=a[1],a[0]}};function Z4(t,e,s,r){var a={key:hs(t),verificationBytes:hs(t)};return s.password&&(a.verifier=nu(s.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=J4(s.password)),a}function Q4(t,e,s){var r=s||{};return r.Info=t.read_shift(2),t.l-=2,r.Info===1?r.Data=Y4(t):r.Data=q4(t,e),r}function eE(t,e,s){var r={Type:s.biff>=8?t.read_shift(2):0};return r.Type?Q4(t,e-2,r):Z4(t,s.biff>=8?e:e-2,s,r),r}var J1=function(){function t(a,i){switch(i.type){case"base64":return e(xr(a),i);case"binary":return e(a,i);case"buffer":return e(it&&Buffer.isBuffer(a)?a.toString("binary"):ln(a),i);case"array":return e(In(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var l=i||{},c=l.dense?[]:{},o=a.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(f,u){Array.isArray(c)&&(c[u]=[]);for(var h=/\\\w+\b/g,x=0,m,p=-1;m=h.exec(f);){switch(m[0]){case"\\cell":var v=f.slice(x,h.lastIndex-m[0].length);if(v[0]==" "&&(v=v.slice(1)),++p,v.length){var b={v,t:"s"};Array.isArray(c)?c[u][p]=b:c[Ye({r:u,c:p})]=b}break}x=h.lastIndex}p>d.e.c&&(d.e.c=p)}),c["!ref"]=tt(d),c}function s(a,i){return cn(t(a,i),i)}function r(a){for(var i=["{\\rtf1\\ansi"],l=mt(a["!ref"]),c,o=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var f=l.s.c;f<=l.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=l.s.c;f<=l.e.c;++f){var u=Ye({r:d,c:f});c=o?(a[d]||[])[f]:a[u],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Ta(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:s,to_sheet:t,from_sheet:r}}();function tE(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Ol(t){for(var e=0,s=1;e!=3;++e)s=s*256+(t[e]>255?255:t[e]<0?0:t[e]);return s.toString(16).toUpperCase().slice(1)}function sE(t){var e=t[0]/255,s=t[1]/255,r=t[2]/255,a=Math.max(e,s,r),i=Math.min(e,s,r),l=a-i;if(l===0)return[0,0,e];var c=0,o=0,d=a+i;switch(o=l/(d>1?2-d:d),a){case e:c=((s-r)/l+6)%6;break;case s:c=(r-e)/l+2;break;case r:c=(e-s)/l+4;break}return[c/6,o,d/2]}function rE(t){var e=t[0],s=t[1],r=t[2],a=s*2*(r<.5?r:1-r),i=r-a/2,l=[i,i,i],c=6*e,o;if(s!==0)switch(c|0){case 0:case 6:o=a*c,l[0]+=a,l[1]+=o;break;case 1:o=a*(2-c),l[0]+=o,l[1]+=a;break;case 2:o=a*(c-2),l[1]+=a,l[2]+=o;break;case 3:o=a*(4-c),l[1]+=o,l[2]+=a;break;case 4:o=a*(c-4),l[2]+=a,l[0]+=o;break;case 5:o=a*(6-c),l[2]+=o,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function Do(t,e){if(e===0)return t;var s=sE(tE(t));return e<0?s[2]=s[2]*(1+e):s[2]=1-(1-s[2])*(1-e),Ol(rE(s))}var Z1=6,aE=15,nE=1,Rs=Z1;function Dl(t){return Math.floor((t+Math.round(128/Rs)/256)*Rs)}function Pl(t){return Math.floor((t-5)/Rs*100+.5)/100}function Po(t){return Math.round((t*Rs+5)/Rs*256)/256}function s0(t){return Po(Pl(Dl(t)))}function iu(t){var e=Math.abs(t-s0(t)),s=Rs;if(e>.005)for(Rs=nE;Rs<aE;++Rs)Math.abs(t-s0(t))<=e&&(e=Math.abs(t-s0(t)),s=Rs);Rs=s}function tn(t){t.width?(t.wpx=Dl(t.width),t.wch=Pl(t.wpx),t.MDW=Rs):t.wpx?(t.wch=Pl(t.wpx),t.width=Po(t.wch),t.MDW=Rs):typeof t.wch=="number"&&(t.width=Po(t.wch),t.wpx=Dl(t.width),t.MDW=Rs),t.customWidth&&delete t.customWidth}var iE=96,Q1=iE;function Ml(t){return t*96/Q1}function Ci(t){return t*Q1/96}var lE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function cE(t,e,s,r){e.Borders=[];var a={},i=!1;(t[0].match(Vs)||[]).forEach(function(l){var c=Je(l);switch(oa(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Dt(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Dt(c.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function oE(t,e,s,r){e.Fills=[];var a={},i=!1;(t[0].match(Vs)||[]).forEach(function(l){var c=Je(l);switch(oa(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function dE(t,e,s,r){e.Fonts=[];var a={},i=!1;(t[0].match(Vs)||[]).forEach(function(l){var c=Je(l);switch(oa(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Et(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Dt(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Dt(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Dt(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Dt(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Dt(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Dt(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Dt(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Pf[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Dt(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var o=Tn[a.color.index];a.color.index==81&&(o=Tn[1]),o||(o=Tn[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&s.themeElements&&s.themeElements.clrScheme&&(a.color.rgb=Do(s.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function fE(t,e,s){e.NumberFmt=[];for(var r=es(Ge),a=0;a<r.length;++a)e.NumberFmt[r[a]]=Ge[r[a]];var i=t[0].match(Vs);if(i)for(a=0;a<i.length;++a){var l=Je(i[a]);switch(oa(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=ft(Et(l.formatCode)),o=parseInt(l.numFmtId,10);if(e.NumberFmt[o]=c,o>0){if(o>392){for(o=392;o>60&&e.NumberFmt[o]!=null;--o);e.NumberFmt[o]=c}Sa(c,o)}}break;case"</numFmt>":break;default:if(s.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function uE(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var r=s[0];r<=s[1];++r)t[r]!=null&&(e[e.length]=ke("numFmt",null,{numFmtId:r,formatCode:kt(t[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ke("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Nc=["numFmtId","fillId","fontId","borderId","xfId"],jc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hE(t,e,s){e.CellXf=[];var r,a=!1;(t[0].match(Vs)||[]).forEach(function(i){var l=Je(i),c=0;switch(oa(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<Nc.length;++c)r[Nc[c]]&&(r[Nc[c]]=parseInt(r[Nc[c]],10));for(c=0;c<jc.length;++c)r[jc[c]]&&(r[jc[c]]=Dt(r[jc[c]]));if(e.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[c]){r.numFmtId=c;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};l.vertical&&(o.vertical=l.vertical),l.horizontal&&(o.horizontal=l.horizontal),l.textRotation!=null&&(o.textRotation=l.textRotation),l.indent&&(o.indent=l.indent),l.wrapText&&(o.wrapText=Dt(l.wrapText)),r.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s&&s.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function mE(t){var e=[];return e[e.length]=ke("cellXfs",null),t.forEach(function(s){e[e.length]=ke("xf",null,s)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ke("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var xE=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,s=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,o,d){var f={};if(!c)return f;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=c.match(e))&&fE(u,f,d),(u=c.match(a))&&dE(u,f,o,d),(u=c.match(r))&&oE(u,f,o,d),(u=c.match(i))&&cE(u,f,o,d),(u=c.match(s))&&hE(u,f,d),f}}();function ev(t,e){var s=[ls,ke("styleSheet",null,{xmlns:Xn[0],"xmlns:vt":xs.vt})],r;return t.SSF&&(r=uE(t.SSF))!=null&&(s[s.length]=r),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=mE(e.cellXfs))&&(s[s.length]=r),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',s.length>2&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function pE(t,e){var s=t.read_shift(2),r=Us(t);return[s,r]}function gE(t,e,s){s||(s=le(6+4*e.length)),s.write_shift(2,t),js(e,s);var r=s.length>s.l?s.slice(0,s.l):s;return s.l==null&&(s.l=s.length),r}function vE(t,e,s){var r={};r.sz=t.read_shift(2)/20;var a=Qj(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var i=t.read_shift(2);switch(i===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(r.underline=l);var c=t.read_shift(1);c>0&&(r.family=c);var o=t.read_shift(1);switch(o>0&&(r.charset=o),t.l++,r.color=Zj(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Us(t),r}function yE(t,e){e||(e=le(25+4*32)),e.write_shift(2,t.sz*20),ek(t,e),e.write_shift(2,t.bold?700:400);var s=0;t.vertAlign=="superscript"?s=1:t.vertAlign=="subscript"&&(s=2),e.write_shift(2,s),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Ao(t.color,e);var r=0;return t.scheme=="major"&&(r=1),t.scheme=="minor"&&(r=2),e.write_shift(1,r),js(t.name,e),e.length>e.l?e.slice(0,e.l):e}var bE=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],r0,_E=$s;function hm(t,e){e||(e=le(4*3+8*7+16*1)),r0||(r0=xd(bE));var s=r0[t.patternType];s==null&&(s=40),e.write_shift(4,s);var r=0;if(s!=40)for(Ao({auto:1},e),Ao({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function wE(t,e){var s=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=s,{ixfe:r,numFmtId:a}}function tv(t,e,s){s||(s=le(16)),s.write_shift(2,e||0),s.write_shift(2,t.numFmtId||0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);var r=0;return s.write_shift(1,r),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(1,0),s}function Xi(t,e){return e||(e=le(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var NE=$s;function jE(t,e){return e||(e=le(51)),e.write_shift(1,0),Xi(null,e),Xi(null,e),Xi(null,e),Xi(null,e),Xi(null,e),e.length>e.l?e.slice(0,e.l):e}function kE(t,e){return e||(e=le(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),Co(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function SE(t,e,s){var r=le(2052);return r.write_shift(4,t),Co(e,r),Co(s,r),r.length>r.l?r.slice(0,r.l):r}function EE(t,e,s){var r={};r.NumberFmt=[];for(var a in Ge)r.NumberFmt[a]=Ge[a];r.CellXf=[],r.Fonts=[];var i=[],l=!1;return Pa(t,function(o,d,f){switch(f){case 44:r.NumberFmt[o[0]]=o[1],Sa(o[1],o[0]);break;case 43:r.Fonts.push(o),o.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(o.color.rgb=Do(e.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&r.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(f),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(f);else if(d.T<0)i.pop();else if(!l||s.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),r}function TE(t,e){if(e){var s=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&++s}),s!=0&&(he(t,615,$r(s)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&he(t,44,gE(a,e[a]))}),he(t,616))}}function CE(t){var e=1;he(t,611,$r(e)),he(t,43,yE({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),he(t,612)}function AE(t){var e=2;he(t,603,$r(e)),he(t,45,hm({patternType:"none"})),he(t,45,hm({patternType:"gray125"})),he(t,604)}function FE(t){var e=1;he(t,613,$r(e)),he(t,46,jE()),he(t,614)}function OE(t){var e=1;he(t,626,$r(e)),he(t,47,tv({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),he(t,627)}function DE(t,e){he(t,617,$r(e.length)),e.forEach(function(s){he(t,47,tv(s,0))}),he(t,618)}function PE(t){var e=1;he(t,619,$r(e)),he(t,48,kE({xfId:0,builtinId:0,name:"Normal"})),he(t,620)}function ME(t){var e=0;he(t,505,$r(e)),he(t,506)}function RE(t){var e=0;he(t,508,SE(e,"TableStyleMedium9","PivotStyleMedium4")),he(t,509)}function IE(t,e){var s=lr();return he(s,278),TE(s,t.SSF),CE(s),AE(s),FE(s),OE(s),DE(s,e.cellXfs),PE(s),ME(s),RE(s),he(s,279),s.end()}var LE=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function BE(t,e,s){e.themeElements.clrScheme=[];var r={};(t[0].match(Vs)||[]).forEach(function(a){var i=Je(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[LE.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(s&&s.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function UE(){}function $E(){}var WE=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,VE=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,zE=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function HE(t,e,s){e.themeElements={};var r;[["clrScheme",WE,BE],["fontScheme",VE,UE],["fmtScheme",zE,$E]].forEach(function(a){if(!(r=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,e,s)})}var GE=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function sv(t,e){(!t||t.length===0)&&(t=lu());var s,r={};if(!(s=t.match(GE)))throw new Error("themeElements not found in theme");return HE(s[0],r,e),r.raw=t,r}function lu(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var s=[ls];return s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join("")}function XE(t,e,s){var r=t.l+e,a=t.read_shift(4);if(a!==124226){if(!s.cellStyles){t.l=r;return}var i=t.slice(t.l);t.l=r;var l;try{l=qg(i,{type:"array"})}catch{return}var c=hr(l,"theme/theme/theme1.xml",!0);if(c)return sv(c,s)}}function qE(t){return t.read_shift(4)}function YE(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=KE(t,4);break;case 2:e.xclrValue=M1(t);break;case 3:e.xclrValue=qE(t);break;case 4:t.l+=4;break}return t.l+=8,e}function KE(t,e){return $s(t,e)}function JE(t,e){return $s(t,e)}function ZE(t){var e=t.read_shift(2),s=t.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=YE(t);break;case 6:r[1]=JE(t,s);break;case 14:case 15:r[1]=t.read_shift(s===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+s)}return r}function QE(t,e){var s=t.l+e;t.l+=2;var r=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(ZE(t,s-t.l));return{ixfe:r,ext:i}}function eT(t,e){e.forEach(function(s){switch(s[0]){}})}function tT(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Us(t)}}function sT(t){var e=le(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),js(t.name,e),e.slice(0,e.l)}function rT(t){for(var e=[],s=t.read_shift(4);s-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function aT(t){var e=le(4+8*t.length);e.write_shift(4,t.length);for(var s=0;s<t.length;++s)e.write_shift(4,t[s][0]),e.write_shift(4,t[s][1]);return e}function nT(t,e){var s=le(8+2*e.length);return s.write_shift(4,t),js(e,s),s.slice(0,s.l)}function iT(t){return t.l+=4,t.read_shift(4)!=0}function lT(t,e){var s=le(8);return s.write_shift(4,t),s.write_shift(4,e?1:0),s}function cT(t,e,s){var r={Types:[],Cell:[],Value:[]},a=s||{},i=[],l=!1,c=2;return Pa(t,function(o,d,f){switch(f){case 335:r.Types.push({name:o.name});break;case 51:o.forEach(function(u){c==1?r.Cell.push({type:r.Types[u[0]-1].name,index:u[1]}):c==0&&r.Value.push({type:r.Types[u[0]-1].name,index:u[1]})});break;case 337:c=o?1:0;break;case 338:c=2;break;case 35:i.push(f),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function oT(){var t=lr();return he(t,332),he(t,334,$r(1)),he(t,335,sT({name:"XLDAPR",version:12e4,flags:3496657072})),he(t,336),he(t,339,nT(1,"XLDAPR")),he(t,52),he(t,35,$r(514)),he(t,4096,$r(0)),he(t,4097,wr(1)),he(t,36),he(t,53),he(t,340),he(t,337,lT(1,!0)),he(t,51,aT([[1,0]])),he(t,338),he(t,333),t.end()}function dT(t,e,s){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var a=!1,i=2,l;return t.replace(Vs,function(c){var o=Je(c);switch(oa(o[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:o.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<r.Types.length;++d)r.Types[d].name==o.name&&(l=r.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?r.Cell.push({type:r.Types[o.t-1].name,index:+o.v}):i==0&&r.Value.push({type:r.Types[o.t-1].name,index:+o.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+o.i);break;default:if(!a&&s.WTF)throw new Error("unrecognized "+o[0]+" in metadata")}return c}),r}function rv(){var t=[ls];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function fT(t){var e=[];if(!t)return e;var s=1;return(t.match(Vs)||[]).forEach(function(r){var a=Je(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?s=a.i:a.i=s,e.push(a);break}}),e}function uT(t){var e={};e.i=t.read_shift(4);var s={};s.r=t.read_shift(4),s.c=t.read_shift(4),e.r=Ye(s);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function hT(t,e,s){var r=[];return Pa(t,function(i,l,c){switch(c){case 63:r.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function mT(t,e,s,r){if(!t)return t;var a=r||{},i=!1;Pa(t,function(c,o,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!o.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function xT(t,e){if(!t)return"??";var s=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][s].Target}var mi=1024;function av(t,e){for(var s=[21600,21600],r=["m0,0l0",s[1],s[0],s[1],s[0],"0xe"].join(","),a=[ke("xml",null,{"xmlns:v":dr.v,"xmlns:o":dr.o,"xmlns:x":dr.x,"xmlns:mv":dr.mv}).replace(/\/>/,">"),ke("o:shapelayout",ke("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ke("v:shapetype",[ke("v:stroke",null,{joinstyle:"miter"}),ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:s.join(","),path:r})];mi<t*1e3;)mi+=1e3;return e.forEach(function(i){var l=Kt(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var o=c.type=="gradient"?ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=ke("v:fill",o,c),f={on:"t",obscured:"t"};++mi,a=a.concat(["<v:shape"+Cl({id:"_x0000_s"+mi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,ke("v:shadow",null,f),ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ts("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Ts("x:AutoFill","False"),Ts("x:Row",String(l.r)),Ts("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function mm(t,e,s,r){var a=Array.isArray(t),i;e.forEach(function(l){var c=Kt(l.ref);if(a?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[l.ref],!i){i={t:"z"},a?t[c.r][c.c]=i:t[l.ref]=i;var o=mt(t["!ref"]||"BDWGO1000001:A1");o.s.r>c.r&&(o.s.r=c.r),o.e.r<c.r&&(o.e.r=c.r),o.s.c>c.c&&(o.s.c=c.c),o.e.c<c.c&&(o.e.c=c.c);var d=tt(o);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var f={a:l.author,t:l.t,r:l.r,T:s};l.h&&(f.h=l.h);for(var u=i.c.length-1;u>=0;--u){if(!s&&i.c[u].T)return;s&&!i.c[u].T&&i.c.splice(u,1)}if(s&&r){for(u=0;u<r.length;++u)if(f.a==r[u].id){f.a=r[u].name||f.a;break}}i.c.push(f)})}function pT(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var s=[],r=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&s.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var o=Je(c[0]),d={author:o.authorId&&s[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},f=Kt(o.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var u=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!u&&!!u[1]&&au(u[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=h.h),r.push(d)}}}}),r}function nv(t){var e=[ls,ke("comments",null,{xmlns:Xn[0]})],s=[];return e.push("<authors>"),t.forEach(function(r){r[1].forEach(function(a){var i=kt(a.a);s.indexOf(i)==-1&&(s.push(i),e.push("<author>"+i+"</author>")),a.T&&a.ID&&s.indexOf("tc="+a.ID)==-1&&(s.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),s.length==0&&(s.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(r){var a=0,i=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?a=s.indexOf("tc="+r[1][0].ID):r[1].forEach(function(o){o.a&&(a=s.indexOf(kt(o.a))),i.push(o.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+a+'"><text>'),i.length<=1)e.push(Ts("t",kt(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)l+=`Reply:
    `+i[c]+`
`;e.push(Ts("t",kt(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function gT(t,e){var s=[],r=!1,a={},i=0;return t.replace(Vs,function(c,o){var d=Je(c);switch(oa(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&s.push(a);break;case"<text>":case"<text":i=o+c.length;break;case"</text>":a.t=t.slice(i,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),s}function vT(t,e,s){var r=[ls,ke("ThreadedComments",null,{xmlns:xs.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var o={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"};c==0?i=o.id:o.parentId=i,l.ID=o.id,l.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),r.push(ke("threadedComment",Ts("text",l.t||""),o))})}),r.push("</ThreadedComments>"),r.join("")}function yT(t,e){var s=[],r=!1;return t.replace(Vs,function(i){var l=Je(i);switch(oa(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":s.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),s}function bT(t){var e=[ls,ke("personList",null,{xmlns:xs.TCMNT,"xmlns:x":Xn[0]}).replace(/[\/]>/,">")];return t.forEach(function(s,r){e.push(ke("person",null,{displayName:s,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:s,providerId:"None"}))}),e.push("</personList>"),e.join("")}function _T(t){var e={};e.iauthor=t.read_shift(4);var s=Jn(t);return e.rfx=s.s,e.ref=Ye(s.s),t.l+=16,e}function wT(t,e){return e==null&&(e=le(36)),e.write_shift(4,t[1].iauthor),Ui(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var NT=Us;function jT(t){return js(t.slice(0,54))}function kT(t,e){var s=[],r=[],a={},i=!1;return Pa(t,function(c,o,d){switch(d){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,s.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!o.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function ST(t){var e=lr(),s=[];return he(e,628),he(e,630),t.forEach(function(r){r[1].forEach(function(a){s.indexOf(a.a)>-1||(s.push(a.a.slice(0,54)),he(e,632,jT(a.a)))})}),he(e,631),he(e,633),t.forEach(function(r){r[1].forEach(function(a){a.iauthor=s.indexOf(a.a);var i={s:Kt(r[0]),e:Kt(r[0])};he(e,635,wT([i,a])),a.t&&a.t.length>0&&he(e,637,qj(a)),he(e,636),delete a.iauthor})}),he(e,634),he(e,629),e.end()}var ET="application/vnd.ms-office.vbaProject";function TT(t){var e=We.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(s,r){if(!(s.slice(-1)==="/"||!s.match(/_VBA_PROJECT_CUR/))){var a=s.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");We.utils.cfb_add(e,a,t.FileIndex[r].content)}}),We.write(e)}function CT(t,e){e.FullPaths.forEach(function(s,r){if(r!=0){var a=s.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&We.utils.cfb_add(t,a,e.FileIndex[r].content)}})}var iv=["xlsb","xlsm","xlam","biff8","xla"];function AT(){return{"!type":"dialog"}}function FT(){return{"!type":"dialog"}}function OT(){return{"!type":"macro"}}function DT(){return{"!type":"macro"}}var Ni=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function s(r,a,i,l){var c=!1,o=!1;i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,f=l.length>0?parseInt(l,10)|0:0;return c?f+=e.c:--f,o?d+=e.r:--d,a+(c?"":"$")+Yt(f)+(o?"":"$")+is(d)}return function(a,i){return e=i,a.replace(t,s)}}(),cu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ou=function(){return function(e,s){return e.replace(cu,function(r,a,i,l,c,o){var d=Yf(l)-(i?0:s.c),f=qf(o)-(c?0:s.r),u=f==0?"":c?f+1:"["+f+"]",h=d==0?"":i?d+1:"["+d+"]";return a+"R"+u+"C"+h})}}();function lv(t,e){return t.replace(cu,function(s,r,a,i,l,c){return r+(a=="$"?a+i:Yt(Yf(i)+e.c))+(l=="$"?l+c:is(qf(c)+e.r))})}function PT(t,e,s){var r=cr(e),a=r.s,i=Kt(s),l={r:i.r-a.r,c:i.c-a.c};return lv(t,l)}function MT(t){return t.length!=1}function xm(t){return t.replace(/_xlfn\./g,"")}function fs(t){t.l+=1}function sn(t,e){var s=t.read_shift(e==1?1:2);return[s&16383,s>>14&1,s>>15&1]}function cv(t,e,s){var r=2;if(s){if(s.biff>=2&&s.biff<=5)return ov(t);s.biff==12&&(r=4)}var a=t.read_shift(r),i=t.read_shift(r),l=sn(t,2),c=sn(t,2);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function ov(t){var e=sn(t,2),s=sn(t,2),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:s[0],c:a,cRel:s[1],rRel:s[2]}}}function RT(t,e,s){if(s.biff<8)return ov(t);var r=t.read_shift(s.biff==12?4:2),a=t.read_shift(s.biff==12?4:2),i=sn(t,2),l=sn(t,2);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function dv(t,e,s){if(s&&s.biff>=2&&s.biff<=5)return IT(t);var r=t.read_shift(s&&s.biff==12?4:2),a=sn(t,2);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function IT(t){var e=sn(t,2),s=t.read_shift(1);return{r:e[0],c:s,cRel:e[1],rRel:e[2]}}function LT(t){var e=t.read_shift(2),s=t.read_shift(2);return{r:e,c:s&255,fQuoted:!!(s&16384),cRel:s>>15,rRel:s>>15}}function BT(t,e,s){var r=s&&s.biff?s.biff:8;if(r>=2&&r<=5)return UT(t);var a=t.read_shift(r>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:c}}function UT(t){var e=t.read_shift(2),s=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&s>=128&&(s=s-256),{r:e,c:s,cRel:a,rRel:r}}function $T(t,e,s){var r=(t[t.l++]&96)>>5,a=cv(t,s.biff>=2&&s.biff<=5?6:8,s);return[r,a]}function WT(t,e,s){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(s)switch(s.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=cv(t,i,s);return[r,a,l]}function VT(t,e,s){var r=(t[t.l++]&96)>>5;return t.l+=s&&s.biff>8?12:s.biff<8?6:8,[r]}function zT(t,e,s){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(s)switch(s.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[r,a]}function HT(t,e,s){var r=(t[t.l++]&96)>>5,a=RT(t,e-1,s);return[r,a]}function GT(t,e,s){var r=(t[t.l++]&96)>>5;return t.l+=s.biff==2?6:s.biff==12?14:7,[r]}function pm(t){var e=t[t.l+1]&1,s=1;return t.l+=4,[e,s]}function XT(t,e,s){t.l+=2;for(var r=t.read_shift(s&&s.biff==2?1:2),a=[],i=0;i<=r;++i)a.push(t.read_shift(s&&s.biff==2?1:2));return a}function qT(t,e,s){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(s&&s.biff==2?1:2)]}function YT(t,e,s){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(s&&s.biff==2?1:2)]}function KT(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function JT(t,e,s){var r=t[t.l+1]&255?1:0;return t.l+=s&&s.biff==2?3:4,[r]}function fv(t){var e=t.read_shift(1),s=t.read_shift(1);return[e,s]}function ZT(t){return t.read_shift(2),fv(t)}function QT(t){return t.read_shift(2),fv(t)}function eC(t,e,s){var r=(t[t.l]&96)>>5;t.l+=1;var a=dv(t,0,s);return[r,a]}function tC(t,e,s){var r=(t[t.l]&96)>>5;t.l+=1;var a=BT(t,0,s);return[r,a]}function sC(t,e,s){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);s&&s.biff==5&&(t.l+=12);var i=dv(t,0,s);return[r,a,i]}function rC(t,e,s){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(s&&s.biff<=3?1:2);return[iA[a],mv[a],r]}function aC(t,e,s){var r=t[t.l++],a=t.read_shift(1),i=s&&s.biff<=3?[r==88?-1:0,t.read_shift(1)]:nC(t);return[a,(i[0]===0?mv:nA)[i[1]]]}function nC(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function iC(t,e,s){t.l+=s&&s.biff==2?3:4}function lC(t,e,s){if(t.l++,s&&s.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(s&&s.biff==2?1:2);return[r,a]}function cC(t){return t.l++,Ma[t.read_shift(1)]}function oC(t){return t.l++,t.read_shift(2)}function dC(t){return t.l++,t.read_shift(1)!==0}function fC(t){return t.l++,Ls(t)}function uC(t,e,s){return t.l++,ac(t,e-1,s)}function hC(t,e){var s=[t.read_shift(1)];if(e==12)switch(s[0]){case 2:s[0]=4;break;case 4:s[0]=16;break;case 0:s[0]=1;break;case 1:s[0]=2;break}switch(s[0]){case 4:s[1]=ts(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:s[1]=Ma[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:s[1]=Ls(t);break;case 2:s[1]=Zn(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+s[0])}return s}function mC(t,e,s){for(var r=t.read_shift(s.biff==12?4:2),a=[],i=0;i!=r;++i)a.push((s.biff==12?Jn:vd)(t));return a}function xC(t,e,s){var r=0,a=0;s.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),s.biff>=2&&s.biff<8&&(--r,--a==0&&(a=256));for(var i=0,l=[];i!=r&&(l[i]=[]);++i)for(var c=0;c!=a;++c)l[i][c]=hC(t,s.biff);return l}function pC(t,e,s){var r=t.read_shift(1)>>>5&3,a=!s||s.biff>=8?4:2,i=t.read_shift(a);switch(s.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,i]}function gC(t,e,s){if(s.biff==5)return vC(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[r,a,i]}function vC(t){var e=t.read_shift(1)>>>5&3,s=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,s,r]}function yC(t,e,s){var r=t.read_shift(1)>>>5&3;t.l+=s&&s.biff==2?3:4;var a=t.read_shift(s&&s.biff==2?1:2);return[r,a]}function bC(t,e,s){var r=t.read_shift(1)>>>5&3,a=t.read_shift(s&&s.biff==2?1:2);return[r,a]}function _C(t,e,s){var r=t.read_shift(1)>>>5&3;return t.l+=4,s.biff<8&&t.l--,s.biff==12&&(t.l+=2),[r]}function wC(t,e,s){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(s)switch(s.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[r,a]}var NC=$s,jC=$s,kC=$s;function ic(t,e,s){return t.l+=2,[LT(t)]}function du(t){return t.l+=6,[]}var SC=ic,EC=du,TC=du,CC=ic;function uv(t){return t.l+=2,[hs(t),t.read_shift(2)&1]}var AC=ic,FC=uv,OC=du,DC=ic,PC=ic,MC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RC(t){t.l+=2;var e=t.read_shift(2),s=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),l=MC[s>>2&31];return{ixti:e,coltype:s&3,rt:l,idx:r,c:a,C:i}}function IC(t){return t.l+=2,[t.read_shift(4)]}function LC(t,e,s){return t.l+=5,t.l+=2,t.l+=s.biff==2?1:4,["PTGSHEET"]}function BC(t,e,s){return t.l+=s.biff==2?4:5,["PTGENDSHEET"]}function UC(t){var e=t.read_shift(1)>>>5&3,s=t.read_shift(2);return[e,s]}function $C(t){var e=t.read_shift(1)>>>5&3,s=t.read_shift(2);return[e,s]}function WC(t){return t.l+=4,[0,0]}var gm={1:{n:"PtgExp",f:lC},2:{n:"PtgTbl",f:kC},3:{n:"PtgAdd",f:fs},4:{n:"PtgSub",f:fs},5:{n:"PtgMul",f:fs},6:{n:"PtgDiv",f:fs},7:{n:"PtgPower",f:fs},8:{n:"PtgConcat",f:fs},9:{n:"PtgLt",f:fs},10:{n:"PtgLe",f:fs},11:{n:"PtgEq",f:fs},12:{n:"PtgGe",f:fs},13:{n:"PtgGt",f:fs},14:{n:"PtgNe",f:fs},15:{n:"PtgIsect",f:fs},16:{n:"PtgUnion",f:fs},17:{n:"PtgRange",f:fs},18:{n:"PtgUplus",f:fs},19:{n:"PtgUminus",f:fs},20:{n:"PtgPercent",f:fs},21:{n:"PtgParen",f:fs},22:{n:"PtgMissArg",f:fs},23:{n:"PtgStr",f:uC},26:{n:"PtgSheet",f:LC},27:{n:"PtgEndSheet",f:BC},28:{n:"PtgErr",f:cC},29:{n:"PtgBool",f:dC},30:{n:"PtgInt",f:oC},31:{n:"PtgNum",f:fC},32:{n:"PtgArray",f:GT},33:{n:"PtgFunc",f:rC},34:{n:"PtgFuncVar",f:aC},35:{n:"PtgName",f:pC},36:{n:"PtgRef",f:eC},37:{n:"PtgArea",f:$T},38:{n:"PtgMemArea",f:yC},39:{n:"PtgMemErr",f:NC},40:{n:"PtgMemNoMem",f:jC},41:{n:"PtgMemFunc",f:bC},42:{n:"PtgRefErr",f:_C},43:{n:"PtgAreaErr",f:VT},44:{n:"PtgRefN",f:tC},45:{n:"PtgAreaN",f:HT},46:{n:"PtgMemAreaN",f:UC},47:{n:"PtgMemNoMemN",f:$C},57:{n:"PtgNameX",f:gC},58:{n:"PtgRef3d",f:sC},59:{n:"PtgArea3d",f:WT},60:{n:"PtgRefErr3d",f:wC},61:{n:"PtgAreaErr3d",f:zT},255:{}},VC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},zC={1:{n:"PtgElfLel",f:uv},2:{n:"PtgElfRw",f:DC},3:{n:"PtgElfCol",f:SC},6:{n:"PtgElfRwV",f:PC},7:{n:"PtgElfColV",f:CC},10:{n:"PtgElfRadical",f:AC},11:{n:"PtgElfRadicalS",f:OC},13:{n:"PtgElfColS",f:EC},15:{n:"PtgElfColSV",f:TC},16:{n:"PtgElfRadicalLel",f:FC},25:{n:"PtgList",f:RC},29:{n:"PtgSxName",f:IC},255:{}},HC={0:{n:"PtgAttrNoop",f:WC},1:{n:"PtgAttrSemi",f:JT},2:{n:"PtgAttrIf",f:YT},4:{n:"PtgAttrChoose",f:XT},8:{n:"PtgAttrGoto",f:qT},16:{n:"PtgAttrSum",f:iC},32:{n:"PtgAttrBaxcel",f:pm},33:{n:"PtgAttrBaxcel",f:pm},64:{n:"PtgAttrSpace",f:ZT},65:{n:"PtgAttrSpaceSemi",f:QT},128:{n:"PtgAttrIfError",f:KT},255:{}};function lc(t,e,s,r){if(r.biff<8)return $s(t,e);for(var a=t.l+e,i=[],l=0;l!==s.length;++l)switch(s[l][0]){case"PtgArray":s[l][1]=xC(t,0,r),i.push(s[l][1]);break;case"PtgMemArea":s[l][2]=mC(t,s[l][1],r),i.push(s[l][2]);break;case"PtgExp":r&&r.biff==12&&(s[l][1][1]=t.read_shift(4),i.push(s[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+s[l][0]}return e=a-t.l,e!==0&&i.push($s(t,e)),i}function cc(t,e,s){for(var r=t.l+e,a,i,l=[];r!=t.l;)e=r-t.l,i=t[t.l],a=gm[i]||gm[VC[i]],(i===24||i===25)&&(a=(i===24?zC:HC)[t[t.l+1]]),!a||!a.f?$s(t,e):l.push([a.n,a.f(t,e,s)]);return l}function GC(t){for(var e=[],s=0;s<t.length;++s){for(var r=t[s],a=[],i=0;i<r.length;++i){var l=r[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var XC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function qC(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function hv(t,e,s){if(!t)return"SH33TJSERR0";if(s.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(s.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(s.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return s.SID!=null?t.SheetNames[s.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function vm(t,e,s){var r=hv(t,e,s);return r=="#REF"?r:qC(r,s)}function Ms(t,e,s,r,a){var i=a&&a.biff||8,l={s:{c:0,r:0},e:{c:0,r:0}},c=[],o,d,f,u=0,h=0,x,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,v="",b=0,_=t[0].length;b<_;++b){var g=t[0][b];switch(g[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=c.pop(),d=c.pop(),p>=0){switch(t[0][p][1][0]){case 0:v=Jt(" ",t[0][p][1][1]);break;case 1:v=Jt("\r",t[0][p][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}d=d+v,p=-1}c.push(d+XC[g[0]]+o);break;case"PtgIsect":o=c.pop(),d=c.pop(),c.push(d+" "+o);break;case"PtgUnion":o=c.pop(),d=c.pop(),c.push(d+","+o);break;case"PtgRange":o=c.pop(),d=c.pop(),c.push(d+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=hl(g[1][1],l,a),c.push(ml(f,i));break;case"PtgRefN":f=s?hl(g[1][1],s,a):g[1][1],c.push(ml(f,i));break;case"PtgRef3d":u=g[1][1],f=hl(g[1][2],l,a),m=vm(r,u,a),c.push(m+"!"+ml(f,i));break;case"PtgFunc":case"PtgFuncVar":var j=g[1][0],w=g[1][1];j||(j=0),j&=127;var k=j==0?[]:c.slice(-j);c.length-=j,w==="User"&&(w=k.shift()),c.push(w+"("+k.join(",")+")");break;case"PtgBool":c.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(g[1]);break;case"PtgNum":c.push(String(g[1]));break;case"PtgStr":c.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(g[1]);break;case"PtgAreaN":x=Xh(g[1][1],s?{s}:l,a),c.push(Qd(x,a));break;case"PtgArea":x=Xh(g[1][1],l,a),c.push(Qd(x,a));break;case"PtgArea3d":u=g[1][1],x=g[1][2],m=vm(r,u,a),c.push(m+"!"+Qd(x,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var y=(r.names||[])[h-1]||(r[0]||[])[h],N=y?y.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!a.xlfn&&(N=N.slice(6)),c.push(N);break;case"PtgNameX":var S=g[1][1];h=g[1][2];var T;if(a.biff<=5)S<0&&(S=-S),r[S]&&(T=r[S][h]);else{var E="";if(((r[S]||[])[0]||[])[0]==14849||(((r[S]||[])[0]||[])[0]==1025?r[S][h]&&r[S][h].itab>0&&(E=r.SheetNames[r[S][h].itab-1]+"!"):E=r.SheetNames[h-1]+"!"),r[S]&&r[S][h])E+=r[S][h].Name;else if(r[0]&&r[0][h])E+=r[0][h].Name;else{var A=(hv(r,S,a)||"").split(";;");A[h-1]?E=A[h-1]:E+="SH33TJSERRX"}c.push(E);break}T||(T={Name:"SH33TJSERRY"}),c.push(T.Name);break;case"PtgParen":var H="(",V=")";if(p>=0){switch(v="",t[0][p][1][0]){case 2:H=Jt(" ",t[0][p][1][1])+H;break;case 3:H=Jt("\r",t[0][p][1][1])+H;break;case 4:V=Jt(" ",t[0][p][1][1])+V;break;case 5:V=Jt("\r",t[0][p][1][1])+V;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}c.push(H+c.pop()+V);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":f={c:g[1][1],r:g[1][0]};var L={c:s.c,r:s.r};if(r.sharedf[Ye(f)]){var P=r.sharedf[Ye(f)];c.push(Ms(P,l,L,r,a))}else{var J=!1;for(o=0;o!=r.arrayf.length;++o)if(d=r.arrayf[o],!(f.c<d[0].s.c||f.c>d[0].e.c)&&!(f.r<d[0].s.r||f.r>d[0].e.r)){c.push(Ms(d[1],l,L,r,a)),J=!0;break}J||c.push(g[1])}break;case"PtgArray":c.push("{"+GC(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var Ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&Ee.indexOf(t[0][b][0])==-1){g=t[0][p];var Y=!0;switch(g[1][0]){case 4:Y=!1;case 0:v=Jt(" ",g[1][1]);break;case 5:Y=!1;case 1:v=Jt("\r",g[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}c.push((Y?v:"")+c.pop()+(Y?"":v)),p=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function YC(t,e,s){var r=t.l+e,a=s.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],$s(t,e-2)];var c=cc(t,l,s);return e!==l+a&&(i=lc(t,e-l-a,c,s)),t.l=r,[c,i]}function KC(t,e,s){var r=t.l+e,a=s.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],$s(t,e-2)];var c=cc(t,l,s);return e!==l+a&&(i=lc(t,e-l-a,c,s)),t.l=r,[c,i]}function JC(t,e,s,r){var a=t.l+e,i=cc(t,r,s),l;return a!==t.l&&(l=lc(t,a-t.l,i,s)),[i,l]}function ZC(t,e,s){var r=t.l+e,a,i=t.read_shift(2),l=cc(t,i,s);return i==65535?[[],$s(t,e-2)]:(e!==i+2&&(a=lc(t,r-i-2,l,s)),[l,a])}function QC(t){var e;if(_a(t,t.l+6)!==65535)return[Ls(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function eA(t){if(t==null){var e=le(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ln(t);return Ln(0)}function a0(t,e,s){var r=t.l+e,a=da(t);s.biff==2&&++t.l;var i=QC(t),l=t.read_shift(1);s.biff!=2&&(t.read_shift(1),s.biff>=5&&t.read_shift(4));var c=KC(t,r-t.l,s);return{cell:a,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function tA(t,e,s,r,a){var i=Un(e,s,a),l=eA(t.v),c=le(6),o=33;c.write_shift(2,o),c.write_shift(4,0);for(var d=le(t.bf.length),f=0;f<t.bf.length;++f)d[f]=t.bf[f];var u=Ns([i,l,c,d]);return u}function yd(t,e,s){var r=t.read_shift(4),a=cc(t,r,s),i=t.read_shift(4),l=i>0?lc(t,i,a,s):null;return[a,l]}var sA=yd,bd=yd,rA=yd,aA=yd,nA={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},mv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iA={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ym(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,s){return s.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function lA(t){var e="of:="+t.replace(cu,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function n0(t){var e=t.split(":"),s=e[0].split(".")[0];return[s,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function cA(t){return t.replace(/\./,"!")}var pl={},ji={},gl=typeof Map<"u";function fu(t,e,s){var r=0,a=t.length;if(s){if(gl?s.has(e):Object.prototype.hasOwnProperty.call(s,e)){for(var i=gl?s.get(e):s[e];r<i.length;++r)if(t[i[r]].t===e)return t.Count++,i[r]}}else for(;r<a;++r)if(t[r].t===e)return t.Count++,r;return t[a]={t:e},t.Count++,t.Unique++,s&&(gl?(s.has(e)||s.set(e,[]),s.get(e).push(a)):(Object.prototype.hasOwnProperty.call(s,e)||(s[e]=[]),s[e].push(a))),a}function _d(t,e){var s={min:t+1,max:t+1},r=-1;return e.MDW&&(Rs=e.MDW),e.width!=null?s.customWidth=1:e.wpx!=null?r=Pl(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(s.width=Po(r),s.customWidth=1):e.width!=null&&(s.width=e.width),e.hidden&&(s.hidden=!0),e.level!=null&&(s.outlineLevel=s.level=e.level),s}function Fn(t,e){if(t){var s=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(s=[1,1,1,1,.5,.5]),t.left==null&&(t.left=s[0]),t.right==null&&(t.right=s[1]),t.top==null&&(t.top=s[2]),t.bottom==null&&(t.bottom=s[3]),t.header==null&&(t.header=s[4]),t.footer==null&&(t.footer=s[5])}}function on(t,e,s){var r=s.revssf[e.z!=null?e.z:"General"],a=60,i=t.length;if(r==null&&s.ssf){for(;a<392;++a)if(s.ssf[a]==null){Sa(e.z,a),s.ssf[a]=e.z,s.revssf[e.z]=r=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===r)return a;return t[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function xv(t,e,s,r,a,i){try{r.cellNF&&(t.z=Ge[e])}catch(c){if(r.WTF)throw c}if(!(t.t==="z"&&!r.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Lt(t.v)),(!r||r.cellText!==!1)&&t.t!=="z")try{if(Ge[e]==null&&Sa(ij[e]||"General",e),t.t==="e")t.w=t.w||Ma[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=El(t.v);else if(t.t==="d"){var l=vs(t.v);(l|0)===l?t.w=l.toString(10):t.w=El(l)}else{if(t.v===void 0)return"";t.w=Rn(t.v,ji)}else t.t==="d"?t.w=Tr(e,vs(t.v),ji):t.w=Tr(e,t.v,ji)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&s!=null)try{t.s=i.Fills[s],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Do(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Do(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&i.Fills)throw c}}}function oA(t,e,s){if(t&&t["!ref"]){var r=mt(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+s+"): "+t["!ref"])}}function dA(t,e){var s=mt(e);s.s.r<=s.e.r&&s.s.c<=s.e.c&&s.s.r>=0&&s.s.c>=0&&(t["!ref"]=tt(s))}var fA=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,uA=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hA=/<(?:\w:)?hyperlink [^>]*>/mg,mA=/"(\w*:\w*)"/,xA=/<(?:\w:)?col\b[^>]*[\/]?>/g,pA=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,gA=/<(?:\w:)?pageMargins[^>]*\/>/g,pv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vA=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yA=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function bA(t,e,s,r,a,i,l){if(!t)return t;r||(r={"!id":{}});var c=e.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",f="",u=t.match(uA);u?(d=t.slice(0,u.index),f=t.slice(u.index+u[0].length)):d=f=t;var h=d.match(pv);h?uu(h[0],c,a,s):(h=d.match(vA))&&wA(h[0],h[1]||"",c,a,s);var x=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var m=d.slice(x,x+50).match(mA);m&&dA(c,m[1])}var p=d.match(yA);p&&p[1]&&MA(p[1],a);var v=[];if(e.cellStyles){var b=d.match(xA);b&&AA(v,b)}u&&LA(u[1],c,e,o,i,l);var _=f.match(pA);_&&(c["!autofilter"]=OA(_[0]));var g=[],j=f.match(fA);if(j)for(x=0;x!=j.length;++x)g[x]=mt(j[x].slice(j[x].indexOf('"')+1));var w=f.match(hA);w&&EA(c,w,r);var k=f.match(gA);if(k&&(c["!margins"]=TA(Je(k[0]))),!c["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(c["!ref"]=tt(o)),e.sheetRows>0&&c["!ref"]){var y=mt(c["!ref"]);e.sheetRows<=+y.e.r&&(y.e.r=e.sheetRows-1,y.e.r>o.e.r&&(y.e.r=o.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>o.e.c&&(y.e.c=o.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),c["!fullref"]=c["!ref"],c["!ref"]=tt(y))}return v.length>0&&(c["!cols"]=v),g.length>0&&(c["!merges"]=g),c}function _A(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',s=0;s!=t.length;++s)e+='<mergeCell ref="'+tt(t[s])+'"/>';return e+"</mergeCells>"}function uu(t,e,s,r){var a=Je(t);s.Sheets[r]||(s.Sheets[r]={}),a.codeName&&(s.Sheets[r].CodeName=ft(Et(a.codeName)))}function wA(t,e,s,r,a){uu(t.slice(0,t.indexOf(">")),s,r,a)}function NA(t,e,s,r,a){var i=!1,l={},c=null;if(r.bookType!=="xlsx"&&e.vbaraw){var o=e.SheetNames[s];try{e.Workbook&&(o=e.Workbook.Sheets[s].CodeName||o)}catch{}i=!0,l.codeName=ta(kt(o))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),c=(c||"")+ke("outlinePr",null,d)}!i&&!c||(a[a.length]=ke("sheetPr",c,l))}var jA=["objects","scenarios","selectLockedCells","selectUnlockedCells"],kA=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function SA(t){var e={sheet:1};return jA.forEach(function(s){t[s]!=null&&t[s]&&(e[s]="1")}),kA.forEach(function(s){t[s]!=null&&!t[s]&&(e[s]="0")}),t.password&&(e.password=nu(t.password).toString(16).toUpperCase()),ke("sheetProtection",null,e)}function EA(t,e,s){for(var r=Array.isArray(t),a=0;a!=e.length;++a){var i=Je(Et(e[a]),!0);if(!i.ref)return;var l=((s||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+ft(i.location))):(i.Target="#"+ft(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=mt(i.ref),o=c.s.r;o<=c.e.r;++o)for(var d=c.s.c;d<=c.e.c;++d){var f=Ye({c:d,r:o});r?(t[o]||(t[o]=[]),t[o][d]||(t[o][d]={t:"z",v:void 0}),t[o][d].l=i):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=i)}}}function TA(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(s){t[s]&&(e[s]=parseFloat(t[s]))}),e}function CA(t){return Fn(t),ke("pageMargins",null,t)}function AA(t,e){for(var s=!1,r=0;r!=e.length;++r){var a=Je(e[r],!0);a.hidden&&(a.hidden=Dt(a.hidden));var i=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!s&&a.width&&(s=!0,iu(a.width)),tn(a);i<=l;)t[i++]=Bt(a)}}function FA(t,e){for(var s=["<cols>"],r,a=0;a!=e.length;++a)(r=e[a])&&(s[s.length]=ke("col",null,_d(a,r)));return s[s.length]="</cols>",s.join("")}function OA(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function DA(t,e,s,r){var a=typeof t.ref=="string"?t.ref:tt(t.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var i=s.Workbook.Names,l=cr(a);l.s.r==l.e.r&&(l.e.r=cr(e["!ref"]).e.r,a=tt(l));for(var c=0;c<i.length;++c){var o=i[c];if(o.Name=="_xlnm._FilterDatabase"&&o.Sheet==r){o.Ref="'"+s.SheetNames[r]+"'!"+a;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+s.SheetNames[r]+"'!"+a}),ke("autoFilter",null,{ref:a})}var PA=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function MA(t,e){e.Views||(e.Views=[{}]),(t.match(PA)||[]).forEach(function(s,r){var a=Je(s);e.Views[r]||(e.Views[r]={}),+a.zoomScale&&(e.Views[r].zoom=+a.zoomScale),Dt(a.rightToLeft)&&(e.Views[r].RTL=!0)})}function RA(t,e,s,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ke("sheetViews",ke("sheetView",null,a),{})}function IA(t,e,s,r){if(t.c&&s["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Ma[t.v];break;case"d":r&&r.cellDates?a=Lt(t.v,-1).toISOString():(t=Bt(t),t.t="n",a=""+(t.v=vs(Lt(t.v)))),typeof t.z>"u"&&(t.z=Ge[14]);break;default:a=t.v;break}var c=Ts("v",kt(a)),o={r:e},d=on(r.cellXfs,t,r);switch(d!==0&&(o.s=d),t.t){case"n":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){c=Ts("v",""+fu(r.Strings,t.v,r.revStrings)),o.t="s";break}o.t="str";break}if(t.t!=i&&(t.t=i,t.v=l),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=ke("f",kt(t.f),f)+(t.v!=null?c:"")}return t.l&&s["!links"].push([e,t.l]),t.D&&(o.cm=1),ke("c",c,o)}var LA=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,s=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Tl("v"),l=Tl("f");return function(o,d,f,u,h,x){for(var m=0,p="",v=[],b=[],_=0,g=0,j=0,w="",k,y,N=0,S=0,T,E,A=0,H=0,V=Array.isArray(x.CellXf),L,P=[],J=[],Ee=Array.isArray(d),Y=[],de={},De=!1,B=!!f.sheetStubs,X=o.split(e),W=0,z=X.length;W!=z;++W){p=X[W].trim();var ae=p.length;if(ae!==0){var me=0;e:for(m=0;m<ae;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(y=Je(p.slice(me,m),!0),N=y.r!=null?parseInt(y.r,10):N+1,S=-1,f.sheetRows&&f.sheetRows<N)continue;de={},De=!1,y.ht&&(De=!0,de.hpt=parseFloat(y.ht),de.hpx=Ci(de.hpt)),y.hidden=="1"&&(De=!0,de.hidden=!0),y.outlineLevel!=null&&(De=!0,de.level=+y.outlineLevel),De&&(Y[N-1]=de)}break;case"<":me=m;break}if(me>=m)break;if(y=Je(p.slice(me,m),!0),N=y.r!=null?parseInt(y.r,10):N+1,S=-1,!(f.sheetRows&&f.sheetRows<N)){u.s.r>N-1&&(u.s.r=N-1),u.e.r<N-1&&(u.e.r=N-1),f&&f.cellStyles&&(de={},De=!1,y.ht&&(De=!0,de.hpt=parseFloat(y.ht),de.hpx=Ci(de.hpt)),y.hidden=="1"&&(De=!0,de.hidden=!0),y.outlineLevel!=null&&(De=!0,de.level=+y.outlineLevel),De&&(Y[N-1]=de)),v=p.slice(m).split(t);for(var xe=0;xe!=v.length&&v[xe].trim().charAt(0)=="<";++xe);for(v=v.slice(xe),m=0;m!=v.length;++m)if(p=v[m].trim(),p.length!==0){if(b=p.match(s),_=m,g=0,j=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,b!=null&&b.length===2){for(_=0,w=b[1],g=0;g!=w.length&&!((j=w.charCodeAt(g)-64)<1||j>26);++g)_=26*_+j;--_,S=_}else++S;for(g=0;g!=p.length&&p.charCodeAt(g)!==62;++g);if(++g,y=Je(p.slice(0,g),!0),y.r||(y.r=Ye({r:N-1,c:S})),w=p.slice(g),k={t:""},(b=w.match(i))!=null&&b[1]!==""&&(k.v=ft(b[1])),f.cellFormula){if((b=w.match(l))!=null&&b[1]!==""){if(k.f=ft(Et(b[1])).replace(/\r\n/g,`
`),f.xlfn||(k.f=xm(k.f)),b[0].indexOf('t="array"')>-1)k.F=(w.match(a)||[])[1],k.F.indexOf(":")>-1&&P.push([mt(k.F),k.F]);else if(b[0].indexOf('t="shared"')>-1){E=Je(b[0]);var ue=ft(Et(b[1]));f.xlfn||(ue=xm(ue)),J[parseInt(E.si,10)]=[E,ue,y.r]}}else(b=w.match(/<f[^>]*\/>/))&&(E=Je(b[0]),J[E.si]&&(k.f=PT(J[E.si][1],J[E.si][2],y.r)));var oe=Kt(y.r);for(g=0;g<P.length;++g)oe.r>=P[g][0].s.r&&oe.r<=P[g][0].e.r&&oe.c>=P[g][0].s.c&&oe.c<=P[g][0].e.c&&(k.F=P[g][1])}if(y.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(B)k.t="z";else continue;else k.t=y.t||"n";switch(u.s.c>S&&(u.s.c=S),u.e.c<S&&(u.e.c=S),k.t){case"n":if(k.v==""||k.v==null){if(!B)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!B)continue;k.t="z"}else T=pl[parseInt(k.v,10)],k.v=T.t,k.r=T.r,f.cellHTML&&(k.h=T.h);break;case"str":k.t="s",k.v=k.v!=null?Et(k.v):"",f.cellHTML&&(k.h=zf(k.v));break;case"inlineStr":b=w.match(r),k.t="s",b!=null&&(T=au(b[1]))?(k.v=T.t,f.cellHTML&&(k.h=T.h)):k.v="";break;case"b":k.v=Dt(k.v);break;case"d":f.cellDates?k.v=Lt(k.v,1):(k.v=vs(Lt(k.v,1)),k.t="n");break;case"e":(!f||f.cellText!==!1)&&(k.w=k.v),k.v=v1[k.v];break}if(A=H=0,L=null,V&&y.s!==void 0&&(L=x.CellXf[y.s],L!=null&&(L.numFmtId!=null&&(A=L.numFmtId),f.cellStyles&&L.fillId!=null&&(H=L.fillId))),xv(k,A,H,f,h,x),f.cellDates&&V&&k.t=="n"&&Ii(Ge[A])&&(k.t="d",k.v=gd(k.v)),y.cm&&f.xlmeta){var ze=(f.xlmeta.Cell||[])[+y.cm-1];ze&&ze.type=="XLDAPR"&&(k.D=!0)}if(Ee){var F=Kt(y.r);d[F.r]||(d[F.r]=[]),d[F.r][F.c]=k}else d[y.r]=k}}}}Y.length>0&&(d["!rows"]=Y)}}();function BA(t,e,s,r){var a=[],i=[],l=mt(t["!ref"]),c="",o,d="",f=[],u=0,h=0,x=t["!rows"],m=Array.isArray(t),p={r:d},v,b=-1;for(h=l.s.c;h<=l.e.c;++h)f[h]=Yt(h);for(u=l.s.r;u<=l.e.r;++u){for(i=[],d=is(u),h=l.s.c;h<=l.e.c;++h){o=f[h]+d;var _=m?(t[u]||[])[h]:t[o];_!==void 0&&(c=IA(_,o,t,e))!=null&&i.push(c)}(i.length>0||x&&x[u])&&(p={r:d},x&&x[u]&&(v=x[u],v.hidden&&(p.hidden=1),b=-1,v.hpx?b=Ml(v.hpx):v.hpt&&(b=v.hpt),b>-1&&(p.ht=b,p.customHeight=1),v.level&&(p.outlineLevel=v.level)),a[a.length]=ke("row",i.join(""),p))}if(x)for(;u<x.length;++u)x&&x[u]&&(p={r:u+1},v=x[u],v.hidden&&(p.hidden=1),b=-1,v.hpx?b=Ml(v.hpx):v.hpt&&(b=v.hpt),b>-1&&(p.ht=b,p.customHeight=1),v.level&&(p.outlineLevel=v.level),a[a.length]=ke("row","",p));return a.join("")}function gv(t,e,s,r){var a=[ls,ke("worksheet",null,{xmlns:Xn[0],"xmlns:r":xs.r})],i=s.SheetNames[t],l=0,c="",o=s.Sheets[i];o==null&&(o={});var d=o["!ref"]||"A1",f=mt(d);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),d=tt(f)}r||(r={}),o["!comments"]=[];var u=[];NA(o,s,t,e,a),a[a.length]=ke("dimension",null,{ref:d}),a[a.length]=RA(o,e,t,s),e.sheetFormat&&(a[a.length]=ke("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),o["!cols"]!=null&&o["!cols"].length>0&&(a[a.length]=FA(o,o["!cols"])),a[l=a.length]="<sheetData/>",o["!links"]=[],o["!ref"]!=null&&(c=BA(o,e),c.length>0&&(a[a.length]=c)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),o["!protect"]&&(a[a.length]=SA(o["!protect"])),o["!autofilter"]!=null&&(a[a.length]=DA(o["!autofilter"],o,s,t)),o["!merges"]!=null&&o["!merges"].length>0&&(a[a.length]=_A(o["!merges"]));var h=-1,x,m=-1;return o["!links"].length>0&&(a[a.length]="<hyperlinks>",o["!links"].forEach(function(p){p[1].Target&&(x={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Nt(r,-1,kt(p[1].Target).replace(/#.*$/,""),lt.HLINK),x["r:id"]="rId"+m),(h=p[1].Target.indexOf("#"))>-1&&(x.location=kt(p[1].Target.slice(h+1))),p[1].Tooltip&&(x.tooltip=kt(p[1].Tooltip)),a[a.length]=ke("hyperlink",null,x))}),a[a.length]="</hyperlinks>"),delete o["!links"],o["!margins"]!=null&&(a[a.length]=CA(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Ts("ignoredErrors",ke("ignoredError",null,{numberStoredAsText:1,sqref:d}))),u.length>0&&(m=Nt(r,-1,"../drawings/drawing"+(t+1)+".xml",lt.DRAW),a[a.length]=ke("drawing",null,{"r:id":"rId"+m}),o["!drawing"]=u),o["!comments"].length>0&&(m=Nt(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",lt.VML),a[a.length]=ke("legacyDrawing",null,{"r:id":"rId"+m}),o["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function UA(t,e){var s={},r=t.l+e;s.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=r,i&7&&(s.level=i&7),i&16&&(s.hidden=!0),i&32&&(s.hpt=a/20),s}function $A(t,e,s){var r=le(145),a=(s["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var i=320;a.hpx?i=Ml(a.hpx)*20:a.hpt&&(i=a.hpt*20),r.write_shift(2,i),r.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),r.write_shift(1,l),r.write_shift(1,0);var c=0,o=r.l;r.l+=4;for(var d={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var u=-1,h=-1,x=f<<10;x<f+1<<10;++x){d.c=x;var m=Array.isArray(s)?(s[d.r]||[])[d.c]:s[Ye(d)];m&&(u<0&&(u=x),h=x)}u<0||(++c,r.write_shift(4,u),r.write_shift(4,h))}var p=r.l;return r.l=o,r.write_shift(4,c),r.l=p,r.length>r.l?r.slice(0,r.l):r}function WA(t,e,s,r){var a=$A(r,s,e);(a.length>17||(e["!rows"]||[])[r])&&he(t,0,a)}var VA=Jn,zA=Ui;function HA(){}function GA(t,e){var s={},r=t[t.l];return++t.l,s.above=!(r&64),s.left=!(r&128),t.l+=18,s.name=Yj(t),s}function XA(t,e,s){s==null&&(s=le(84+4*t.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),s.write_shift(1,r);for(var a=1;a<3;++a)s.write_shift(1,0);return Ao({auto:1},s),s.write_shift(-4,-1),s.write_shift(-4,-1),h1(t,s),s.slice(0,s.l)}function qA(t){var e=Cr(t);return[e]}function YA(t,e,s){return s==null&&(s=le(8)),qn(e,s)}function KA(t){var e=Yn(t);return[e]}function JA(t,e,s){return s==null&&(s=le(4)),Kn(e,s)}function ZA(t){var e=Cr(t),s=t.read_shift(1);return[e,s,"b"]}function QA(t,e,s){return s==null&&(s=le(9)),qn(e,s),s.write_shift(1,t.v?1:0),s}function e3(t){var e=Yn(t),s=t.read_shift(1);return[e,s,"b"]}function t3(t,e,s){return s==null&&(s=le(5)),Kn(e,s),s.write_shift(1,t.v?1:0),s}function s3(t){var e=Cr(t),s=t.read_shift(1);return[e,s,"e"]}function r3(t,e,s){return s==null&&(s=le(9)),qn(e,s),s.write_shift(1,t.v),s}function a3(t){var e=Yn(t),s=t.read_shift(1);return[e,s,"e"]}function n3(t,e,s){return s==null&&(s=le(8)),Kn(e,s),s.write_shift(1,t.v),s.write_shift(2,0),s.write_shift(1,0),s}function i3(t){var e=Cr(t),s=t.read_shift(4);return[e,s,"s"]}function l3(t,e,s){return s==null&&(s=le(12)),qn(e,s),s.write_shift(4,e.v),s}function c3(t){var e=Yn(t),s=t.read_shift(4);return[e,s,"s"]}function o3(t,e,s){return s==null&&(s=le(8)),Kn(e,s),s.write_shift(4,e.v),s}function d3(t){var e=Cr(t),s=Ls(t);return[e,s,"n"]}function f3(t,e,s){return s==null&&(s=le(16)),qn(e,s),Ln(t.v,s),s}function vv(t){var e=Yn(t),s=Ls(t);return[e,s,"n"]}function u3(t,e,s){return s==null&&(s=le(12)),Kn(e,s),Ln(t.v,s),s}function h3(t){var e=Cr(t),s=Qf(t);return[e,s,"n"]}function m3(t,e,s){return s==null&&(s=le(12)),qn(e,s),m1(t.v,s),s}function x3(t){var e=Yn(t),s=Qf(t);return[e,s,"n"]}function p3(t,e,s){return s==null&&(s=le(8)),Kn(e,s),m1(t.v,s),s}function g3(t){var e=Cr(t),s=Kf(t);return[e,s,"is"]}function v3(t){var e=Cr(t),s=Us(t);return[e,s,"str"]}function y3(t,e,s){return s==null&&(s=le(12+4*t.v.length)),qn(e,s),js(t.v,s),s.length>s.l?s.slice(0,s.l):s}function b3(t){var e=Yn(t),s=Us(t);return[e,s,"str"]}function _3(t,e,s){return s==null&&(s=le(8+4*t.v.length)),Kn(e,s),js(t.v,s),s.length>s.l?s.slice(0,s.l):s}function w3(t,e,s){var r=t.l+e,a=Cr(t);a.r=s["!row"];var i=t.read_shift(1),l=[a,i,"b"];if(s.cellFormula){t.l+=2;var c=bd(t,r-t.l,s);l[3]=Ms(c,null,a,s.supbooks,s)}else t.l=r;return l}function N3(t,e,s){var r=t.l+e,a=Cr(t);a.r=s["!row"];var i=t.read_shift(1),l=[a,i,"e"];if(s.cellFormula){t.l+=2;var c=bd(t,r-t.l,s);l[3]=Ms(c,null,a,s.supbooks,s)}else t.l=r;return l}function j3(t,e,s){var r=t.l+e,a=Cr(t);a.r=s["!row"];var i=Ls(t),l=[a,i,"n"];if(s.cellFormula){t.l+=2;var c=bd(t,r-t.l,s);l[3]=Ms(c,null,a,s.supbooks,s)}else t.l=r;return l}function k3(t,e,s){var r=t.l+e,a=Cr(t);a.r=s["!row"];var i=Us(t),l=[a,i,"str"];if(s.cellFormula){t.l+=2;var c=bd(t,r-t.l,s);l[3]=Ms(c,null,a,s.supbooks,s)}else t.l=r;return l}var S3=Jn,E3=Ui;function T3(t,e){return e==null&&(e=le(4)),e.write_shift(4,t),e}function C3(t,e){var s=t.l+e,r=Jn(t),a=Jf(t),i=Us(t),l=Us(t),c=Us(t);t.l=s;var o={rfx:r,relId:a,loc:i,display:c};return l&&(o.Tooltip=l),o}function A3(t,e){var s=le(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Ui({s:Kt(t[0]),e:Kt(t[0])},s),Zf("rId"+e,s);var r=t[1].Target.indexOf("#"),a=r==-1?"":t[1].Target.slice(r+1);return js(a||"",s),js(t[1].Tooltip||"",s),js("",s),s.slice(0,s.l)}function F3(){}function O3(t,e,s){var r=t.l+e,a=x1(t),i=t.read_shift(1),l=[a];if(l[2]=i,s.cellFormula){var c=sA(t,r-t.l,s);l[1]=c}else t.l=r;return l}function D3(t,e,s){var r=t.l+e,a=Jn(t),i=[a];if(s.cellFormula){var l=aA(t,r-t.l,s);i[1]=l,t.l=r}else t.l=r;return i}function P3(t,e,s){s==null&&(s=le(18));var r=_d(t,e);s.write_shift(-4,t),s.write_shift(-4,t),s.write_shift(4,(r.width||10)*256),s.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof r.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),s.write_shift(2,a),s}var yv=["left","right","top","bottom","header","footer"];function M3(t){var e={};return yv.forEach(function(s){e[s]=Ls(t)}),e}function R3(t,e){return e==null&&(e=le(6*8)),Fn(t),yv.forEach(function(s){Ln(t[s],e)}),e}function I3(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function L3(t,e,s){s==null&&(s=le(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),s.write_shift(2,r),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,100),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s}function B3(t){var e=le(24);return e.write_shift(4,4),e.write_shift(4,1),Ui(t,e),e}function U3(t,e){return e==null&&(e=le(16*4+2)),e.write_shift(2,t.password?nu(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(s){s[1]?e.write_shift(4,t[s[0]]!=null&&!t[s[0]]?1:0):e.write_shift(4,t[s[0]]!=null&&t[s[0]]?0:1)}),e}function $3(){}function W3(){}function V3(t,e,s,r,a,i,l){if(!t)return t;var c=e||{};r||(r={"!id":{}});var o=c.dense?[]:{},d,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,h=!1,x,m,p,v,b,_,g,j,w,k=[];c.biff=12,c["!row"]=0;var y=0,N=!1,S=[],T={},E=c.supbooks||a.supbooks||[[]];if(E.sharedf=T,E.arrayf=S,E.SheetNames=a.SheetNames||a.Sheets.map(function(Ee){return Ee.name}),!c.supbooks&&(c.supbooks=E,a.Names))for(var A=0;A<a.Names.length;++A)E[0][A+1]=a.Names[A];var H=[],V=[],L=!1;Rl[16]={n:"BrtShortReal",f:vv};var P;if(Pa(t,function(Y,de,De){if(!h)switch(De){case 148:d=Y;break;case 0:x=Y,c.sheetRows&&c.sheetRows<=x.r&&(h=!0),j=is(v=x.r),c["!row"]=x.r,(Y.hidden||Y.hpt||Y.level!=null)&&(Y.hpt&&(Y.hpx=Ci(Y.hpt)),V[Y.r]=Y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:Y[2]},Y[2]){case"n":m.v=Y[1];break;case"s":g=pl[Y[1]],m.v=g.t,m.r=g.r;break;case"b":m.v=!!Y[1];break;case"e":m.v=Y[1],c.cellText!==!1&&(m.w=Ma[m.v]);break;case"str":m.t="s",m.v=Y[1];break;case"is":m.t="s",m.v=Y[1].t;break}if((p=l.CellXf[Y[0].iStyleRef])&&xv(m,p.numFmtId,null,c,i,l),b=Y[0].c==-1?b+1:Y[0].c,c.dense?(o[v]||(o[v]=[]),o[v][b]=m):o[Yt(b)+j]=m,c.cellFormula){for(N=!1,y=0;y<S.length;++y){var B=S[y];x.r>=B[0].s.r&&x.r<=B[0].e.r&&b>=B[0].s.c&&b<=B[0].e.c&&(m.F=tt(B[0]),N=!0)}!N&&Y.length>3&&(m.f=Y[3])}if(f.s.r>x.r&&(f.s.r=x.r),f.s.c>b&&(f.s.c=b),f.e.r<x.r&&(f.e.r=x.r),f.e.c<b&&(f.e.c=b),c.cellDates&&p&&m.t=="n"&&Ii(Ge[p.numFmtId])){var X=Nn(m.v);X&&(m.t="d",m.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}P&&(P.type=="XLDAPR"&&(m.D=!0),P=void 0);break;case 1:case 12:if(!c.sheetStubs||u)break;m={t:"z",v:void 0},b=Y[0].c==-1?b+1:Y[0].c,c.dense?(o[v]||(o[v]=[]),o[v][b]=m):o[Yt(b)+j]=m,f.s.r>x.r&&(f.s.r=x.r),f.s.c>b&&(f.s.c=b),f.e.r<x.r&&(f.e.r=x.r),f.e.c<b&&(f.e.c=b),P&&(P.type=="XLDAPR"&&(m.D=!0),P=void 0);break;case 176:k.push(Y);break;case 49:P=((c.xlmeta||{}).Cell||[])[Y-1];break;case 494:var W=r["!id"][Y.relId];for(W?(Y.Target=W.Target,Y.loc&&(Y.Target+="#"+Y.loc),Y.Rel=W):Y.relId==""&&(Y.Target="#"+Y.loc),v=Y.rfx.s.r;v<=Y.rfx.e.r;++v)for(b=Y.rfx.s.c;b<=Y.rfx.e.c;++b)c.dense?(o[v]||(o[v]=[]),o[v][b]||(o[v][b]={t:"z",v:void 0}),o[v][b].l=Y):(_=Ye({c:b,r:v}),o[_]||(o[_]={t:"z",v:void 0}),o[_].l=Y);break;case 426:if(!c.cellFormula)break;S.push(Y),w=c.dense?o[v][b]:o[Yt(b)+j],w.f=Ms(Y[1],f,{r:x.r,c:b},E,c),w.F=tt(Y[0]);break;case 427:if(!c.cellFormula)break;T[Ye(Y[0].s)]=Y[1],w=c.dense?o[v][b]:o[Yt(b)+j],w.f=Ms(Y[1],f,{r:x.r,c:b},E,c);break;case 60:if(!c.cellStyles)break;for(;Y.e>=Y.s;)H[Y.e--]={width:Y.w/256,hidden:!!(Y.flags&1),level:Y.level},L||(L=!0,iu(Y.w/256)),tn(H[Y.e+1]);break;case 161:o["!autofilter"]={ref:tt(Y)};break;case 476:o["!margins"]=Y;break;case 147:a.Sheets[s]||(a.Sheets[s]={}),Y.name&&(a.Sheets[s].CodeName=Y.name),(Y.above||Y.left)&&(o["!outline"]={above:Y.above,left:Y.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Y.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!de.T){if(!u||c.WTF)throw new Error("Unexpected record 0x"+De.toString(16))}}},c),delete c.supbooks,delete c["!row"],!o["!ref"]&&(f.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(o["!ref"]=tt(d||f)),c.sheetRows&&o["!ref"]){var J=mt(o["!ref"]);c.sheetRows<=+J.e.r&&(J.e.r=c.sheetRows-1,J.e.r>f.e.r&&(J.e.r=f.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>f.e.c&&(J.e.c=f.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),o["!fullref"]=o["!ref"],o["!ref"]=tt(J))}return k.length>0&&(o["!merges"]=k),H.length>0&&(o["!cols"]=H),V.length>0&&(o["!rows"]=V),o}function z3(t,e,s,r,a,i,l){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=Bt(e),e.z=e.z||Ge[14],e.v=vs(Lt(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var o={r:s,c:r};switch(o.s=on(a.cellXfs,e,a),e.l&&i["!links"].push([Ye(o),e.l]),e.c&&i["!comments"].push([Ye(o),e.c]),e.t){case"s":case"str":return a.bookSST?(c=fu(a.Strings,e.v,a.revStrings),o.t="s",o.v=c,l?he(t,18,o3(e,o)):he(t,7,l3(e,o))):(o.t="str",l?he(t,17,_3(e,o)):he(t,6,y3(e,o))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?he(t,13,p3(e,o)):he(t,2,m3(e,o)):l?he(t,16,u3(e,o)):he(t,5,f3(e,o)),!0;case"b":return o.t="b",l?he(t,15,t3(e,o)):he(t,4,QA(e,o)),!0;case"e":return o.t="e",l?he(t,14,n3(e,o)):he(t,3,r3(e,o)),!0}return l?he(t,12,JA(e,o)):he(t,1,YA(e,o)),!0}function H3(t,e,s,r){var a=mt(e["!ref"]||"A1"),i,l="",c=[];he(t,145);var o=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var f=a.s.r;f<=d;++f){l=is(f),WA(t,e,a,f);var u=!1;if(f<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){f===a.s.r&&(c[h]=Yt(h)),i=c[h]+l;var x=o?(e[f]||[])[h]:e[i];if(!x){u=!1;continue}u=z3(t,x,f,h,r,e,u)}}he(t,146)}function G3(t,e){!e||!e["!merges"]||(he(t,177,T3(e["!merges"].length)),e["!merges"].forEach(function(s){he(t,176,E3(s))}),he(t,178))}function X3(t,e){!e||!e["!cols"]||(he(t,390),e["!cols"].forEach(function(s,r){s&&he(t,60,P3(r,s))}),he(t,391))}function q3(t,e){!e||!e["!ref"]||(he(t,648),he(t,649,B3(mt(e["!ref"]))),he(t,650))}function Y3(t,e,s){e["!links"].forEach(function(r){if(r[1].Target){var a=Nt(s,-1,r[1].Target.replace(/#.*$/,""),lt.HLINK);he(t,494,A3(r,a))}}),delete e["!links"]}function K3(t,e,s,r){if(e["!comments"].length>0){var a=Nt(r,-1,"../drawings/vmlDrawing"+(s+1)+".vml",lt.VML);he(t,551,Zf("rId"+a)),e["!legacy"]=a}}function J3(t,e,s,r){if(e["!autofilter"]){var a=e["!autofilter"],i=typeof a.ref=="string"?a.ref:tt(a.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var l=s.Workbook.Names,c=cr(i);c.s.r==c.e.r&&(c.e.r=cr(e["!ref"]).e.r,i=tt(c));for(var o=0;o<l.length;++o){var d=l[o];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==r){d.Ref="'"+s.SheetNames[r]+"'!"+i;break}}o==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+s.SheetNames[r]+"'!"+i}),he(t,161,Ui(mt(i))),he(t,162)}}function Z3(t,e,s){he(t,133),he(t,137,L3(e,s)),he(t,138),he(t,134)}function Q3(t,e){e["!protect"]&&he(t,535,U3(e["!protect"]))}function e6(t,e,s,r){var a=lr(),i=s.SheetNames[t],l=s.Sheets[i]||{},c=i;try{s&&s.Workbook&&(c=s.Workbook.Sheets[t].CodeName||c)}catch{}var o=mt(l["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],he(a,129),(s.vbaraw||l["!outline"])&&he(a,147,XA(c,l["!outline"])),he(a,148,zA(o)),Z3(a,l,s.Workbook),X3(a,l),H3(a,l,t,e),Q3(a,l),J3(a,l,s,t),G3(a,l),Y3(a,l,r),l["!margins"]&&he(a,476,R3(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&q3(a,l),K3(a,l,t,r),he(a,130),a.end()}function t6(t){var e=[],s=t.match(/^<c:numCache>/),r;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=s?+l[2]:l[2])});var a=ft((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){r=i.replace(/<.*?>/g,"")}),[e,a,r]}function s6(t,e,s,r,a,i){var l=i||{"!type":"chart"};if(!t)return i;var c=0,o=0,d="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var h=t6(u);f.s.r=f.s.c=0,f.e.c=c,d=Yt(c),h[0].forEach(function(x,m){l[d+is(m)]={t:"n",v:x,z:h[1]},o=m}),f.e.r<o&&(f.e.r=o),++c}),c>0&&(l["!ref"]=tt(f)),l}function r6(t,e,s,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(pv);return c&&uu(c[0],i,a,s),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}function a6(t,e){t.l+=10;var s=Us(t);return{name:s}}function n6(t,e,s,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Pa(t,function(o,d,f){switch(f){case 550:i["!rel"]=o;break;case 651:a.Sheets[s]||(a.Sheets[s]={}),o.name&&(a.Sheets[s].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}var hu=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],i6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],l6=[],c6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function bm(t,e){for(var s=0;s!=t.length;++s)for(var r=t[s],a=0;a!=e.length;++a){var i=e[a];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=Dt(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function _m(t,e){for(var s=0;s!=e.length;++s){var r=e[s];if(t[r[0]]==null)t[r[0]]=r[1];else switch(r[2]){case"bool":typeof t[r[0]]=="string"&&(t[r[0]]=Dt(t[r[0]]));break;case"int":typeof t[r[0]]=="string"&&(t[r[0]]=parseInt(t[r[0]],10));break}}}function bv(t){_m(t.WBProps,hu),_m(t.CalcPr,c6),bm(t.WBView,i6),bm(t.Sheets,l6),ji.date1904=Dt(t.WBProps.date1904)}function o6(t){return!t.Workbook||!t.Workbook.WBProps?"false":Dt(t.Workbook.WBProps.date1904)?"true":"false"}var d6="][*?/\\".split("");function _v(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var s=!0;return d6.forEach(function(r){if(t.indexOf(r)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");s=!1}}),s}function f6(t,e,s){t.forEach(function(r,a){_v(r);for(var i=0;i<a;++i)if(r==t[i])throw new Error("Duplicate Sheet Name: "+r);if(s){var l=e&&e[a]&&e[a].CodeName||r;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function u6(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];f6(t.SheetNames,e,!!t.vbaraw);for(var s=0;s<t.SheetNames.length;++s)oA(t.Sheets[t.SheetNames[s]],t.SheetNames[s],s)}var h6=/<\w+:workbook/;function m6(t,e){if(!t)throw new Error("Could not find file");var s={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",i={},l=0;if(t.replace(Vs,function(o,d){var f=Je(o);switch(oa(f[0])){case"<?xml":break;case"<workbook":o.match(h6)&&(a="xmlns"+o.match(/<(\w+):/)[1]),s.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],s.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":hu.forEach(function(u){if(f[u[0]]!=null)switch(u[2]){case"bool":s.WBProps[u[0]]=Dt(f[u[0]]);break;case"int":s.WBProps[u[0]]=parseInt(f[u[0]],10);break;default:s.WBProps[u[0]]=f[u[0]]}}),f.codeName&&(s.WBProps.CodeName=Et(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],s.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=ft(Et(f.name)),delete f[0],s.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":i={},i.Name=Et(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),Dt(f.hidden||"0")&&(i.Hidden=!0),l=d+o.length;break;case"</definedName>":i.Ref=ft(Et(t.slice(l,d))),s.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],s.CalcPr=f;break;case"<calcPr/>":delete f[0],s.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return o}),Xn.indexOf(s.xmlns)===-1)throw new Error("Unknown Namespace: "+s.xmlns);return bv(s),s}function wv(t){var e=[ls];e[e.length]=ke("workbook",null,{xmlns:Xn[0],"xmlns:r":xs.r});var s=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(hu.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(r[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=ke("workbookPr",null,r);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var l={name:kt(t.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=ke("sheet",null,l)}return e[e.length]="</sheets>",s&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var o={name:c.Name};c.Comment&&(o.comment=c.Comment),c.Sheet!=null&&(o.localSheetId=""+c.Sheet),c.Hidden&&(o.hidden="1"),c.Ref&&(e[e.length]=ke("definedName",kt(c.Ref),o))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function x6(t,e){var s={};return s.Hidden=t.read_shift(4),s.iTabID=t.read_shift(4),s.strRelID=W0(t),s.name=Us(t),s}function p6(t,e){return e||(e=le(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Zf(t.strRelID,e),js(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function g6(t,e){var s={},r=t.read_shift(4);s.defaultThemeVersion=t.read_shift(4);var a=e>8?Us(t):"";return a.length>0&&(s.CodeName=a),s.autoCompressPictures=!!(r&65536),s.backupFile=!!(r&64),s.checkCompatibility=!!(r&4096),s.date1904=!!(r&1),s.filterPrivacy=!!(r&8),s.hidePivotFieldList=!!(r&1024),s.promptedSolutions=!!(r&16),s.publishItems=!!(r&2048),s.refreshAllConnections=!!(r&262144),s.saveExternalLinkValues=!!(r&128),s.showBorderUnselectedTables=!!(r&4),s.showInkAnnotation=!!(r&32),s.showObjects=["all","placeholders","none"][r>>13&3],s.showPivotChartFilter=!!(r&32768),s.updateLinks=["userSet","never","always"][r>>8&3],s}function v6(t,e){e||(e=le(72));var s=0;return t&&t.filterPrivacy&&(s|=8),e.write_shift(4,s),e.write_shift(4,0),h1(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function y6(t,e){var s={};return t.read_shift(4),s.ArchID=t.read_shift(4),t.l+=e-8,s}function b6(t,e,s){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=Kj(t),l=rA(t,0,s),c=Jf(t);t.l=r;var o={Name:i,Ptg:l};return a<268435455&&(o.Sheet=a),c&&(o.Comment=c),o}function _6(t,e){var s={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;e||(e={}),e.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Rl[16]={n:"BrtFRTArchID$",f:y6},Pa(t,function(o,d,f){switch(f){case 156:l.SheetNames.push(o.name),s.Sheets.push(o);break;case 153:s.WBProps=o;break;case 39:o.Sheet!=null&&(e.SID=o.Sheet),o.Ref=Ms(o.Ptg,null,null,l,e),delete e.SID,delete o.Ptg,i.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([f,o]):l[0]=[f,o],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(o),l.XTI=l.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(f),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(f),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),bv(s),s.Names=i,s.supbooks=l,s}function w6(t,e){he(t,143);for(var s=0;s!=e.SheetNames.length;++s){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[s]&&e.Workbook.Sheets[s].Hidden||0,a={Hidden:r,iTabID:s+1,strRelID:"rId"+(s+1),name:e.SheetNames[s]};he(t,156,p6(a))}he(t,144)}function N6(t,e){e||(e=le(127));for(var s=0;s!=4;++s)e.write_shift(4,0);return js("SheetJS",e),js(No.version,e),js(No.version,e),js("7262",e),e.length>e.l?e.slice(0,e.l):e}function j6(t,e){e||(e=le(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var s=120;return e.write_shift(1,s),e.length>e.l?e.slice(0,e.l):e}function k6(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var s=e.Workbook.Sheets,r=0,a=-1,i=-1;r<s.length;++r)!s[r]||!s[r].Hidden&&a==-1?a=r:s[r].Hidden==1&&i==-1&&(i=r);i>a||(he(t,135),he(t,158,j6(a)),he(t,136))}}function S6(t,e){var s=lr();return he(s,131),he(s,128,N6()),he(s,153,v6(t.Workbook&&t.Workbook.WBProps||null)),k6(s,t),w6(s,t),he(s,132),s.end()}function E6(t,e,s){return e.slice(-4)===".bin"?_6(t,s):m6(t,s)}function T6(t,e,s,r,a,i,l,c){return e.slice(-4)===".bin"?V3(t,r,s,a,i,l,c):bA(t,r,s,a,i,l,c)}function C6(t,e,s,r,a,i,l,c){return e.slice(-4)===".bin"?n6(t,r,s,a,i):r6(t,r,s,a,i)}function A6(t,e,s,r,a,i,l,c){return e.slice(-4)===".bin"?OT():DT()}function F6(t,e,s,r,a,i,l,c){return e.slice(-4)===".bin"?AT():FT()}function O6(t,e,s,r){return e.slice(-4)===".bin"?EE(t,s,r):xE(t,s,r)}function D6(t,e,s){return sv(t,s)}function P6(t,e,s){return e.slice(-4)===".bin"?P4(t,s):F4(t,s)}function M6(t,e,s){return e.slice(-4)===".bin"?kT(t,s):pT(t,s)}function R6(t,e,s){return e.slice(-4)===".bin"?hT(t):fT(t)}function I6(t,e,s,r){return s.slice(-4)===".bin"?mT(t,e,s,r):void 0}function L6(t,e,s){return e.slice(-4)===".bin"?cT(t,e,s):dT(t,e,s)}function B6(t,e,s){return(e.slice(-4)===".bin"?S6:wv)(t)}function U6(t,e,s,r,a){return(e.slice(-4)===".bin"?e6:gv)(t,s,r,a)}function $6(t,e,s){return(e.slice(-4)===".bin"?IE:ev)(t,s)}function W6(t,e,s){return(e.slice(-4)===".bin"?I4:G1)(t,s)}function V6(t,e,s){return(e.slice(-4)===".bin"?ST:nv)(t)}function z6(t){return(t.slice(-4)===".bin"?oT:rv)()}var Nv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,jv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ar(t,e){var s=t.split(/\s+/),r=[];if(e||(r[0]=s[0]),s.length===1)return r;var a=t.match(Nv),i,l,c,o;if(a)for(o=0;o!=a.length;++o)i=a[o].match(jv),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),r[c]=i[2].slice(1,i[2].length-1));return r}function H6(t){var e=t.split(/\s+/),s={};if(e.length===1)return s;var r=t.match(Nv),a,i,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(jv),(i=a[1].indexOf(":"))===-1?s[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),s[l]=a[2].slice(1,a[2].length-1));return s}var vl;function G6(t,e){var s=vl[t]||ft(t);return s==="General"?Rn(e):Tr(s,e)}function X6(t,e,s,r){var a=r;switch((s[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Dt(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Lt(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+s[0])}t[ft(e)]=a}function q6(t,e,s){if(t.t!=="z"){if(!s||s.cellText!==!1)try{t.t==="e"?t.w=t.w||Ma[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=El(t.v):t.w=Rn(t.v):t.w=G6(e||"General",t.v)}catch(i){if(s.WTF)throw i}try{var r=vl[e]||e||"General";if(s.cellNF&&(t.z=r),s.cellDates&&t.t=="n"&&Ii(r)){var a=Nn(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(s.WTF)throw i}}}function Y6(t,e,s){if(s.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=lE[r.Pattern]||r.Pattern)}t[e.ID]=e}function K6(t,e,s,r,a,i,l,c,o,d){var f="General",u=r.StyleID,h={};d=d||{};var x=[],m=0;for(u===void 0&&c&&(u=c.StyleID),u===void 0&&l&&(u=l.StyleID);i[u]!==void 0&&(i[u].nf&&(f=i[u].nf),i[u].Interior&&x.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(s.Type){case"Boolean":r.t="b",r.v=Dt(t);break;case"String":r.t="s",r.r=Lh(ft(t)),r.v=t.indexOf("<")>-1?ft(e||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),r.v=(Lt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=ft(t):r.v<60&&(r.v=r.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=v1[t],d.cellText!==!1&&(r.w=t);break;default:t==""&&e==""?r.t="z":(r.t="s",r.v=Lh(e||t));break}if(q6(r,f,d),d.cellFormula!==!1)if(r.Formula){var p=ft(r.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),r.f=Ni(p,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Ni("RC:RC",a):r.ArrayRange&&(r.F=Ni(r.ArrayRange,a),o.push([mt(r.F),r.F]))}else for(m=0;m<o.length;++m)a.r>=o[m][0].s.r&&a.r<=o[m][0].e.r&&a.c>=o[m][0].s.c&&a.c<=o[m][0].e.c&&(r.F=o[m][1]);d.cellStyles&&(x.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),r.s=h),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function J6(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function i0(t,e){var s=e||{};Li();var r=tl(Hf(t));(s.type=="binary"||s.type=="array"||s.type=="base64")&&(r=Et(r));var a=r.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Bt(s);return l.type="string",Ti.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Oe){a.indexOf("<"+Oe)>=0&&(i=!0)}),i)return RF(r,s);vl={"General Number":"General","General Date":Ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ge[15],"Short Date":Ge[14],"Long Time":Ge[19],"Medium Time":Ge[18],"Short Time":Ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ge[2],Standard:Ge[4],Percent:Ge[10],Scientific:Ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,o=[],d,f={},u=[],h=s.dense?[]:{},x="",m={},p={},v=Ar('<Data ss:Type="String">'),b=0,_=0,g=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},k={},y="",N=0,S=[],T={},E={},A=0,H=[],V=[],L={},P=[],J,Ee=!1,Y=[],de=[],De={},B=0,X=0,W={Sheets:[],WBProps:{date1904:!1}},z={};Al.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";c=Al.exec(r);)switch(c[3]=(ae=c[3]).toLowerCase()){case"data":if(ae=="data"){if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break}if(o[o.length-1][1])break;c[1]==="/"?K6(r.slice(b,c.index),y,v,o[o.length-1][0]=="comment"?L:m,{c:_,r:g},w,P[_],p,Y,s):(y="",v=Ar(c[0]),b=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(V.length>0&&(m.c=V),(!s.sheetRows||s.sheetRows>g)&&m.v!==void 0&&(s.dense?(h[g]||(h[g]=[]),h[g][_]=m):h[Yt(_)+is(g)]=m),m.HRef&&(m.l={Target:ft(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(B=_+(parseInt(m.MergeAcross,10)|0),X=g+(parseInt(m.MergeDown,10)|0),S.push({s:{c:_,r:g},e:{c:B,r:X}})),!s.sheetStubs)m.MergeAcross?_=B+1:++_;else if(m.MergeAcross||m.MergeDown){for(var me=_;me<=B;++me)for(var xe=g;xe<=X;++xe)(me>_||xe>g)&&(s.dense?(h[xe]||(h[xe]=[]),h[xe][me]={t:"z"}):h[Yt(me)+is(xe)]={t:"z"});_=B+1}else++_;else m=H6(c[0]),m.Index&&(_=+m.Index-1),_<j.s.c&&(j.s.c=_),_>j.e.c&&(j.e.c=_),c[0].slice(-2)==="/>"&&++_,V=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(g<j.s.r&&(j.s.r=g),g>j.e.r&&(j.e.r=g),c[0].slice(-2)==="/>"&&(p=Ar(c[0]),p.Index&&(g=+p.Index-1)),_=0,++g):(p=Ar(c[0]),p.Index&&(g=+p.Index-1),De={},(p.AutoFitHeight=="0"||p.Height)&&(De.hpx=parseInt(p.Height,10),De.hpt=Ml(De.hpx),de[g]=De),p.Hidden=="1"&&(De.hidden=!0,de[g]=De));break;case"worksheet":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));u.push(x),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(h["!ref"]=tt(j),s.sheetRows&&s.sheetRows<=j.e.r&&(h["!fullref"]=h["!ref"],j.e.r=s.sheetRows-1,h["!ref"]=tt(j))),S.length&&(h["!merges"]=S),P.length>0&&(h["!cols"]=P),de.length>0&&(h["!rows"]=de),f[x]=h}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=_=0,o.push([c[3],!1]),d=Ar(c[0]),x=ft(d.Name),h=s.dense?[]:{},S=[],Y=[],de=[],z={name:x,Hidden:0},W.Sheets.push(z);break;case"table":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;o.push([c[3],!1]),P=[],Ee=!1}break;case"style":c[1]==="/"?Y6(w,k,s):k=Ar(c[0]);break;case"numberformat":k.nf=ft(Ar(c[0]).Format||"General"),vl[k.nf]&&(k.nf=vl[k.nf]);for(var ue=0;ue!=392&&Ge[ue]!=k.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(Ge[ue]==null){Sa(k.nf,ue);break}}break;case"column":if(o[o.length-1][0]!=="table")break;if(J=Ar(c[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!Ee&&J.wpx>10){Ee=!0,Rs=Z1;for(var oe=0;oe<P.length;++oe)P[oe]&&tn(P[oe])}Ee&&tn(J),P[J.Index-1||P.length]=J;for(var ze=0;ze<+J.Span;++ze)P[P.length]=Bt(J);break;case"namedrange":if(c[1]==="/")break;W.Names||(W.Names=[]);var F=Je(c[0]),ye={Name:F.Name,Ref:Ni(F.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(ye.Sheet=W.Sheets.length-1),W.Names.push(ye);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?y+=r.slice(N,c.index):N=c.index+c[0].length;break;case"interior":if(!s.cellStyles)break;k.Interior=Ar(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?_k(T,ae,r.slice(A,c.index)):A=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else o.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));J6(L),V.push(L)}else o.push([c[3],!1]),d=Ar(c[0]),L={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Ie=Ar(c[0]);h["!autofilter"]={ref:Ni(Ie.Range).replace(/\$/g,"")},o.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"null":break;default:if(o.length==0&&c[3]=="document"||o.length==0&&c[3]=="uof")return Sm(r,s);var Le=!0;switch(o[o.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Le=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Le=!1}break;case"excelworkbook":switch(c[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Le=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Le=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(A,c.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else A=c.index+c[0].length;break;case"header":h["!margins"]||Fn(h["!margins"]={},"xlml"),isNaN(+Je(c[0]).Margin)||(h["!margins"].header=+Je(c[0]).Margin);break;case"footer":h["!margins"]||Fn(h["!margins"]={},"xlml"),isNaN(+Je(c[0]).Margin)||(h["!margins"].footer=+Je(c[0]).Margin);break;case"pagemargins":var K=Je(c[0]);h["!margins"]||Fn(h["!margins"]={},"xlml"),isNaN(+K.Top)||(h["!margins"].top=+K.Top),isNaN(+K.Left)||(h["!margins"].left=+K.Left),isNaN(+K.Right)||(h["!margins"].right=+K.Right),isNaN(+K.Bottom)||(h["!margins"].bottom=+K.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Le=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Le=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Le=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Le=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Le=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Le=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Le=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Le=!1}break;case"smarttags":break;default:Le=!1;break}if(Le||c[3].match(/!\[CDATA/))break;if(!o[o.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+o.join("|");if(o[o.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?X6(E,ae,H,r.slice(A,c.index)):(H=c,A=c.index+c[0].length);break}if(s.WTF)throw"Unrecognized tag: "+c[3]+"|"+o.join("|")}var Z={};return!s.bookSheets&&!s.bookProps&&(Z.Sheets=f),Z.SheetNames=u,Z.Workbook=W,Z.SSF=Bt(Ge),Z.Props=T,Z.Custprops=E,Z}function Y0(t,e){switch(xu(e=e||{}),e.type||"base64"){case"base64":return i0(xr(t),e);case"binary":case"buffer":case"file":return i0(t,e);case"array":return i0(ln(t),e)}}function Z6(t,e){var s=[];return t.Props&&s.push(wk(t.Props,e)),t.Custprops&&s.push(Nk(t.Props,t.Custprops)),s.join("")}function Q6(){return""}function eF(t,e){var s=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,a){var i=[];i.push(ke("NumberFormat",null,{"ss:Format":kt(Ge[r.numFmtId])}));var l={"ss:ID":"s"+(21+a)};s.push(ke("Style",i.join(""),l))}),ke("Styles",s.join(""))}function kv(t){return ke("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ou(t.Ref,{r:0,c:0})})}function tF(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,s=[],r=0;r<e.length;++r){var a=e[r];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||s.push(kv(a)))}return ke("Names",s.join(""))}function sF(t,e,s,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,i=[],l=0;l<a.length;++l){var c=a[l];c.Sheet==s&&(c.Name.match(/^_xlfn\./)||i.push(kv(c)))}return i.join("")}function rF(t,e,s,r){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(ke("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(ke("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(ke("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[s])if(r.Workbook.Sheets[s].Hidden)a.push(ke("Visible",r.Workbook.Sheets[s].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<s&&!(r.Workbook.Sheets[i]&&!r.Workbook.Sheets[i].Hidden);++i);i==s&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Ts("ProtectContents","True")),t["!protect"].objects&&a.push(Ts("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Ts("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Ts("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Ts("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":ke("WorksheetOptions",a.join(""),{xmlns:dr.x})}function aF(t){return t.map(function(e){var s=kj(e.t||""),r=ke("ss:Data",s,{xmlns:"http://www.w3.org/TR/REC-html40"});return ke("Comment",r,{"ss:Author":e.a})}).join("")}function nF(t,e,s,r,a,i,l){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+kt(ou(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var o=Kt(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(o.r==l.r?"":"["+(o.r-l.r)+"]")+"C"+(o.c==l.c?"":"["+(o.c-l.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=kt(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=kt(t.l.Tooltip))),s["!merges"])for(var d=s["!merges"],f=0;f!=d.length;++f)d[f].s.c!=l.c||d[f].s.r!=l.r||(d[f].e.c>d[f].s.c&&(c["ss:MergeAcross"]=d[f].e.c-d[f].s.c),d[f].e.r>d[f].s.r&&(c["ss:MergeDown"]=d[f].e.r-d[f].s.r));var u="",h="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":u="Number",h=String(t.v);break;case"b":u="Boolean",h=t.v?"1":"0";break;case"e":u="Error",h=Ma[t.v];break;case"d":u="DateTime",h=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ge[14]);break;case"s":u="String",h=jj(t.v||"");break}var x=on(r.cellXfs,t,r);c["ss:StyleID"]="s"+(21+x),c["ss:Index"]=l.c+1;var m=t.v!=null?h:"",p=t.t=="z"?"":'<Data ss:Type="'+u+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=aF(t.c)),ke("Cell",p,c)}function iF(t,e){var s='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Ci(e.hpt)),e.hpx&&(s+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(s+=' ss:Hidden="1"')),s+">"}function lF(t,e,s,r){if(!t["!ref"])return"";var a=mt(t["!ref"]),i=t["!merges"]||[],l=0,c=[];t["!cols"]&&t["!cols"].forEach(function(v,b){tn(v);var _=!!v.width,g=_d(b,v),j={"ss:Index":b+1};_&&(j["ss:Width"]=Dl(g.width)),v.hidden&&(j["ss:Hidden"]="1"),c.push(ke("Column",null,j))});for(var o=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var f=[iF(d,(t["!rows"]||[])[d])],u=a.s.c;u<=a.e.c;++u){var h=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>u)&&!(i[l].s.r>d)&&!(i[l].e.c<u)&&!(i[l].e.r<d)){(i[l].s.c!=u||i[l].s.r!=d)&&(h=!0);break}if(!h){var x={r:d,c:u},m=Ye(x),p=o?(t[d]||[])[u]:t[m];f.push(nF(p,m,t,e,s,r,x))}}f.push("</Row>"),f.length>2&&c.push(f.join(""))}return c.join("")}function cF(t,e,s){var r=[],a=s.SheetNames[t],i=s.Sheets[a],l=i?sF(i,e,t,s):"";return l.length>0&&r.push("<Names>"+l+"</Names>"),l=i?lF(i,e,t,s):"",l.length>0&&r.push("<Table>"+l+"</Table>"),r.push(rF(i,e,t,s)),r.join("")}function oF(t,e){e||(e={}),t.SSF||(t.SSF=Bt(Ge)),t.SSF&&(Li(),md(t.SSF),e.revssf=pd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],on(e.cellXfs,{},{revssf:{General:0}}));var s=[];s.push(Z6(t,e)),s.push(Q6()),s.push(""),s.push("");for(var r=0;r<t.SheetNames.length;++r)s.push(ke("Worksheet",cF(r,e,t),{"ss:Name":kt(t.SheetNames[r])}));return s[2]=eF(t,e),s[3]=tF(t),ls+ke("Workbook",s.join(""),{xmlns:dr.ss,"xmlns:o":dr.o,"xmlns:x":dr.x,"xmlns:ss":dr.ss,"xmlns:dt":dr.dt,"xmlns:html":dr.html})}function dF(t){var e={},s=t.content;if(s.l=28,e.AnsiUserType=s.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=tk(s),s.length-s.l<=4)return e;var r=s.read_shift(4);if(r==0||r>40||(s.l-=4,e.Reserved1=s.read_shift(0,"lpstr-ansi"),s.length-s.l<=4)||(r=s.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=sk(s),r=s.read_shift(4),r==0||r>40))return e;s.l-=4,e.Reserved2=s.read_shift(0,"lpwstr")}var fF=[60,1084,2066,2165,2175];function uF(t,e,s,r,a){var i=r,l=[],c=s.slice(s.l,s.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),s.l+=i;for(var o=_a(s,s.l),d=K0[o],f=0;d!=null&&fF.indexOf(o)>-1;)i=_a(s,s.l+2),f=s.l+4,o==2066?f+=4:(o==2165||o==2175)&&(f+=12),c=s.slice(f,s.l+4+i),l.push(c),s.l+=4+i,d=K0[o=_a(s,s.l)];var u=Ns(l);Es(u,0);var h=0;u.lens=[];for(var x=0;x<l.length;++x)u.lens.push(h),h+=l[x].length;if(u.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+u.length+" < "+r;return e.f(u,u.length,a)}function Hr(t,e,s){if(t.t!=="z"&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ge[r])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ma[t.v]:r===0||r=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=El(t.v):t.w=Rn(t.v):t.w=Tr(r,t.v,{date1904:!!s,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&r&&t.t=="n"&&Ii(Ge[r]||String(r))){var a=Nn(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function kc(t,e,s){return{v:t,ixfe:e,t:s}}function hF(t,e){var s={opts:{}},r={},a=e.dense?[]:{},i={},l={},c=null,o=[],d="",f={},u,h="",x,m,p,v,b={},_=[],g,j,w=[],k=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},S=function(Ke){return Ke<8?Tn[Ke]:Ke<64&&k[Ke-8]||Tn[Ke]},T=function(Ke,ct,cs){var yt=ct.XF.data;if(!(!yt||!yt.patternType||!cs||!cs.cellStyles)){ct.s={},ct.s.patternType=yt.patternType;var ee;(ee=Ol(S(yt.icvFore)))&&(ct.s.fgColor={rgb:ee}),(ee=Ol(S(yt.icvBack)))&&(ct.s.bgColor={rgb:ee})}},E=function(Ke,ct,cs){if(!(De>1)&&!(cs.sheetRows&&Ke.r>=cs.sheetRows)){if(cs.cellStyles&&ct.XF&&ct.XF.data&&T(Ke,ct,cs),delete ct.ixfe,delete ct.XF,u=Ke,h=Ye(Ke),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ke.r<l.s.r&&(l.s.r=Ke.r),Ke.c<l.s.c&&(l.s.c=Ke.c),Ke.r+1>l.e.r&&(l.e.r=Ke.r+1),Ke.c+1>l.e.c&&(l.e.c=Ke.c+1),cs.cellFormula&&ct.f){for(var yt=0;yt<_.length;++yt)if(!(_[yt][0].s.c>Ke.c||_[yt][0].s.r>Ke.r)&&!(_[yt][0].e.c<Ke.c||_[yt][0].e.r<Ke.r)){ct.F=tt(_[yt][0]),(_[yt][0].s.c!=Ke.c||_[yt][0].s.r!=Ke.r)&&delete ct.f,ct.f&&(ct.f=""+Ms(_[yt][1],l,Ke,Y,A));break}}cs.dense?(a[Ke.r]||(a[Ke.r]=[]),a[Ke.r][Ke.c]=ct):a[h]=ct}},A={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(A.password=e.password);var H,V=[],L=[],P=[],J=[],Ee=!1,Y=[];Y.SheetNames=A.snames,Y.sharedf=A.sharedf,Y.arrayf=A.arrayf,Y.names=[],Y.XTI=[];var de=0,De=0,B=0,X=[],W=[],z;A.codepage=1200,Pr(1200);for(var ae=!1;t.l<t.length-1;){var me=t.l,xe=t.read_shift(2);if(xe===0&&de===10)break;var ue=t.l===t.length?0:t.read_shift(2),oe=K0[xe];if(oe&&oe.f){if(e.bookSheets&&de===133&&xe!==133)break;if(de=xe,oe.r===2||oe.r==12){var ze=t.read_shift(2);if(ue-=2,!A.enc&&ze!==xe&&((ze&255)<<8|ze>>8)!==xe)throw new Error("rt mismatch: "+ze+"!="+xe);oe.r==12&&(t.l+=10,ue-=10)}var F={};if(xe===10?F=oe.f(t,ue,A):F=uF(xe,oe,t,ue,A),De==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(xe){case 34:s.opts.Date1904=y.WBProps.date1904=F;break;case 134:s.opts.WriteProtect=!0;break;case 47:if(A.enc||(t.l=0),A.enc=F,!e.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=F;break;case 66:var ye=Number(F);switch(ye){case 21010:ye=1200;break;case 32768:ye=1e4;break;case 32769:ye=1252;break}Pr(A.codepage=ye),ae=!0;break;case 317:A.rrtabid=F;break;case 25:A.winlocked=F;break;case 439:s.opts.RefreshAll=F;break;case 12:s.opts.CalcCount=F;break;case 16:s.opts.CalcDelta=F;break;case 17:s.opts.CalcIter=F;break;case 13:s.opts.CalcMode=F;break;case 14:s.opts.CalcPrecision=F;break;case 95:s.opts.CalcSaveRecalc=F;break;case 15:A.CalcRefMode=F;break;case 2211:s.opts.FullCalc=F;break;case 129:F.fDialog&&(a["!type"]="dialog"),F.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),F.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:w.push(F);break;case 430:Y.push([F]),Y[Y.length-1].XTI=[];break;case 35:case 547:Y[Y.length-1].push(F);break;case 24:case 536:z={Name:F.Name,Ref:Ms(F.rgce,l,null,Y,A)},F.itab>0&&(z.Sheet=F.itab-1),Y.names.push(z),Y[0]||(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(W[F.itab-1]={ref:tt(F.rgce[0][0][1][2])});break;case 22:A.ExternCount=F;break;case 23:Y.length==0&&(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].XTI=Y[Y.length-1].XTI.concat(F),Y.XTI=Y.XTI.concat(F);break;case 2196:if(A.biff<8)break;z!=null&&(z.Comment=F[1]);break;case 18:a["!protect"]=F;break;case 19:F!==0&&A.WTF&&console.error("Password verifier: "+F);break;case 133:i[F.pos]=F,A.snames.push(F.name);break;case 10:{if(--De)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=tt(l),e.sheetRows&&e.sheetRows<=l.e.r){var Ie=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=tt(l),l.e.r=Ie}l.e.r++,l.e.c++}V.length>0&&(a["!merges"]=V),L.length>0&&(a["!objects"]=L),P.length>0&&(a["!cols"]=P),J.length>0&&(a["!rows"]=J),y.Sheets.push(N)}d===""?f=a:r[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),A.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(A.biff=5,ae=!0,Pr(A.codepage=28591)),A.biff==8&&F.BIFFVer==0&&F.dt==16&&(A.biff=2),De++)break;if(a=e.dense?[]:{},A.biff<8&&!ae&&(ae=!0,Pr(A.codepage=e.codepage||1252)),A.biff<5||F.BIFFVer==0&&F.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Le={pos:t.l-ue,name:d};i[Le.pos]=Le,A.snames.push(d)}else d=(i[me]||{name:""}).name;F.dt==32&&(a["!type"]="chart"),F.dt==64&&(a["!type"]="macro"),V=[],L=[],A.arrayf=_=[],P=[],J=[],Ee=!1,N={Hidden:(i[me]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[F.r]||[])[F.c]:a[Ye({c:F.c,r:F.r})])&&++F.c,g={ixfe:F.ixfe,XF:w[F.ixfe]||{},v:F.val,t:"n"},B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E({c:F.c,r:F.r},g,e);break;case 5:case 517:g={ixfe:F.ixfe,XF:w[F.ixfe],v:F.val,t:F.t},B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E({c:F.c,r:F.r},g,e);break;case 638:g={ixfe:F.ixfe,XF:w[F.ixfe],v:F.rknum,t:"n"},B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E({c:F.c,r:F.r},g,e);break;case 189:for(var K=F.c;K<=F.C;++K){var Z=F.rkrec[K-F.c][0];g={ixfe:Z,XF:w[Z],v:F.rkrec[K-F.c][1],t:"n"},B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E({c:K,r:F.r},g,e)}break;case 6:case 518:case 1030:{if(F.val=="String"){c=F;break}if(g=kc(F.val,F.cell.ixfe,F.tt),g.XF=w[g.ixfe],e.cellFormula){var Oe=F.formula;if(Oe&&Oe[0]&&Oe[0][0]&&Oe[0][0][0]=="PtgExp"){var Te=Oe[0][0][1][0],M=Oe[0][0][1][1],q=Ye({r:Te,c:M});b[q]?g.f=""+Ms(F.formula,l,F.cell,Y,A):g.F=((e.dense?(a[Te]||[])[M]:a[q])||{}).F}else g.f=""+Ms(F.formula,l,F.cell,Y,A)}B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E(F.cell,g,e),c=F}break;case 7:case 519:if(c)c.val=F,g=kc(F,c.cell.ixfe,"s"),g.XF=w[g.ixfe],e.cellFormula&&(g.f=""+Ms(c.formula,l,c.cell,Y,A)),B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E(c.cell,g,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(F);var Q=Ye(F[0].s);if(x=e.dense?(a[F[0].s.r]||[])[F[0].s.c]:a[Q],e.cellFormula&&x){if(!c||!Q||!x)break;x.f=""+Ms(F[1],l,F[0],Y,A),x.F=tt(F[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!c)break;b[Ye(c.cell)]=F[0],x=e.dense?(a[c.cell.r]||[])[c.cell.c]:a[Ye(c.cell)],(x||{}).f=""+Ms(F[0],l,u,Y,A)}}break;case 253:g=kc(o[F.isst].t,F.ixfe,"s"),o[F.isst].h&&(g.h=o[F.isst].h),g.XF=w[g.ixfe],B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E({c:F.c,r:F.r},g,e);break;case 513:e.sheetStubs&&(g={ixfe:F.ixfe,XF:w[F.ixfe],t:"z"},B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E({c:F.c,r:F.r},g,e));break;case 190:if(e.sheetStubs)for(var _e=F.c;_e<=F.C;++_e){var ve=F.ixfe[_e-F.c];g={ixfe:ve,XF:w[ve],t:"z"},B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E({c:_e,r:F.r},g,e)}break;case 214:case 516:case 4:g=kc(F.val,F.ixfe,"s"),g.XF=w[g.ixfe],B>0&&(g.z=X[g.ixfe>>8&63]),Hr(g,e,s.opts.Date1904),E({c:F.c,r:F.r},g,e);break;case 0:case 512:De===1&&(l=F);break;case 252:o=F;break;case 1054:if(A.biff==4){X[B++]=F[1];for(var fe=0;fe<B+163&&Ge[fe]!=F[1];++fe);fe>=163&&Sa(F[1],B+163)}else Sa(F[1],F[0]);break;case 30:{X[B++]=F;for(var Fe=0;Fe<B+163&&Ge[Fe]!=F;++Fe);Fe>=163&&Sa(F,B+163)}break;case 229:V=V.concat(F);break;case 93:L[F.cmo[0]]=A.lastobj=F;break;case 438:A.lastobj.TxO=F;break;case 127:A.lastobj.ImData=F;break;case 440:for(v=F[0].s.r;v<=F[0].e.r;++v)for(p=F[0].s.c;p<=F[0].e.c;++p)x=e.dense?(a[v]||[])[p]:a[Ye({c:p,r:v})],x&&(x.l=F[1]);break;case 2048:for(v=F[0].s.r;v<=F[0].e.r;++v)for(p=F[0].s.c;p<=F[0].e.c;++p)x=e.dense?(a[v]||[])[p]:a[Ye({c:p,r:v})],x&&x.l&&(x.l.Tooltip=F[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;x=e.dense?(a[F[0].r]||[])[F[0].c]:a[Ye(F[0])];var rt=L[F[2]];x||(e.dense?(a[F[0].r]||(a[F[0].r]=[]),x=a[F[0].r][F[0].c]={t:"z"}):x=a[Ye(F[0])]={t:"z"},l.e.r=Math.max(l.e.r,F[0].r),l.s.r=Math.min(l.s.r,F[0].r),l.e.c=Math.max(l.e.c,F[0].c),l.s.c=Math.min(l.s.c,F[0].c)),x.c||(x.c=[]),m={a:F[1],t:rt.TxO.t},x.c.push(m)}break;case 2173:eT(w[F.ixfe],F.ext);break;case 125:{if(!A.cellStyles)break;for(;F.e>=F.s;)P[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},Ee||(Ee=!0,iu(F.w/256)),tn(P[F.e+1])}break;case 520:{var Ze={};F.level!=null&&(J[F.r]=Ze,Ze.level=F.level),F.hidden&&(J[F.r]=Ze,Ze.hidden=!0),F.hpt&&(J[F.r]=Ze,Ze.hpt=F.hpt,Ze.hpx=Ci(F.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Fn(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=F;break;case 161:a["!margins"]||Fn(a["!margins"]={}),a["!margins"].header=F.header,a["!margins"].footer=F.footer;break;case 574:F.RTL&&(y.Views[0].RTL=!0);break;case 146:k=F;break;case 2198:H=F;break;case 140:j=F;break;case 442:d?N.CodeName=F||N.name:y.WBProps.CodeName=F||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),t.l+=ue}return s.SheetNames=es(i).sort(function(St,Ke){return Number(St)-Number(Ke)}).map(function(St){return i[St].name}),e.bookSheets||(s.Sheets=r),!s.SheetNames.length&&f["!ref"]?(s.SheetNames.push("Sheet1"),s.Sheets&&(s.Sheets.Sheet1=f)):s.Preamble=f,s.Sheets&&W.forEach(function(St,Ke){s.Sheets[s.SheetNames[Ke]]["!autofilter"]=St}),s.Strings=o,s.SSF=Bt(Ge),A.enc&&(s.Encryption=A.enc),H&&(s.Themes=H),s.Metadata={},j!==void 0&&(s.Metadata.Country=j),Y.names.length>0&&(y.Names=Y.names),s.Workbook=y,s}var yl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function mF(t,e,s){var r=We.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=sm(r,V0,yl.DSI);for(var i in a)e[i]=a[i]}catch(d){if(s.WTF)throw d}var l=We.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=sm(l,z0,yl.SI);for(var o in c)e[o]==null&&(e[o]=c[o])}catch(d){if(s.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(j1(e.HeadingPairs,e.TitlesOfParts,e,s),delete e.HeadingPairs,delete e.TitlesOfParts)}function xF(t,e){var s=[],r=[],a=[],i=0,l,c=Oh(V0,"n"),o=Oh(z0,"n");if(t.Props)for(l=es(t.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(c,l[i])?s:Object.prototype.hasOwnProperty.call(o,l[i])?r:a).push([l[i],t.Props[l[i]]]);if(t.Custprops)for(l=es(t.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(c,l[i])?s:Object.prototype.hasOwnProperty.call(o,l[i])?r:a).push([l[i],t.Custprops[l[i]]]);var d=[];for(i=0;i<a.length;++i)F1.indexOf(a[i][0])>-1||N1.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);r.length&&We.utils.cfb_add(e,"/SummaryInformation",rm(r,yl.SI,o,z0)),(s.length||d.length)&&We.utils.cfb_add(e,"/DocumentSummaryInformation",rm(s,yl.DSI,c,V0,d.length?d:null,yl.UDI))}function Sv(t,e){e||(e={}),xu(e),Rf(),e.codepage&&Mf(e.codepage);var s,r;if(t.FullPaths){if(We.find(t,"/encryption"))throw new Error("File is password-protected");s=We.find(t,"!CompObj"),r=We.find(t,"/Workbook")||We.find(t,"/Book")}else{switch(e.type){case"base64":t=ur(xr(t));break;case"binary":t=ur(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Es(t,0),r={content:t}}var a,i;if(s&&dF(s),e.bookProps&&!e.bookSheets)a={};else{var l=it?"buffer":"array";if(r&&r.content)a=hF(r.content,e);else if((i=We.find(t,"PerfectOffice_MAIN"))&&i.content)a=An.to_workbook(i.content,(e.type=l,e));else if((i=We.find(t,"NativeContent_MAIN"))&&i.content)a=An.to_workbook(i.content,(e.type=l,e));else throw(i=We.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&We.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=TT(t))}var c={};return t.FullPaths&&mF(t,c,e),a.Props=a.Custprops=c,e.bookFiles&&(a.cfb=t),a}function pF(t,e){var s=e||{},r=We.utils.cfb_new({root:"R"}),a="/Workbook";switch(s.bookType||"xls"){case"xls":s.bookType="biff8";case"xla":s.bookType||(s.bookType="xla");case"biff8":a="/Workbook",s.biff=8;break;case"biff5":a="/Book",s.biff=5;break;default:throw new Error("invalid type "+s.bookType+" for XLS CFB")}return We.utils.cfb_add(r,a,Ev(t,s)),s.biff==8&&(t.Props||t.Custprops)&&xF(t,r),s.biff==8&&t.vbaraw&&CT(r,We.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),r}var Rl={0:{f:UA},1:{f:qA},2:{f:h3},3:{f:s3},4:{f:ZA},5:{f:d3},6:{f:v3},7:{f:i3},8:{f:k3},9:{f:j3},10:{f:w3},11:{f:N3},12:{f:KA},13:{f:x3},14:{f:a3},15:{f:e3},16:{f:vv},17:{f:b3},18:{f:c3},19:{f:Kf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:b6},40:{},42:{},43:{f:vE},44:{f:pE},45:{f:_E},46:{f:NE},47:{f:wE},48:{},49:{f:Vj},50:{},51:{f:rT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:W1},62:{f:g3},63:{f:uT},64:{f:$3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$s,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:I3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GA},148:{f:VA,p:16},151:{f:F3},152:{},153:{f:g6},154:{},155:{},156:{f:x6},157:{},158:{},159:{T:1,f:D4},160:{T:-1},161:{T:1,f:Jn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:S3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:tT},336:{T:-1},337:{f:iT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:W0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:O3},427:{f:D3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:M3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:HA},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:C3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:W0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:NT},633:{T:1},634:{T:-1},635:{T:1,f:_T},636:{T:-1},637:{f:Xj},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:a6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:W3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},K0={6:{f:a0},10:{f:La},12:{f:hs},13:{f:hs},14:{f:ts},15:{f:ts},16:{f:Ls},17:{f:ts},18:{f:ts},19:{f:hs},20:{f:om},21:{f:om},23:{f:$1},24:{f:fm},25:{f:ts},26:{},27:{},28:{f:WS},29:{},34:{f:ts},35:{f:dm},38:{f:Ls},39:{f:Ls},40:{f:Ls},41:{f:Ls},42:{f:ts},43:{f:ts},47:{f:eE},49:{f:xS},51:{f:hs},60:{},61:{f:dS},64:{f:ts},65:{f:mS},66:{f:hs},77:{},80:{},81:{},82:{},85:{f:hs},89:{},90:{},91:{},92:{f:Qk},93:{f:HS},94:{},95:{f:ts},96:{},97:{},99:{f:ts},125:{f:W1},128:{f:AS},129:{f:tS},130:{f:hs},131:{f:ts},132:{f:ts},133:{f:sS},134:{},140:{f:QS},141:{f:hs},144:{},146:{f:s4},151:{},152:{},153:{},154:{},155:{},156:{f:hs},157:{},158:{},160:{f:o4},161:{f:n4},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:SS},190:{f:ES},193:{f:La},197:{},198:{},199:{},200:{},201:{},202:{f:ts},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:hs},220:{},221:{f:ts},222:{},224:{f:CS},225:{f:Zk},226:{f:La},227:{},229:{f:VS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:aS},253:{f:gS},255:{f:iS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:O1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ts},353:{f:La},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:MS},431:{f:ts},432:{},433:{},434:{},437:{},438:{f:qS},439:{f:ts},440:{f:YS},441:{},442:{f:nc},443:{},444:{f:hs},445:{},446:{},448:{f:La},449:{f:oS,r:2},450:{f:La},512:{f:im},513:{f:c4},515:{f:DS},516:{f:yS},517:{f:cm},519:{f:d4},520:{f:lS},523:{},545:{f:um},549:{f:nm},566:{},574:{f:uS},638:{f:kS},659:{},1048:{},1054:{f:_S},1084:{},1212:{f:BS},2048:{f:JS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:wc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:La},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:r4,r:12},2173:{f:QE,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ts,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:LS,r:12},2197:{},2198:{f:XE,r:12},2199:{},2200:{},2201:{},2202:{f:US,r:12},2203:{f:La},2204:{},2205:{},2206:{},2207:{},2211:{f:cS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:hs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:i4},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:t4},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:im},1:{},2:{f:x4},3:{f:h4},4:{f:u4},5:{f:cm},7:{f:g4},8:{},9:{f:wc},11:{},22:{f:hs},30:{f:NS},31:{},32:{},33:{f:um},36:{},37:{f:nm},50:{f:v4},62:{},52:{},67:{},68:{f:hs},69:{},86:{},126:{},127:{f:f4},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:y4},223:{},234:{},354:{},421:{},518:{f:a0},521:{f:wc},536:{f:fm},547:{f:dm},561:{},579:{},1030:{f:a0},1033:{f:wc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Se(t,e,s,r){var a=e;if(!isNaN(a)){var i=r||(s||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&Xf(s)&&t.push(s)}}function gF(t,e,s,r){var a=r||(s||[]).length||0;if(a<=8224)return Se(t,e,s,a);var i=e;if(!isNaN(i)){for(var l=s.parts||[],c=0,o=0,d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;var f=t.next(4);for(f.write_shift(2,i),f.write_shift(2,d),t.push(s.slice(o,o+d)),o+=d;o<a;){for(f=t.next(4),f.write_shift(2,60),d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;f.write_shift(2,d),t.push(s.slice(o,o+d)),o+=d}}}function oc(t,e,s){return t||(t=le(7)),t.write_shift(2,e),t.write_shift(2,s),t.write_shift(2,0),t.write_shift(1,0),t}function vF(t,e,s,r){var a=le(9);return oc(a,t,e),D1(s,r||"b",a),a}function yF(t,e,s){var r=le(8+2*s.length);return oc(r,t,e),r.write_shift(1,s.length),r.write_shift(s.length,s,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function bF(t,e,s,r){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?vs(Lt(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Se(t,2,p4(s,r,a)):Se(t,3,m4(s,r,a));return;case"b":case"e":Se(t,5,vF(s,r,e.v,e.t));return;case"s":case"str":Se(t,4,yF(s,r,(e.v||"").slice(0,255)));return}Se(t,1,oc(null,s,r))}function _F(t,e,s,r){var a=Array.isArray(e),i=mt(e["!ref"]||"A1"),l,c="",o=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=tt(i)}for(var d=i.s.r;d<=i.e.r;++d){c=is(d);for(var f=i.s.c;f<=i.e.c;++f){d===i.s.r&&(o[f]=Yt(f)),l=o[f]+c;var u=a?(e[d]||[])[f]:e[l];u&&bF(t,u,d,f)}}}function wF(t,e){for(var s=e||{},r=lr(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==s.sheet&&(a=i);if(a==0&&s.sheet&&t.SheetNames[0]!=s.sheet)throw new Error("Sheet not found: "+s.sheet);return Se(r,s.biff==4?1033:s.biff==3?521:9,ru(t,16,s)),_F(r,t.Sheets[t.SheetNames[a]],a,s),Se(r,10),r.end()}function NF(t,e,s){Se(t,49,pS({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},s))}function jF(t,e,s){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&Se(t,1054,wS(a,e[a],s))})}function kF(t,e){var s=le(19);s.write_shift(4,2151),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,1),s.write_shift(4,0),Se(t,2151,s),s=le(39),s.write_shift(4,2152),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(2,1),s.write_shift(4,4),s.write_shift(2,0),L1(mt(e["!ref"]||"A1"),s),s.write_shift(4,4),Se(t,2152,s)}function SF(t,e){for(var s=0;s<16;++s)Se(t,224,lm({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){Se(t,224,lm(r,0,e))})}function EF(t,e){for(var s=0;s<e["!links"].length;++s){var r=e["!links"][s];Se(t,440,KS(r)),r[1].Tooltip&&Se(t,2048,ZS(r))}delete e["!links"]}function TF(t,e){if(e){var s=0;e.forEach(function(r,a){++s<=256&&r&&Se(t,125,a4(_d(a,r),a))})}}function CF(t,e,s,r,a){var i=16+on(a.cellXfs,e,a);if(e.v==null&&!e.bf){Se(t,513,Un(s,r,i));return}if(e.bf)Se(t,6,tA(e,s,r,a,i));else switch(e.t){case"d":case"n":var l=e.t=="d"?vs(Lt(e.v)):e.v;Se(t,515,PS(s,r,l,i));break;case"b":case"e":Se(t,517,OS(s,r,e.v,i,a,e.t));break;case"s":case"str":if(a.bookSST){var c=fu(a.Strings,e.v,a.revStrings);Se(t,253,vS(s,r,c,i))}else Se(t,516,bS(s,r,(e.v||"").slice(0,255),i,a));break;default:Se(t,513,Un(s,r,i))}}function AF(t,e,s){var r=lr(),a=s.SheetNames[t],i=s.Sheets[a]||{},l=(s||{}).Workbook||{},c=(l.Sheets||[])[t]||{},o=Array.isArray(i),d=e.biff==8,f,u="",h=[],x=mt(i["!ref"]||"A1"),m=d?65536:16384;if(x.e.c>255||x.e.r>=m){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,m-1)}Se(r,2057,ru(s,16,e)),Se(r,13,wr(1)),Se(r,12,wr(100)),Se(r,15,qs(!0)),Se(r,17,qs(!1)),Se(r,16,Ln(.001)),Se(r,95,qs(!0)),Se(r,42,qs(!1)),Se(r,43,qs(!1)),Se(r,130,wr(1)),Se(r,128,FS([0,0])),Se(r,131,qs(!1)),Se(r,132,qs(!1)),d&&TF(r,i["!cols"]),Se(r,512,jS(x,e)),d&&(i["!links"]=[]);for(var p=x.s.r;p<=x.e.r;++p){u=is(p);for(var v=x.s.c;v<=x.e.c;++v){p===x.s.r&&(h[v]=Yt(v)),f=h[v]+u;var b=o?(i[p]||[])[v]:i[f];b&&(CF(r,b,p,v,e),d&&b.l&&i["!links"].push([f,b.l]))}}var _=c.CodeName||c.name||a;return d&&Se(r,574,hS((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&Se(r,229,zS(i["!merges"])),d&&EF(r,i),Se(r,442,P1(_)),d&&kF(r,i),Se(r,10),r.end()}function FF(t,e,s){var r=lr(),a=(t||{}).Workbook||{},i=a.Sheets||[],l=a.WBProps||{},c=s.biff==8,o=s.biff==5;if(Se(r,2057,ru(t,5,s)),s.bookType=="xla"&&Se(r,135),Se(r,225,c?wr(1200):null),Se(r,193,Ok(2)),o&&Se(r,191),o&&Se(r,192),Se(r,226),Se(r,92,eS("SheetJS",s)),Se(r,66,wr(c?1200:1252)),c&&Se(r,353,wr(0)),c&&Se(r,448),Se(r,317,l4(t.SheetNames.length)),c&&t.vbaraw&&Se(r,211),c&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";Se(r,442,P1(d))}Se(r,156,wr(17)),Se(r,25,qs(!1)),Se(r,18,qs(!1)),Se(r,19,wr(0)),c&&Se(r,431,qs(!1)),c&&Se(r,444,wr(0)),Se(r,61,fS()),Se(r,64,qs(!1)),Se(r,141,wr(0)),Se(r,34,qs(o6(t)=="true")),Se(r,14,qs(!0)),c&&Se(r,439,qs(!1)),Se(r,218,wr(0)),NF(r,t,s),jF(r,t.SSF,s),SF(r,s),c&&Se(r,352,qs(!1));var f=r.end(),u=lr();c&&Se(u,140,e4()),c&&s.Strings&&gF(u,252,nS(s.Strings)),Se(u,10);var h=u.end(),x=lr(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(c?12:11)+(c?2:1)*t.SheetNames[p].length;var v=f.length+m+h.length;for(p=0;p<t.SheetNames.length;++p){var b=i[p]||{};Se(x,133,rS({pos:v,hs:b.Hidden||0,dt:0,name:t.SheetNames[p]},s)),v+=e[p].length}var _=x.end();if(m!=_.length)throw new Error("BS8 "+m+" != "+_.length);var g=[];return f.length&&g.push(f),_.length&&g.push(_),h.length&&g.push(h),Ns(g)}function OF(t,e){var s=e||{},r=[];t&&!t.SSF&&(t.SSF=Bt(Ge)),t&&t.SSF&&(Li(),md(t.SSF),s.revssf=pd(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF),s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,pu(s),s.cellXfs=[],on(s.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)r[r.length]=AF(a,s,t);return r.unshift(FF(t,r,s)),Ns(r)}function Ev(t,e){for(var s=0;s<=t.SheetNames.length;++s){var r=t.Sheets[t.SheetNames[s]];if(!(!r||!r["!ref"])){var a=cr(r["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[s]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return OF(t,e);case 4:case 3:case 2:return wF(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function wm(t,e){var s=e||{},r=s.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=a.index,c=i&&i.index||t.length,o=gj(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,f=0,u=0,h=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(l=0;l<o.length;++l){var p=o[l].trim(),v=p.slice(0,3).toLowerCase();if(v=="<tr"){if(++d,s.sheetRows&&s.sheetRows<=d){--d;break}f=0;continue}if(!(v!="<td"&&v!="<th")){var b=p.split(/<\/t[dh]>/i);for(c=0;c<b.length;++c){var _=b[c].trim();if(_.match(/<t[dh]/i)){for(var g=_,j=0;g.charAt(0)=="<"&&(j=g.indexOf(">"))>-1;)g=g.slice(j+1);for(var w=0;w<m.length;++w){var k=m[w];k.s.c==f&&k.s.r<d&&d<=k.e.r&&(f=k.e.c+1,w=-1)}var y=Je(_.slice(0,_.indexOf(">")));h=y.colspan?+y.colspan:1,((u=+y.rowspan)>1||h>1)&&m.push({s:{r:d,c:f},e:{r:d+(u||1)-1,c:f+h-1}});var N=y.t||y["data-t"]||"";if(!g.length){f+=h;continue}if(g=Jg(g),x.s.r>d&&(x.s.r=d),x.e.r<d&&(x.e.r=d),x.s.c>f&&(x.s.c=f),x.e.c<f&&(x.e.c=f),!g.length){f+=h;continue}var S={t:"s",v:g};s.raw||!g.trim().length||N=="s"||(g==="TRUE"?S={t:"b",v:!0}:g==="FALSE"?S={t:"b",v:!1}:isNaN(Ur(g))?isNaN(Ei(g).getDate())||(S={t:"d",v:Lt(g)},s.cellDates||(S={t:"n",v:vs(S.v)}),S.z=s.dateNF||Ge[14]):S={t:"n",v:Ur(g)}),s.dense?(r[d]||(r[d]=[]),r[d][f]=S):r[Ye({r:d,c:f})]=S,f+=h}}}}return r["!ref"]=tt(x),m.length&&(r["!merges"]=m),r}function DF(t,e,s,r){for(var a=t["!merges"]||[],i=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,o=0,d=0;d<a.length;++d)if(!(a[d].s.r>s||a[d].s.c>l)&&!(a[d].e.r<s||a[d].e.c<l)){if(a[d].s.r<s||a[d].s.c<l){c=-1;break}c=a[d].e.r-a[d].s.r+1,o=a[d].e.c-a[d].s.c+1;break}if(!(c<0)){var f=Ye({r:s,c:l}),u=r.dense?(t[s]||[])[l]:t[f],h=u&&u.v!=null&&(u.h||zf(u.w||(Ta(u),u.w)||""))||"",x={};c>1&&(x.rowspan=c),o>1&&(x.colspan=o),r.editable?h='<span contenteditable="true">'+h+"</span>":u&&(x["data-t"]=u&&u.t||"z",u.v!=null&&(x["data-v"]=u.v),u.z!=null&&(x["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),x.id=(r.id||"sjs")+"-"+f,i.push(ke("td",h,x))}}var m="<tr>";return m+i.join("")+"</tr>"}var PF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',MF="</body></html>";function RF(t,e){var s=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!s||s.length==0)throw new Error("Invalid HTML: could not find <table>");if(s.length==1)return cn(wm(s[0],e),e);var r=yu();return s.forEach(function(a,i){bu(r,wm(a,e),"Sheet"+(i+1))}),r}function IF(t,e,s){var r=[];return r.join("")+"<table"+(s&&s.id?' id="'+s.id+'"':"")+">"}function Tv(t,e){var s=e||{},r=s.header!=null?s.header:PF,a=s.footer!=null?s.footer:MF,i=[r],l=cr(t["!ref"]);s.dense=Array.isArray(t),i.push(IF(t,l,s));for(var c=l.s.r;c<=l.e.r;++c)i.push(DF(t,l,c,s));return i.push("</table>"+a),i.join("")}function Cv(t,e,s){var r=s||{},a=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?Kt(r.origin):r.origin;a=l.r,i=l.c}var c=e.getElementsByTagName("tr"),o=Math.min(r.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var f=cr(t["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),a==-1&&(d.e.r=a=f.e.r+1)}var u=[],h=0,x=t["!rows"]||(t["!rows"]=[]),m=0,p=0,v=0,b=0,_=0,g=0;for(t["!cols"]||(t["!cols"]=[]);m<c.length&&p<o;++m){var j=c[m];if(Nm(j)){if(r.display)continue;x[p]={hidden:!0}}var w=j.children;for(v=b=0;v<w.length;++v){var k=w[v];if(!(r.display&&Nm(k))){var y=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):Jg(k.innerHTML),N=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<u.length;++h){var S=u[h];S.s.c==b+i&&S.s.r<p+a&&p+a<=S.e.r&&(b=S.e.c+1-i,h=-1)}g=+k.getAttribute("colspan")||1,((_=+k.getAttribute("rowspan")||1)>1||g>1)&&u.push({s:{r:p+a,c:b+i},e:{r:p+a+(_||1)-1,c:b+i+(g||1)-1}});var T={t:"s",v:y},E=k.getAttribute("data-t")||k.getAttribute("t")||"";y!=null&&(y.length==0?T.t=E||"z":r.raw||y.trim().length==0||E=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(Ur(y))?isNaN(Ei(y).getDate())||(T={t:"d",v:Lt(y)},r.cellDates||(T={t:"n",v:vs(T.v)}),T.z=r.dateNF||Ge[14]):T={t:"n",v:Ur(y)})),T.z===void 0&&N!=null&&(T.z=N);var A="",H=k.getElementsByTagName("A");if(H&&H.length)for(var V=0;V<H.length&&!(H[V].hasAttribute("href")&&(A=H[V].getAttribute("href"),A.charAt(0)!="#"));++V);A&&A.charAt(0)!="#"&&(T.l={Target:A}),r.dense?(t[p+a]||(t[p+a]=[]),t[p+a][b+i]=T):t[Ye({c:b+i,r:p+a})]=T,d.e.c<b+i&&(d.e.c=b+i),b+=g}}++p}return u.length&&(t["!merges"]=(t["!merges"]||[]).concat(u)),d.e.r=Math.max(d.e.r,p-1+a),t["!ref"]=tt(d),p>=o&&(t["!fullref"]=tt((d.e.r=c.length-m+p-1+a,d))),t}function Av(t,e){var s=e||{},r=s.dense?[]:{};return Cv(r,t,e)}function LF(t,e){return cn(Av(t,e),e)}function Nm(t){var e="",s=BF(t);return s&&(e=s(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function BF(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function UF(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),s=ft(e.replace(/<[^>]*>/g,""));return[s]}var jm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Fv(t,e){var s=e||{},r=Hf(t),a=[],i,l,c={name:""},o="",d=0,f,u,h={},x=[],m=s.dense?[]:{},p,v,b={value:""},_="",g=0,j=[],w=-1,k=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,S={},T=[],E={},A=0,H=0,V=[],L=1,P=1,J=[],Ee={Names:[]},Y={},de=["",""],De=[],B={},X="",W=0,z=!1,ae=!1,me=0;for(Al.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Al.exec(r);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?m["!ref"]=tt(y):m["!ref"]="A1:A1",s.sheetRows>0&&s.sheetRows<=y.e.r&&(m["!fullref"]=m["!ref"],y.e.r=s.sheetRows-1,m["!ref"]=tt(y)),T.length&&(m["!merges"]=T),V.length&&(m["!rows"]=V),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),x.push(f.name),h[f.name]=m,ae=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=Je(p[0],!1),w=k=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,m=s.dense?[]:{},T=[],V=[],ae=!0);break;case"table-row-group":p[1]==="/"?--N:++N;break;case"table-row":case"":if(p[1]==="/"){w+=L,L=1;break}if(u=Je(p[0],!1),u.?w=u.-1:w==-1&&(w=0),L=+u["number-rows-repeated"]||1,L<10)for(me=0;me<L;++me)N>0&&(V[w+me]={level:N});k=-1;break;case"covered-table-cell":p[1]!=="/"&&++k,s.sheetStubs&&(s.dense?(m[w]||(m[w]=[]),m[w][k]={t:"z"}):m[Ye({r:w,c:k})]={t:"z"}),_="",j=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++k,b=Je(p[0],!1),P=parseInt(b["number-columns-repeated"]||"1",10),v={t:"z",v:null},b.formula&&s.cellFormula!=!1&&(v.f=ym(ft(b.formula))),(b.||b["value-type"])=="string"&&(v.t="s",v.v=ft(b["string-value"]||""),s.dense?(m[w]||(m[w]=[]),m[w][k]=v):m[Ye({r:w,c:k})]=v),k+=P-1;else if(p[1]!=="/"){++k,_="",g=0,j=[],P=1;var xe=L?w+L-1:w;if(k>y.e.c&&(y.e.c=k),k<y.s.c&&(y.s.c=k),w<y.s.r&&(y.s.r=w),xe>y.e.r&&(y.e.r=xe),b=Je(p[0],!1),De=[],B={},v={t:b.||b["value-type"],v:null},s.cellFormula)if(b.formula&&(b.formula=ft(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(A=parseInt(b["number-matrix-rows-spanned"],10)||0,H=parseInt(b["number-matrix-columns-spanned"],10)||0,E={s:{r:w,c:k},e:{r:w+A-1,c:k+H-1}},v.F=tt(E),J.push([E,v.F])),b.formula)v.f=ym(b.formula);else for(me=0;me<J.length;++me)w>=J[me][0].s.r&&w<=J[me][0].e.r&&k>=J[me][0].s.c&&k<=J[me][0].e.c&&(v.F=J[me][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(A=parseInt(b["number-rows-spanned"],10)||0,H=parseInt(b["number-columns-spanned"],10)||0,E={s:{r:w,c:k},e:{r:w+A-1,c:k+H-1}},T.push(E)),b["number-columns-repeated"]&&(P=parseInt(b["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Dt(b["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(b.value);break;case"percentage":v.t="n",v.v=parseFloat(b.value);break;case"currency":v.t="n",v.v=parseFloat(b.value);break;case"date":v.t="d",v.v=Lt(b["date-value"]),s.cellDates||(v.t="n",v.v=vs(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=mj(b["time-value"])/86400,s.cellDates&&(v.t="d",v.v=gd(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(b.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",b["string-value"]!=null&&(_=ft(b["string-value"]),j=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(z=!1,v.t==="s"&&(v.v=_||"",j.length&&(v.R=j),z=g==0),Y.Target&&(v.l=Y),De.length>0&&(v.c=De,De=[]),_&&s.cellText!==!1&&(v.w=_),z&&(v.t="z",delete v.v),(!z||s.sheetStubs)&&!(s.sheetRows&&s.sheetRows<=w))for(var ue=0;ue<L;++ue){if(P=parseInt(b["number-columns-repeated"]||"1",10),s.dense)for(m[w+ue]||(m[w+ue]=[]),m[w+ue][k]=ue==0?v:Bt(v);--P>0;)m[w+ue][k+P]=Bt(v);else for(m[Ye({r:w+ue,c:k})]=v;--P>0;)m[Ye({r:w+ue,c:k+P})]=Bt(v);y.e.c<=k&&(y.e.c=k)}P=parseInt(b["number-columns-repeated"]||"1",10),k+=P-1,P=0,v={},_="",j=[]}Y={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i;B.t=_,j.length&&(B.R=j),B.a=X,De.push(B)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);X="",W=0,_="",g=0,j=[];break;case"creator":p[1]==="/"?X=r.slice(W,p.index):W=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);_="",g=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(S[c.name]=o,(i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(o="",c=Je(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Je(p[0],!1),o+=jm[p[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Je(p[0],!1),o+=jm[p[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":o+=r.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":l=Je(p[0],!1),de=n0(l["cell-range-address"]);var oe={Name:l.name,Ref:de[0]+"!"+de[1]};ae&&(oe.Sheet=x.length),Ee.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!b||!b["string-value"])){var ze=UF(r.slice(g,p.index));_=(_.length>0?_+`
`:"")+ze[0]}else Je(p[0],!1),g=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{de=n0(Je(p[0])["target-range-address"]),h[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Y=Je(p[0],!1),!Y.href)break;Y.Target=ft(Y.href),delete Y.href,Y.Target.charAt(0)=="#"&&Y.Target.indexOf(".")>-1?(de=n0(Y.Target.slice(1)),Y.Target="#"+de[0]+"!"+de[1]):Y.Target.match(/^\.\.[\\\/]/)&&(Y.Target=Y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(s.WTF)throw new Error(p)}}var F={Sheets:h,SheetNames:x,Workbook:Ee};return s.bookSheets&&delete F.Sheets,F}function km(t,e){e=e||{},_r(t,"META-INF/manifest.xml")&&hk(us(t,"META-INF/manifest.xml"),e);var s=hr(t,"content.xml");if(!s)throw new Error("Missing content.xml in ODS / UOF file");var r=Fv(Et(s),e);return _r(t,"meta.xml")&&(r.Props=_1(us(t,"meta.xml"))),r}function Sm(t,e){return Fv(t,e)}var $F=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Cl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return ls+e}}(),Em=function(){var t=function(i){return kt(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,s=`          <table:covered-table-cell/>
`,r=function(i,l,c){var o=[];o.push('      <table:table table:name="'+kt(l.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,f=0,u=cr(i["!ref"]||"A1"),h=i["!merges"]||[],x=0,m=Array.isArray(i);if(i["!cols"])for(f=0;f<=u.e.c;++f)o.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",v=i["!rows"]||[];for(d=0;d<u.s.r;++d)p=v[d]?' table:style-name="ro'+v[d].ods+'"':"",o.push("        <table:table-row"+p+`></table:table-row>
`);for(;d<=u.e.r;++d){for(p=v[d]?' table:style-name="ro'+v[d].ods+'"':"",o.push("        <table:table-row"+p+`>
`),f=0;f<u.s.c;++f)o.push(e);for(;f<=u.e.c;++f){var b=!1,_={},g="";for(x=0;x!=h.length;++x)if(!(h[x].s.c>f)&&!(h[x].s.r>d)&&!(h[x].e.c<f)&&!(h[x].e.r<d)){(h[x].s.c!=f||h[x].s.r!=d)&&(b=!0),_["table:number-columns-spanned"]=h[x].e.c-h[x].s.c+1,_["table:number-rows-spanned"]=h[x].e.r-h[x].s.r+1;break}if(b){o.push(s);continue}var j=Ye({r:d,c:f}),w=m?(i[d]||[])[f]:i[j];if(w&&w.f&&(_["table:formula"]=kt(lA(w.f)),w.F&&w.F.slice(0,j.length)==j)){var k=cr(w.F);_["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,_["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!w){o.push(e);continue}switch(w.t){case"b":g=w.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=w.v?"true":"false";break;case"n":g=w.w||String(w.v||0),_["office:value-type"]="float",_["office:value"]=w.v||0;break;case"s":case"str":g=w.v==null?"":w.v,_["office:value-type"]="string";break;case"d":g=w.w||Lt(w.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=Lt(w.v).toISOString(),_["table:style-name"]="ce1";break;default:o.push(e);continue}var y=t(g);if(w.l&&w.l.Target){var N=w.l.Target;N=N.charAt(0)=="#"?"#"+cA(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),y=ke("text:a",y,{"xlink:href":N.replace(/&/g,"&amp;")})}o.push("          "+ke("table:table-cell",ke("text:p",y,{}),_)+`
`)}o.push(`        </table:table-row>
`)}return o.push(`      </table:table>
`),o.join("")},a=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var f=0;f<d["!cols"].length;++f)if(d["!cols"][f]){var u=d["!cols"][f];if(u.width==null&&u.wpx==null&&u.wch==null)continue;tn(u),u.ods=c;var h=d["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++c}}});var o=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var f=0;f<d["!rows"].length;++f)if(d["!rows"][f]){d["!rows"][f].ods=o;var u=d["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),i.push(`  </style:style>
`),++o}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,c){var o=[ls],d=Cl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Cl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(o.push("<office:document"+d+f+`>
`),o.push(b1().replace(/office:document-meta/g,"office:meta"))):o.push("<office:document-content"+d+`>
`),a(o,l),o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`);for(var u=0;u!=l.SheetNames.length;++u)o.push(r(l.Sheets[l.SheetNames[u]],l,u));return o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),c.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function Ov(t,e){if(e.bookType=="fods")return Em(t,e);var s=$f(),r="",a=[],i=[];return r="mimetype",st(s,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",st(s,r,Em(t,e)),a.push([r,"text/xml"]),i.push([r,"ContentFile"]),r="styles.xml",st(s,r,$F(t,e)),a.push([r,"text/xml"]),i.push([r,"StylesFile"]),r="meta.xml",st(s,r,ls+b1()),a.push([r,"text/xml"]),i.push([r,"MetadataFile"]),r="manifest.rdf",st(s,r,pk(i)),a.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",st(s,r,mk(a)),s}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $n(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function J0(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Et(ln(t))}function WF(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):ur(ta(t))}function VF(t,e){e:for(var s=0;s<=t.length-e.length;++s){for(var r=0;r<e.length;++r)if(t[s+r]!=e[r])continue e;return!0}return!1}function rn(t){var e=t.reduce(function(a,i){return a+i.length},0),s=new Uint8Array(e),r=0;return t.forEach(function(a){s.set(a,r),r+=a.length}),s}function Tm(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function zF(t,e){for(var s=(t[e+15]&127)<<7|t[e+14]>>1,r=t[e+14]&1,a=e+13;a>=e;--a)r=r*256+t[a];return(t[e+15]&128?-r:r)*Math.pow(10,s-6176)}function HF(t,e,s){var r=Math.floor(s==0?0:Math.LOG10E*Math.log(Math.abs(s)))+6176-20,a=s/Math.pow(10,r-6176);t[e+15]|=r>>7,t[e+14]|=(r&127)<<1;for(var i=0;a>=1;++i,a/=256)t[e+i]=a&255;t[e+15]|=s>=0?0:128}function Il(t,e){var s=e?e[0]:0,r=t[s]&127;e:if(t[s++]>=128&&(r|=(t[s]&127)<<7,t[s++]<128||(r|=(t[s]&127)<<14,t[s++]<128)||(r|=(t[s]&127)<<21,t[s++]<128)||(r+=(t[s]&127)*Math.pow(2,28),++s,t[s++]<128)||(r+=(t[s]&127)*Math.pow(2,35),++s,t[s++]<128)||(r+=(t[s]&127)*Math.pow(2,42),++s,t[s++]<128)))break e;return e&&(e[0]=s),r}function _t(t){var e=new Uint8Array(7);e[0]=t&127;var s=1;e:if(t>127){if(e[s-1]|=128,e[s]=t>>7&127,++s,t<=16383||(e[s-1]|=128,e[s]=t>>14&127,++s,t<=2097151)||(e[s-1]|=128,e[s]=t>>21&127,++s,t<=268435455)||(e[s-1]|=128,e[s]=t/256>>>21&127,++s,t<=34359738367)||(e[s-1]|=128,e[s]=t/65536>>>21&127,++s,t<=4398046511103))break e;e[s-1]|=128,e[s]=t/16777216>>>21&127,++s}return e.slice(0,s)}function Qt(t){var e=0,s=t[e]&127;e:if(t[e++]>=128){if(s|=(t[e]&127)<<7,t[e++]<128||(s|=(t[e]&127)<<14,t[e++]<128)||(s|=(t[e]&127)<<21,t[e++]<128))break e;s|=(t[e]&127)<<28}return s}function xt(t){for(var e=[],s=[0];s[0]<t.length;){var r=s[0],a=Il(t,s),i=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(i){case 0:{for(var o=s[0];t[s[0]++]>=128;);c=t.slice(o,s[0])}break;case 5:l=4,c=t.slice(s[0],s[0]+l),s[0]+=l;break;case 1:l=8,c=t.slice(s[0],s[0]+l),s[0]+=l;break;case 2:l=Il(t,s),c=t.slice(s[0],s[0]+l),s[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(r))}var d={data:c,type:i};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function Ss(t){var e=[];return t.forEach(function(s,r){s.forEach(function(a){a.data&&(e.push(_t(r*8+a.type)),a.type==2&&e.push(_t(a.data.length)),e.push(a.data))})}),rn(e)}function mu(t,e){return(t==null?void 0:t.map(function(s){return e(s.data)}))||[]}function yr(t){for(var e,s=[],r=[0];r[0]<t.length;){var a=Il(t,r),i=xt(t.slice(r[0],r[0]+a));r[0]+=a;var l={id:Qt(i[1][0].data),messages:[]};i[2].forEach(function(c){var o=xt(c.data),d=Qt(o[3][0].data);l.messages.push({meta:o,data:t.slice(r[0],r[0]+d)}),r[0]+=d}),(e=i[3])!=null&&e[0]&&(l.merge=Qt(i[3][0].data)>>>0>0),s.push(l)}return s}function ii(t){var e=[];return t.forEach(function(s){var r=[];r[1]=[{data:_t(s.id),type:0}],r[2]=[],s.merge!=null&&(r[3]=[{data:_t(+!!s.merge),type:0}]);var a=[];s.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:_t(l.data.length)}],r[2].push({data:Ss(l.meta),type:2})});var i=Ss(r);e.push(_t(i.length)),e.push(i),a.forEach(function(l){return e.push(l)})}),rn(e)}function GF(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var s=[0],r=Il(e,s),a=[];s[0]<e.length;){var i=e[s[0]]&3;if(i==0){var l=e[s[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[s[0]],c>1&&(l|=e[s[0]+1]<<8),c>2&&(l|=e[s[0]+2]<<16),c>3&&(l|=e[s[0]+3]<<24),l>>>=0,l++,s[0]+=c}a.push(e.slice(s[0],s[0]+l)),s[0]+=l;continue}else{var o=0,d=0;if(i==1?(d=(e[s[0]]>>2&7)+4,o=(e[s[0]++]&224)<<3,o|=e[s[0]++]):(d=(e[s[0]++]>>2)+1,i==2?(o=e[s[0]]|e[s[0]+1]<<8,s[0]+=2):(o=(e[s[0]]|e[s[0]+1]<<8|e[s[0]+2]<<16|e[s[0]+3]<<24)>>>0,s[0]+=4)),a=[rn(a)],o==0)throw new Error("Invalid offset 0");if(o>a[0].length)throw new Error("Invalid offset beyond length");if(d>=o)for(a.push(a[0].slice(-o)),d-=o;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-o,-o+d))}}var f=rn(a);if(f.length!=r)throw new Error("Unexpected length: ".concat(f.length," != ").concat(r));return f}function br(t){for(var e=[],s=0;s<t.length;){var r=t[s++],a=t[s]|t[s+1]<<8|t[s+2]<<16;s+=3,e.push(GF(r,t.slice(s,s+a))),s+=a}if(s!==t.length)throw new Error("data is not a valid framed stream!");return rn(e)}function li(t){for(var e=[],s=0;s<t.length;){var r=Math.min(t.length-s,268435455),a=new Uint8Array(4);e.push(a);var i=_t(r),l=i.length;e.push(i),r<=60?(l++,e.push(new Uint8Array([r-1<<2]))):r<=256?(l+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(l+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(l+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(l+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(t.slice(s,s+r)),l+=r,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,s+=r}return rn(e)}function XF(t,e,s,r){var a=$n(t),i=a.getUint32(4,!0),l=(r>1?12:8)+Tm(i&(r>1?3470:398))*4,c=-1,o=-1,d=NaN,f=new Date(2001,0,1);i&512&&(c=a.getUint32(l,!0),l+=4),l+=Tm(i&(r>1?12288:4096))*4,i&16&&(o=a.getUint32(l,!0),l+=4),i&32&&(d=a.getFloat64(l,!0),l+=8),i&64&&(f.setTime(f.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var u;switch(t[2]){case 0:break;case 2:u={t:"n",v:d};break;case 3:u={t:"s",v:e[o]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(c>-1)u={t:"s",v:s[c]};else if(o>-1)u={t:"s",v:e[o]};else if(!isNaN(d))u={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return u}function qF(t,e,s){var r=$n(t),a=r.getUint32(8,!0),i=12,l=-1,c=-1,o=NaN,d=NaN,f=new Date(2001,0,1);a&1&&(o=zF(t,i),i+=16),a&2&&(d=r.getFloat64(i,!0),i+=8),a&4&&(f.setTime(f.getTime()+r.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=r.getUint32(i,!0),i+=4),a&16&&(l=r.getUint32(i,!0),i+=4);var u;switch(t[1]){case 0:break;case 2:u={t:"n",v:o};break;case 3:u={t:"s",v:e[c]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(l>-1)u={t:"s",v:s[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:u={t:"n",v:o};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return u}function l0(t,e){var s=new Uint8Array(32),r=$n(s),a=12,i=0;switch(s[0]=5,t.t){case"n":s[1]=2,HF(s,a,t.v),i|=1,a+=16;break;case"b":s[1]=6,r.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));s[1]=3,r.setUint32(a,e.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,i,!0),s.slice(0,a)}function c0(t,e){var s=new Uint8Array(32),r=$n(s),a=12,i=0;switch(s[0]=3,t.t){case"n":s[2]=2,r.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":s[2]=6,r.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));s[2]=3,r.setUint32(a,e.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,i,!0),s.slice(0,a)}function YF(t,e,s){switch(t[0]){case 0:case 1:case 2:case 3:return XF(t,e,s,t[0]);case 5:return qF(t,e,s);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ds(t){var e=xt(t);return Il(e[1][0].data)}function Cm(t,e){var s=xt(e.data),r=Qt(s[1][0].data),a=s[3],i=[];return(a||[]).forEach(function(l){var c=xt(l.data),o=Qt(c[1][0].data)>>>0;switch(r){case 1:i[o]=J0(c[3][0].data);break;case 8:{var d=t[Ds(c[9][0].data)][0],f=xt(d.data),u=t[Ds(f[1][0].data)][0],h=Qt(u.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var x=xt(u.data);i[o]=x[3].map(function(m){return J0(m.data)}).join("")}break}}),i}function KF(t,e){var s,r,a,i,l,c,o,d,f,u,h,x,m,p,v=xt(t),b=Qt(v[1][0].data)>>>0,_=Qt(v[2][0].data)>>>0,g=((r=(s=v[8])==null?void 0:s[0])==null?void 0:r.data)&&Qt(v[8][0].data)>0||!1,j,w;if((i=(a=v[7])==null?void 0:a[0])!=null&&i.data&&e!=0)j=(c=(l=v[7])==null?void 0:l[0])==null?void 0:c.data,w=(d=(o=v[6])==null?void 0:o[0])==null?void 0:d.data;else if((u=(f=v[4])==null?void 0:f[0])!=null&&u.data&&e!=1)j=(x=(h=v[4])==null?void 0:h[0])==null?void 0:x.data,w=(p=(m=v[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var k=g?4:1,y=$n(j),N=[],S=0;S<j.length/2;++S){var T=y.getUint16(S*2,!0);T<65535&&N.push([S,T])}if(N.length!=_)throw"Expected ".concat(_," cells, found ").concat(N.length);var E=[];for(S=0;S<N.length-1;++S)E[N[S][0]]=w.subarray(N[S][1]*k,N[S+1][1]*k);return N.length>=1&&(E[N[N.length-1][0]]=w.subarray(N[N.length-1][1]*k)),{R:b,cells:E}}function JF(t,e){var s,r=xt(e.data),a=(s=r==null?void 0:r[7])!=null&&s[0]?Qt(r[7][0].data)>>>0>0?1:0:-1,i=mu(r[5],function(l){return KF(l,a)});return{nrows:Qt(r[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(o,d){if(l[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));l[c.R][d]=o}),l},[])}}function ZF(t,e,s){var r,a=xt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Qt(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Qt(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));s["!ref"]=tt(i);var l=xt(a[4][0].data),c=Cm(t,t[Ds(l[4][0].data)][0]),o=(r=l[17])!=null&&r[0]?Cm(t,t[Ds(l[17][0].data)][0]):[],d=xt(l[3][0].data),f=0;d[1].forEach(function(u){var h=xt(u.data),x=t[Ds(h[2][0].data)][0],m=Qt(x.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=JF(t,x);p.data.forEach(function(v,b){v.forEach(function(_,g){var j=Ye({r:f+b,c:g}),w=YF(_,c,o);w&&(s[j]=w)})}),f+=p.nrows})}function QF(t,e){var s=xt(e.data),r={"!ref":"A1"},a=t[Ds(s[2][0].data)],i=Qt(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return ZF(t,a[0],r),r}function eO(t,e){var s,r=xt(e.data),a={name:(s=r[1])!=null&&s[0]?J0(r[1][0].data):"",sheets:[]},i=mu(r[2],Ds);return i.forEach(function(l){t[l].forEach(function(c){var o=Qt(c.meta[1][0].data);o==6e3&&a.sheets.push(QF(t,c))})}),a}function tO(t,e){var s=yu(),r=xt(e.data),a=mu(r[1],Ds);if(a.forEach(function(i){t[i].forEach(function(l){var c=Qt(l.meta[1][0].data);if(c==2){var o=eO(t,l);o.sheets.forEach(function(d,f){bu(s,d,f==0?o.name:o.name+"_"+f,!0)})}})}),s.SheetNames.length==0)throw new Error("Empty NUMBERS file");return s}function o0(t){var e,s,r,a,i={},l=[];if(t.FullPaths.forEach(function(o){if(o.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(o){if(o.name.match(/\.iwa$/)){var d;try{d=br(o.content)}catch(u){return console.log("?? "+o.content.length+" "+(u.message||u))}var f;try{f=yr(d)}catch(u){return console.log("## "+(u.message||u))}f.forEach(function(u){i[u.id]=u.messages,l.push(u.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(s=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:s.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Qt(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(o){i[o].forEach(function(d){var f=Qt(d.meta[1][0].data)>>>0;if(f==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return tO(i,c)}function sO(t,e,s){var r,a,i,l;if(!((r=t[6])!=null&&r[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(i=t[8])==null?void 0:i[0])==null?void 0:l.data)&&Qt(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var o=0,d=$n(t[7][0].data),f=0,u=[],h=$n(t[4][0].data),x=0,m=[],p=0;p<e.length;++p){if(e[p]==null){d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}d.setUint16(p*2,f,!0),h.setUint16(p*2,x,!0);var v,b;switch(typeof e[p]){case"string":v=l0({t:"s",v:e[p]},s),b=c0({t:"s",v:e[p]},s);break;case"number":v=l0({t:"n",v:e[p]},s),b=c0({t:"n",v:e[p]},s);break;case"boolean":v=l0({t:"b",v:e[p]},s),b=c0({t:"b",v:e[p]},s);break;default:throw new Error("Unsupported value "+e[p])}u.push(v),f+=v.length,m.push(b),x+=b.length,++o}for(t[2][0].data=_t(o);p<t[7][0].data.length/2;++p)d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return t[6][0].data=rn(u),t[3][0].data=rn(m),o}function rO(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var s=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=cr(s["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(tt(r)));var i=Mo(s,{range:r,header:1}),l=["~Sh33tJ5~"];i.forEach(function(X){return X.forEach(function(W){typeof W=="string"&&l.push(W)})});var c={},o=[],d=We.read(e.numbers,{type:"base64"});d.FileIndex.map(function(X,W){return[X,d.FullPaths[W]]}).forEach(function(X){var W=X[0],z=X[1];if(W.type==2&&W.name.match(/\.iwa/)){var ae=W.content,me=br(ae),xe=yr(me);xe.forEach(function(ue){o.push(ue.id),c[ue.id]={deps:[],location:z,type:Qt(ue.messages[0].meta[1][0].data)}})}}),o.sort(function(X,W){return X-W});var f=o.filter(function(X){return X>1}).map(function(X){return[X,_t(X)]});d.FileIndex.map(function(X,W){return[X,d.FullPaths[W]]}).forEach(function(X){var W=X[0];if(X[1],!!W.name.match(/\.iwa/)){var z=yr(br(W.content));z.forEach(function(ae){ae.messages.forEach(function(me){f.forEach(function(xe){ae.messages.some(function(ue){return Qt(ue.meta[1][0].data)!=11006&&VF(ue.data,xe[1])})&&c[xe[0]].deps.push(ae.id)})})})}});for(var u=We.find(d,c[1].location),h=yr(br(u.content)),x,m=0;m<h.length;++m){var p=h[m];p.id==1&&(x=p)}var v=Ds(xt(x.messages[0].data)[1][0].data);for(u=We.find(d,c[v].location),h=yr(br(u.content)),m=0;m<h.length;++m)p=h[m],p.id==v&&(x=p);for(v=Ds(xt(x.messages[0].data)[2][0].data),u=We.find(d,c[v].location),h=yr(br(u.content)),m=0;m<h.length;++m)p=h[m],p.id==v&&(x=p);for(v=Ds(xt(x.messages[0].data)[2][0].data),u=We.find(d,c[v].location),h=yr(br(u.content)),m=0;m<h.length;++m)p=h[m],p.id==v&&(x=p);var b=xt(x.messages[0].data);{b[6][0].data=_t(r.e.r+1),b[7][0].data=_t(r.e.c+1);var _=Ds(b[46][0].data),g=We.find(d,c[_].location),j=yr(br(g.content));{for(var w=0;w<j.length&&j[w].id!=_;++w);if(j[w].id!=_)throw"Bad ColumnRowUIDMapArchive";var k=xt(j[w].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var y=0;y<=r.e.c;++y){var N=[];N[1]=N[2]=[{type:0,data:_t(y+420690)}],k[1].push({type:2,data:Ss(N)}),k[2].push({type:0,data:_t(y)}),k[3].push({type:0,data:_t(y)})}k[4]=[],k[5]=[],k[6]=[];for(var S=0;S<=r.e.r;++S)N=[],N[1]=N[2]=[{type:0,data:_t(S+726270)}],k[4].push({type:2,data:Ss(N)}),k[5].push({type:0,data:_t(S)}),k[6].push({type:0,data:_t(S)});j[w].messages[0].data=Ss(k)}g.content=li(ii(j)),g.size=g.content.length,delete b[46];var T=xt(b[4][0].data);{T[7][0].data=_t(r.e.r+1);var E=xt(T[1][0].data),A=Ds(E[2][0].data);g=We.find(d,c[A].location),j=yr(br(g.content));{if(j[0].id!=A)throw"Bad HeaderStorageBucket";var H=xt(j[0].messages[0].data);for(S=0;S<i.length;++S){var V=xt(H[2][0].data);V[1][0].data=_t(S),V[4][0].data=_t(i[S].length),H[2][S]={type:H[2][0].type,data:Ss(V)}}j[0].messages[0].data=Ss(H)}g.content=li(ii(j)),g.size=g.content.length;var L=Ds(T[2][0].data);g=We.find(d,c[L].location),j=yr(br(g.content));{if(j[0].id!=L)throw"Bad HeaderStorageBucket";for(H=xt(j[0].messages[0].data),y=0;y<=r.e.c;++y)V=xt(H[2][0].data),V[1][0].data=_t(y),V[4][0].data=_t(r.e.r+1),H[2][y]={type:H[2][0].type,data:Ss(V)};j[0].messages[0].data=Ss(H)}g.content=li(ii(j)),g.size=g.content.length;var P=Ds(T[4][0].data);(function(){for(var X=We.find(d,c[P].location),W=yr(br(X.content)),z,ae=0;ae<W.length;++ae){var me=W[ae];me.id==P&&(z=me)}var xe=xt(z.messages[0].data);{xe[3]=[];var ue=[];l.forEach(function(F,ye){ue[1]=[{type:0,data:_t(ye)}],ue[2]=[{type:0,data:_t(1)}],ue[3]=[{type:2,data:WF(F)}],xe[3].push({type:2,data:Ss(ue)})})}z.messages[0].data=Ss(xe);var oe=ii(W),ze=li(oe);X.content=ze,X.size=X.content.length})();var J=xt(T[3][0].data);{var Ee=J[1][0];delete J[2];var Y=xt(Ee.data);{var de=Ds(Y[2][0].data);(function(){for(var X=We.find(d,c[de].location),W=yr(br(X.content)),z,ae=0;ae<W.length;++ae){var me=W[ae];me.id==de&&(z=me)}var xe=xt(z.messages[0].data);{delete xe[6],delete J[7];var ue=new Uint8Array(xe[5][0].data);xe[5]=[];for(var oe=0,ze=0;ze<=r.e.r;++ze){var F=xt(ue);oe+=sO(F,i[ze],l),F[1][0].data=_t(ze),xe[5].push({data:Ss(F),type:2})}xe[1]=[{type:0,data:_t(r.e.c+1)}],xe[2]=[{type:0,data:_t(r.e.r+1)}],xe[3]=[{type:0,data:_t(oe)}],xe[4]=[{type:0,data:_t(r.e.r+1)}]}z.messages[0].data=Ss(xe);var ye=ii(W),Ie=li(ye);X.content=Ie,X.size=X.content.length})()}Ee.data=Ss(Y)}T[3][0].data=Ss(J)}b[4][0].data=Ss(T)}x.messages[0].data=Ss(b);var De=ii(h),B=li(De);return u.content=B,u.size=u.content.length,d}function Dv(t){return function(s){for(var r=0;r!=t.length;++r){var a=t[r];s[a[0]]===void 0&&(s[a[0]]=a[1]),a[2]==="n"&&(s[a[0]]=Number(s[a[0]]))}}}function xu(t){Dv([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function pu(t){Dv([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function aO(t){return lt.WS.indexOf(t)>-1?"sheet":t==lt.CS?"chart":t==lt.DS?"dialog":t==lt.MS?"macro":t&&t.length?t:"sheet"}function nO(t,e){if(!t)return 0;try{t=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,aO(t["!id"][r.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function iO(t,e,s,r,a,i,l,c,o,d,f,u){try{i[r]=xl(hr(t,s,!0),e);var h=us(t,e),x;switch(c){case"sheet":x=T6(h,e,a,o,i[r],d,f,u);break;case"chart":if(x=C6(h,e,a,o,i[r],d,f,u),!x||!x["!drawel"])break;var m=rl(x["!drawel"].Target,e),p=Fl(m),v=xT(hr(t,m,!0),xl(hr(t,p,!0),m)),b=rl(v,m),_=Fl(b);x=s6(hr(t,b,!0),b,o,xl(hr(t,_,!0),b),d,x);break;case"macro":x=A6(h,e,a,o,i[r],d,f,u);break;case"dialog":x=F6(h,e,a,o,i[r],d,f,u);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=x;var g=[];i&&i[r]&&es(i[r]).forEach(function(j){var w="";if(i[r][j].Type==lt.CMNT){w=rl(i[r][j].Target,e);var k=M6(us(t,w,!0),w,o);if(!k||!k.length)return;mm(x,k,!1)}i[r][j].Type==lt.TCMNT&&(w=rl(i[r][j].Target,e),g=g.concat(gT(us(t,w,!0),o)))}),g&&g.length&&mm(x,g,!0,o.people||[])}catch(j){if(o.WTF)throw j}}function pr(t){return t.charAt(0)=="/"?t.slice(1):t}function lO(t,e){if(Li(),e=e||{},xu(e),_r(t,"META-INF/manifest.xml")||_r(t,"objectdata.xml"))return km(t,e);if(_r(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof o0<"u"){if(t.FileIndex)return o0(t);var s=We.utils.cfb_new();return Mh(t).forEach(function(V){st(s,V,Xg(t,V))}),o0(s)}throw new Error("Unsupported NUMBERS file")}if(!_r(t,"[Content_Types].xml"))throw _r(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_r(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Mh(t),a=fk(hr(t,"[Content_Types].xml")),i=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",us(t,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!us(t,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var o={},d={};if(!e.bookSheets&&!e.bookProps){if(pl=[],a.sst)try{pl=P6(us(t,pr(a.sst)),a.sst,e)}catch(V){if(e.WTF)throw V}e.cellStyles&&a.themes.length&&(o=D6(hr(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=O6(us(t,pr(a.style)),a.style,o,e))}a.links.map(function(V){try{var L=xl(hr(t,Fl(pr(V))),V);return I6(us(t,pr(V)),L,V,e)}catch{}});var f=E6(us(t,pr(a.workbooks[0])),a.workbooks[0],e),u={},h="";a.coreprops.length&&(h=us(t,pr(a.coreprops[0]),!0),h&&(u=_1(h)),a.extprops.length!==0&&(h=us(t,pr(a.extprops[0]),!0),h&&vk(h,u,e)));var x={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(h=hr(t,pr(a.custprops[0]),!0),h&&(x=bk(h,e)));var m={};if((e.bookSheets||e.bookProps)&&(f.Sheets?l=f.Sheets.map(function(L){return L.name}):u.Worksheets&&u.SheetNames.length>0&&(l=u.SheetNames),e.bookProps&&(m.Props=u,m.Custprops=x),e.bookSheets&&typeof l<"u"&&(m.SheetNames=l),e.bookSheets?m.SheetNames:e.bookProps))return m;l={};var p={};e.bookDeps&&a.calcchain&&(p=R6(us(t,pr(a.calcchain)),a.calcchain));var v=0,b={},_,g;{var j=f.Sheets;u.Worksheets=j.length,u.SheetNames=[];for(var w=0;w!=j.length;++w)u.SheetNames[w]=j[w].name}var k=i?"bin":"xml",y=a.workbooks[0].lastIndexOf("/"),N=(a.workbooks[0].slice(0,y+1)+"_rels/"+a.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");_r(t,N)||(N="xl/_rels/workbook."+k+".rels");var S=xl(hr(t,N,!0),N.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=L6(us(t,pr(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=yT(us(t,pr(a.people[0])),e)),S&&(S=nO(S,f.Sheets));var T=us(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=u.Worksheets;++v){var E="sheet";if(S&&S[v]?(_="xl/"+S[v][1].replace(/[\/]?xl\//,""),_r(t,_)||(_=S[v][1]),_r(t,_)||(_=N.replace(/_rels\/.*$/,"")+S[v][1]),E=S[v][2]):(_="xl/worksheets/sheet"+(v+1-T)+"."+k,_=_.replace(/sheet0\./,"sheet.")),g=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(v!=e.sheets)continue e;break;case"string":if(u.SheetNames[v].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var A=!1,H=0;H!=e.sheets.length;++H)typeof e.sheets[H]=="number"&&e.sheets[H]==v&&(A=1),typeof e.sheets[H]=="string"&&e.sheets[H].toLowerCase()==u.SheetNames[v].toLowerCase()&&(A=1);if(!A)continue e}}iO(t,_,g,u.SheetNames[v],v,b,l,E,e,f,o,d)}return m={Directory:a,Workbook:f,Props:u,Custprops:x,Deps:p,Sheets:l,SheetNames:u.SheetNames,Strings:pl,Styles:d,Themes:o,SSF:Bt(Ge)},e&&e.bookFiles&&(t.files?(m.keys=r,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(V,L){V=V.replace(/^Root Entry[\/]/,""),m.keys.push(V),m.files[V]=t.FileIndex[L]}))),e&&e.bookVBA&&(a.vba.length>0?m.vbaraw=us(t,pr(a.vba[0]),!0):a.defaults&&a.defaults.bin===ET&&(m.vbaraw=us(t,"xl/vbaProject.bin",!0))),m}function cO(t,e){var s=e||{},r="Workbook",a=We.find(t,r);try{if(r="/!DataSpaces/Version",a=We.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(L4(a.content),r="/!DataSpaces/DataSpaceMap",a=We.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=U4(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=We.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=$4(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=We.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);V4(a.content)}catch{}if(r="/EncryptionInfo",a=We.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=z4(a.content);if(r="/EncryptedPackage",a=We.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,s.password||"",s);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,s.password||"",s);throw new Error("File is password-protected")}function oO(t,e){return e.bookType=="ods"?Ov(t,e):e.bookType=="numbers"?rO(t,e):e.bookType=="xlsb"?dO(t,e):fO(t,e)}function dO(t,e){mi=1024,t&&!t.SSF&&(t.SSF=Bt(Ge)),t&&t.SSF&&(Li(),md(t.SSF),e.revssf=pd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,gl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var s=e.bookType=="xlsb"?"bin":"xml",r=iv.indexOf(e.bookType)>-1,a=tu();pu(e=e||{});var i=$f(),l="",c=0;if(e.cellXfs=[],on(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",st(i,l,w1(t.Props,e)),a.coreprops.push(l),Nt(e.rels,2,l,lt.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var o=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&o.push(t.SheetNames[d]);t.Props.SheetNames=o}for(t.Props.Worksheets=t.Props.SheetNames.length,st(i,l,k1(t.Props)),a.extprops.push(l),Nt(e.rels,3,l,lt.EXT_PROPS),t.Custprops!==t.Props&&es(t.Custprops||{}).length>0&&(l="docProps/custom.xml",st(i,l,S1(t.Custprops)),a.custprops.push(l),Nt(e.rels,4,l,lt.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var f={"!id":{}},u=t.Sheets[t.SheetNames[c-1]],h=(u||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+c+"."+s,st(i,l,U6(c-1,l,e,t,f)),a.sheets.push(l),Nt(e.wbrels,-1,"worksheets/sheet"+c+"."+s,lt.WS[0])}if(u){var x=u["!comments"],m=!1,p="";x&&x.length>0&&(p="xl/comments"+c+"."+s,st(i,p,V6(x,p)),a.comments.push(p),Nt(f,-1,"../comments"+c+"."+s,lt.CMNT),m=!0),u["!legacy"]&&m&&st(i,"xl/drawings/vmlDrawing"+c+".vml",av(c,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&st(i,Fl(l),wi(f))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+s,st(i,l,W6(e.Strings,l,e)),a.strs.push(l),Nt(e.wbrels,-1,"sharedStrings."+s,lt.SST)),l="xl/workbook."+s,st(i,l,B6(t,l)),a.workbooks.push(l),Nt(e.rels,1,l,lt.WB),l="xl/theme/theme1.xml",st(i,l,lu(t.Themes,e)),a.themes.push(l),Nt(e.wbrels,-1,"theme/theme1.xml",lt.THEME),l="xl/styles."+s,st(i,l,$6(t,l,e)),a.styles.push(l),Nt(e.wbrels,-1,"styles."+s,lt.STY),t.vbaraw&&r&&(l="xl/vbaProject.bin",st(i,l,t.vbaraw),a.vba.push(l),Nt(e.wbrels,-1,"vbaProject.bin",lt.VBA)),l="xl/metadata."+s,st(i,l,z6(l)),a.metadata.push(l),Nt(e.wbrels,-1,"metadata."+s,lt.XLMETA),st(i,"[Content_Types].xml",y1(a,e)),st(i,"_rels/.rels",wi(e.rels)),st(i,"xl/_rels/workbook."+s+".rels",wi(e.wbrels)),delete e.revssf,delete e.ssf,i}function fO(t,e){mi=1024,t&&!t.SSF&&(t.SSF=Bt(Ge)),t&&t.SSF&&(Li(),md(t.SSF),e.revssf=pd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,gl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var s="xml",r=iv.indexOf(e.bookType)>-1,a=tu();pu(e=e||{});var i=$f(),l="",c=0;if(e.cellXfs=[],on(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",st(i,l,w1(t.Props,e)),a.coreprops.push(l),Nt(e.rels,2,l,lt.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var o=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&o.push(t.SheetNames[d]);t.Props.SheetNames=o}t.Props.Worksheets=t.Props.SheetNames.length,st(i,l,k1(t.Props)),a.extprops.push(l),Nt(e.rels,3,l,lt.EXT_PROPS),t.Custprops!==t.Props&&es(t.Custprops||{}).length>0&&(l="docProps/custom.xml",st(i,l,S1(t.Custprops)),a.custprops.push(l),Nt(e.rels,4,l,lt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var u={"!id":{}},h=t.Sheets[t.SheetNames[c-1]],x=(h||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+s,st(i,l,gv(c-1,e,t,u)),a.sheets.push(l),Nt(e.wbrels,-1,"worksheets/sheet"+c+"."+s,lt.WS[0])}if(h){var m=h["!comments"],p=!1,v="";if(m&&m.length>0){var b=!1;m.forEach(function(_){_[1].forEach(function(g){g.T==!0&&(b=!0)})}),b&&(v="xl/threadedComments/threadedComment"+c+"."+s,st(i,v,vT(m,f,e)),a.threadedcomments.push(v),Nt(u,-1,"../threadedComments/threadedComment"+c+"."+s,lt.TCMNT)),v="xl/comments"+c+"."+s,st(i,v,nv(m)),a.comments.push(v),Nt(u,-1,"../comments"+c+"."+s,lt.CMNT),p=!0}h["!legacy"]&&p&&st(i,"xl/drawings/vmlDrawing"+c+".vml",av(c,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&st(i,Fl(l),wi(u))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+s,st(i,l,G1(e.Strings,e)),a.strs.push(l),Nt(e.wbrels,-1,"sharedStrings."+s,lt.SST)),l="xl/workbook."+s,st(i,l,wv(t)),a.workbooks.push(l),Nt(e.rels,1,l,lt.WB),l="xl/theme/theme1.xml",st(i,l,lu(t.Themes,e)),a.themes.push(l),Nt(e.wbrels,-1,"theme/theme1.xml",lt.THEME),l="xl/styles."+s,st(i,l,ev(t,e)),a.styles.push(l),Nt(e.wbrels,-1,"styles."+s,lt.STY),t.vbaraw&&r&&(l="xl/vbaProject.bin",st(i,l,t.vbaraw),a.vba.push(l),Nt(e.wbrels,-1,"vbaProject.bin",lt.VBA)),l="xl/metadata."+s,st(i,l,rv()),a.metadata.push(l),Nt(e.wbrels,-1,"metadata."+s,lt.XLMETA),f.length>1&&(l="xl/persons/person.xml",st(i,l,bT(f)),a.people.push(l),Nt(e.wbrels,-1,"persons/person.xml",lt.PEOPLE)),st(i,"[Content_Types].xml",y1(a,e)),st(i,"_rels/.rels",wi(e.rels)),st(i,"xl/_rels/workbook."+s+".rels",wi(e.wbrels)),delete e.revssf,delete e.ssf,i}function gu(t,e){var s="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":s=xr(t.slice(0,12));break;case"binary":s=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3),s.charCodeAt(4),s.charCodeAt(5),s.charCodeAt(6),s.charCodeAt(7)]}function uO(t,e){return We.find(t,"EncryptedPackage")?cO(t,e):Sv(t,e)}function hO(t,e){var s,r=t,a=e||{};return a.type||(a.type=it&&Buffer.isBuffer(t)?"buffer":"base64"),s=qg(r,a),lO(s,a)}function Pv(t,e){var s=0;e:for(;s<t.length;)switch(t.charCodeAt(s)){case 10:case 13:case 32:++s;break;case 60:return Y0(t.slice(s),e);default:break e}return Ti.to_workbook(t,e)}function mO(t,e){var s="",r=gu(t,e);switch(e.type){case"base64":s=xr(t);break;case"binary":s=t;break;case"buffer":s=t.toString("binary");break;case"array":s=In(t);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(s=Et(s)),e.type="binary",Pv(s,e)}function xO(t,e){var s=t;return e.type=="base64"&&(s=xr(s)),s=Va.utils.decode(1200,s.slice(2),"str"),e.type="binary",Pv(s,e)}function pO(t){return t.match(/[^\x00-\x7F]/)?ta(t):t}function d0(t,e,s,r){return r?(s.type="string",Ti.to_workbook(t,s)):Ti.to_workbook(e,s)}function Z0(t,e){Rf();var s=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Z0(new Uint8Array(t),(s=Bt(s),s.type="array",s));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!s.type&&(s.type=typeof Deno<"u"?"buffer":"array");var r=t,a=[0,0,0,0],i=!1;if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),ji={},s.dateNF&&(ji.dateNF=s.dateNF),s.type||(s.type=it&&Buffer.isBuffer(t)?"buffer":"base64"),s.type=="file"&&(s.type=it?"buffer":"binary",r=fj(t),typeof Uint8Array<"u"&&!it&&(s.type="array")),s.type=="string"&&(i=!0,s.type="binary",s.codepage=65001,r=pO(t)),s.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return s=Bt(s),s.type="array",Z0(If(r),s)}switch((a=gu(r,s))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return uO(We.read(r,s),s);break;case 9:if(a[1]<=8)return Sv(r,s);break;case 60:return Y0(r,s);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return _4(r,s);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return z1.to_workbook(r,s);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?hO(r,s):d0(t,r,s,i);case 239:return a[3]===60?Y0(r,s):d0(t,r,s,i);case 255:if(a[1]===254)return xO(r,s);if(a[1]===0&&a[2]===2&&a[3]===0)return An.to_workbook(r,s);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return An.to_workbook(r,s);break;case 3:case 131:case 139:case 140:return q0.to_workbook(r,s);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return J1.to_workbook(r,s);break;case 10:case 13:case 32:return mO(r,s);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return b4.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?q0.to_workbook(r,s):d0(t,r,s,i)}function Mv(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return sc(e.file,We.write(t,{type:it?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return We.write(t,e)}function gO(t,e){var s=Bt(e||{}),r=oO(t,s);return vO(r,s)}function vO(t,e){var s={},r=it?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(s.compression="DEFLATE"),e.password)s.type=r;else switch(e.type){case"base64":s.type="base64";break;case"binary":s.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":s.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?We.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[s.type]||s.type,compression:!!e.compression}):t.generate(s);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(hd(a))}return e.password&&typeof encrypt_agile<"u"?Mv(encrypt_agile(a,e.password),e):e.type==="file"?sc(e.file,a):e.type=="string"?Et(a):a}function yO(t,e){var s=e||{},r=pF(t,s);return Mv(r,s)}function qr(t,e,s){s||(s="");var r=s+t;switch(e.type){case"base64":return Sl(ta(r));case"binary":return ta(r);case"string":return t;case"file":return sc(e.file,r,"utf8");case"buffer":return it?Da(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):qr(r,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function bO(t,e){switch(e.type){case"base64":return Sl(t);case"binary":return t;case"string":return t;case"file":return sc(e.file,t,"binary");case"buffer":return it?Da(t,"binary"):t.split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Sc(t,e){switch(e.type){case"string":case"base64":case"binary":for(var s="",r=0;r<t.length;++r)s+=String.fromCharCode(t[r]);return e.type=="base64"?Sl(s):e.type=="string"?Et(s):s;case"file":return sc(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Rv(t,e){Rf(),u6(t);var s=Bt(e||{});if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),s.type=="array"){s.type="binary";var r=Rv(t,s);return s.type="array",hd(r)}var a=0;if(s.sheet&&(typeof s.sheet=="number"?a=s.sheet:a=t.SheetNames.indexOf(s.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+s.sheet+" : "+typeof s.sheet);switch(s.bookType||"xlsb"){case"xml":case"xlml":return qr(oF(t,s),s);case"slk":case"sylk":return qr(V1.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"htm":case"html":return qr(Tv(t.Sheets[t.SheetNames[a]],s),s);case"txt":return bO(Iv(t.Sheets[t.SheetNames[a]],s),s);case"csv":return qr(vu(t.Sheets[t.SheetNames[a]],s),s,"\uFEFF");case"dif":return qr(z1.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"dbf":return Sc(q0.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"prn":return qr(Ti.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"rtf":return qr(J1.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"eth":return qr(H1.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"fods":return qr(Ov(t,s),s);case"wk1":return Sc(An.sheet_to_wk1(t.Sheets[t.SheetNames[a]],s),s);case"wk3":return Sc(An.book_to_wk3(t,s),s);case"biff2":s.biff||(s.biff=2);case"biff3":s.biff||(s.biff=3);case"biff4":return s.biff||(s.biff=4),Sc(Ev(t,s),s);case"biff5":s.biff||(s.biff=5);case"biff8":case"xla":case"xls":return s.biff||(s.biff=8),yO(t,s);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return gO(t,s);default:throw new Error("Unrecognized bookType |"+s.bookType+"|")}}function _O(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},s=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();s.match(/^\.[a-z]+$/)&&(t.bookType=s.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Am(t,e,s){var r=s||{};return r.type="file",r.file=e,_O(r),Rv(t,r)}function wO(t,e,s,r,a,i,l,c){var o=is(s),d=c.defval,f=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),u=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:s,enumerable:!1})}catch{h.__rowNum__=s}else h.__rowNum__=s;if(!l||t[s])for(var x=e.s.c;x<=e.e.c;++x){var m=l?t[s][x]:t[r[x]+o];if(m===void 0||m.t===void 0){if(d===void 0)continue;i[x]!=null&&(h[i[x]]=d);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[x]!=null){if(p==null)if(m.t=="e"&&p===null)h[i[x]]=null;else if(d!==void 0)h[i[x]]=d;else if(f&&p===null)h[i[x]]=null;else continue;else h[i[x]]=f&&(m.t!=="n"||m.t==="n"&&c.rawNumbers!==!1)?p:Ta(m,p,c);p!=null&&(u=!1)}}return{row:h,isempty:u}}function Mo(t,e){if(t==null||t["!ref"]==null)return[];var s={t:"n",v:0},r=0,a=1,i=[],l=0,c="",o={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},f=d.range!=null?d.range:t["!ref"];switch(d.header===1?r=1:d.header==="A"?r=2:Array.isArray(d.header)?r=3:d.header==null&&(r=0),typeof f){case"string":o=mt(f);break;case"number":o=mt(t["!ref"]),o.s.r=f;break;default:o=f}r>0&&(a=0);var u=is(o.s.r),h=[],x=[],m=0,p=0,v=Array.isArray(t),b=o.s.r,_=0,g={};v&&!t[b]&&(t[b]=[]);var j=d.skipHidden&&t["!cols"]||[],w=d.skipHidden&&t["!rows"]||[];for(_=o.s.c;_<=o.e.c;++_)if(!(j[_]||{}).hidden)switch(h[_]=Yt(_),s=v?t[b][_]:t[h[_]+u],r){case 1:i[_]=_-o.s.c;break;case 2:i[_]=h[_];break;case 3:i[_]=d.header[_-o.s.c];break;default:if(s==null&&(s={w:"__EMPTY",t:"s"}),c=l=Ta(s,null,d),p=g[l]||0,!p)g[l]=1;else{do c=l+"_"+p++;while(g[c]);g[l]=p,g[c]=1}i[_]=c}for(b=o.s.r+a;b<=o.e.r;++b)if(!(w[b]||{}).hidden){var k=wO(t,o,b,h,r,i,v,d);(k.isempty===!1||(r===1?d.blankrows!==!1:d.blankrows))&&(x[m++]=k.row)}return x.length=m,x}var Fm=/"/g;function NO(t,e,s,r,a,i,l,c){for(var o=!0,d=[],f="",u=is(s),h=e.s.c;h<=e.e.c;++h)if(r[h]){var x=c.dense?(t[s]||[])[h]:t[r[h]+u];if(x==null)f="";else if(x.v!=null){o=!1,f=""+(c.rawNumbers&&x.t=="n"?x.v:Ta(x,null,c));for(var m=0,p=0;m!==f.length;++m)if((p=f.charCodeAt(m))===a||p===i||p===34||c.forceQuotes){f='"'+f.replace(Fm,'""')+'"';break}f=="ID"&&(f='"ID"')}else x.f!=null&&!x.F?(o=!1,f="="+x.f,f.indexOf(",")>=0&&(f='"'+f.replace(Fm,'""')+'"')):f="";d.push(f)}return c.blankrows===!1&&o?null:d.join(l)}function vu(t,e){var s=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=mt(t["!ref"]),i=r.FS!==void 0?r.FS:",",l=i.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,o=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),f="",u=[];r.dense=Array.isArray(t);for(var h=r.skipHidden&&t["!cols"]||[],x=r.skipHidden&&t["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(u[m]=Yt(m));for(var p=0,v=a.s.r;v<=a.e.r;++v)(x[v]||{}).hidden||(f=NO(t,a,v,u,l,o,i,r),f!=null&&(r.strip&&(f=f.replace(d,"")),(f||r.blankrows!==!1)&&s.push((p++?c:"")+f)));return delete r.dense,s.join("")}function Iv(t,e){e||(e={}),e.FS="	",e.RS=`
`;var s=vu(t,e);return s}function jO(t){var e="",s,r="";if(t==null||t["!ref"]==null)return[];var a=mt(t["!ref"]),i="",l=[],c,o=[],d=Array.isArray(t);for(c=a.s.c;c<=a.e.c;++c)l[c]=Yt(c);for(var f=a.s.r;f<=a.e.r;++f)for(i=is(f),c=a.s.c;c<=a.e.c;++c)if(e=l[c]+i,s=d?(t[f]||[])[c]:t[e],r="",s!==void 0){if(s.F!=null){if(e=s.F,!s.f)continue;r=s.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(s.f!=null)r=s.f;else{if(s.t=="z")continue;if(s.t=="n"&&s.v!=null)r=""+s.v;else if(s.t=="b")r=s.v?"TRUE":"FALSE";else if(s.w!==void 0)r="'"+s.w;else{if(s.v===void 0)continue;s.t=="s"?r="'"+s.v:r=""+s.v}}o[o.length]=e+"="+r}return o}function Lv(t,e,s){var r=s||{},a=+!r.skipHeader,i=t||{},l=0,c=0;if(i&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var o=typeof r.origin=="string"?Kt(r.origin):r.origin;l=o.r,c=o.c}var d,f={s:{c:0,r:0},e:{c,r:l+e.length-1+a}};if(i["!ref"]){var u=mt(i["!ref"]);f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),l==-1&&(l=u.e.r+1,f.e.r=l+e.length-1+a)}else l==-1&&(l=0,f.e.r=e.length-1+a);var h=r.header||[],x=0;e.forEach(function(p,v){es(p).forEach(function(b){(x=h.indexOf(b))==-1&&(h[x=h.length]=b);var _=p[b],g="z",j="",w=Ye({c:c+x,r:l+v+a});d=Ll(i,w),_&&typeof _=="object"&&!(_ instanceof Date)?i[w]=_:(typeof _=="number"?g="n":typeof _=="boolean"?g="b":typeof _=="string"?g="s":_ instanceof Date?(g="d",r.cellDates||(g="n",_=vs(_)),j=r.dateNF||Ge[14]):_===null&&r.nullError&&(g="e",_=0),d?(d.t=g,d.v=_,delete d.w,delete d.R,j&&(d.z=j)):i[w]=d={t:g,v:_},j&&(d.z=j))})}),f.e.c=Math.max(f.e.c,c+h.length-1);var m=is(l);if(a)for(x=0;x<h.length;++x)i[Yt(x+c)+m]={t:"s",v:h[x]};return i["!ref"]=tt(f),i}function kO(t,e){return Lv(null,t,e)}function Ll(t,e,s){if(typeof e=="string"){if(Array.isArray(t)){var r=Kt(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ll(t,Ye(e)):Ll(t,Ye({r:e,c:s||0}))}function SO(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var s=t.SheetNames.indexOf(e);if(s>-1)return s;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function yu(){return{SheetNames:[],Sheets:{}}}function bu(t,e,s,r){var a=1;if(!s)for(;a<=65535&&t.SheetNames.indexOf(s="Sheet"+a)!=-1;++a,s=void 0);if(!s||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(s)>=0){var i=s.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||s;for(++a;a<=65535&&t.SheetNames.indexOf(s=l+a)!=-1;++a);}if(_v(s),t.SheetNames.indexOf(s)>=0)throw new Error("Worksheet with name |"+s+"| already exists!");return t.SheetNames.push(s),t.Sheets[s]=e,s}function EO(t,e,s){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=SO(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),s){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+s)}t.Workbook.Sheets[r].Hidden=s}function TO(t,e){return t.z=e,t}function Bv(t,e,s){return e?(t.l={Target:e},s&&(t.l.Tooltip=s)):delete t.l,t}function CO(t,e,s){return Bv(t,"#"+e,s)}function AO(t,e,s){t.c||(t.c=[]),t.c.push({t:e,a:s||"SheetJS"})}function FO(t,e,s,r){for(var a=typeof e!="string"?e:mt(e),i=typeof e=="string"?e:tt(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var o=Ll(t,l,c);o.t="n",o.F=i,delete o.v,l==a.s.r&&c==a.s.c&&(o.f=s,r&&(o.D=!0))}return t}var Gr={encode_col:Yt,encode_row:is,encode_cell:Ye,encode_range:tt,decode_col:Yf,decode_row:qf,split_cell:Wj,decode_cell:Kt,decode_range:cr,format_cell:Ta,sheet_add_aoa:u1,sheet_add_json:Lv,sheet_add_dom:Cv,aoa_to_sheet:Bi,json_to_sheet:kO,table_to_sheet:Av,table_to_book:LF,sheet_to_csv:vu,sheet_to_txt:Iv,sheet_to_json:Mo,sheet_to_html:Tv,sheet_to_formulae:jO,sheet_to_row_object_array:Mo,sheet_get_cell:Ll,book_new:yu,book_append_sheet:bu,book_set_sheet_visibility:EO,cell_set_number_format:TO,cell_set_hyperlink:Bv,cell_set_internal_link:CO,cell_add_comment:AO,sheet_set_array_formula:FO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const OO=()=>{var ct,cs,yt;const t=vt(),{exams:e}=ge(ee=>ee.exams),{subjects:s}=ge(ee=>ee.subjects),{users:r}=ge(ee=>ee.users),{marks:a,loading:i}=ge(ee=>ee.marks),{user:l}=ge(ee=>ee.auth),[c,o]=G.useState(null),[d,f]=G.useState([]),[u,h]=G.useState([]),[x,m]=G.useState(""),[p,v]=G.useState("name"),[b]=G.useState("asc"),[_,g]=G.useState(!0),[j,w]=G.useState(!1),[k,y]=G.useState(null),[N,S]=G.useState(null),[T,E]=G.useState(!1),[A,H]=G.useState(!1),[V,L]=G.useState(new Set),[P,J]=G.useState(""),[Ee,Y]=G.useState(!1),[de]=G.useState(!0),[De,B]=G.useState(!0),[X,W]=G.useState(!1),[z,ae]=G.useState(null),[me,xe]=G.useState([]),[ue,oe]=G.useState(""),ze=G.useRef({}),F=G.useRef(null);G.useEffect(()=>{t(Br()),t(It()),t(gs())},[t]);const ye=G.useMemo(()=>s.filter(ee=>ee.teacher_id===(l==null?void 0:l.id)),[s,l==null?void 0:l.id]),Ie=G.useMemo(()=>e.filter(ee=>ye.some(je=>je.id===ee.subject_id)),[e,ye]),Le=G.useMemo(()=>{if(!c||!d.length)return{totalMarks:0,average:0,passRate:0};const ee=c.total_marks||0,je=d.filter(ot=>ot.total!==void 0&&!isNaN(ot.total)),Ae=je.reduce((ot,qe)=>ot+(qe.total||0),0),$e=je.length>0?Ae/je.length:0,Ve=je.filter(ot=>(ot.total||0)>=ee*.4).length,Xe=je.length>0?Ve/je.length*100:0;return{totalMarks:ee,average:Math.round($e*100)/100,passRate:Math.round(Xe*100)/100,totalStudents:je.length,passCount:Ve}},[d,c]),K=G.useMemo(()=>{if(!d.length||!c)return null;const{totalMarks:ee,average:je,passRate:Ae,totalStudents:$e,passCount:Ve}=Le||{},Xe=d.map(qe=>qe.total||0).filter(qe=>!isNaN(qe)),ot={"A+":Xe.filter(qe=>qe>=(ee||0)*.9).length,A:Xe.filter(qe=>qe>=(ee||0)*.8&&qe<(ee||0)*.9).length,"B+":Xe.filter(qe=>qe>=(ee||0)*.7&&qe<(ee||0)*.8).length,B:Xe.filter(qe=>qe>=(ee||0)*.6&&qe<(ee||0)*.7).length,C:Xe.filter(qe=>qe>=(ee||0)*.5&&qe<(ee||0)*.6).length,D:Xe.filter(qe=>qe>=(ee||0)*.4&&qe<(ee||0)*.5).length,F:Xe.filter(qe=>qe<(ee||0)*.4).length};return{totalMarks:ee,average:je,passRate:Ae,totalStudents:$e||0,passCount:Ve||0,failCount:($e||0)-(Ve||0),gradeDistribution:ot,highest:Math.max(...Xe,0),lowest:Math.min(...Xe.filter(qe=>qe>0),0)||0}},[d,c,Le]),Z=async ee=>{try{E(!0);const je=await id.getLockStatus(ee);S(je)}catch(je){console.error("Error fetching lock status:",je),S(null)}finally{E(!1)}},Oe=async ee=>{o(ee),S(null),L(new Set),H(!1);const je=s.find(Ae=>Ae.id===ee.subject_id);if(je){const Ae=r.filter(Ve=>Ve.role==="student"&&Ve.class_id===je.class_id);h(Ae),t(eo(ee.id)),Z(ee.id);const $e=Ae.map(Ve=>{var qe;const Xe={};let ot=0;return(qe=ee.questions)==null||qe.forEach(ys=>{const Ut=a.find(ds=>ds.student_id===Ve.id&&ds.question_id===ys.id),os=(Ut==null?void 0:Ut.marks_obtained)||0;Xe[ys.id]=os,ot+=os}),{student_id:Ve.id,student_name:`${Ve.first_name} ${Ve.last_name}`,student_roll:Ve.username||"",marks:Xe,total:Math.round(ot*100)/100,percentage:(c==null?void 0:c.total_marks)>0?Math.round(ot/c.total_marks*1e4)/100:0}});f($e)}},Te=(ee,je,Ae)=>{N!=null&&N.is_locked||(f($e=>$e.map(Ve=>{if(Ve.student_id===ee){const Xe={...Ve.marks,[je]:Ae},ot=Object.values(Xe).reduce((ys,Ut)=>{const os=Number(Ut)||0;return ys+os},0),qe=(c==null?void 0:c.total_marks)>0?ot/c.total_marks*100:0;return{...Ve,marks:Xe,total:Math.round(ot*100)/100,percentage:Math.round(qe*100)/100}}return Ve})),j&&setTimeout(()=>{_e()},2e3))},M=(ee,je)=>{N!=null&&N.is_locked||f(Ae=>Ae.map($e=>{if(V.size===0||V.has($e.student_id)){const Ve={...$e.marks,[ee]:je},Xe=Object.values(Ve).reduce((qe,ys)=>{const Ut=Number(ys)||0;return qe+Ut},0),ot=(c==null?void 0:c.total_marks)>0?Xe/c.total_marks*100:0;return{...$e,marks:Ve,total:Math.round(Xe*100)/100,percentage:Math.round(ot*100)/100}}return $e}))},q=ee=>{const je=new Set(V);je.has(ee)?je.delete(ee):je.add(ee),L(je)},Q=()=>{V.size===u.length?L(new Set):L(new Set(u.map(ee=>ee.id)))};G.useEffect(()=>{if(!De)return;const ee=je=>{var Ae;if(je.ctrlKey||je.metaKey)switch(je.key){case"s":je.preventDefault(),_e();break;case"a":je.preventDefault(),Q();break;case"b":je.preventDefault(),H(!A);break;case"f":je.preventDefault(),(Ae=document.getElementById("search-input"))==null||Ae.focus();break}};return document.addEventListener("keydown",ee),()=>document.removeEventListener("keydown",ee)},[De,A]),G.useEffect(()=>{if(j&&d.length>0){const ee=setTimeout(()=>{_e()},5e3);return()=>clearTimeout(ee)}},[d,j]);const _e=async()=>{if(c){if(N!=null&&N.is_locked){Ue.error(N.message||"Marks are locked and cannot be modified");return}try{const ee=[];for(const je of d)for(const Ae in je.marks)ee.push({exam_id:c.id,student_id:je.student_id,question_id:parseInt(Ae),marks_obtained:Number(je.marks[Ae])});await t(fl(ee)).unwrap(),y(new Date),Ue.success("Marks saved successfully!",{duration:3e3,icon:""})}catch(ee){Ue.error(ee.message||"Failed to save marks")}}},ve=G.useMemo(()=>{let ee=d.filter(je=>je.student_name.toLowerCase().includes(x.toLowerCase())||je.student_roll.toLowerCase().includes(x.toLowerCase()));return Ee&&(ee=ee.filter(je=>{var Ve;const Ae=((Ve=c==null?void 0:c.questions)==null?void 0:Ve.length)||0;return Object.values(je.marks).filter(Xe=>Xe>0).length<Ae})),ee.sort((je,Ae)=>{let $e=0;switch(p){case"name":$e=je.student_name.localeCompare(Ae.student_name);break;case"total":$e=(je.total||0)-(Ae.total||0);break;case"percentage":$e=(je.percentage||0)-(Ae.percentage||0);break}return b==="asc"?$e:-$e})},[d,x,p,b,Ee,c]),fe=ee=>{var $e;const je=($e=ee.target.files)==null?void 0:$e[0];if(!je)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(je.type)){oe("Please upload a valid Excel (.xlsx, .xls) or CSV file");return}ae(je),oe(""),Fe(je)},Fe=ee=>{const je=new FileReader;je.onload=Ae=>{var $e;try{const Ve=($e=Ae.target)==null?void 0:$e.result;let Xe;if(ee.type==="text/csv"){const os=Gr.aoa_to_sheet(Ve.split(`
`).map(ds=>ds.split(",")));Xe=Gr.book_new(),Gr.book_append_sheet(Xe,os,"Sheet1")}else Xe=Z0(Ve,{type:"binary"});const ot=Xe.SheetNames[0],qe=Xe.Sheets[ot],ys=Gr.sheet_to_json(qe,{header:1}),Ut=rt(ys);if(Ut.error){oe(Ut.error);return}xe(Ut.data)}catch(Ve){oe("Error parsing file. Please check the format."),console.error("File parsing error:",Ve)}},ee.type==="text/csv"?je.readAsText(ee):je.readAsBinaryString(ee)},rt=ee=>{var ot,qe,ys,Ut;if(!c)return{error:"No exam selected",data:[]};if(ee.length<2)return{error:"File must contain at least a header row and one data row",data:[]};const je=ee[0],Ae=["Roll No","Student Name"];(ot=c.questions)==null||ot.forEach((os,ds)=>{Ae.push(`Q${ds+1} (${os.max_marks})`)});const $e=Ae.filter(os=>!je.some(ds=>ds&&ds.toString().toLowerCase().includes(os.toLowerCase().split(" ")[0])));if($e.length>0)return{error:`Missing required columns: ${$e.join(", ")}. Please use the template format.`,data:[]};const Ve=[],Xe=[];for(let os=1;os<ee.length;os++){const ds=ee[os];if(!ds||ds.length===0)continue;const bs={rowIndex:os+1,rollNo:((qe=ds[0])==null?void 0:qe.toString().trim())||"",studentName:((ys=ds[1])==null?void 0:ys.toString().trim())||"",marks:{},errors:[]};(Ut=c.questions)==null||Ut.forEach((dt,Tt)=>{const zs=2+Tt,_s=ds[zs];if(_s!=null&&_s!==""){const Ra=parseFloat(_s.toString());isNaN(Ra)?bs.errors.push(`Q${Tt+1}: Invalid number format`):Ra<0?bs.errors.push(`Q${Tt+1}: Cannot be negative`):Ra>dt.max_marks?bs.errors.push(`Q${Tt+1}: Exceeds max marks (${dt.max_marks})`):bs.marks[dt.id]=Ra}});const pe=u.find(dt=>dt.username===bs.rollNo||`${dt.first_name} ${dt.last_name}`.toLowerCase()===bs.studentName.toLowerCase());pe?(bs.student_id=pe.id,bs.student=pe):bs.errors.push("Student not found in class"),bs.errors.length>0&&Xe.push(`Row ${bs.rowIndex}: ${bs.errors.join(", ")}`),Ve.push(bs)}return Xe.length>0?{error:`Validation errors found:
${Xe.slice(0,5).join(`
`)}${Xe.length>5?`
... and ${Xe.length-5} more errors`:""}`,data:Ve}:{error:null,data:Ve}},Ze=async()=>{if(!(!c||!me.length)){if(N!=null&&N.is_locked){Ue.error(N.message||"Marks are locked and cannot be modified");return}try{const ee=[];for(const Ae of me)if(Ae.student_id)for(const $e in Ae.marks)ee.push({exam_id:c.id,student_id:Ae.student_id,question_id:parseInt($e),marks_obtained:Ae.marks[$e]});if(ee.length===0){Ue.error("No valid marks found to upload");return}await t(fl(ee)).unwrap();const je=d.map(Ae=>{const $e=me.find(Ve=>Ve.student_id===Ae.student_id);if($e){const Ve={...Ae.marks,...$e.marks},Xe=Object.values(Ve).reduce((qe,ys)=>{const Ut=Number(ys)||0;return qe+Ut},0),ot=(c==null?void 0:c.total_marks)>0?Xe/c.total_marks*100:0;return{...Ae,marks:Ve,total:Math.round(Xe*100)/100,percentage:Math.round(ot*100)/100}}return Ae});f(je),W(!1),ae(null),xe([]),oe(""),Ue.success(`Successfully uploaded marks for ${ee.length} entries!`)}catch(ee){Ue.error(ee.message||"Failed to upload marks")}}},St=()=>{if(!c)return;const ee=Gr.book_new(),je=ve.map($e=>{var Xe;const Ve={"Roll No":$e.student_roll,"Student Name":$e.student_name,"Total Marks":$e.total||0,Percentage:`${$e.percentage||0}%`,Status:($e.total||0)>=c.total_marks*.4?"Pass":"Fail"};return(Xe=c.questions)==null||Xe.forEach((ot,qe)=>{Ve[`Q${qe+1} (${ot.max_marks})`]=$e.marks[ot.id]||0}),Ve}),Ae=Gr.json_to_sheet(je);Gr.book_append_sheet(ee,Ae,"Marks"),Am(ee,`${c.name}_Marks_${new Date().toISOString().split("T")[0]}.xlsx`)},Ke=()=>{if(!c)return;const ee=Gr.book_new(),je=u.map($e=>{var Xe;const Ve={"Roll No":$e.username||"","Student Name":`${$e.first_name} ${$e.last_name}`,"Total Marks":"",Percentage:"",Status:""};return(Xe=c.questions)==null||Xe.forEach((ot,qe)=>{Ve[`Q${qe+1} (${ot.max_marks})`]=""}),Ve}),Ae=Gr.json_to_sheet(je);Gr.book_append_sheet(ee,Ae,"Template"),Am(ee,`${c.name}_Template.xlsx`)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Marks Entry"}),n.jsx("p",{className:"text-gray-600",children:"Enter and manage student marks efficiently"})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",id:"keyboard-shortcuts",checked:De,onChange:ee=>B(ee.target.checked),className:"rounded"}),n.jsx("label",{htmlFor:"keyboard-shortcuts",className:"text-sm text-gray-600",children:"Keyboard Shortcuts"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",id:"auto-save",checked:j,onChange:ee=>w(ee.target.checked),className:"rounded"}),n.jsx("label",{htmlFor:"auto-save",className:"text-sm text-gray-600",children:"Auto Save"})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Exam"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Ie.map(ee=>{var Ae;const je=s.find($e=>$e.id===ee.subject_id);return n.jsxs("div",{onClick:()=>Oe(ee),className:`p-4 border rounded-lg cursor-pointer transition-all hover:shadow-md ${(c==null?void 0:c.id)===ee.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:ee.name}),n.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:ee.exam_type})]}),n.jsx("p",{className:"text-sm text-gray-600 mb-2",children:je==null?void 0:je.name}),n.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:[ee.total_marks," marks"]}),n.jsxs("span",{children:[((Ae=ee.questions)==null?void 0:Ae.length)||0," questions"]})]}),ee.exam_date&&n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(ee.exam_date).toLocaleDateString()})]},ee.id)})})]}),c&&n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[c.name," - Marks Entry"]}),n.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[u.length," students  ",((ct=c.questions)==null?void 0:ct.length)||0," questions  ",c.total_marks," total marks"]}),N&&n.jsx("div",{className:`mt-2 px-3 py-2 rounded-md text-sm font-medium ${N.is_locked?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:T?n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Checking lock status..."]}):n.jsxs("div",{className:"flex items-center",children:[N.is_locked?n.jsx(Cs,{size:16,className:"mr-2"}):n.jsx(Ot,{size:16,className:"mr-2"}),N.message,!N.is_locked&&N.days_remaining!==null&&n.jsxs("span",{className:"ml-2 text-xs",children:["(Lock date: ",new Date(N.lock_date).toLocaleDateString(),")"]})]})})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[k&&n.jsxs("div",{className:"text-xs text-gray-500",children:["Last saved: ",k.toLocaleTimeString()]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Ct,{size:16,className:"text-gray-600"}),n.jsxs("span",{className:"text-sm text-gray-600",children:[u.length," students"]})]})]})]}),n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6 p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Oi,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),n.jsx("input",{id:"search-input",type:"text",placeholder:"Search students...",value:x,onChange:ee=>m(ee.target.value),className:"input-field pl-10 w-64"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",id:"show-incomplete",checked:Ee,onChange:ee=>Y(ee.target.checked),className:"rounded"}),n.jsx("label",{htmlFor:"show-incomplete",className:"text-sm text-gray-600",children:"Show only incomplete"})]})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>H(!A),className:`btn-secondary flex items-center space-x-2 ${A?"bg-blue-100 text-blue-700":""}`,children:[n.jsx(ob,{size:16}),n.jsx("span",{children:"Bulk Mode"})]}),A&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:Q,className:"btn-secondary text-sm",children:V.size===u.length?"Deselect All":"Select All"}),n.jsxs("span",{className:"text-sm text-gray-600",children:[V.size," selected"]})]})]}),n.jsx("div",{className:"flex items-center space-x-2",children:n.jsxs("button",{onClick:()=>g(!_),className:"btn-secondary flex items-center space-x-2",children:[n.jsx(rs,{size:16}),n.jsxs("span",{children:[_?"Hide":"Show"," Stats"]})]})})]})]}),_&&K&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:K.totalStudents}),n.jsx("div",{className:"text-sm text-blue-600",children:"Total Students"})]}),n.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:K.passCount}),n.jsx("div",{className:"text-sm text-green-600",children:"Passed"})]}),n.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-red-600",children:K.failCount}),n.jsx("div",{className:"text-sm text-red-600",children:"Failed"})]}),n.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-purple-600",children:K.average}),n.jsx("div",{className:"text-sm text-purple-600",children:"Average"})]}),n.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[n.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[K.passRate,"%"]}),n.jsx("div",{className:"text-sm text-orange-600",children:"Pass Rate"})]}),n.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:K.highest}),n.jsx("div",{className:"text-sm text-indigo-600",children:"Highest"})]})]}),n.jsx("div",{ref:F,className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:[A&&n.jsx("input",{type:"checkbox",checked:V.size===u.length,onChange:Q,className:"rounded"}),n.jsx("span",{className:"ml-2",children:"Student"})]}),(cs=c.questions)==null?void 0:cs.map((ee,je)=>n.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("span",{children:["Q",je+1]}),n.jsxs("span",{className:"text-gray-400",children:["(",ee.max_marks,")"]}),A&&n.jsxs("div",{className:"mt-2 flex items-center space-x-1",children:[n.jsx("input",{type:"number",placeholder:"Fill",value:P,onChange:Ae=>J(Ae.target.value),className:"w-12 h-6 text-xs text-center border rounded",min:"0",max:ee.max_marks}),n.jsx("button",{onClick:()=>M(ee.id,Number(P)||0),className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200",children:"Fill"})]})]})},ee.id)),n.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("span",{children:"Total"}),n.jsx("button",{onClick:()=>v("total"),className:"hover:text-gray-700",children:p==="total"?b==="asc"?n.jsx(hc,{size:14}):n.jsx(Lu,{size:14}):n.jsx(hc,{size:14})})]})}),n.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("span",{children:"%"}),n.jsx("button",{onClick:()=>v("percentage"),className:"hover:text-gray-700",children:p==="percentage"?b==="asc"?n.jsx(hc,{size:14}):n.jsx(Lu,{size:14}):n.jsx(hc,{size:14})})]})}),n.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ve.map(ee=>{var je;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center",children:[A&&n.jsx("input",{type:"checkbox",checked:V.has(ee.student_id),onChange:()=>q(ee.student_id),className:"rounded mr-3"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:ee.student_name}),n.jsx("div",{className:"text-sm text-gray-500",children:ee.student_roll})]})]})}),(je=c.questions)==null?void 0:je.map(Ae=>n.jsxs("td",{className:"px-4 py-3 text-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx("input",{ref:$e=>{ze.current[`${ee.student_id}-${Ae.id}`]=$e},type:"number",min:"0",max:Ae.max_marks,step:"0.5",value:ee.marks[Ae.id]||"",onChange:$e=>Te(ee.student_id,Ae.id,parseFloat($e.target.value)||0),disabled:N==null?void 0:N.is_locked,className:`w-16 input-field text-center ${N!=null&&N.is_locked?"bg-gray-100 cursor-not-allowed opacity-60":ee.marks[Ae.id]>Ae.max_marks?"border-red-300 bg-red-50":ee.marks[Ae.id]===Ae.max_marks?"border-green-300 bg-green-50":""}`,placeholder:"0"}),de&&ee.marks[Ae.id]>Ae.max_marks&&n.jsx(Cs,{className:"absolute -right-6 top-1/2 transform -translate-y-1/2 w-4 h-4 text-red-500"}),de&&ee.marks[Ae.id]===Ae.max_marks&&n.jsx(Ot,{className:"absolute -right-6 top-1/2 transform -translate-y-1/2 w-4 h-4 text-green-500"})]}),n.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["/",Ae.max_marks]})]},Ae.id)),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:ee.total||0})}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsxs("div",{className:`text-sm font-medium ${(ee.percentage||0)>=80?"text-green-600":(ee.percentage||0)>=60?"text-yellow-600":(ee.percentage||0)>=40?"text-orange-600":"text-red-600"}`,children:[ee.percentage||0,"%"]})}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${(ee.percentage||0)>=40?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(ee.percentage||0)>=40?"Pass":"Fail"})})]},ee.student_id)})})]})}),n.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("button",{onClick:Ke,className:"btn-secondary flex items-center space-x-2",children:[n.jsx(kr,{size:18}),n.jsx("span",{children:"Download Template"})]}),n.jsxs("button",{onClick:()=>W(!0),className:"btn-secondary flex items-center space-x-2",children:[n.jsx(mc,{size:18}),n.jsx("span",{children:"Upload Excel/CSV"})]}),n.jsxs("button",{onClick:St,className:"btn-secondary flex items-center space-x-2",children:[n.jsx(Bu,{size:18}),n.jsx("span",{children:"Export Excel"})]})]}),n.jsxs("button",{onClick:_e,disabled:i||!d.length||(N==null?void 0:N.is_locked),className:"btn-primary flex items-center space-x-2 disabled:opacity-50",children:[i?n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):n.jsx(db,{size:18}),n.jsx("span",{children:i?"Saving...":"Save Marks"})]})]}),De&&n.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Keyboard Shortcuts:"}),n.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[n.jsx("div",{children:"Ctrl+S: Save marks"}),n.jsx("div",{children:"Ctrl+A: Select all students"}),n.jsx("div",{children:"Ctrl+B: Toggle bulk mode"}),n.jsx("div",{children:"Ctrl+F: Focus search"})]})]})]}),X&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 my-8 max-h-[90vh] flex flex-col shadow-xl",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upload Marks from Excel/CSV"}),n.jsx("button",{onClick:()=>{W(!1),ae(null),xe([]),oe("")},className:"text-gray-400 hover:text-gray-600",children:""})]}),n.jsx("div",{className:"p-6 flex-1 overflow-y-auto",children:z?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Bu,{size:24,className:"text-green-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:z.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:[(z.size/1024).toFixed(1)," KB"]})]})]}),n.jsx("button",{onClick:()=>{ae(null),xe([]),oe("")},className:"text-gray-400 hover:text-gray-600",children:""})]}),ue?n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(Cs,{size:20,className:"text-red-600 mr-3 mt-0.5"}),n.jsxs("div",{children:[n.jsx("h5",{className:"font-medium text-red-800 mb-1",children:"Validation Error"}),n.jsx("p",{className:"text-sm text-red-700 whitespace-pre-line",children:ue})]})]})}):me.length>0?n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(Ot,{size:20,className:"text-green-600 mr-3 mt-0.5"}),n.jsxs("div",{children:[n.jsx("h5",{className:"font-medium text-green-800 mb-1",children:"File Validated Successfully"}),n.jsxs("p",{className:"text-sm text-green-700",children:["Found ",me.length," students with valid marks data."]})]})]})}),n.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[n.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b",children:n.jsx("h6",{className:"font-medium text-gray-900",children:"Preview (First 10 rows)"})}),n.jsx("div",{className:"overflow-x-auto max-h-64",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left",children:"Roll No"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"Student Name"}),(yt=c.questions)==null?void 0:yt.slice(0,5).map((ee,je)=>n.jsxs("th",{className:"px-3 py-2 text-center",children:["Q",je+1]},ee.id)),c.questions&&c.questions.length>5&&n.jsx("th",{className:"px-3 py-2 text-center",children:"..."})]})}),n.jsx("tbody",{children:me.slice(0,10).map((ee,je)=>{var Ae;return n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-3 py-2",children:ee.rollNo}),n.jsx("td",{className:"px-3 py-2",children:ee.studentName}),(Ae=c.questions)==null?void 0:Ae.slice(0,5).map($e=>n.jsx("td",{className:"px-3 py-2 text-center",children:ee.marks[$e.id]!==void 0?ee.marks[$e.id]:"-"},$e.id)),c.questions&&c.questions.length>5&&n.jsx("td",{className:"px-3 py-2 text-center text-gray-400",children:"..."})]},je)})})]})})]})]}):null]}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[n.jsx(mc,{size:48,className:"mx-auto text-gray-400 mb-4"}),n.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Excel or CSV File"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"Please use the template format. Download the template first to ensure proper formatting."}),n.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:fe,className:"hidden",id:"file-upload"}),n.jsxs("label",{htmlFor:"file-upload",className:"btn-primary cursor-pointer inline-flex items-center space-x-2",children:[n.jsx(mc,{size:18}),n.jsx("span",{children:"Choose File"})]})]}),n.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[n.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"File Format Requirements:"}),n.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[n.jsx("li",{children:" First column: Roll No (must match student roll numbers)"}),n.jsx("li",{children:" Second column: Student Name (must match student names)"}),n.jsx("li",{children:" Subsequent columns: Q1 (max_marks), Q2 (max_marks), etc."}),n.jsx("li",{children:" Supported formats: .xlsx, .xls, .csv"}),n.jsx("li",{children:" Use the template for proper formatting"})]})]})]})}),z&&!ue&&me.length>0&&n.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t bg-gray-50",children:[n.jsx("button",{onClick:()=>{W(!1),ae(null),xe([]),oe("")},className:"btn-secondary",children:"Cancel"}),n.jsxs("button",{onClick:Ze,disabled:i,className:"btn-primary flex items-center space-x-2",children:[i?n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):n.jsx(mc,{size:18}),n.jsx("span",{children:i?"Uploading...":"Upload Marks"})]})]})]})})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function dc(t){return t+.5|0}const Ga=(t,e,s)=>Math.max(Math.min(t,s),e);function al(t){return Ga(dc(t*2.55),0,255)}function Ja(t){return Ga(dc(t*255),0,255)}function ya(t){return Ga(dc(t/2.55)/100,0,1)}function Om(t){return Ga(dc(t*100),0,100)}const gr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Q0=[..."0123456789ABCDEF"],DO=t=>Q0[t&15],PO=t=>Q0[(t&240)>>4]+Q0[t&15],Ec=t=>(t&240)>>4===(t&15),MO=t=>Ec(t.r)&&Ec(t.g)&&Ec(t.b)&&Ec(t.a);function RO(t){var e=t.length,s;return t[0]==="#"&&(e===4||e===5?s={r:255&gr[t[1]]*17,g:255&gr[t[2]]*17,b:255&gr[t[3]]*17,a:e===5?gr[t[4]]*17:255}:(e===7||e===9)&&(s={r:gr[t[1]]<<4|gr[t[2]],g:gr[t[3]]<<4|gr[t[4]],b:gr[t[5]]<<4|gr[t[6]],a:e===9?gr[t[7]]<<4|gr[t[8]]:255})),s}const IO=(t,e)=>t<255?e(t):"";function LO(t){var e=MO(t)?DO:PO;return t?"#"+e(t.r)+e(t.g)+e(t.b)+IO(t.a,e):void 0}const BO=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Uv(t,e,s){const r=e*Math.min(s,1-s),a=(i,l=(i+t/30)%12)=>s-r*Math.max(Math.min(l-3,9-l,1),-1);return[a(0),a(8),a(4)]}function UO(t,e,s){const r=(a,i=(a+t/60)%6)=>s-s*e*Math.max(Math.min(i,4-i,1),0);return[r(5),r(3),r(1)]}function $O(t,e,s){const r=Uv(t,1,.5);let a;for(e+s>1&&(a=1/(e+s),e*=a,s*=a),a=0;a<3;a++)r[a]*=1-e-s,r[a]+=e;return r}function WO(t,e,s,r,a){return t===a?(e-s)/r+(e<s?6:0):e===a?(s-t)/r+2:(t-e)/r+4}function _u(t){const s=t.r/255,r=t.g/255,a=t.b/255,i=Math.max(s,r,a),l=Math.min(s,r,a),c=(i+l)/2;let o,d,f;return i!==l&&(f=i-l,d=c>.5?f/(2-i-l):f/(i+l),o=WO(s,r,a,f,i),o=o*60+.5),[o|0,d||0,c]}function wu(t,e,s,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,s,r)).map(Ja)}function Nu(t,e,s){return wu(Uv,t,e,s)}function VO(t,e,s){return wu($O,t,e,s)}function zO(t,e,s){return wu(UO,t,e,s)}function $v(t){return(t%360+360)%360}function HO(t){const e=BO.exec(t);let s=255,r;if(!e)return;e[5]!==r&&(s=e[6]?al(+e[5]):Ja(+e[5]));const a=$v(+e[2]),i=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?r=VO(a,i,l):e[1]==="hsv"?r=zO(a,i,l):r=Nu(a,i,l),{r:r[0],g:r[1],b:r[2],a:s}}function GO(t,e){var s=_u(t);s[0]=$v(s[0]+e),s=Nu(s),t.r=s[0],t.g=s[1],t.b=s[2]}function XO(t){if(!t)return;const e=_u(t),s=e[0],r=Om(e[1]),a=Om(e[2]);return t.a<255?`hsla(${s}, ${r}%, ${a}%, ${ya(t.a)})`:`hsl(${s}, ${r}%, ${a}%)`}const Dm={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Pm={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function qO(){const t={},e=Object.keys(Pm),s=Object.keys(Dm);let r,a,i,l,c;for(r=0;r<e.length;r++){for(l=c=e[r],a=0;a<s.length;a++)i=s[a],c=c.replace(i,Dm[i]);i=parseInt(Pm[l],16),t[c]=[i>>16&255,i>>8&255,i&255]}return t}let Tc;function YO(t){Tc||(Tc=qO(),Tc.transparent=[0,0,0,0]);const e=Tc[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const KO=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function JO(t){const e=KO.exec(t);let s=255,r,a,i;if(e){if(e[7]!==r){const l=+e[7];s=e[8]?al(l):Ga(l*255,0,255)}return r=+e[1],a=+e[3],i=+e[5],r=255&(e[2]?al(r):Ga(r,0,255)),a=255&(e[4]?al(a):Ga(a,0,255)),i=255&(e[6]?al(i):Ga(i,0,255)),{r,g:a,b:i,a:s}}}function ZO(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${ya(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const f0=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,ci=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function QO(t,e,s){const r=ci(ya(t.r)),a=ci(ya(t.g)),i=ci(ya(t.b));return{r:Ja(f0(r+s*(ci(ya(e.r))-r))),g:Ja(f0(a+s*(ci(ya(e.g))-a))),b:Ja(f0(i+s*(ci(ya(e.b))-i))),a:t.a+s*(e.a-t.a)}}function Cc(t,e,s){if(t){let r=_u(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*s,e===0?360:1)),r=Nu(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function Wv(t,e){return t&&Object.assign(e||{},t)}function Mm(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Ja(t[3]))):(e=Wv(t,{r:0,g:0,b:0,a:1}),e.a=Ja(e.a)),e}function e5(t){return t.charAt(0)==="r"?JO(t):HO(t)}class Bl{constructor(e){if(e instanceof Bl)return e;const s=typeof e;let r;s==="object"?r=Mm(e):s==="string"&&(r=RO(e)||YO(e)||e5(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=Wv(this._rgb);return e&&(e.a=ya(e.a)),e}set rgb(e){this._rgb=Mm(e)}rgbString(){return this._valid?ZO(this._rgb):void 0}hexString(){return this._valid?LO(this._rgb):void 0}hslString(){return this._valid?XO(this._rgb):void 0}mix(e,s){if(e){const r=this.rgb,a=e.rgb;let i;const l=s===i?.5:s,c=2*l-1,o=r.a-a.a,d=((c*o===-1?c:(c+o)/(1+c*o))+1)/2;i=1-d,r.r=255&d*r.r+i*a.r+.5,r.g=255&d*r.g+i*a.g+.5,r.b=255&d*r.b+i*a.b+.5,r.a=l*r.a+(1-l)*a.a,this.rgb=r}return this}interpolate(e,s){return e&&(this._rgb=QO(this._rgb,e._rgb,s)),this}clone(){return new Bl(this.rgb)}alpha(e){return this._rgb.a=Ja(e),this}clearer(e){const s=this._rgb;return s.a*=1-e,this}greyscale(){const e=this._rgb,s=dc(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=s,this}opaquer(e){const s=this._rgb;return s.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Cc(this._rgb,2,e),this}darken(e){return Cc(this._rgb,2,-e),this}saturate(e){return Cc(this._rgb,1,e),this}desaturate(e){return Cc(this._rgb,1,-e),this}rotate(e){return GO(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function pa(){}const t5=(()=>{let t=0;return()=>t++})();function ut(t){return t==null}function zt(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function ht(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function ks(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function or(t,e){return ks(t)?t:e}function nt(t,e){return typeof t>"u"?e:t}const s5=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,Vv=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function At(t,e,s){if(t&&typeof t.call=="function")return t.apply(s,e)}function jt(t,e,s,r){let a,i,l;if(zt(t))if(i=t.length,r)for(a=i-1;a>=0;a--)e.call(s,t[a],a);else for(a=0;a<i;a++)e.call(s,t[a],a);else if(ht(t))for(l=Object.keys(t),i=l.length,a=0;a<i;a++)e.call(s,t[l[a]],l[a])}function Ro(t,e){let s,r,a,i;if(!t||!e||t.length!==e.length)return!1;for(s=0,r=t.length;s<r;++s)if(a=t[s],i=e[s],a.datasetIndex!==i.datasetIndex||a.index!==i.index)return!1;return!0}function Io(t){if(zt(t))return t.map(Io);if(ht(t)){const e=Object.create(null),s=Object.keys(t),r=s.length;let a=0;for(;a<r;++a)e[s[a]]=Io(t[s[a]]);return e}return t}function zv(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function r5(t,e,s,r){if(!zv(t))return;const a=e[t],i=s[t];ht(a)&&ht(i)?Ul(a,i,r):e[t]=Io(i)}function Ul(t,e,s){const r=zt(e)?e:[e],a=r.length;if(!ht(t))return t;s=s||{};const i=s.merger||r5;let l;for(let c=0;c<a;++c){if(l=r[c],!ht(l))continue;const o=Object.keys(l);for(let d=0,f=o.length;d<f;++d)i(o[d],t,l,s)}return t}function bl(t,e){return Ul(t,e,{merger:a5})}function a5(t,e,s){if(!zv(t))return;const r=e[t],a=s[t];ht(r)&&ht(a)?bl(r,a):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Io(a))}const Rm={"":t=>t,x:t=>t.x,y:t=>t.y};function n5(t){const e=t.split("."),s=[];let r="";for(const a of e)r+=a,r.endsWith("\\")?r=r.slice(0,-1)+".":(s.push(r),r="");return s}function i5(t){const e=n5(t);return s=>{for(const r of e){if(r==="")break;s=s&&s[r]}return s}}function an(t,e){return(Rm[e]||(Rm[e]=i5(e)))(t)}function ju(t){return t.charAt(0).toUpperCase()+t.slice(1)}const $l=t=>typeof t<"u",nn=t=>typeof t=="function",Im=(t,e)=>{if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;return!0};function l5(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const pt=Math.PI,Ht=2*pt,c5=Ht+pt,Lo=Number.POSITIVE_INFINITY,o5=pt/180,as=pt/2,un=pt/4,Lm=pt*2/3,Xa=Math.log10,aa=Math.sign;function _l(t,e,s){return Math.abs(t-e)<s}function Bm(t){const e=Math.round(t);t=_l(t,e,t/1e3)?e:t;const s=Math.pow(10,Math.floor(Xa(t))),r=t/s;return(r<=1?1:r<=2?2:r<=5?5:10)*s}function d5(t){const e=[],s=Math.sqrt(t);let r;for(r=1;r<s;r++)t%r===0&&(e.push(r),e.push(t/r));return s===(s|0)&&e.push(s),e.sort((a,i)=>a-i).pop(),e}function f5(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Wl(t){return!f5(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function u5(t,e){const s=Math.round(t);return s-e<=t&&s+e>=t}function Hv(t,e,s){let r,a,i;for(r=0,a=t.length;r<a;r++)i=t[r][s],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function sa(t){return t*(pt/180)}function ku(t){return t*(180/pt)}function Um(t){if(!ks(t))return;let e=1,s=0;for(;Math.round(t*e)/e!==t;)e*=10,s++;return s}function Gv(t,e){const s=e.x-t.x,r=e.y-t.y,a=Math.sqrt(s*s+r*r);let i=Math.atan2(r,s);return i<-.5*pt&&(i+=Ht),{angle:i,distance:a}}function ef(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function h5(t,e){return(t-e+c5)%Ht-pt}function sr(t){return(t%Ht+Ht)%Ht}function Vl(t,e,s,r){const a=sr(t),i=sr(e),l=sr(s),c=sr(i-a),o=sr(l-a),d=sr(a-i),f=sr(a-l);return a===i||a===l||r&&i===l||c>o&&d<f}function Bs(t,e,s){return Math.max(e,Math.min(s,t))}function m5(t){return Bs(t,-32768,32767)}function qa(t,e,s,r=1e-6){return t>=Math.min(e,s)-r&&t<=Math.max(e,s)+r}function Su(t,e,s){s=s||(l=>t[l]<e);let r=t.length-1,a=0,i;for(;r-a>1;)i=a+r>>1,s(i)?a=i:r=i;return{lo:a,hi:r}}const jn=(t,e,s,r)=>Su(t,s,r?a=>{const i=t[a][e];return i<s||i===s&&t[a+1][e]===s}:a=>t[a][e]<s),x5=(t,e,s)=>Su(t,s,r=>t[r][e]>=s);function p5(t,e,s){let r=0,a=t.length;for(;r<a&&t[r]<e;)r++;for(;a>r&&t[a-1]>s;)a--;return r>0||a<t.length?t.slice(r,a):t}const Xv=["push","pop","shift","splice","unshift"];function g5(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Xv.forEach(s=>{const r="_onData"+ju(s),a=t[s];Object.defineProperty(t,s,{configurable:!0,enumerable:!1,value(...i){const l=a.apply(this,i);return t._chartjs.listeners.forEach(c=>{typeof c[r]=="function"&&c[r](...i)}),l}})})}function $m(t,e){const s=t._chartjs;if(!s)return;const r=s.listeners,a=r.indexOf(e);a!==-1&&r.splice(a,1),!(r.length>0)&&(Xv.forEach(i=>{delete t[i]}),delete t._chartjs)}function qv(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Yv=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function Kv(t,e){let s=[],r=!1;return function(...a){s=a,r||(r=!0,Yv.call(window,()=>{r=!1,t.apply(e,s)}))}}function v5(t,e){let s;return function(...r){return e?(clearTimeout(s),s=setTimeout(t,e,r)):t.apply(this,r),e}}const Eu=t=>t==="start"?"left":t==="end"?"right":"center",Os=(t,e,s)=>t==="start"?e:t==="end"?s:(e+s)/2,y5=(t,e,s,r)=>t===(r?"left":"right")?s:t==="center"?(e+s)/2:e;function b5(t,e,s){const r=e.length;let a=0,i=r;if(t._sorted){const{iScale:l,vScale:c,_parsed:o}=t,d=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,f=l.axis,{min:u,max:h,minDefined:x,maxDefined:m}=l.getUserBounds();if(x){if(a=Math.min(jn(o,f,u).lo,s?r:jn(e,f,l.getPixelForValue(u)).lo),d){const p=o.slice(0,a+1).reverse().findIndex(v=>!ut(v[c.axis]));a-=Math.max(0,p)}a=Bs(a,0,r-1)}if(m){let p=Math.max(jn(o,l.axis,h,!0).hi+1,s?0:jn(e,f,l.getPixelForValue(h),!0).hi+1);if(d){const v=o.slice(p-1).findIndex(b=>!ut(b[c.axis]));p+=Math.max(0,v)}i=Bs(p,a,r)-a}else i=r-a}return{start:a,count:i}}function _5(t){const{xScale:e,yScale:s,_scaleRanges:r}=t,a={xmin:e.min,xmax:e.max,ymin:s.min,ymax:s.max};if(!r)return t._scaleRanges=a,!0;const i=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==s.min||r.ymax!==s.max;return Object.assign(r,a),i}const Ac=t=>t===0||t===1,Wm=(t,e,s)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Ht/s)),Vm=(t,e,s)=>Math.pow(2,-10*t)*Math.sin((t-e)*Ht/s)+1,wl={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*as)+1,easeOutSine:t=>Math.sin(t*as),easeInOutSine:t=>-.5*(Math.cos(pt*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Ac(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Ac(t)?t:Wm(t,.075,.3),easeOutElastic:t=>Ac(t)?t:Vm(t,.075,.3),easeInOutElastic(t){return Ac(t)?t:t<.5?.5*Wm(t*2,.1125,.45):.5+.5*Vm(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-wl.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?wl.easeInBounce(t*2)*.5:wl.easeOutBounce(t*2-1)*.5+.5};function Tu(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function zm(t){return Tu(t)?t:new Bl(t)}function u0(t){return Tu(t)?t:new Bl(t).saturate(.5).darken(.1).hexString()}const w5=["x","y","borderWidth","radius","tension"],N5=["color","borderColor","backgroundColor"];function j5(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:N5},numbers:{type:"number",properties:w5}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function k5(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Hm=new Map;function S5(t,e){e=e||{};const s=t+JSON.stringify(e);let r=Hm.get(s);return r||(r=new Intl.NumberFormat(t,e),Hm.set(s,r)),r}function wd(t,e,s){return S5(e,s).format(t)}const Jv={values(t){return zt(t)?t:""+t},numeric(t,e,s){if(t===0)return"0";const r=this.chart.options.locale;let a,i=t;if(s.length>1){const d=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(d<1e-4||d>1e15)&&(a="scientific"),i=E5(t,s)}const l=Xa(Math.abs(i)),c=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),o={notation:a,minimumFractionDigits:c,maximumFractionDigits:c};return Object.assign(o,this.options.ticks.format),wd(t,r,o)},logarithmic(t,e,s){if(t===0)return"0";const r=s[e].significand||t/Math.pow(10,Math.floor(Xa(t)));return[1,2,3,5,10,15].includes(r)||e>.8*s.length?Jv.numeric.call(this,t,e,s):""}};function E5(t,e){let s=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(s)>=1&&t!==Math.floor(t)&&(s=t-Math.floor(t)),s}var Nd={formatters:Jv};function T5(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,s)=>s.lineWidth,tickColor:(e,s)=>s.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Nd.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Wn=Object.create(null),tf=Object.create(null);function Nl(t,e){if(!e)return t;const s=e.split(".");for(let r=0,a=s.length;r<a;++r){const i=s[r];t=t[i]||(t[i]=Object.create(null))}return t}function h0(t,e,s){return typeof e=="string"?Ul(Nl(t,e),s):Ul(Nl(t,""),e)}class C5{constructor(e,s){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,a)=>u0(a.backgroundColor),this.hoverBorderColor=(r,a)=>u0(a.borderColor),this.hoverColor=(r,a)=>u0(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(s)}set(e,s){return h0(this,e,s)}get(e){return Nl(this,e)}describe(e,s){return h0(tf,e,s)}override(e,s){return h0(Wn,e,s)}route(e,s,r,a){const i=Nl(this,e),l=Nl(this,r),c="_"+s;Object.defineProperties(i,{[c]:{value:i[s],writable:!0},[s]:{enumerable:!0,get(){const o=this[c],d=l[a];return ht(o)?Object.assign({},d,o):nt(o,d)},set(o){this[c]=o}}})}apply(e){e.forEach(s=>s(this))}}var Zt=new C5({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[j5,k5,T5]);function A5(t){return!t||ut(t.size)||ut(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Bo(t,e,s,r,a){let i=e[a];return i||(i=e[a]=t.measureText(a).width,s.push(a)),i>r&&(r=i),r}function F5(t,e,s,r){r=r||{};let a=r.data=r.data||{},i=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(a=r.data={},i=r.garbageCollect=[],r.font=e),t.save(),t.font=e;let l=0;const c=s.length;let o,d,f,u,h;for(o=0;o<c;o++)if(u=s[o],u!=null&&!zt(u))l=Bo(t,a,i,l,u);else if(zt(u))for(d=0,f=u.length;d<f;d++)h=u[d],h!=null&&!zt(h)&&(l=Bo(t,a,i,l,h));t.restore();const x=i.length/2;if(x>s.length){for(o=0;o<x;o++)delete a[i[o]];i.splice(0,x)}return l}function hn(t,e,s){const r=t.currentDevicePixelRatio,a=s!==0?Math.max(s/2,.5):0;return Math.round((e-a)*r)/r+a}function Gm(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function sf(t,e,s,r){Zv(t,e,s,r,null)}function Zv(t,e,s,r,a){let i,l,c,o,d,f,u,h;const x=e.pointStyle,m=e.rotation,p=e.radius;let v=(m||0)*o5;if(x&&typeof x=="object"&&(i=x.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(s,r),t.rotate(v),t.drawImage(x,-x.width/2,-x.height/2,x.width,x.height),t.restore();return}if(!(isNaN(p)||p<=0)){switch(t.beginPath(),x){default:a?t.ellipse(s,r,a/2,p,0,0,Ht):t.arc(s,r,p,0,Ht),t.closePath();break;case"triangle":f=a?a/2:p,t.moveTo(s+Math.sin(v)*f,r-Math.cos(v)*p),v+=Lm,t.lineTo(s+Math.sin(v)*f,r-Math.cos(v)*p),v+=Lm,t.lineTo(s+Math.sin(v)*f,r-Math.cos(v)*p),t.closePath();break;case"rectRounded":d=p*.516,o=p-d,l=Math.cos(v+un)*o,u=Math.cos(v+un)*(a?a/2-d:o),c=Math.sin(v+un)*o,h=Math.sin(v+un)*(a?a/2-d:o),t.arc(s-u,r-c,d,v-pt,v-as),t.arc(s+h,r-l,d,v-as,v),t.arc(s+u,r+c,d,v,v+as),t.arc(s-h,r+l,d,v+as,v+pt),t.closePath();break;case"rect":if(!m){o=Math.SQRT1_2*p,f=a?a/2:o,t.rect(s-f,r-o,2*f,2*o);break}v+=un;case"rectRot":u=Math.cos(v)*(a?a/2:p),l=Math.cos(v)*p,c=Math.sin(v)*p,h=Math.sin(v)*(a?a/2:p),t.moveTo(s-u,r-c),t.lineTo(s+h,r-l),t.lineTo(s+u,r+c),t.lineTo(s-h,r+l),t.closePath();break;case"crossRot":v+=un;case"cross":u=Math.cos(v)*(a?a/2:p),l=Math.cos(v)*p,c=Math.sin(v)*p,h=Math.sin(v)*(a?a/2:p),t.moveTo(s-u,r-c),t.lineTo(s+u,r+c),t.moveTo(s+h,r-l),t.lineTo(s-h,r+l);break;case"star":u=Math.cos(v)*(a?a/2:p),l=Math.cos(v)*p,c=Math.sin(v)*p,h=Math.sin(v)*(a?a/2:p),t.moveTo(s-u,r-c),t.lineTo(s+u,r+c),t.moveTo(s+h,r-l),t.lineTo(s-h,r+l),v+=un,u=Math.cos(v)*(a?a/2:p),l=Math.cos(v)*p,c=Math.sin(v)*p,h=Math.sin(v)*(a?a/2:p),t.moveTo(s-u,r-c),t.lineTo(s+u,r+c),t.moveTo(s+h,r-l),t.lineTo(s-h,r+l);break;case"line":l=a?a/2:Math.cos(v)*p,c=Math.sin(v)*p,t.moveTo(s-l,r-c),t.lineTo(s+l,r+c);break;case"dash":t.moveTo(s,r),t.lineTo(s+Math.cos(v)*(a?a/2:p),r+Math.sin(v)*p);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function wa(t,e,s){return s=s||.5,!e||t&&t.x>e.left-s&&t.x<e.right+s&&t.y>e.top-s&&t.y<e.bottom+s}function Cu(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Au(t){t.restore()}function O5(t,e,s,r,a){if(!e)return t.lineTo(s.x,s.y);if(a==="middle"){const i=(e.x+s.x)/2;t.lineTo(i,e.y),t.lineTo(i,s.y)}else a==="after"!=!!r?t.lineTo(e.x,s.y):t.lineTo(s.x,e.y);t.lineTo(s.x,s.y)}function D5(t,e,s,r){if(!e)return t.lineTo(s.x,s.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?s.cp2x:s.cp1x,r?s.cp2y:s.cp1y,s.x,s.y)}function P5(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),ut(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function M5(t,e,s,r,a){if(a.strikethrough||a.underline){const i=t.measureText(r),l=e-i.actualBoundingBoxLeft,c=e+i.actualBoundingBoxRight,o=s-i.actualBoundingBoxAscent,d=s+i.actualBoundingBoxDescent,f=a.strikethrough?(o+d)/2:d;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=a.decorationWidth||2,t.moveTo(l,f),t.lineTo(c,f),t.stroke()}}function R5(t,e){const s=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=s}function Vn(t,e,s,r,a,i={}){const l=zt(e)?e:[e],c=i.strokeWidth>0&&i.strokeColor!=="";let o,d;for(t.save(),t.font=a.string,P5(t,i),o=0;o<l.length;++o)d=l[o],i.backdrop&&R5(t,i.backdrop),c&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),ut(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(d,s,r,i.maxWidth)),t.fillText(d,s,r,i.maxWidth),M5(t,s,r,d,i),r+=Number(a.lineHeight);t.restore()}function zl(t,e){const{x:s,y:r,w:a,h:i,radius:l}=e;t.arc(s+l.topLeft,r+l.topLeft,l.topLeft,1.5*pt,pt,!0),t.lineTo(s,r+i-l.bottomLeft),t.arc(s+l.bottomLeft,r+i-l.bottomLeft,l.bottomLeft,pt,as,!0),t.lineTo(s+a-l.bottomRight,r+i),t.arc(s+a-l.bottomRight,r+i-l.bottomRight,l.bottomRight,as,0,!0),t.lineTo(s+a,r+l.topRight),t.arc(s+a-l.topRight,r+l.topRight,l.topRight,0,-as,!0),t.lineTo(s+l.topLeft,r)}const I5=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,L5=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function B5(t,e){const s=(""+t).match(I5);if(!s||s[1]==="normal")return e*1.2;switch(t=+s[2],s[3]){case"px":return t;case"%":t/=100;break}return e*t}const U5=t=>+t||0;function Fu(t,e){const s={},r=ht(e),a=r?Object.keys(e):e,i=ht(t)?r?l=>nt(t[l],t[e[l]]):l=>t[l]:()=>t;for(const l of a)s[l]=U5(i(l));return s}function Qv(t){return Fu(t,{top:"y",right:"x",bottom:"y",left:"x"})}function On(t){return Fu(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Ws(t){const e=Qv(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ps(t,e){t=t||{},e=e||Zt.font;let s=nt(t.size,e.size);typeof s=="string"&&(s=parseInt(s,10));let r=nt(t.style,e.style);r&&!(""+r).match(L5)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const a={family:nt(t.family,e.family),lineHeight:B5(nt(t.lineHeight,e.lineHeight),s),size:s,style:r,weight:nt(t.weight,e.weight),string:""};return a.string=A5(a),a}function Fc(t,e,s,r){let a=!0,i,l,c;for(i=0,l=t.length;i<l;++i)if(c=t[i],c!==void 0&&(e!==void 0&&typeof c=="function"&&(c=c(e),a=!1),s!==void 0&&zt(c)&&(c=c[s%c.length],a=!1),c!==void 0))return r&&!a&&(r.cacheable=!1),c}function $5(t,e,s){const{min:r,max:a}=t,i=Vv(e,(a-r)/2),l=(c,o)=>s&&c===0?0:c+o;return{min:l(r,-Math.abs(i)),max:l(a,i)}}function dn(t,e){return Object.assign(Object.create(t),e)}function Ou(t,e=[""],s,r,a=()=>t[0]){const i=s||t;typeof r>"u"&&(r=ry("_fallback",t));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:r,_getTarget:a,override:c=>Ou([c,...t],e,i,r)};return new Proxy(l,{deleteProperty(c,o){return delete c[o],delete c._keys,delete t[0][o],!0},get(c,o){return ty(c,o,()=>Y5(o,e,t,c))},getOwnPropertyDescriptor(c,o){return Reflect.getOwnPropertyDescriptor(c._scopes[0],o)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(c,o){return qm(c).includes(o)},ownKeys(c){return qm(c)},set(c,o,d){const f=c._storage||(c._storage=a());return c[o]=f[o]=d,delete c._keys,!0}})}function Ai(t,e,s,r){const a={_cacheable:!1,_proxy:t,_context:e,_subProxy:s,_stack:new Set,_descriptors:ey(t,r),setContext:i=>Ai(t,i,s,r),override:i=>Ai(t.override(i),e,s,r)};return new Proxy(a,{deleteProperty(i,l){return delete i[l],delete t[l],!0},get(i,l,c){return ty(i,l,()=>V5(i,l,c))},getOwnPropertyDescriptor(i,l){return i._descriptors.allKeys?Reflect.has(t,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,l)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,l){return Reflect.has(t,l)},ownKeys(){return Reflect.ownKeys(t)},set(i,l,c){return t[l]=c,delete i[l],!0}})}function ey(t,e={scriptable:!0,indexable:!0}){const{_scriptable:s=e.scriptable,_indexable:r=e.indexable,_allKeys:a=e.allKeys}=t;return{allKeys:a,scriptable:s,indexable:r,isScriptable:nn(s)?s:()=>s,isIndexable:nn(r)?r:()=>r}}const W5=(t,e)=>t?t+ju(e):e,Du=(t,e)=>ht(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function ty(t,e,s){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const r=s();return t[e]=r,r}function V5(t,e,s){const{_proxy:r,_context:a,_subProxy:i,_descriptors:l}=t;let c=r[e];return nn(c)&&l.isScriptable(e)&&(c=z5(e,c,t,s)),zt(c)&&c.length&&(c=H5(e,c,t,l.isIndexable)),Du(e,c)&&(c=Ai(c,a,i&&i[e],l)),c}function z5(t,e,s,r){const{_proxy:a,_context:i,_subProxy:l,_stack:c}=s;if(c.has(t))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+t);c.add(t);let o=e(i,l||r);return c.delete(t),Du(t,o)&&(o=Pu(a._scopes,a,t,o)),o}function H5(t,e,s,r){const{_proxy:a,_context:i,_subProxy:l,_descriptors:c}=s;if(typeof i.index<"u"&&r(t))return e[i.index%e.length];if(ht(e[0])){const o=e,d=a._scopes.filter(f=>f!==o);e=[];for(const f of o){const u=Pu(d,a,t,f);e.push(Ai(u,i,l&&l[t],c))}}return e}function sy(t,e,s){return nn(t)?t(e,s):t}const G5=(t,e)=>t===!0?e:typeof t=="string"?an(e,t):void 0;function X5(t,e,s,r,a){for(const i of e){const l=G5(s,i);if(l){t.add(l);const c=sy(l._fallback,s,a);if(typeof c<"u"&&c!==s&&c!==r)return c}else if(l===!1&&typeof r<"u"&&s!==r)return null}return!1}function Pu(t,e,s,r){const a=e._rootScopes,i=sy(e._fallback,s,r),l=[...t,...a],c=new Set;c.add(r);let o=Xm(c,l,s,i||s,r);return o===null||typeof i<"u"&&i!==s&&(o=Xm(c,l,i,o,r),o===null)?!1:Ou(Array.from(c),[""],a,i,()=>q5(e,s,r))}function Xm(t,e,s,r,a){for(;s;)s=X5(t,e,s,r,a);return s}function q5(t,e,s){const r=t._getTarget();e in r||(r[e]={});const a=r[e];return zt(a)&&ht(s)?s:a||{}}function Y5(t,e,s,r){let a;for(const i of e)if(a=ry(W5(i,t),s),typeof a<"u")return Du(t,a)?Pu(s,r,t,a):a}function ry(t,e){for(const s of e){if(!s)continue;const r=s[t];if(typeof r<"u")return r}}function qm(t){let e=t._keys;return e||(e=t._keys=K5(t._scopes)),e}function K5(t){const e=new Set;for(const s of t)for(const r of Object.keys(s).filter(a=>!a.startsWith("_")))e.add(r);return Array.from(e)}function J5(t,e,s,r){const{iScale:a}=t,{key:i="r"}=this._parsing,l=new Array(r);let c,o,d,f;for(c=0,o=r;c<o;++c)d=c+s,f=e[d],l[c]={r:a.parse(an(f,i),d)};return l}const Z5=Number.EPSILON||1e-14,Fi=(t,e)=>e<t.length&&!t[e].skip&&t[e],ay=t=>t==="x"?"y":"x";function Q5(t,e,s,r){const a=t.skip?e:t,i=e,l=s.skip?e:s,c=ef(i,a),o=ef(l,i);let d=c/(c+o),f=o/(c+o);d=isNaN(d)?0:d,f=isNaN(f)?0:f;const u=r*d,h=r*f;return{previous:{x:i.x-u*(l.x-a.x),y:i.y-u*(l.y-a.y)},next:{x:i.x+h*(l.x-a.x),y:i.y+h*(l.y-a.y)}}}function eD(t,e,s){const r=t.length;let a,i,l,c,o,d=Fi(t,0);for(let f=0;f<r-1;++f)if(o=d,d=Fi(t,f+1),!(!o||!d)){if(_l(e[f],0,Z5)){s[f]=s[f+1]=0;continue}a=s[f]/e[f],i=s[f+1]/e[f],c=Math.pow(a,2)+Math.pow(i,2),!(c<=9)&&(l=3/Math.sqrt(c),s[f]=a*l*e[f],s[f+1]=i*l*e[f])}}function tD(t,e,s="x"){const r=ay(s),a=t.length;let i,l,c,o=Fi(t,0);for(let d=0;d<a;++d){if(l=c,c=o,o=Fi(t,d+1),!c)continue;const f=c[s],u=c[r];l&&(i=(f-l[s])/3,c[`cp1${s}`]=f-i,c[`cp1${r}`]=u-i*e[d]),o&&(i=(o[s]-f)/3,c[`cp2${s}`]=f+i,c[`cp2${r}`]=u+i*e[d])}}function sD(t,e="x"){const s=ay(e),r=t.length,a=Array(r).fill(0),i=Array(r);let l,c,o,d=Fi(t,0);for(l=0;l<r;++l)if(c=o,o=d,d=Fi(t,l+1),!!o){if(d){const f=d[e]-o[e];a[l]=f!==0?(d[s]-o[s])/f:0}i[l]=c?d?aa(a[l-1])!==aa(a[l])?0:(a[l-1]+a[l])/2:a[l-1]:a[l]}eD(t,a,i),tD(t,i,e)}function Oc(t,e,s){return Math.max(Math.min(t,s),e)}function rD(t,e){let s,r,a,i,l,c=wa(t[0],e);for(s=0,r=t.length;s<r;++s)l=i,i=c,c=s<r-1&&wa(t[s+1],e),i&&(a=t[s],l&&(a.cp1x=Oc(a.cp1x,e.left,e.right),a.cp1y=Oc(a.cp1y,e.top,e.bottom)),c&&(a.cp2x=Oc(a.cp2x,e.left,e.right),a.cp2y=Oc(a.cp2y,e.top,e.bottom)))}function aD(t,e,s,r,a){let i,l,c,o;if(e.spanGaps&&(t=t.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")sD(t,a);else{let d=r?t[t.length-1]:t[0];for(i=0,l=t.length;i<l;++i)c=t[i],o=Q5(d,c,t[Math.min(i+1,l-(r?0:1))%l],e.tension),c.cp1x=o.previous.x,c.cp1y=o.previous.y,c.cp2x=o.next.x,c.cp2y=o.next.y,d=c}e.capBezierPoints&&rD(t,s)}function Mu(){return typeof window<"u"&&typeof document<"u"}function Ru(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Uo(t,e,s){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[s])):r=t,r}const jd=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function nD(t,e){return jd(t).getPropertyValue(e)}const iD=["top","right","bottom","left"];function Dn(t,e,s){const r={};s=s?"-"+s:"";for(let a=0;a<4;a++){const i=iD[a];r[i]=parseFloat(t[e+"-"+i+s])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const lD=(t,e,s)=>(t>0||e>0)&&(!s||!s.shadowRoot);function cD(t,e){const s=t.touches,r=s&&s.length?s[0]:t,{offsetX:a,offsetY:i}=r;let l=!1,c,o;if(lD(a,i,t.target))c=a,o=i;else{const d=e.getBoundingClientRect();c=r.clientX-d.left,o=r.clientY-d.top,l=!0}return{x:c,y:o,box:l}}function pn(t,e){if("native"in t)return t;const{canvas:s,currentDevicePixelRatio:r}=e,a=jd(s),i=a.boxSizing==="border-box",l=Dn(a,"padding"),c=Dn(a,"border","width"),{x:o,y:d,box:f}=cD(t,s),u=l.left+(f&&c.left),h=l.top+(f&&c.top);let{width:x,height:m}=e;return i&&(x-=l.width+c.width,m-=l.height+c.height),{x:Math.round((o-u)/x*s.width/r),y:Math.round((d-h)/m*s.height/r)}}function oD(t,e,s){let r,a;if(e===void 0||s===void 0){const i=t&&Ru(t);if(!i)e=t.clientWidth,s=t.clientHeight;else{const l=i.getBoundingClientRect(),c=jd(i),o=Dn(c,"border","width"),d=Dn(c,"padding");e=l.width-d.width-o.width,s=l.height-d.height-o.height,r=Uo(c.maxWidth,i,"clientWidth"),a=Uo(c.maxHeight,i,"clientHeight")}}return{width:e,height:s,maxWidth:r||Lo,maxHeight:a||Lo}}const Dc=t=>Math.round(t*10)/10;function dD(t,e,s,r){const a=jd(t),i=Dn(a,"margin"),l=Uo(a.maxWidth,t,"clientWidth")||Lo,c=Uo(a.maxHeight,t,"clientHeight")||Lo,o=oD(t,e,s);let{width:d,height:f}=o;if(a.boxSizing==="content-box"){const h=Dn(a,"border","width"),x=Dn(a,"padding");d-=x.width+h.width,f-=x.height+h.height}return d=Math.max(0,d-i.width),f=Math.max(0,r?d/r:f-i.height),d=Dc(Math.min(d,l,o.maxWidth)),f=Dc(Math.min(f,c,o.maxHeight)),d&&!f&&(f=Dc(d/2)),(e!==void 0||s!==void 0)&&r&&o.height&&f>o.height&&(f=o.height,d=Dc(Math.floor(f*r))),{width:d,height:f}}function Ym(t,e,s){const r=e||1,a=Math.floor(t.height*r),i=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const l=t.canvas;return l.style&&(s||!l.style.height&&!l.style.width)&&(l.style.height=`${t.height}px`,l.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||l.height!==a||l.width!==i?(t.currentDevicePixelRatio=r,l.height=a,l.width=i,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const fD=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Mu()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function Km(t,e){const s=nD(t,e),r=s&&s.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function gn(t,e,s,r){return{x:t.x+s*(e.x-t.x),y:t.y+s*(e.y-t.y)}}function uD(t,e,s,r){return{x:t.x+s*(e.x-t.x),y:r==="middle"?s<.5?t.y:e.y:r==="after"?s<1?t.y:e.y:s>0?e.y:t.y}}function hD(t,e,s,r){const a={x:t.cp2x,y:t.cp2y},i={x:e.cp1x,y:e.cp1y},l=gn(t,a,s),c=gn(a,i,s),o=gn(i,e,s),d=gn(l,c,s),f=gn(c,o,s);return gn(d,f,s)}const mD=function(t,e){return{x(s){return t+t+e-s},setWidth(s){e=s},textAlign(s){return s==="center"?s:s==="right"?"left":"right"},xPlus(s,r){return s-r},leftForLtr(s,r){return s-r}}},xD=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function ki(t,e,s){return t?mD(e,s):xD()}function ny(t,e){let s,r;(e==="ltr"||e==="rtl")&&(s=t.canvas.style,r=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",e,"important"),t.prevTextDirection=r)}function iy(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function ly(t){return t==="angle"?{between:Vl,compare:h5,normalize:sr}:{between:qa,compare:(e,s)=>e-s,normalize:e=>e}}function Jm({start:t,end:e,count:s,loop:r,style:a}){return{start:t%s,end:e%s,loop:r&&(e-t+1)%s===0,style:a}}function pD(t,e,s){const{property:r,start:a,end:i}=s,{between:l,normalize:c}=ly(r),o=e.length;let{start:d,end:f,loop:u}=t,h,x;if(u){for(d+=o,f+=o,h=0,x=o;h<x&&l(c(e[d%o][r]),a,i);++h)d--,f--;d%=o,f%=o}return f<d&&(f+=o),{start:d,end:f,loop:u,style:t.style}}function gD(t,e,s){if(!s)return[t];const{property:r,start:a,end:i}=s,l=e.length,{compare:c,between:o,normalize:d}=ly(r),{start:f,end:u,loop:h,style:x}=pD(t,e,s),m=[];let p=!1,v=null,b,_,g;const j=()=>o(a,g,b)&&c(a,g)!==0,w=()=>c(i,b)===0||o(i,g,b),k=()=>p||j(),y=()=>!p||w();for(let N=f,S=f;N<=u;++N)_=e[N%l],!_.skip&&(b=d(_[r]),b!==g&&(p=o(b,a,i),v===null&&k()&&(v=c(b,a)===0?N:S),v!==null&&y()&&(m.push(Jm({start:v,end:N,loop:h,count:l,style:x})),v=null),S=N,g=b));return v!==null&&m.push(Jm({start:v,end:u,loop:h,count:l,style:x})),m}function vD(t,e){const s=[],r=t.segments;for(let a=0;a<r.length;a++){const i=gD(r[a],t.points,e);i.length&&s.push(...i)}return s}function yD(t,e,s,r){let a=0,i=e-1;if(s&&!r)for(;a<e&&!t[a].skip;)a++;for(;a<e&&t[a].skip;)a++;for(a%=e,s&&(i+=a);i>a&&t[i%e].skip;)i--;return i%=e,{start:a,end:i}}function bD(t,e,s,r){const a=t.length,i=[];let l=e,c=t[e],o;for(o=e+1;o<=s;++o){const d=t[o%a];d.skip||d.stop?c.skip||(r=!1,i.push({start:e%a,end:(o-1)%a,loop:r}),e=l=d.stop?o:null):(l=o,c.skip&&(e=o)),c=d}return l!==null&&i.push({start:e%a,end:l%a,loop:r}),i}function _D(t,e){const s=t.points,r=t.options.spanGaps,a=s.length;if(!a)return[];const i=!!t._loop,{start:l,end:c}=yD(s,a,i,r);if(r===!0)return Zm(t,[{start:l,end:c,loop:i}],s,e);const o=c<l?c+a:c,d=!!t._fullLoop&&l===0&&c===a-1;return Zm(t,bD(s,l,o,d),s,e)}function Zm(t,e,s,r){return!r||!r.setContext||!s?e:wD(t,e,s,r)}function wD(t,e,s,r){const a=t._chart.getContext(),i=Qm(t.options),{_datasetIndex:l,options:{spanGaps:c}}=t,o=s.length,d=[];let f=i,u=e[0].start,h=u;function x(m,p,v,b){const _=c?-1:1;if(m!==p){for(m+=o;s[m%o].skip;)m-=_;for(;s[p%o].skip;)p+=_;m%o!==p%o&&(d.push({start:m%o,end:p%o,loop:v,style:b}),f=b,u=p%o)}}for(const m of e){u=c?u:m.start;let p=s[u%o],v;for(h=u+1;h<=m.end;h++){const b=s[h%o];v=Qm(r.setContext(dn(a,{type:"segment",p0:p,p1:b,p0DataIndex:(h-1)%o,p1DataIndex:h%o,datasetIndex:l}))),ND(v,f)&&x(u,h-1,m.loop,f),p=b,f=v}u<h-1&&x(u,h-1,m.loop,f)}return d}function Qm(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function ND(t,e){if(!e)return!1;const s=[],r=function(a,i){return Tu(i)?(s.includes(i)||s.push(i),s.indexOf(i)):i};return JSON.stringify(t,r)!==JSON.stringify(e,r)}function Pc(t,e,s){return t.options.clip?t[s]:e[s]}function jD(t,e){const{xScale:s,yScale:r}=t;return s&&r?{left:Pc(s,e,"left"),right:Pc(s,e,"right"),top:Pc(r,e,"top"),bottom:Pc(r,e,"bottom")}:e}function kD(t,e){const s=e._clip;if(s.disabled)return!1;const r=jD(e,t.chartArea);return{left:s.left===!1?0:r.left-(s.left===!0?0:s.left),right:s.right===!1?t.width:r.right+(s.right===!0?0:s.right),top:s.top===!1?0:r.top-(s.top===!0?0:s.top),bottom:s.bottom===!1?t.height:r.bottom+(s.bottom===!0?0:s.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class SD{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,s,r,a){const i=s.listeners[a],l=s.duration;i.forEach(c=>c({chart:e,initial:s.initial,numSteps:l,currentStep:Math.min(r-s.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=Yv.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let s=0;this._charts.forEach((r,a)=>{if(!r.running||!r.items.length)return;const i=r.items;let l=i.length-1,c=!1,o;for(;l>=0;--l)o=i[l],o._active?(o._total>r.duration&&(r.duration=o._total),o.tick(e),c=!0):(i[l]=i[i.length-1],i.pop());c&&(a.draw(),this._notify(a,r,e,"progress")),i.length||(r.running=!1,this._notify(a,r,e,"complete"),r.initial=!1),s+=i.length}),this._lastDate=e,s===0&&(this._running=!1)}_getAnims(e){const s=this._charts;let r=s.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},s.set(e,r)),r}listen(e,s,r){this._getAnims(e).listeners[s].push(r)}add(e,s){!s||!s.length||this._getAnims(e).items.push(...s)}has(e){return this._getAnims(e).items.length>0}start(e){const s=this._charts.get(e);s&&(s.running=!0,s.start=Date.now(),s.duration=s.items.reduce((r,a)=>Math.max(r,a._duration),0),this._refresh())}running(e){if(!this._running)return!1;const s=this._charts.get(e);return!(!s||!s.running||!s.items.length)}stop(e){const s=this._charts.get(e);if(!s||!s.items.length)return;const r=s.items;let a=r.length-1;for(;a>=0;--a)r[a].cancel();s.items=[],this._notify(e,s,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ga=new SD;const ex="transparent",ED={boolean(t,e,s){return s>.5?e:t},color(t,e,s){const r=zm(t||ex),a=r.valid&&zm(e||ex);return a&&a.valid?a.mix(r,s).hexString():e},number(t,e,s){return t+(e-t)*s}};class TD{constructor(e,s,r,a){const i=s[r];a=Fc([e.to,a,i,e.from]);const l=Fc([e.from,i,a]);this._active=!0,this._fn=e.fn||ED[e.type||typeof l],this._easing=wl[e.easing]||wl.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=s,this._prop=r,this._from=l,this._to=a,this._promises=void 0}active(){return this._active}update(e,s,r){if(this._active){this._notify(!1);const a=this._target[this._prop],i=r-this._start,l=this._duration-i;this._start=r,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Fc([e.to,s,a,e.from]),this._from=Fc([e.from,a,s])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const s=e-this._start,r=this._duration,a=this._prop,i=this._from,l=this._loop,c=this._to;let o;if(this._active=i!==c&&(l||s<r),!this._active){this._target[a]=c,this._notify(!0);return}if(s<0){this._target[a]=i;return}o=s/r%2,o=l&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[a]=this._fn(i,c,o)}wait(){const e=this._promises||(this._promises=[]);return new Promise((s,r)=>{e.push({res:s,rej:r})})}_notify(e){const s=e?"res":"rej",r=this._promises||[];for(let a=0;a<r.length;a++)r[a][s]()}}class cy{constructor(e,s){this._chart=e,this._properties=new Map,this.configure(s)}configure(e){if(!ht(e))return;const s=Object.keys(Zt.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(a=>{const i=e[a];if(!ht(i))return;const l={};for(const c of s)l[c]=i[c];(zt(i.properties)&&i.properties||[a]).forEach(c=>{(c===a||!r.has(c))&&r.set(c,l)})})}_animateOptions(e,s){const r=s.options,a=AD(e,r);if(!a)return[];const i=this._createAnimations(a,r);return r.$shared&&CD(e.options.$animations,r).then(()=>{e.options=r},()=>{}),i}_createAnimations(e,s){const r=this._properties,a=[],i=e.$animations||(e.$animations={}),l=Object.keys(s),c=Date.now();let o;for(o=l.length-1;o>=0;--o){const d=l[o];if(d.charAt(0)==="$")continue;if(d==="options"){a.push(...this._animateOptions(e,s));continue}const f=s[d];let u=i[d];const h=r.get(d);if(u)if(h&&u.active()){u.update(h,f,c);continue}else u.cancel();if(!h||!h.duration){e[d]=f;continue}i[d]=u=new TD(h,e,d,f),a.push(u)}return a}update(e,s){if(this._properties.size===0){Object.assign(e,s);return}const r=this._createAnimations(e,s);if(r.length)return ga.add(this._chart,r),!0}}function CD(t,e){const s=[],r=Object.keys(e);for(let a=0;a<r.length;a++){const i=t[r[a]];i&&i.active()&&s.push(i.wait())}return Promise.all(s)}function AD(t,e){if(!e)return;let s=t.options;if(!s){t.options=e;return}return s.$shared&&(t.options=s=Object.assign({},s,{$shared:!1,$animations:{}})),s}function tx(t,e){const s=t&&t.options||{},r=s.reverse,a=s.min===void 0?e:0,i=s.max===void 0?e:0;return{start:r?i:a,end:r?a:i}}function FD(t,e,s){if(s===!1)return!1;const r=tx(t,s),a=tx(e,s);return{top:a.end,right:r.end,bottom:a.start,left:r.start}}function OD(t){let e,s,r,a;return ht(t)?(e=t.top,s=t.right,r=t.bottom,a=t.left):e=s=r=a=t,{top:e,right:s,bottom:r,left:a,disabled:t===!1}}function oy(t,e){const s=[],r=t._getSortedDatasetMetas(e);let a,i;for(a=0,i=r.length;a<i;++a)s.push(r[a].index);return s}function sx(t,e,s,r={}){const a=t.keys,i=r.mode==="single";let l,c,o,d;if(e===null)return;let f=!1;for(l=0,c=a.length;l<c;++l){if(o=+a[l],o===s){if(f=!0,r.all)continue;break}d=t.values[o],ks(d)&&(i||e===0||aa(e)===aa(d))&&(e+=d)}return!f&&!r.all?0:e}function DD(t,e){const{iScale:s,vScale:r}=e,a=s.axis==="x"?"x":"y",i=r.axis==="x"?"x":"y",l=Object.keys(t),c=new Array(l.length);let o,d,f;for(o=0,d=l.length;o<d;++o)f=l[o],c[o]={[a]:f,[i]:t[f]};return c}function m0(t,e){const s=t&&t.options.stacked;return s||s===void 0&&e.stack!==void 0}function PD(t,e,s){return`${t.id}.${e.id}.${s.stack||s.type}`}function MD(t){const{min:e,max:s,minDefined:r,maxDefined:a}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:a?s:Number.POSITIVE_INFINITY}}function RD(t,e,s){const r=t[e]||(t[e]={});return r[s]||(r[s]={})}function rx(t,e,s,r){for(const a of e.getMatchingVisibleMetas(r).reverse()){const i=t[a.index];if(s&&i>0||!s&&i<0)return a.index}return null}function ax(t,e){const{chart:s,_cachedMeta:r}=t,a=s._stacks||(s._stacks={}),{iScale:i,vScale:l,index:c}=r,o=i.axis,d=l.axis,f=PD(i,l,r),u=e.length;let h;for(let x=0;x<u;++x){const m=e[x],{[o]:p,[d]:v}=m,b=m._stacks||(m._stacks={});h=b[d]=RD(a,f,p),h[c]=v,h._top=rx(h,l,!0,r.type),h._bottom=rx(h,l,!1,r.type);const _=h._visualValues||(h._visualValues={});_[c]=v}}function x0(t,e){const s=t.scales;return Object.keys(s).filter(r=>s[r].axis===e).shift()}function ID(t,e){return dn(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function LD(t,e,s){return dn(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:s,index:e,mode:"default",type:"data"})}function qi(t,e){const s=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const a of e){const i=a._stacks;if(!i||i[r]===void 0||i[r][s]===void 0)return;delete i[r][s],i[r]._visualValues!==void 0&&i[r]._visualValues[s]!==void 0&&delete i[r]._visualValues[s]}}}const p0=t=>t==="reset"||t==="none",nx=(t,e)=>e?t:Object.assign({},t),BD=(t,e,s)=>t&&!e.hidden&&e._stacked&&{keys:oy(s,!0),values:null};class Za{constructor(e,s){this.chart=e,this._ctx=e.ctx,this.index=s,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=m0(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&qi(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,s=this._cachedMeta,r=this.getDataset(),a=(u,h,x,m)=>u==="x"?h:u==="r"?m:x,i=s.xAxisID=nt(r.xAxisID,x0(e,"x")),l=s.yAxisID=nt(r.yAxisID,x0(e,"y")),c=s.rAxisID=nt(r.rAxisID,x0(e,"r")),o=s.indexAxis,d=s.iAxisID=a(o,i,l,c),f=s.vAxisID=a(o,l,i,c);s.xScale=this.getScaleForId(i),s.yScale=this.getScaleForId(l),s.rScale=this.getScaleForId(c),s.iScale=this.getScaleForId(d),s.vScale=this.getScaleForId(f)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const s=this._cachedMeta;return e===s.iScale?s.vScale:s.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&$m(this._data,this),e._stacked&&qi(e)}_dataCheck(){const e=this.getDataset(),s=e.data||(e.data=[]),r=this._data;if(ht(s)){const a=this._cachedMeta;this._data=DD(s,a)}else if(r!==s){if(r){$m(r,this);const a=this._cachedMeta;qi(a),a._parsed=[]}s&&Object.isExtensible(s)&&g5(s,this),this._syncList=[],this._data=s}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const s=this._cachedMeta,r=this.getDataset();let a=!1;this._dataCheck();const i=s._stacked;s._stacked=m0(s.vScale,s),s.stack!==r.stack&&(a=!0,qi(s),s.stack=r.stack),this._resyncElements(e),(a||i!==s._stacked)&&(ax(this,s._parsed),s._stacked=m0(s.vScale,s))}configure(){const e=this.chart.config,s=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),s,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,s){const{_cachedMeta:r,_data:a}=this,{iScale:i,_stacked:l}=r,c=i.axis;let o=e===0&&s===a.length?!0:r._sorted,d=e>0&&r._parsed[e-1],f,u,h;if(this._parsing===!1)r._parsed=a,r._sorted=!0,h=a;else{zt(a[e])?h=this.parseArrayData(r,a,e,s):ht(a[e])?h=this.parseObjectData(r,a,e,s):h=this.parsePrimitiveData(r,a,e,s);const x=()=>u[c]===null||d&&u[c]<d[c];for(f=0;f<s;++f)r._parsed[f+e]=u=h[f],o&&(x()&&(o=!1),d=u);r._sorted=o}l&&ax(this,h)}parsePrimitiveData(e,s,r,a){const{iScale:i,vScale:l}=e,c=i.axis,o=l.axis,d=i.getLabels(),f=i===l,u=new Array(a);let h,x,m;for(h=0,x=a;h<x;++h)m=h+r,u[h]={[c]:f||i.parse(d[m],m),[o]:l.parse(s[m],m)};return u}parseArrayData(e,s,r,a){const{xScale:i,yScale:l}=e,c=new Array(a);let o,d,f,u;for(o=0,d=a;o<d;++o)f=o+r,u=s[f],c[o]={x:i.parse(u[0],f),y:l.parse(u[1],f)};return c}parseObjectData(e,s,r,a){const{xScale:i,yScale:l}=e,{xAxisKey:c="x",yAxisKey:o="y"}=this._parsing,d=new Array(a);let f,u,h,x;for(f=0,u=a;f<u;++f)h=f+r,x=s[h],d[f]={x:i.parse(an(x,c),h),y:l.parse(an(x,o),h)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,s,r){const a=this.chart,i=this._cachedMeta,l=s[e.axis],c={keys:oy(a,!0),values:s._stacks[e.axis]._visualValues};return sx(c,l,i.index,{mode:r})}updateRangeFromParsed(e,s,r,a){const i=r[s.axis];let l=i===null?NaN:i;const c=a&&r._stacks[s.axis];a&&c&&(a.values=c,l=sx(a,i,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,s){const r=this._cachedMeta,a=r._parsed,i=r._sorted&&e===r.iScale,l=a.length,c=this._getOtherScale(e),o=BD(s,r,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:f,max:u}=MD(c);let h,x;function m(){x=a[h];const p=x[c.axis];return!ks(x[e.axis])||f>p||u<p}for(h=0;h<l&&!(!m()&&(this.updateRangeFromParsed(d,e,x,o),i));++h);if(i){for(h=l-1;h>=0;--h)if(!m()){this.updateRangeFromParsed(d,e,x,o);break}}return d}getAllParsedValues(e){const s=this._cachedMeta._parsed,r=[];let a,i,l;for(a=0,i=s.length;a<i;++a)l=s[a][e.axis],ks(l)&&r.push(l);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const s=this._cachedMeta,r=s.iScale,a=s.vScale,i=this.getParsed(e);return{label:r?""+r.getLabelForValue(i[r.axis]):"",value:a?""+a.getLabelForValue(i[a.axis]):""}}_update(e){const s=this._cachedMeta;this.update(e||"default"),s._clip=OD(nt(this.options.clip,FD(s.xScale,s.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,s=this.chart,r=this._cachedMeta,a=r.data||[],i=s.chartArea,l=[],c=this._drawStart||0,o=this._drawCount||a.length-c,d=this.options.drawActiveElementsOnTop;let f;for(r.dataset&&r.dataset.draw(e,i,c,o),f=c;f<c+o;++f){const u=a[f];u.hidden||(u.active&&d?l.push(u):u.draw(e,i))}for(f=0;f<l.length;++f)l[f].draw(e,i)}getStyle(e,s){const r=s?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,s,r){const a=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];i=l.$context||(l.$context=LD(this.getContext(),e,l)),i.parsed=this.getParsed(e),i.raw=a.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=ID(this.chart.getContext(),this.index)),i.dataset=a,i.index=i.datasetIndex=this.index;return i.active=!!s,i.mode=r,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,s){return this._resolveElementOptions(this.dataElementType.id,s,e)}_resolveElementOptions(e,s="default",r){const a=s==="active",i=this._cachedDataOpts,l=e+"-"+s,c=i[l],o=this.enableOptionSharing&&$l(r);if(c)return nx(c,o);const d=this.chart.config,f=d.datasetElementScopeKeys(this._type,e),u=a?[`${e}Hover`,"hover",e,""]:[e,""],h=d.getOptionScopes(this.getDataset(),f),x=Object.keys(Zt.elements[e]),m=()=>this.getContext(r,a,s),p=d.resolveNamedOptions(h,x,m,u);return p.$shared&&(p.$shared=o,i[l]=Object.freeze(nx(p,o))),p}_resolveAnimations(e,s,r){const a=this.chart,i=this._cachedDataOpts,l=`animation-${s}`,c=i[l];if(c)return c;let o;if(a.options.animation!==!1){const f=this.chart.config,u=f.datasetAnimationScopeKeys(this._type,s),h=f.getOptionScopes(this.getDataset(),u);o=f.createResolver(h,this.getContext(e,r,s))}const d=new cy(a,o&&o.animations);return o&&o._cacheable&&(i[l]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,s){return!s||p0(e)||this.chart._animationsDisabled}_getSharedOptions(e,s){const r=this.resolveDataElementOptions(e,s),a=this._sharedOptions,i=this.getSharedOptions(r),l=this.includeOptions(s,i)||i!==a;return this.updateSharedOptions(i,s,r),{sharedOptions:i,includeOptions:l}}updateElement(e,s,r,a){p0(a)?Object.assign(e,r):this._resolveAnimations(s,a).update(e,r)}updateSharedOptions(e,s,r){e&&!p0(s)&&this._resolveAnimations(void 0,s).update(e,r)}_setStyle(e,s,r,a){e.active=a;const i=this.getStyle(s,a);this._resolveAnimations(s,r,a).update(e,{options:!a&&this.getSharedOptions(i)||i})}removeHoverStyle(e,s,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,s,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const s=this._data,r=this._cachedMeta.data;for(const[c,o,d]of this._syncList)this[c](o,d);this._syncList=[];const a=r.length,i=s.length,l=Math.min(i,a);l&&this.parse(0,l),i>a?this._insertElements(a,i-a,e):i<a&&this._removeElements(i,a-i)}_insertElements(e,s,r=!0){const a=this._cachedMeta,i=a.data,l=e+s;let c;const o=d=>{for(d.length+=s,c=d.length-1;c>=l;c--)d[c]=d[c-s]};for(o(i),c=e;c<l;++c)i[c]=new this.dataElementType;this._parsing&&o(a._parsed),this.parse(e,s),r&&this.updateElements(i,e,s,"reset")}updateElements(e,s,r,a){}_removeElements(e,s){const r=this._cachedMeta;if(this._parsing){const a=r._parsed.splice(e,s);r._stacked&&qi(r,a)}r.data.splice(e,s)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[s,r,a]=e;this[s](r,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,s){s&&this._sync(["_removeElements",e,s]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Re(Za,"defaults",{}),Re(Za,"datasetElementType",null),Re(Za,"dataElementType",null);function UD(t,e){if(!t._cache.$bar){const s=t.getMatchingVisibleMetas(e);let r=[];for(let a=0,i=s.length;a<i;a++)r=r.concat(s[a].controller.getAllParsedValues(t));t._cache.$bar=qv(r.sort((a,i)=>a-i))}return t._cache.$bar}function $D(t){const e=t.iScale,s=UD(e,t.type);let r=e._length,a,i,l,c;const o=()=>{l===32767||l===-32768||($l(c)&&(r=Math.min(r,Math.abs(l-c)||r)),c=l)};for(a=0,i=s.length;a<i;++a)l=e.getPixelForValue(s[a]),o();for(c=void 0,a=0,i=e.ticks.length;a<i;++a)l=e.getPixelForTick(a),o();return r}function WD(t,e,s,r){const a=s.barThickness;let i,l;return ut(a)?(i=e.min*s.categoryPercentage,l=s.barPercentage):(i=a*r,l=1),{chunk:i/r,ratio:l,start:e.pixels[t]-i/2}}function VD(t,e,s,r){const a=e.pixels,i=a[t];let l=t>0?a[t-1]:null,c=t<a.length-1?a[t+1]:null;const o=s.categoryPercentage;l===null&&(l=i-(c===null?e.end-e.start:c-i)),c===null&&(c=i+i-l);const d=i-(i-Math.min(l,c))/2*o;return{chunk:Math.abs(c-l)/2*o/r,ratio:s.barPercentage,start:d}}function zD(t,e,s,r){const a=s.parse(t[0],r),i=s.parse(t[1],r),l=Math.min(a,i),c=Math.max(a,i);let o=l,d=c;Math.abs(l)>Math.abs(c)&&(o=c,d=l),e[s.axis]=d,e._custom={barStart:o,barEnd:d,start:a,end:i,min:l,max:c}}function dy(t,e,s,r){return zt(t)?zD(t,e,s,r):e[s.axis]=s.parse(t,r),e}function ix(t,e,s,r){const a=t.iScale,i=t.vScale,l=a.getLabels(),c=a===i,o=[];let d,f,u,h;for(d=s,f=s+r;d<f;++d)h=e[d],u={},u[a.axis]=c||a.parse(l[d],d),o.push(dy(h,u,i,d));return o}function g0(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function HD(t,e,s){return t!==0?aa(t):(e.isHorizontal()?1:-1)*(e.min>=s?1:-1)}function GD(t){let e,s,r,a,i;return t.horizontal?(e=t.base>t.x,s="left",r="right"):(e=t.base<t.y,s="bottom",r="top"),e?(a="end",i="start"):(a="start",i="end"),{start:s,end:r,reverse:e,top:a,bottom:i}}function XD(t,e,s,r){let a=e.borderSkipped;const i={};if(!a){t.borderSkipped=i;return}if(a===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:c,reverse:o,top:d,bottom:f}=GD(t);a==="middle"&&s&&(t.enableBorderRadius=!0,(s._top||0)===r?a=d:(s._bottom||0)===r?a=f:(i[lx(f,l,c,o)]=!0,a=d)),i[lx(a,l,c,o)]=!0,t.borderSkipped=i}function lx(t,e,s,r){return r?(t=qD(t,e,s),t=cx(t,s,e)):t=cx(t,e,s),t}function qD(t,e,s){return t===e?s:t===s?e:t}function cx(t,e,s){return t==="start"?e:t==="end"?s:t}function YD(t,{inflateAmount:e},s){t.inflateAmount=e==="auto"?s===1?.33:0:e}class to extends Za{parsePrimitiveData(e,s,r,a){return ix(e,s,r,a)}parseArrayData(e,s,r,a){return ix(e,s,r,a)}parseObjectData(e,s,r,a){const{iScale:i,vScale:l}=e,{xAxisKey:c="x",yAxisKey:o="y"}=this._parsing,d=i.axis==="x"?c:o,f=l.axis==="x"?c:o,u=[];let h,x,m,p;for(h=r,x=r+a;h<x;++h)p=s[h],m={},m[i.axis]=i.parse(an(p,d),h),u.push(dy(an(p,f),m,l,h));return u}updateRangeFromParsed(e,s,r,a){super.updateRangeFromParsed(e,s,r,a);const i=r._custom;i&&s===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const s=this._cachedMeta,{iScale:r,vScale:a}=s,i=this.getParsed(e),l=i._custom,c=g0(l)?"["+l.start+", "+l.end+"]":""+a.getLabelForValue(i[a.axis]);return{label:""+r.getLabelForValue(i[r.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const s=this._cachedMeta;this.updateElements(s.data,0,s.data.length,e)}updateElements(e,s,r,a){const i=a==="reset",{index:l,_cachedMeta:{vScale:c}}=this,o=c.getBasePixel(),d=c.isHorizontal(),f=this._getRuler(),{sharedOptions:u,includeOptions:h}=this._getSharedOptions(s,a);for(let x=s;x<s+r;x++){const m=this.getParsed(x),p=i||ut(m[c.axis])?{base:o,head:o}:this._calculateBarValuePixels(x),v=this._calculateBarIndexPixels(x,f),b=(m._stacks||{})[c.axis],_={horizontal:d,base:p.base,enableBorderRadius:!b||g0(m._custom)||l===b._top||l===b._bottom,x:d?p.head:v.center,y:d?v.center:p.head,height:d?v.size:Math.abs(p.size),width:d?Math.abs(p.size):v.size};h&&(_.options=u||this.resolveDataElementOptions(x,e[x].active?"active":a));const g=_.options||e[x].options;XD(_,g,b,l),YD(_,g,f.ratio),this.updateElement(e[x],x,_,a)}}_getStacks(e,s){const{iScale:r}=this._cachedMeta,a=r.getMatchingVisibleMetas(this._type).filter(f=>f.controller.options.grouped),i=r.options.stacked,l=[],c=this._cachedMeta.controller.getParsed(s),o=c&&c[r.axis],d=f=>{const u=f._parsed.find(x=>x[r.axis]===o),h=u&&u[f.vScale.axis];if(ut(h)||isNaN(h))return!0};for(const f of a)if(!(s!==void 0&&d(f))&&((i===!1||l.indexOf(f.stack)===-1||i===void 0&&f.stack===void 0)&&l.push(f.stack),f.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,s=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===s).shift()}_getAxis(){const e={},s=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[nt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,s)]=!0;return Object.keys(e)}_getStackIndex(e,s,r){const a=this._getStacks(e,r),i=s!==void 0?a.indexOf(s):-1;return i===-1?a.length-1:i}_getRuler(){const e=this.options,s=this._cachedMeta,r=s.iScale,a=[];let i,l;for(i=0,l=s.data.length;i<l;++i)a.push(r.getPixelForValue(this.getParsed(i)[r.axis],i));const c=e.barThickness;return{min:c||$D(s),pixels:a,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:c?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:s,_stacked:r,index:a},options:{base:i,minBarLength:l}}=this,c=i||0,o=this.getParsed(e),d=o._custom,f=g0(d);let u=o[s.axis],h=0,x=r?this.applyStack(s,o,r):u,m,p;x!==u&&(h=x-u,x=u),f&&(u=d.barStart,x=d.barEnd-d.barStart,u!==0&&aa(u)!==aa(d.barEnd)&&(h=0),h+=u);const v=!ut(i)&&!f?i:h;let b=s.getPixelForValue(v);if(this.chart.getDataVisibility(e)?m=s.getPixelForValue(h+x):m=b,p=m-b,Math.abs(p)<l){p=HD(p,s,c)*l,u===c&&(b-=p/2);const _=s.getPixelForDecimal(0),g=s.getPixelForDecimal(1),j=Math.min(_,g),w=Math.max(_,g);b=Math.max(Math.min(b,w),j),m=b+p,r&&!f&&(o._stacks[s.axis]._visualValues[a]=s.getValueForPixel(m)-s.getValueForPixel(b))}if(b===s.getPixelForValue(c)){const _=aa(p)*s.getLineWidthForValue(c)/2;b+=_,p-=_}return{size:p,base:b,head:m,center:m+p/2}}_calculateBarIndexPixels(e,s){const r=s.scale,a=this.options,i=a.skipNull,l=nt(a.maxBarThickness,1/0);let c,o;const d=this._getAxisCount();if(s.grouped){const f=i?this._getStackCount(e):s.stackCount,u=a.barThickness==="flex"?VD(e,s,a,f*d):WD(e,s,a,f*d),h=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,x=this._getAxis().indexOf(nt(h,this.getFirstScaleIdForIndexAxis())),m=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+x;c=u.start+u.chunk*m+u.chunk/2,o=Math.min(l,u.chunk*u.ratio)}else c=r.getPixelForValue(this.getParsed(e)[r.axis],e),o=Math.min(l,s.min*s.ratio);return{base:c-o/2,head:c+o/2,center:c,size:o}}draw(){const e=this._cachedMeta,s=e.vScale,r=e.data,a=r.length;let i=0;for(;i<a;++i)this.getParsed(i)[s.axis]!==null&&!r[i].hidden&&r[i].draw(this._ctx)}}Re(to,"id","bar"),Re(to,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Re(to,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function KD(t,e,s){let r=1,a=1,i=0,l=0;if(e<Ht){const c=t,o=c+e,d=Math.cos(c),f=Math.sin(c),u=Math.cos(o),h=Math.sin(o),x=(g,j,w)=>Vl(g,c,o,!0)?1:Math.max(j,j*s,w,w*s),m=(g,j,w)=>Vl(g,c,o,!0)?-1:Math.min(j,j*s,w,w*s),p=x(0,d,u),v=x(as,f,h),b=m(pt,d,u),_=m(pt+as,f,h);r=(p-b)/2,a=(v-_)/2,i=-(p+b)/2,l=-(v+_)/2}return{ratioX:r,ratioY:a,offsetX:i,offsetY:l}}class nl extends Za{constructor(e,s){super(e,s),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,s){const r=this.getDataset().data,a=this._cachedMeta;if(this._parsing===!1)a._parsed=r;else{let i=o=>+r[o];if(ht(r[e])){const{key:o="value"}=this._parsing;i=d=>+an(r[d],o)}let l,c;for(l=e,c=e+s;l<c;++l)a._parsed[l]=i(l)}}_getRotation(){return sa(this.options.rotation-90)}_getCircumference(){return sa(this.options.circumference)}_getRotationExtents(){let e=Ht,s=-Ht;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const a=this.chart.getDatasetMeta(r).controller,i=a._getRotation(),l=a._getCircumference();e=Math.min(e,i),s=Math.max(s,i+l)}return{rotation:e,circumference:s-e}}update(e){const s=this.chart,{chartArea:r}=s,a=this._cachedMeta,i=a.data,l=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,c=Math.max((Math.min(r.width,r.height)-l)/2,0),o=Math.min(s5(this.options.cutout,c),1),d=this._getRingWeight(this.index),{circumference:f,rotation:u}=this._getRotationExtents(),{ratioX:h,ratioY:x,offsetX:m,offsetY:p}=KD(u,f,o),v=(r.width-l)/h,b=(r.height-l)/x,_=Math.max(Math.min(v,b)/2,0),g=Vv(this.options.radius,_),j=Math.max(g*o,0),w=(g-j)/this._getVisibleDatasetWeightTotal();this.offsetX=m*g,this.offsetY=p*g,a.total=this.calculateTotal(),this.outerRadius=g-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*d,0),this.updateElements(i,0,i.length,e)}_circumference(e,s){const r=this.options,a=this._cachedMeta,i=this._getCircumference();return s&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||a._parsed[e]===null||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*i/Ht)}updateElements(e,s,r,a){const i=a==="reset",l=this.chart,c=l.chartArea,d=l.options.animation,f=(c.left+c.right)/2,u=(c.top+c.bottom)/2,h=i&&d.animateScale,x=h?0:this.innerRadius,m=h?0:this.outerRadius,{sharedOptions:p,includeOptions:v}=this._getSharedOptions(s,a);let b=this._getRotation(),_;for(_=0;_<s;++_)b+=this._circumference(_,i);for(_=s;_<s+r;++_){const g=this._circumference(_,i),j=e[_],w={x:f+this.offsetX,y:u+this.offsetY,startAngle:b,endAngle:b+g,circumference:g,outerRadius:m,innerRadius:x};v&&(w.options=p||this.resolveDataElementOptions(_,j.active?"active":a)),b+=g,this.updateElement(j,_,w,a)}}calculateTotal(){const e=this._cachedMeta,s=e.data;let r=0,a;for(a=0;a<s.length;a++){const i=e._parsed[a];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(a)&&!s[a].hidden&&(r+=Math.abs(i))}return r}calculateCircumference(e){const s=this._cachedMeta.total;return s>0&&!isNaN(e)?Ht*(Math.abs(e)/s):0}getLabelAndValue(e){const s=this._cachedMeta,r=this.chart,a=r.data.labels||[],i=wd(s._parsed[e],r.options.locale);return{label:a[e]||"",value:i}}getMaxBorderWidth(e){let s=0;const r=this.chart;let a,i,l,c,o;if(!e){for(a=0,i=r.data.datasets.length;a<i;++a)if(r.isDatasetVisible(a)){l=r.getDatasetMeta(a),e=l.data,c=l.controller;break}}if(!e)return 0;for(a=0,i=e.length;a<i;++a)o=c.resolveDataElementOptions(a),o.borderAlign!=="inner"&&(s=Math.max(s,o.borderWidth||0,o.hoverBorderWidth||0));return s}getMaxOffset(e){let s=0;for(let r=0,a=e.length;r<a;++r){const i=this.resolveDataElementOptions(r);s=Math.max(s,i.offset||0,i.hoverOffset||0)}return s}_getRingWeightOffset(e){let s=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(s+=this._getRingWeight(r));return s}_getRingWeight(e){return Math.max(nt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Re(nl,"id","doughnut"),Re(nl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Re(nl,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Re(nl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const s=e.data;if(s.labels.length&&s.datasets.length){const{labels:{pointStyle:r,color:a}}=e.legend.options;return s.labels.map((i,l)=>{const o=e.getDatasetMeta(0).controller.getStyle(l);return{text:i,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,fontColor:a,lineWidth:o.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(l),index:l}})}return[]}},onClick(e,s,r){r.chart.toggleDataVisibility(s.index),r.chart.update()}}}});class so extends Za{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const s=this._cachedMeta,{dataset:r,data:a=[],_dataset:i}=s,l=this.chart._animationsDisabled;let{start:c,count:o}=b5(s,a,l);this._drawStart=c,this._drawCount=o,_5(s)&&(c=0,o=a.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!i._decimated,r.points=a;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(r,void 0,{animated:!l,options:d},e),this.updateElements(a,c,o,e)}updateElements(e,s,r,a){const i=a==="reset",{iScale:l,vScale:c,_stacked:o,_dataset:d}=this._cachedMeta,{sharedOptions:f,includeOptions:u}=this._getSharedOptions(s,a),h=l.axis,x=c.axis,{spanGaps:m,segment:p}=this.options,v=Wl(m)?m:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||i||a==="none",_=s+r,g=e.length;let j=s>0&&this.getParsed(s-1);for(let w=0;w<g;++w){const k=e[w],y=b?k:{};if(w<s||w>=_){y.skip=!0;continue}const N=this.getParsed(w),S=ut(N[x]),T=y[h]=l.getPixelForValue(N[h],w),E=y[x]=i||S?c.getBasePixel():c.getPixelForValue(o?this.applyStack(c,N,o):N[x],w);y.skip=isNaN(T)||isNaN(E)||S,y.stop=w>0&&Math.abs(N[h]-j[h])>v,p&&(y.parsed=N,y.raw=d.data[w]),u&&(y.options=f||this.resolveDataElementOptions(w,k.active?"active":a)),b||this.updateElement(k,w,y,a),j=N}}getMaxOverflow(){const e=this._cachedMeta,s=e.dataset,r=s.options&&s.options.borderWidth||0,a=e.data||[];if(!a.length)return r;const i=a[0].size(this.resolveDataElementOptions(0)),l=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(r,i,l)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Re(so,"id","line"),Re(so,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Re(so,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class ro extends Za{getLabelAndValue(e){const s=this._cachedMeta.vScale,r=this.getParsed(e);return{label:s.getLabels()[e],value:""+s.getLabelForValue(r[s.axis])}}parseObjectData(e,s,r,a){return J5.bind(this)(e,s,r,a)}update(e){const s=this._cachedMeta,r=s.dataset,a=s.data||[],i=s.iScale.getLabels();if(r.points=a,e!=="resize"){const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0);const c={_loop:!0,_fullLoop:i.length===a.length,options:l};this.updateElement(r,void 0,c,e)}this.updateElements(a,0,a.length,e)}updateElements(e,s,r,a){const i=this._cachedMeta.rScale,l=a==="reset";for(let c=s;c<s+r;c++){const o=e[c],d=this.resolveDataElementOptions(c,o.active?"active":a),f=i.getPointPositionForValue(c,this.getParsed(c).r),u=l?i.xCenter:f.x,h=l?i.yCenter:f.y,x={x:u,y:h,angle:f.angle,skip:isNaN(u)||isNaN(h),options:d};this.updateElement(o,c,x,a)}}}Re(ro,"id","radar"),Re(ro,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Re(ro,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});function mn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Iu{constructor(e){Re(this,"options");this.options=e||{}}static override(e){Object.assign(Iu.prototype,e)}init(){}formats(){return mn()}parse(){return mn()}format(){return mn()}add(){return mn()}diff(){return mn()}startOf(){return mn()}endOf(){return mn()}}var JD={_date:Iu};function ZD(t,e,s,r){const{controller:a,data:i,_sorted:l}=t,c=a._cachedMeta.iScale,o=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(c&&e===c.axis&&e!=="r"&&l&&i.length){const d=c._reversePixels?x5:jn;if(r){if(a._sharedOptions){const f=i[0],u=typeof f.getRange=="function"&&f.getRange(e);if(u){const h=d(i,e,s-u),x=d(i,e,s+u);return{lo:h.lo,hi:x.hi}}}}else{const f=d(i,e,s);if(o){const{vScale:u}=a._cachedMeta,{_parsed:h}=t,x=h.slice(0,f.lo+1).reverse().findIndex(p=>!ut(p[u.axis]));f.lo-=Math.max(0,x);const m=h.slice(f.hi).findIndex(p=>!ut(p[u.axis]));f.hi+=Math.max(0,m)}return f}}return{lo:0,hi:i.length-1}}function fc(t,e,s,r,a){const i=t.getSortedVisibleDatasetMetas(),l=s[e];for(let c=0,o=i.length;c<o;++c){const{index:d,data:f}=i[c],{lo:u,hi:h}=ZD(i[c],e,l,a);for(let x=u;x<=h;++x){const m=f[x];m.skip||r(m,d,x)}}}function QD(t){const e=t.indexOf("x")!==-1,s=t.indexOf("y")!==-1;return function(r,a){const i=e?Math.abs(r.x-a.x):0,l=s?Math.abs(r.y-a.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(l,2))}}function v0(t,e,s,r,a){const i=[];return!a&&!t.isPointInArea(e)||fc(t,s,e,function(c,o,d){!a&&!wa(c,t.chartArea,0)||c.inRange(e.x,e.y,r)&&i.push({element:c,datasetIndex:o,index:d})},!0),i}function e8(t,e,s,r){let a=[];function i(l,c,o){const{startAngle:d,endAngle:f}=l.getProps(["startAngle","endAngle"],r),{angle:u}=Gv(l,{x:e.x,y:e.y});Vl(u,d,f)&&a.push({element:l,datasetIndex:c,index:o})}return fc(t,s,e,i),a}function t8(t,e,s,r,a,i){let l=[];const c=QD(s);let o=Number.POSITIVE_INFINITY;function d(f,u,h){const x=f.inRange(e.x,e.y,a);if(r&&!x)return;const m=f.getCenterPoint(a);if(!(!!i||t.isPointInArea(m))&&!x)return;const v=c(e,m);v<o?(l=[{element:f,datasetIndex:u,index:h}],o=v):v===o&&l.push({element:f,datasetIndex:u,index:h})}return fc(t,s,e,d),l}function y0(t,e,s,r,a,i){return!i&&!t.isPointInArea(e)?[]:s==="r"&&!r?e8(t,e,s,a):t8(t,e,s,r,a,i)}function ox(t,e,s,r,a){const i=[],l=s==="x"?"inXRange":"inYRange";let c=!1;return fc(t,s,e,(o,d,f)=>{o[l]&&o[l](e[s],a)&&(i.push({element:o,datasetIndex:d,index:f}),c=c||o.inRange(e.x,e.y,a))}),r&&!c?[]:i}var s8={evaluateInteractionItems:fc,modes:{index(t,e,s,r){const a=pn(e,t),i=s.axis||"x",l=s.includeInvisible||!1,c=s.intersect?v0(t,a,i,r,l):y0(t,a,i,!1,r,l),o=[];return c.length?(t.getSortedVisibleDatasetMetas().forEach(d=>{const f=c[0].index,u=d.data[f];u&&!u.skip&&o.push({element:u,datasetIndex:d.index,index:f})}),o):[]},dataset(t,e,s,r){const a=pn(e,t),i=s.axis||"xy",l=s.includeInvisible||!1;let c=s.intersect?v0(t,a,i,r,l):y0(t,a,i,!1,r,l);if(c.length>0){const o=c[0].datasetIndex,d=t.getDatasetMeta(o).data;c=[];for(let f=0;f<d.length;++f)c.push({element:d[f],datasetIndex:o,index:f})}return c},point(t,e,s,r){const a=pn(e,t),i=s.axis||"xy",l=s.includeInvisible||!1;return v0(t,a,i,r,l)},nearest(t,e,s,r){const a=pn(e,t),i=s.axis||"xy",l=s.includeInvisible||!1;return y0(t,a,i,s.intersect,r,l)},x(t,e,s,r){const a=pn(e,t);return ox(t,a,"x",s.intersect,r)},y(t,e,s,r){const a=pn(e,t);return ox(t,a,"y",s.intersect,r)}}};const fy=["left","top","right","bottom"];function Yi(t,e){return t.filter(s=>s.pos===e)}function dx(t,e){return t.filter(s=>fy.indexOf(s.pos)===-1&&s.box.axis===e)}function Ki(t,e){return t.sort((s,r)=>{const a=e?r:s,i=e?s:r;return a.weight===i.weight?a.index-i.index:a.weight-i.weight})}function r8(t){const e=[];let s,r,a,i,l,c;for(s=0,r=(t||[]).length;s<r;++s)a=t[s],{position:i,options:{stack:l,stackWeight:c=1}}=a,e.push({index:s,box:a,pos:i,horizontal:a.isHorizontal(),weight:a.weight,stack:l&&i+l,stackWeight:c});return e}function a8(t){const e={};for(const s of t){const{stack:r,pos:a,stackWeight:i}=s;if(!r||!fy.includes(a))continue;const l=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=i}return e}function n8(t,e){const s=a8(t),{vBoxMaxWidth:r,hBoxMaxHeight:a}=e;let i,l,c;for(i=0,l=t.length;i<l;++i){c=t[i];const{fullSize:o}=c.box,d=s[c.stack],f=d&&c.stackWeight/d.weight;c.horizontal?(c.width=f?f*r:o&&e.availableWidth,c.height=a):(c.width=r,c.height=f?f*a:o&&e.availableHeight)}return s}function i8(t){const e=r8(t),s=Ki(e.filter(d=>d.box.fullSize),!0),r=Ki(Yi(e,"left"),!0),a=Ki(Yi(e,"right")),i=Ki(Yi(e,"top"),!0),l=Ki(Yi(e,"bottom")),c=dx(e,"x"),o=dx(e,"y");return{fullSize:s,leftAndTop:r.concat(i),rightAndBottom:a.concat(o).concat(l).concat(c),chartArea:Yi(e,"chartArea"),vertical:r.concat(a).concat(o),horizontal:i.concat(l).concat(c)}}function fx(t,e,s,r){return Math.max(t[s],e[s])+Math.max(t[r],e[r])}function uy(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function l8(t,e,s,r){const{pos:a,box:i}=s,l=t.maxPadding;if(!ht(a)){s.size&&(t[a]-=s.size);const u=r[s.stack]||{size:0,count:1};u.size=Math.max(u.size,s.horizontal?i.height:i.width),s.size=u.size/u.count,t[a]+=s.size}i.getPadding&&uy(l,i.getPadding());const c=Math.max(0,e.outerWidth-fx(l,t,"left","right")),o=Math.max(0,e.outerHeight-fx(l,t,"top","bottom")),d=c!==t.w,f=o!==t.h;return t.w=c,t.h=o,s.horizontal?{same:d,other:f}:{same:f,other:d}}function c8(t){const e=t.maxPadding;function s(r){const a=Math.max(e[r]-t[r],0);return t[r]+=a,a}t.y+=s("top"),t.x+=s("left"),s("right"),s("bottom")}function o8(t,e){const s=e.maxPadding;function r(a){const i={left:0,top:0,right:0,bottom:0};return a.forEach(l=>{i[l]=Math.max(e[l],s[l])}),i}return r(t?["left","right"]:["top","bottom"])}function il(t,e,s,r){const a=[];let i,l,c,o,d,f;for(i=0,l=t.length,d=0;i<l;++i){c=t[i],o=c.box,o.update(c.width||e.w,c.height||e.h,o8(c.horizontal,e));const{same:u,other:h}=l8(e,s,c,r);d|=u&&a.length,f=f||h,o.fullSize||a.push(c)}return d&&il(a,e,s,r)||f}function Mc(t,e,s,r,a){t.top=s,t.left=e,t.right=e+r,t.bottom=s+a,t.width=r,t.height=a}function ux(t,e,s,r){const a=s.padding;let{x:i,y:l}=e;for(const c of t){const o=c.box,d=r[c.stack]||{count:1,placed:0,weight:1},f=c.stackWeight/d.weight||1;if(c.horizontal){const u=e.w*f,h=d.size||o.height;$l(d.start)&&(l=d.start),o.fullSize?Mc(o,a.left,l,s.outerWidth-a.right-a.left,h):Mc(o,e.left+d.placed,l,u,h),d.start=l,d.placed+=u,l=o.bottom}else{const u=e.h*f,h=d.size||o.width;$l(d.start)&&(i=d.start),o.fullSize?Mc(o,i,a.top,h,s.outerHeight-a.bottom-a.top):Mc(o,i,e.top+d.placed,h,u),d.start=i,d.placed+=u,i=o.right}}e.x=i,e.y=l}var jr={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(s){e.draw(s)}}]},t.boxes.push(e)},removeBox(t,e){const s=t.boxes?t.boxes.indexOf(e):-1;s!==-1&&t.boxes.splice(s,1)},configure(t,e,s){e.fullSize=s.fullSize,e.position=s.position,e.weight=s.weight},update(t,e,s,r){if(!t)return;const a=Ws(t.options.layout.padding),i=Math.max(e-a.width,0),l=Math.max(s-a.height,0),c=i8(t.boxes),o=c.vertical,d=c.horizontal;jt(t.boxes,p=>{typeof p.beforeLayout=="function"&&p.beforeLayout()});const f=o.reduce((p,v)=>v.box.options&&v.box.options.display===!1?p:p+1,0)||1,u=Object.freeze({outerWidth:e,outerHeight:s,padding:a,availableWidth:i,availableHeight:l,vBoxMaxWidth:i/2/f,hBoxMaxHeight:l/2}),h=Object.assign({},a);uy(h,Ws(r));const x=Object.assign({maxPadding:h,w:i,h:l,x:a.left,y:a.top},a),m=n8(o.concat(d),u);il(c.fullSize,x,u,m),il(o,x,u,m),il(d,x,u,m)&&il(o,x,u,m),c8(x),ux(c.leftAndTop,x,u,m),x.x+=x.w,x.y+=x.h,ux(c.rightAndBottom,x,u,m),t.chartArea={left:x.left,top:x.top,right:x.left+x.w,bottom:x.top+x.h,height:x.h,width:x.w},jt(c.chartArea,p=>{const v=p.box;Object.assign(v,t.chartArea),v.update(x.w,x.h,{left:0,top:0,right:0,bottom:0})})}};class hy{acquireContext(e,s){}releaseContext(e){return!1}addEventListener(e,s,r){}removeEventListener(e,s,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,s,r,a){return s=Math.max(0,s||e.width),r=r||e.height,{width:s,height:Math.max(0,a?Math.floor(s/a):r)}}isAttached(e){return!0}updateConfig(e){}}class d8 extends hy{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ao="$chartjs",f8={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},hx=t=>t===null||t==="";function u8(t,e){const s=t.style,r=t.getAttribute("height"),a=t.getAttribute("width");if(t[ao]={initial:{height:r,width:a,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",hx(a)){const i=Km(t,"width");i!==void 0&&(t.width=i)}if(hx(r))if(t.style.height==="")t.height=t.width/(e||2);else{const i=Km(t,"height");i!==void 0&&(t.height=i)}return t}const my=fD?{passive:!0}:!1;function h8(t,e,s){t&&t.addEventListener(e,s,my)}function m8(t,e,s){t&&t.canvas&&t.canvas.removeEventListener(e,s,my)}function x8(t,e){const s=f8[t.type]||t.type,{x:r,y:a}=pn(t,e);return{type:s,chart:e,native:t,x:r!==void 0?r:null,y:a!==void 0?a:null}}function $o(t,e){for(const s of t)if(s===e||s.contains(e))return!0}function p8(t,e,s){const r=t.canvas,a=new MutationObserver(i=>{let l=!1;for(const c of i)l=l||$o(c.addedNodes,r),l=l&&!$o(c.removedNodes,r);l&&s()});return a.observe(document,{childList:!0,subtree:!0}),a}function g8(t,e,s){const r=t.canvas,a=new MutationObserver(i=>{let l=!1;for(const c of i)l=l||$o(c.removedNodes,r),l=l&&!$o(c.addedNodes,r);l&&s()});return a.observe(document,{childList:!0,subtree:!0}),a}const Hl=new Map;let mx=0;function xy(){const t=window.devicePixelRatio;t!==mx&&(mx=t,Hl.forEach((e,s)=>{s.currentDevicePixelRatio!==t&&e()}))}function v8(t,e){Hl.size||window.addEventListener("resize",xy),Hl.set(t,e)}function y8(t){Hl.delete(t),Hl.size||window.removeEventListener("resize",xy)}function b8(t,e,s){const r=t.canvas,a=r&&Ru(r);if(!a)return;const i=Kv((c,o)=>{const d=a.clientWidth;s(c,o),d<a.clientWidth&&s()},window),l=new ResizeObserver(c=>{const o=c[0],d=o.contentRect.width,f=o.contentRect.height;d===0&&f===0||i(d,f)});return l.observe(a),v8(t,i),l}function b0(t,e,s){s&&s.disconnect(),e==="resize"&&y8(t)}function _8(t,e,s){const r=t.canvas,a=Kv(i=>{t.ctx!==null&&s(x8(i,t))},t);return h8(r,e,a),a}class w8 extends hy{acquireContext(e,s){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(u8(e,s),r):null}releaseContext(e){const s=e.canvas;if(!s[ao])return!1;const r=s[ao].initial;["height","width"].forEach(i=>{const l=r[i];ut(l)?s.removeAttribute(i):s.setAttribute(i,l)});const a=r.style||{};return Object.keys(a).forEach(i=>{s.style[i]=a[i]}),s.width=s.width,delete s[ao],!0}addEventListener(e,s,r){this.removeEventListener(e,s);const a=e.$proxies||(e.$proxies={}),l={attach:p8,detach:g8,resize:b8}[s]||_8;a[s]=l(e,s,r)}removeEventListener(e,s){const r=e.$proxies||(e.$proxies={}),a=r[s];if(!a)return;({attach:b0,detach:b0,resize:b0}[s]||m8)(e,s,a),r[s]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,s,r,a){return dD(e,s,r,a)}isAttached(e){const s=e&&Ru(e);return!!(s&&s.isConnected)}}function N8(t){return!Mu()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?d8:w8}class Wr{constructor(){Re(this,"x");Re(this,"y");Re(this,"active",!1);Re(this,"options");Re(this,"$animations")}tooltipPosition(e){const{x:s,y:r}=this.getProps(["x","y"],e);return{x:s,y:r}}hasValue(){return Wl(this.x)&&Wl(this.y)}getProps(e,s){const r=this.$animations;if(!s||!r)return this;const a={};return e.forEach(i=>{a[i]=r[i]&&r[i].active()?r[i]._to:this[i]}),a}}Re(Wr,"defaults",{}),Re(Wr,"defaultRoutes");function j8(t,e){const s=t.options.ticks,r=k8(t),a=Math.min(s.maxTicksLimit||r,r),i=s.major.enabled?E8(e):[],l=i.length,c=i[0],o=i[l-1],d=[];if(l>a)return T8(e,d,i,l/a),d;const f=S8(i,e,a);if(l>0){let u,h;const x=l>1?Math.round((o-c)/(l-1)):null;for(Rc(e,d,f,ut(x)?0:c-x,c),u=0,h=l-1;u<h;u++)Rc(e,d,f,i[u],i[u+1]);return Rc(e,d,f,o,ut(x)?e.length:o+x),d}return Rc(e,d,f),d}function k8(t){const e=t.options.offset,s=t._tickSize(),r=t._length/s+(e?0:1),a=t._maxLength/s;return Math.floor(Math.min(r,a))}function S8(t,e,s){const r=C8(t),a=e.length/s;if(!r)return Math.max(a,1);const i=d5(r);for(let l=0,c=i.length-1;l<c;l++){const o=i[l];if(o>a)return o}return Math.max(a,1)}function E8(t){const e=[];let s,r;for(s=0,r=t.length;s<r;s++)t[s].major&&e.push(s);return e}function T8(t,e,s,r){let a=0,i=s[0],l;for(r=Math.ceil(r),l=0;l<t.length;l++)l===i&&(e.push(t[l]),a++,i=s[a*r])}function Rc(t,e,s,r,a){const i=nt(r,0),l=Math.min(nt(a,t.length),t.length);let c=0,o,d,f;for(s=Math.ceil(s),a&&(o=a-r,s=o/Math.floor(o/s)),f=i;f<0;)c++,f=Math.round(i+c*s);for(d=Math.max(i,0);d<l;d++)d===f&&(e.push(t[d]),c++,f=Math.round(i+c*s))}function C8(t){const e=t.length;let s,r;if(e<2)return!1;for(r=t[0],s=1;s<e;++s)if(t[s]-t[s-1]!==r)return!1;return r}const A8=t=>t==="left"?"right":t==="right"?"left":t,xx=(t,e,s)=>e==="top"||e==="left"?t[e]+s:t[e]-s,px=(t,e)=>Math.min(e||t,t);function gx(t,e){const s=[],r=t.length/e,a=t.length;let i=0;for(;i<a;i+=r)s.push(t[Math.floor(i)]);return s}function F8(t,e,s){const r=t.ticks.length,a=Math.min(e,r-1),i=t._startPixel,l=t._endPixel,c=1e-6;let o=t.getPixelForTick(a),d;if(!(s&&(r===1?d=Math.max(o-i,l-o):e===0?d=(t.getPixelForTick(1)-o)/2:d=(o-t.getPixelForTick(a-1))/2,o+=a<e?d:-d,o<i-c||o>l+c)))return o}function O8(t,e){jt(t,s=>{const r=s.gc,a=r.length/2;let i;if(a>e){for(i=0;i<a;++i)delete s.data[r[i]];r.splice(0,a)}})}function Ji(t){return t.drawTicks?t.tickLength:0}function vx(t,e){if(!t.display)return 0;const s=ps(t.font,e),r=Ws(t.padding);return(zt(t.text)?t.text.length:1)*s.lineHeight+r.height}function D8(t,e){return dn(t,{scale:e,type:"scale"})}function P8(t,e,s){return dn(t,{tick:s,index:e,type:"tick"})}function M8(t,e,s){let r=Eu(t);return(s&&e!=="right"||!s&&e==="right")&&(r=A8(r)),r}function R8(t,e,s,r){const{top:a,left:i,bottom:l,right:c,chart:o}=t,{chartArea:d,scales:f}=o;let u=0,h,x,m;const p=l-a,v=c-i;if(t.isHorizontal()){if(x=Os(r,i,c),ht(s)){const b=Object.keys(s)[0],_=s[b];m=f[b].getPixelForValue(_)+p-e}else s==="center"?m=(d.bottom+d.top)/2+p-e:m=xx(t,s,e);h=c-i}else{if(ht(s)){const b=Object.keys(s)[0],_=s[b];x=f[b].getPixelForValue(_)-v+e}else s==="center"?x=(d.left+d.right)/2-v+e:x=xx(t,s,e);m=Os(r,l,a),u=s==="left"?-as:as}return{titleX:x,titleY:m,maxWidth:h,rotation:u}}class Qn extends Wr{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,s){return e}getUserBounds(){let{_userMin:e,_userMax:s,_suggestedMin:r,_suggestedMax:a}=this;return e=or(e,Number.POSITIVE_INFINITY),s=or(s,Number.NEGATIVE_INFINITY),r=or(r,Number.POSITIVE_INFINITY),a=or(a,Number.NEGATIVE_INFINITY),{min:or(e,r),max:or(s,a),minDefined:ks(e),maxDefined:ks(s)}}getMinMax(e){let{min:s,max:r,minDefined:a,maxDefined:i}=this.getUserBounds(),l;if(a&&i)return{min:s,max:r};const c=this.getMatchingVisibleMetas();for(let o=0,d=c.length;o<d;++o)l=c[o].controller.getMinMax(this,e),a||(s=Math.min(s,l.min)),i||(r=Math.max(r,l.max));return s=i&&s>r?r:s,r=a&&s>r?s:r,{min:or(s,or(r,s)),max:or(r,or(s,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){At(this.options.beforeUpdate,[this])}update(e,s,r){const{beginAtZero:a,grace:i,ticks:l}=this.options,c=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=s,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=$5(this,i,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=c<this.ticks.length;this._convertTicksToLabels(o?gx(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=j8(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,s,r;this.isHorizontal()?(s=this.left,r=this.right):(s=this.top,r=this.bottom,e=!e),this._startPixel=s,this._endPixel=r,this._reversePixels=e,this._length=r-s,this._alignToPixels=this.options.alignToPixels}afterUpdate(){At(this.options.afterUpdate,[this])}beforeSetDimensions(){At(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){At(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),At(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){At(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const s=this.options.ticks;let r,a,i;for(r=0,a=e.length;r<a;r++)i=e[r],i.label=At(s.callback,[i.value,r,e],this)}afterTickToLabelConversion(){At(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){At(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,s=e.ticks,r=px(this.ticks.length,e.ticks.maxTicksLimit),a=s.minRotation||0,i=s.maxRotation;let l=a,c,o,d;if(!this._isVisible()||!s.display||a>=i||r<=1||!this.isHorizontal()){this.labelRotation=a;return}const f=this._getLabelSizes(),u=f.widest.width,h=f.highest.height,x=Bs(this.chart.width-u,0,this.maxWidth);c=e.offset?this.maxWidth/r:x/(r-1),u+6>c&&(c=x/(r-(e.offset?.5:1)),o=this.maxHeight-Ji(e.grid)-s.padding-vx(e.title,this.chart.options.font),d=Math.sqrt(u*u+h*h),l=ku(Math.min(Math.asin(Bs((f.highest.height+6)/c,-1,1)),Math.asin(Bs(o/d,-1,1))-Math.asin(Bs(h/d,-1,1)))),l=Math.max(a,Math.min(i,l))),this.labelRotation=l}afterCalculateLabelRotation(){At(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){At(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:s,options:{ticks:r,title:a,grid:i}}=this,l=this._isVisible(),c=this.isHorizontal();if(l){const o=vx(a,s.options.font);if(c?(e.width=this.maxWidth,e.height=Ji(i)+o):(e.height=this.maxHeight,e.width=Ji(i)+o),r.display&&this.ticks.length){const{first:d,last:f,widest:u,highest:h}=this._getLabelSizes(),x=r.padding*2,m=sa(this.labelRotation),p=Math.cos(m),v=Math.sin(m);if(c){const b=r.mirror?0:v*u.width+p*h.height;e.height=Math.min(this.maxHeight,e.height+b+x)}else{const b=r.mirror?0:p*u.width+v*h.height;e.width=Math.min(this.maxWidth,e.width+b+x)}this._calculatePadding(d,f,v,p)}}this._handleMargins(),c?(this.width=this._length=s.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=s.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,s,r,a){const{ticks:{align:i,padding:l},position:c}=this.options,o=this.labelRotation!==0,d=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const f=this.getPixelForTick(0)-this.left,u=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,x=0;o?d?(h=a*e.width,x=r*s.height):(h=r*e.height,x=a*s.width):i==="start"?x=s.width:i==="end"?h=e.width:i!=="inner"&&(h=e.width/2,x=s.width/2),this.paddingLeft=Math.max((h-f+l)*this.width/(this.width-f),0),this.paddingRight=Math.max((x-u+l)*this.width/(this.width-u),0)}else{let f=s.height/2,u=e.height/2;i==="start"?(f=0,u=e.height):i==="end"&&(f=s.height,u=0),this.paddingTop=f+l,this.paddingBottom=u+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){At(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:s}=this.options;return s==="top"||s==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let s,r;for(s=0,r=e.length;s<r;s++)ut(e[s].label)&&(e.splice(s,1),r--,s--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const s=this.options.ticks.sampleSize;let r=this.ticks;s<r.length&&(r=gx(r,s)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,s,r){const{ctx:a,_longestTextCache:i}=this,l=[],c=[],o=Math.floor(s/px(s,r));let d=0,f=0,u,h,x,m,p,v,b,_,g,j,w;for(u=0;u<s;u+=o){if(m=e[u].label,p=this._resolveTickFontOptions(u),a.font=v=p.string,b=i[v]=i[v]||{data:{},gc:[]},_=p.lineHeight,g=j=0,!ut(m)&&!zt(m))g=Bo(a,b.data,b.gc,g,m),j=_;else if(zt(m))for(h=0,x=m.length;h<x;++h)w=m[h],!ut(w)&&!zt(w)&&(g=Bo(a,b.data,b.gc,g,w),j+=_);l.push(g),c.push(j),d=Math.max(g,d),f=Math.max(j,f)}O8(i,s);const k=l.indexOf(d),y=c.indexOf(f),N=S=>({width:l[S]||0,height:c[S]||0});return{first:N(0),last:N(s-1),widest:N(k),highest:N(y),widths:l,heights:c}}getLabelForValue(e){return e}getPixelForValue(e,s){return NaN}getValueForPixel(e){}getPixelForTick(e){const s=this.ticks;return e<0||e>s.length-1?null:this.getPixelForValue(s[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const s=this._startPixel+e*this._length;return m5(this._alignToPixels?hn(this.chart,s,0):s)}getDecimalForPixel(e){const s=(e-this._startPixel)/this._length;return this._reversePixels?1-s:s}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:s}=this;return e<0&&s<0?s:e>0&&s>0?e:0}getContext(e){const s=this.ticks||[];if(e>=0&&e<s.length){const r=s[e];return r.$context||(r.$context=P8(this.getContext(),e,r))}return this.$context||(this.$context=D8(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,s=sa(this.labelRotation),r=Math.abs(Math.cos(s)),a=Math.abs(Math.sin(s)),i=this._getLabelSizes(),l=e.autoSkipPadding||0,c=i?i.widest.width+l:0,o=i?i.highest.height+l:0;return this.isHorizontal()?o*r>c*a?c/r:o/a:o*a<c*r?o/r:c/a}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const s=this.axis,r=this.chart,a=this.options,{grid:i,position:l,border:c}=a,o=i.offset,d=this.isHorizontal(),u=this.ticks.length+(o?1:0),h=Ji(i),x=[],m=c.setContext(this.getContext()),p=m.display?m.width:0,v=p/2,b=function(P){return hn(r,P,p)};let _,g,j,w,k,y,N,S,T,E,A,H;if(l==="top")_=b(this.bottom),y=this.bottom-h,S=_-v,E=b(e.top)+v,H=e.bottom;else if(l==="bottom")_=b(this.top),E=e.top,H=b(e.bottom)-v,y=_+v,S=this.top+h;else if(l==="left")_=b(this.right),k=this.right-h,N=_-v,T=b(e.left)+v,A=e.right;else if(l==="right")_=b(this.left),T=e.left,A=b(e.right)-v,k=_+v,N=this.left+h;else if(s==="x"){if(l==="center")_=b((e.top+e.bottom)/2+.5);else if(ht(l)){const P=Object.keys(l)[0],J=l[P];_=b(this.chart.scales[P].getPixelForValue(J))}E=e.top,H=e.bottom,y=_+v,S=y+h}else if(s==="y"){if(l==="center")_=b((e.left+e.right)/2);else if(ht(l)){const P=Object.keys(l)[0],J=l[P];_=b(this.chart.scales[P].getPixelForValue(J))}k=_-v,N=k-h,T=e.left,A=e.right}const V=nt(a.ticks.maxTicksLimit,u),L=Math.max(1,Math.ceil(u/V));for(g=0;g<u;g+=L){const P=this.getContext(g),J=i.setContext(P),Ee=c.setContext(P),Y=J.lineWidth,de=J.color,De=Ee.dash||[],B=Ee.dashOffset,X=J.tickWidth,W=J.tickColor,z=J.tickBorderDash||[],ae=J.tickBorderDashOffset;j=F8(this,g,o),j!==void 0&&(w=hn(r,j,Y),d?k=N=T=A=w:y=S=E=H=w,x.push({tx1:k,ty1:y,tx2:N,ty2:S,x1:T,y1:E,x2:A,y2:H,width:Y,color:de,borderDash:De,borderDashOffset:B,tickWidth:X,tickColor:W,tickBorderDash:z,tickBorderDashOffset:ae}))}return this._ticksLength=u,this._borderValue=_,x}_computeLabelItems(e){const s=this.axis,r=this.options,{position:a,ticks:i}=r,l=this.isHorizontal(),c=this.ticks,{align:o,crossAlign:d,padding:f,mirror:u}=i,h=Ji(r.grid),x=h+f,m=u?-f:x,p=-sa(this.labelRotation),v=[];let b,_,g,j,w,k,y,N,S,T,E,A,H="middle";if(a==="top")k=this.bottom-m,y=this._getXAxisLabelAlignment();else if(a==="bottom")k=this.top+m,y=this._getXAxisLabelAlignment();else if(a==="left"){const L=this._getYAxisLabelAlignment(h);y=L.textAlign,w=L.x}else if(a==="right"){const L=this._getYAxisLabelAlignment(h);y=L.textAlign,w=L.x}else if(s==="x"){if(a==="center")k=(e.top+e.bottom)/2+x;else if(ht(a)){const L=Object.keys(a)[0],P=a[L];k=this.chart.scales[L].getPixelForValue(P)+x}y=this._getXAxisLabelAlignment()}else if(s==="y"){if(a==="center")w=(e.left+e.right)/2-x;else if(ht(a)){const L=Object.keys(a)[0],P=a[L];w=this.chart.scales[L].getPixelForValue(P)}y=this._getYAxisLabelAlignment(h).textAlign}s==="y"&&(o==="start"?H="top":o==="end"&&(H="bottom"));const V=this._getLabelSizes();for(b=0,_=c.length;b<_;++b){g=c[b],j=g.label;const L=i.setContext(this.getContext(b));N=this.getPixelForTick(b)+i.labelOffset,S=this._resolveTickFontOptions(b),T=S.lineHeight,E=zt(j)?j.length:1;const P=E/2,J=L.color,Ee=L.textStrokeColor,Y=L.textStrokeWidth;let de=y;l?(w=N,y==="inner"&&(b===_-1?de=this.options.reverse?"left":"right":b===0?de=this.options.reverse?"right":"left":de="center"),a==="top"?d==="near"||p!==0?A=-E*T+T/2:d==="center"?A=-V.highest.height/2-P*T+T:A=-V.highest.height+T/2:d==="near"||p!==0?A=T/2:d==="center"?A=V.highest.height/2-P*T:A=V.highest.height-E*T,u&&(A*=-1),p!==0&&!L.showLabelBackdrop&&(w+=T/2*Math.sin(p))):(k=N,A=(1-E)*T/2);let De;if(L.showLabelBackdrop){const B=Ws(L.backdropPadding),X=V.heights[b],W=V.widths[b];let z=A-B.top,ae=0-B.left;switch(H){case"middle":z-=X/2;break;case"bottom":z-=X;break}switch(y){case"center":ae-=W/2;break;case"right":ae-=W;break;case"inner":b===_-1?ae-=W:b>0&&(ae-=W/2);break}De={left:ae,top:z,width:W+B.width,height:X+B.height,color:L.backdropColor}}v.push({label:j,font:S,textOffset:A,options:{rotation:p,color:J,strokeColor:Ee,strokeWidth:Y,textAlign:de,textBaseline:H,translation:[w,k],backdrop:De}})}return v}_getXAxisLabelAlignment(){const{position:e,ticks:s}=this.options;if(-sa(this.labelRotation))return e==="top"?"left":"right";let a="center";return s.align==="start"?a="left":s.align==="end"?a="right":s.align==="inner"&&(a="inner"),a}_getYAxisLabelAlignment(e){const{position:s,ticks:{crossAlign:r,mirror:a,padding:i}}=this.options,l=this._getLabelSizes(),c=e+i,o=l.widest.width;let d,f;return s==="left"?a?(f=this.right+i,r==="near"?d="left":r==="center"?(d="center",f+=o/2):(d="right",f+=o)):(f=this.right-c,r==="near"?d="right":r==="center"?(d="center",f-=o/2):(d="left",f=this.left)):s==="right"?a?(f=this.left+i,r==="near"?d="right":r==="center"?(d="center",f-=o/2):(d="left",f-=o)):(f=this.left+c,r==="near"?d="left":r==="center"?(d="center",f+=o/2):(d="right",f=this.right)):d="right",{textAlign:d,x:f}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,s=this.options.position;if(s==="left"||s==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(s==="top"||s==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:s},left:r,top:a,width:i,height:l}=this;s&&(e.save(),e.fillStyle=s,e.fillRect(r,a,i,l),e.restore())}getLineWidthForValue(e){const s=this.options.grid;if(!this._isVisible()||!s.display)return 0;const a=this.ticks.findIndex(i=>i.value===e);return a>=0?s.setContext(this.getContext(a)).lineWidth:0}drawGrid(e){const s=this.options.grid,r=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,l;const c=(o,d,f)=>{!f.width||!f.color||(r.save(),r.lineWidth=f.width,r.strokeStyle=f.color,r.setLineDash(f.borderDash||[]),r.lineDashOffset=f.borderDashOffset,r.beginPath(),r.moveTo(o.x,o.y),r.lineTo(d.x,d.y),r.stroke(),r.restore())};if(s.display)for(i=0,l=a.length;i<l;++i){const o=a[i];s.drawOnChartArea&&c({x:o.x1,y:o.y1},{x:o.x2,y:o.y2},o),s.drawTicks&&c({x:o.tx1,y:o.ty1},{x:o.tx2,y:o.ty2},{color:o.tickColor,width:o.tickWidth,borderDash:o.tickBorderDash,borderDashOffset:o.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:s,options:{border:r,grid:a}}=this,i=r.setContext(this.getContext()),l=r.display?i.width:0;if(!l)return;const c=a.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let d,f,u,h;this.isHorizontal()?(d=hn(e,this.left,l)-l/2,f=hn(e,this.right,c)+c/2,u=h=o):(u=hn(e,this.top,l)-l/2,h=hn(e,this.bottom,c)+c/2,d=f=o),s.save(),s.lineWidth=i.width,s.strokeStyle=i.color,s.beginPath(),s.moveTo(d,u),s.lineTo(f,h),s.stroke(),s.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,a=this._computeLabelArea();a&&Cu(r,a);const i=this.getLabelItems(e);for(const l of i){const c=l.options,o=l.font,d=l.label,f=l.textOffset;Vn(r,d,0,f,o,c)}a&&Au(r)}drawTitle(){const{ctx:e,options:{position:s,title:r,reverse:a}}=this;if(!r.display)return;const i=ps(r.font),l=Ws(r.padding),c=r.align;let o=i.lineHeight/2;s==="bottom"||s==="center"||ht(s)?(o+=l.bottom,zt(r.text)&&(o+=i.lineHeight*(r.text.length-1))):o+=l.top;const{titleX:d,titleY:f,maxWidth:u,rotation:h}=R8(this,o,s,c);Vn(e,r.text,0,0,i,{color:r.color,maxWidth:u,rotation:h,textAlign:M8(c,s,a),textBaseline:"middle",translation:[d,f]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,s=e.ticks&&e.ticks.z||0,r=nt(e.grid&&e.grid.z,-1),a=nt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Qn.prototype.draw?[{z:s,draw:i=>{this.draw(i)}}]:[{z:r,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:s,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const s=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",a=[];let i,l;for(i=0,l=s.length;i<l;++i){const c=s[i];c[r]===this.id&&(!e||c.type===e)&&a.push(c)}return a}_resolveTickFontOptions(e){const s=this.options.ticks.setContext(this.getContext(e));return ps(s.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ic{constructor(e,s,r){this.type=e,this.scope=s,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const s=Object.getPrototypeOf(e);let r;B8(s)&&(r=this.register(s));const a=this.items,i=e.id,l=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in a||(a[i]=e,I8(e,l,r),this.override&&Zt.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const s=this.items,r=e.id,a=this.scope;r in s&&delete s[r],a&&r in Zt[a]&&(delete Zt[a][r],this.override&&delete Wn[r])}}function I8(t,e,s){const r=Ul(Object.create(null),[s?Zt.get(s):{},Zt.get(e),t.defaults]);Zt.set(e,r),t.defaultRoutes&&L8(e,t.defaultRoutes),t.descriptors&&Zt.describe(e,t.descriptors)}function L8(t,e){Object.keys(e).forEach(s=>{const r=s.split("."),a=r.pop(),i=[t].concat(r).join("."),l=e[s].split("."),c=l.pop(),o=l.join(".");Zt.route(i,a,o,c)})}function B8(t){return"id"in t&&"defaults"in t}class U8{constructor(){this.controllers=new Ic(Za,"datasets",!0),this.elements=new Ic(Wr,"elements"),this.plugins=new Ic(Object,"plugins"),this.scales=new Ic(Qn,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,s,r){[...s].forEach(a=>{const i=r||this._getRegistryForType(a);r||i.isForType(a)||i===this.plugins&&a.id?this._exec(e,i,a):jt(a,l=>{const c=r||this._getRegistryForType(l);this._exec(e,c,l)})})}_exec(e,s,r){const a=ju(e);At(r["before"+a],[],r),s[e](r),At(r["after"+a],[],r)}_getRegistryForType(e){for(let s=0;s<this._typedRegistries.length;s++){const r=this._typedRegistries[s];if(r.isForType(e))return r}return this.plugins}_get(e,s,r){const a=s.get(e);if(a===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return a}}var Kr=new U8;class $8{constructor(){this._init=[]}notify(e,s,r,a){s==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=a?this._descriptors(e).filter(a):this._descriptors(e),l=this._notify(i,e,s,r);return s==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),l}_notify(e,s,r,a){a=a||{};for(const i of e){const l=i.plugin,c=l[r],o=[s,a,i.options];if(At(c,o,l)===!1&&a.cancelable)return!1}return!0}invalidate(){ut(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const s=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),s}_createDescriptors(e,s){const r=e&&e.config,a=nt(r.options&&r.options.plugins,{}),i=W8(r);return a===!1&&!s?[]:z8(e,i,a,s)}_notifyStateChanges(e){const s=this._oldCache||[],r=this._cache,a=(i,l)=>i.filter(c=>!l.some(o=>c.plugin.id===o.plugin.id));this._notify(a(s,r),e,"stop"),this._notify(a(r,s),e,"start")}}function W8(t){const e={},s=[],r=Object.keys(Kr.plugins.items);for(let i=0;i<r.length;i++)s.push(Kr.getPlugin(r[i]));const a=t.plugins||[];for(let i=0;i<a.length;i++){const l=a[i];s.indexOf(l)===-1&&(s.push(l),e[l.id]=!0)}return{plugins:s,localIds:e}}function V8(t,e){return!e&&t===!1?null:t===!0?{}:t}function z8(t,{plugins:e,localIds:s},r,a){const i=[],l=t.getContext();for(const c of e){const o=c.id,d=V8(r[o],a);d!==null&&i.push({plugin:c,options:H8(t.config,{plugin:c,local:s[o]},d,l)})}return i}function H8(t,{plugin:e,local:s},r,a){const i=t.pluginScopeKeys(e),l=t.getOptionScopes(r,i);return s&&e.defaults&&l.push(e.defaults),t.createResolver(l,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function rf(t,e){const s=Zt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||s.indexAxis||"x"}function G8(t,e){let s=t;return t==="_index_"?s=e:t==="_value_"&&(s=e==="x"?"y":"x"),s}function X8(t,e){return t===e?"_index_":"_value_"}function yx(t){if(t==="x"||t==="y"||t==="r")return t}function q8(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function af(t,...e){if(yx(t))return t;for(const s of e){const r=s.axis||q8(s.position)||t.length>1&&yx(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function bx(t,e,s){if(s[e+"AxisID"]===t)return{axis:e}}function Y8(t,e){if(e.data&&e.data.datasets){const s=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(s.length)return bx(t,"x",s[0])||bx(t,"y",s[0])}return{}}function K8(t,e){const s=Wn[t.type]||{scales:{}},r=e.scales||{},a=rf(t.type,e),i=Object.create(null);return Object.keys(r).forEach(l=>{const c=r[l];if(!ht(c))return console.error(`Invalid scale configuration for scale: ${l}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const o=af(l,c,Y8(l,t),Zt.scales[c.type]),d=X8(o,a),f=s.scales||{};i[l]=bl(Object.create(null),[{axis:o},c,f[o],f[d]])}),t.data.datasets.forEach(l=>{const c=l.type||t.type,o=l.indexAxis||rf(c,e),f=(Wn[c]||{}).scales||{};Object.keys(f).forEach(u=>{const h=G8(u,o),x=l[h+"AxisID"]||h;i[x]=i[x]||Object.create(null),bl(i[x],[{axis:h},r[x],f[u]])})}),Object.keys(i).forEach(l=>{const c=i[l];bl(c,[Zt.scales[c.type],Zt.scale])}),i}function py(t){const e=t.options||(t.options={});e.plugins=nt(e.plugins,{}),e.scales=K8(t,e)}function gy(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function J8(t){return t=t||{},t.data=gy(t.data),py(t),t}const _x=new Map,vy=new Set;function Lc(t,e){let s=_x.get(t);return s||(s=e(),_x.set(t,s),vy.add(s)),s}const Zi=(t,e,s)=>{const r=an(e,s);r!==void 0&&t.add(r)};class Z8{constructor(e){this._config=J8(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=gy(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),py(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Lc(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,s){return Lc(`${e}.transition.${s}`,()=>[[`datasets.${e}.transitions.${s}`,`transitions.${s}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,s){return Lc(`${e}-${s}`,()=>[[`datasets.${e}.elements.${s}`,`datasets.${e}`,`elements.${s}`,""]])}pluginScopeKeys(e){const s=e.id,r=this.type;return Lc(`${r}-plugin-${s}`,()=>[[`plugins.${s}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,s){const r=this._scopeCache;let a=r.get(e);return(!a||s)&&(a=new Map,r.set(e,a)),a}getOptionScopes(e,s,r){const{options:a,type:i}=this,l=this._cachedScopes(e,r),c=l.get(s);if(c)return c;const o=new Set;s.forEach(f=>{e&&(o.add(e),f.forEach(u=>Zi(o,e,u))),f.forEach(u=>Zi(o,a,u)),f.forEach(u=>Zi(o,Wn[i]||{},u)),f.forEach(u=>Zi(o,Zt,u)),f.forEach(u=>Zi(o,tf,u))});const d=Array.from(o);return d.length===0&&d.push(Object.create(null)),vy.has(s)&&l.set(s,d),d}chartOptionScopes(){const{options:e,type:s}=this;return[e,Wn[s]||{},Zt.datasets[s]||{},{type:s},Zt,tf]}resolveNamedOptions(e,s,r,a=[""]){const i={$shared:!0},{resolver:l,subPrefixes:c}=wx(this._resolverCache,e,a);let o=l;if(eP(l,s)){i.$shared=!1,r=nn(r)?r():r;const d=this.createResolver(e,r,c);o=Ai(l,r,d)}for(const d of s)i[d]=o[d];return i}createResolver(e,s,r=[""],a){const{resolver:i}=wx(this._resolverCache,e,r);return ht(s)?Ai(i,s,void 0,a):i}}function wx(t,e,s){let r=t.get(e);r||(r=new Map,t.set(e,r));const a=s.join();let i=r.get(a);return i||(i={resolver:Ou(e,s),subPrefixes:s.filter(c=>!c.toLowerCase().includes("hover"))},r.set(a,i)),i}const Q8=t=>ht(t)&&Object.getOwnPropertyNames(t).some(e=>nn(t[e]));function eP(t,e){const{isScriptable:s,isIndexable:r}=ey(t);for(const a of e){const i=s(a),l=r(a),c=(l||i)&&t[a];if(i&&(nn(c)||Q8(c))||l&&zt(c))return!0}return!1}var tP="4.5.0";const sP=["top","bottom","left","right","chartArea"];function Nx(t,e){return t==="top"||t==="bottom"||sP.indexOf(t)===-1&&e==="x"}function jx(t,e){return function(s,r){return s[t]===r[t]?s[e]-r[e]:s[t]-r[t]}}function kx(t){const e=t.chart,s=e.options.animation;e.notifyPlugins("afterRender"),At(s&&s.onComplete,[t],e)}function rP(t){const e=t.chart,s=e.options.animation;At(s&&s.onProgress,[t],e)}function yy(t){return Mu()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const no={},Sx=t=>{const e=yy(t);return Object.values(no).filter(s=>s.canvas===e).pop()};function aP(t,e,s){const r=Object.keys(t);for(const a of r){const i=+a;if(i>=e){const l=t[a];delete t[a],(s>0||i>e)&&(t[i+s]=l)}}}function nP(t,e,s,r){return!s||t.type==="mouseout"?null:r?e:t}var Ua;let fa=(Ua=class{static register(...e){Kr.add(...e),Ex()}static unregister(...e){Kr.remove(...e),Ex()}constructor(e,s){const r=this.config=new Z8(s),a=yy(e),i=Sx(a);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const l=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||N8(a)),this.platform.updateConfig(r);const c=this.platform.acquireContext(a,l.aspectRatio),o=c&&c.canvas,d=o&&o.height,f=o&&o.width;if(this.id=t5(),this.ctx=c,this.canvas=o,this.width=f,this.height=d,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new $8,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=v5(u=>this.update(u),l.resizeDelay||0),this._dataChanges=[],no[this.id]=this,!c||!o){console.error("Failed to create chart: can't acquire context from the given item");return}ga.listen(this,"complete",kx),ga.listen(this,"progress",rP),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:s},width:r,height:a,_aspectRatio:i}=this;return ut(e)?s&&i?i:a?r/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Kr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Ym(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Gm(this.canvas,this.ctx),this}stop(){return ga.stop(this),this}resize(e,s){ga.running(this)?this._resizeBeforeDraw={width:e,height:s}:this._resize(e,s)}_resize(e,s){const r=this.options,a=this.canvas,i=r.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(a,e,s,i),c=r.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,Ym(this,c,!0)&&(this.notifyPlugins("resize",{size:l}),At(r.onResize,[this,l],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){const s=this.options.scales||{};jt(s,(r,a)=>{r.id=a})}buildOrUpdateScales(){const e=this.options,s=e.scales,r=this.scales,a=Object.keys(r).reduce((l,c)=>(l[c]=!1,l),{});let i=[];s&&(i=i.concat(Object.keys(s).map(l=>{const c=s[l],o=af(l,c),d=o==="r",f=o==="x";return{options:c,dposition:d?"chartArea":f?"bottom":"left",dtype:d?"radialLinear":f?"category":"linear"}}))),jt(i,l=>{const c=l.options,o=c.id,d=af(o,c),f=nt(c.type,l.dtype);(c.position===void 0||Nx(c.position,d)!==Nx(l.dposition))&&(c.position=l.dposition),a[o]=!0;let u=null;if(o in r&&r[o].type===f)u=r[o];else{const h=Kr.getScale(f);u=new h({id:o,type:f,ctx:this.ctx,chart:this}),r[u.id]=u}u.init(c,e)}),jt(a,(l,c)=>{l||delete r[c]}),jt(r,l=>{jr.configure(this,l,l.options),jr.addBox(this,l)})}_updateMetasets(){const e=this._metasets,s=this.data.datasets.length,r=e.length;if(e.sort((a,i)=>a.index-i.index),r>s){for(let a=s;a<r;++a)this._destroyDatasetMeta(a);e.splice(s,r-s)}this._sortedMetasets=e.slice(0).sort(jx("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:s}}=this;e.length>s.length&&delete this._stacks,e.forEach((r,a)=>{s.filter(i=>i===r._dataset).length===0&&this._destroyDatasetMeta(a)})}buildOrUpdateControllers(){const e=[],s=this.data.datasets;let r,a;for(this._removeUnreferencedMetasets(),r=0,a=s.length;r<a;r++){const i=s[r];let l=this.getDatasetMeta(r);const c=i.type||this.config.type;if(l.type&&l.type!==c&&(this._destroyDatasetMeta(r),l=this.getDatasetMeta(r)),l.type=c,l.indexAxis=i.indexAxis||rf(c,this.options),l.order=i.order||0,l.index=r,l.label=""+i.label,l.visible=this.isDatasetVisible(r),l.controller)l.controller.updateIndex(r),l.controller.linkScales();else{const o=Kr.getController(c),{datasetElementType:d,dataElementType:f}=Zt.datasets[c];Object.assign(o,{dataElementType:Kr.getElement(f),datasetElementType:d&&Kr.getElement(d)}),l.controller=new o(this,r),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){jt(this.data.datasets,(e,s)=>{this.getDatasetMeta(s).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const s=this.config;s.update();const r=this._options=s.createResolver(s.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let d=0,f=this.data.datasets.length;d<f;d++){const{controller:u}=this.getDatasetMeta(d),h=!a&&i.indexOf(u)===-1;u.buildOrUpdateElements(h),l=Math.max(+u.getMaxOverflow(),l)}l=this._minPadding=r.layout.autoPadding?l:0,this._updateLayout(l),a||jt(i,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(jx("z","_idx"));const{_active:c,_lastEvent:o}=this;o?this._eventHandler(o,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){jt(this.scales,e=>{jr.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,s=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!Im(s,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,s=this._getUniformDataChanges()||[];for(const{method:r,start:a,count:i}of s){const l=r==="_removeElements"?-i:i;aP(e,a,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const s=this.data.datasets.length,r=i=>new Set(e.filter(l=>l[0]===i).map((l,c)=>c+","+l.splice(1).join(","))),a=r(0);for(let i=1;i<s;i++)if(!Im(a,r(i)))return;return Array.from(a).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;jr.update(this,this.width,this.height,e);const s=this.chartArea,r=s.width<=0||s.height<=0;this._layers=[],jt(this.boxes,a=>{r&&a.position==="chartArea"||(a.configure&&a.configure(),this._layers.push(...a._layers()))},this),this._layers.forEach((a,i)=>{a._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let s=0,r=this.data.datasets.length;s<r;++s)this.getDatasetMeta(s).controller.configure();for(let s=0,r=this.data.datasets.length;s<r;++s)this._updateDataset(s,nn(e)?e({datasetIndex:s}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,s){const r=this.getDatasetMeta(e),a={meta:r,index:e,mode:s,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",a)!==!1&&(r.controller._update(s),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ga.has(this)?this.attached&&!ga.running(this)&&ga.start(this):(this.draw(),kx({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:a}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,a)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const s=this._layers;for(e=0;e<s.length&&s[e].z<=0;++e)s[e].draw(this.chartArea);for(this._drawDatasets();e<s.length;++e)s[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const s=this._sortedMetasets,r=[];let a,i;for(a=0,i=s.length;a<i;++a){const l=s[a];(!e||l.visible)&&r.push(l)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let s=e.length-1;s>=0;--s)this._drawDataset(e[s]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const s=this.ctx,r={meta:e,index:e.index,cancelable:!0},a=kD(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(a&&Cu(s,a),e.controller.draw(),a&&Au(s),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return wa(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,s,r,a){const i=s8.modes[s];return typeof i=="function"?i(this,e,r,a):[]}getDatasetMeta(e){const s=this.data.datasets[e],r=this._metasets;let a=r.filter(i=>i&&i._dataset===s).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:s&&s.order||0,index:e,_dataset:s,_parsed:[],_sorted:!1},r.push(a)),a}getContext(){return this.$context||(this.$context=dn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const s=this.data.datasets[e];if(!s)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!s.hidden}setDatasetVisibility(e,s){const r=this.getDatasetMeta(e);r.hidden=!s}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,s,r){const a=r?"show":"hide",i=this.getDatasetMeta(e),l=i.controller._resolveAnimations(void 0,a);$l(s)?(i.data[s].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),l.update(i,{visible:r}),this.update(c=>c.datasetIndex===e?a:void 0))}hide(e,s){this._updateVisibility(e,s,!1)}show(e,s){this._updateVisibility(e,s,!0)}_destroyDatasetMeta(e){const s=this._metasets[e];s&&s.controller&&s.controller._destroy(),delete this._metasets[e]}_stop(){let e,s;for(this.stop(),ga.remove(this),e=0,s=this.data.datasets.length;e<s;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:s}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Gm(e,s),this.platform.releaseContext(s),this.canvas=null,this.ctx=null),delete no[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,s=this.platform,r=(i,l)=>{s.addEventListener(this,i,l),e[i]=l},a=(i,l,c)=>{i.offsetX=l,i.offsetY=c,this._eventHandler(i)};jt(this.options.events,i=>r(i,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,s=this.platform,r=(o,d)=>{s.addEventListener(this,o,d),e[o]=d},a=(o,d)=>{e[o]&&(s.removeEventListener(this,o,d),delete e[o])},i=(o,d)=>{this.canvas&&this.resize(o,d)};let l;const c=()=>{a("attach",c),this.attached=!0,this.resize(),r("resize",i),r("detach",l)};l=()=>{this.attached=!1,a("resize",i),this._stop(),this._resize(0,0),r("attach",c)},s.isAttached(this.canvas)?c():l()}unbindEvents(){jt(this._listeners,(e,s)=>{this.platform.removeEventListener(this,s,e)}),this._listeners={},jt(this._responsiveListeners,(e,s)=>{this.platform.removeEventListener(this,s,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,s,r){const a=r?"set":"remove";let i,l,c,o;for(s==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+a+"DatasetHoverStyle"]()),c=0,o=e.length;c<o;++c){l=e[c];const d=l&&this.getDatasetMeta(l.datasetIndex).controller;d&&d[a+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const s=this._active||[],r=e.map(({datasetIndex:i,index:l})=>{const c=this.getDatasetMeta(i);if(!c)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:c.data[l],index:l}});!Ro(r,s)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,s))}notifyPlugins(e,s,r){return this._plugins.notify(this,e,s,r)}isPluginEnabled(e){return this._plugins._cache.filter(s=>s.plugin.id===e).length===1}_updateHoverStyles(e,s,r){const a=this.options.hover,i=(o,d)=>o.filter(f=>!d.some(u=>f.datasetIndex===u.datasetIndex&&f.index===u.index)),l=i(s,e),c=r?e:i(e,s);l.length&&this.updateHoverStyle(l,a.mode,!1),c.length&&a.mode&&this.updateHoverStyle(c,a.mode,!0)}_eventHandler(e,s){const r={event:e,replay:s,cancelable:!0,inChartArea:this.isPointInArea(e)},a=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,a)===!1)return;const i=this._handleEvent(e,s,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,a),(i||r.changed)&&this.render(),this}_handleEvent(e,s,r){const{_active:a=[],options:i}=this,l=s,c=this._getActiveElements(e,a,r,l),o=l5(e),d=nP(e,this._lastEvent,r,o);r&&(this._lastEvent=null,At(i.onHover,[e,c,this],this),o&&At(i.onClick,[e,c,this],this));const f=!Ro(c,a);return(f||s)&&(this._active=c,this._updateHoverStyles(c,a,s)),this._lastEvent=d,f}_getActiveElements(e,s,r,a){if(e.type==="mouseout")return[];if(!r)return s;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,a)}},Re(Ua,"defaults",Zt),Re(Ua,"instances",no),Re(Ua,"overrides",Wn),Re(Ua,"registry",Kr),Re(Ua,"version",tP),Re(Ua,"getChart",Sx),Ua);function Ex(){return jt(fa.instances,t=>t._plugins.invalidate())}function iP(t,e,s){const{startAngle:r,x:a,y:i,outerRadius:l,innerRadius:c,options:o}=e,{borderWidth:d,borderJoinStyle:f}=o,u=Math.min(d/l,sr(r-s));if(t.beginPath(),t.arc(a,i,l-d/2,r+u/2,s-u/2),c>0){const h=Math.min(d/c,sr(r-s));t.arc(a,i,c+d/2,s-h/2,r+h/2,!0)}else{const h=Math.min(d/2,l*sr(r-s));if(f==="round")t.arc(a,i,h,s-pt/2,r+pt/2,!0);else if(f==="bevel"){const x=2*h*h,m=-x*Math.cos(s+pt/2)+a,p=-x*Math.sin(s+pt/2)+i,v=x*Math.cos(r+pt/2)+a,b=x*Math.sin(r+pt/2)+i;t.lineTo(m,p),t.lineTo(v,b)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function lP(t,e,s){const{startAngle:r,pixelMargin:a,x:i,y:l,outerRadius:c,innerRadius:o}=e;let d=a/c;t.beginPath(),t.arc(i,l,c,r-d,s+d),o>a?(d=a/o,t.arc(i,l,o,s+d,r-d,!0)):t.arc(i,l,a,s+as,r-as),t.closePath(),t.clip()}function cP(t){return Fu(t,["outerStart","outerEnd","innerStart","innerEnd"])}function oP(t,e,s,r){const a=cP(t.options.borderRadius),i=(s-e)/2,l=Math.min(i,r*e/2),c=o=>{const d=(s-Math.min(i,o))*r/2;return Bs(o,0,Math.min(i,d))};return{outerStart:c(a.outerStart),outerEnd:c(a.outerEnd),innerStart:Bs(a.innerStart,0,l),innerEnd:Bs(a.innerEnd,0,l)}}function oi(t,e,s,r){return{x:s+t*Math.cos(e),y:r+t*Math.sin(e)}}function Wo(t,e,s,r,a,i){const{x:l,y:c,startAngle:o,pixelMargin:d,innerRadius:f}=e,u=Math.max(e.outerRadius+r+s-d,0),h=f>0?f+r+s+d:0;let x=0;const m=a-o;if(r){const L=f>0?f-r:0,P=u>0?u-r:0,J=(L+P)/2,Ee=J!==0?m*J/(J+r):m;x=(m-Ee)/2}const p=Math.max(.001,m*u-s/pt)/u,v=(m-p)/2,b=o+v+x,_=a-v-x,{outerStart:g,outerEnd:j,innerStart:w,innerEnd:k}=oP(e,h,u,_-b),y=u-g,N=u-j,S=b+g/y,T=_-j/N,E=h+w,A=h+k,H=b+w/E,V=_-k/A;if(t.beginPath(),i){const L=(S+T)/2;if(t.arc(l,c,u,S,L),t.arc(l,c,u,L,T),j>0){const Y=oi(N,T,l,c);t.arc(Y.x,Y.y,j,T,_+as)}const P=oi(A,_,l,c);if(t.lineTo(P.x,P.y),k>0){const Y=oi(A,V,l,c);t.arc(Y.x,Y.y,k,_+as,V+Math.PI)}const J=(_-k/h+(b+w/h))/2;if(t.arc(l,c,h,_-k/h,J,!0),t.arc(l,c,h,J,b+w/h,!0),w>0){const Y=oi(E,H,l,c);t.arc(Y.x,Y.y,w,H+Math.PI,b-as)}const Ee=oi(y,b,l,c);if(t.lineTo(Ee.x,Ee.y),g>0){const Y=oi(y,S,l,c);t.arc(Y.x,Y.y,g,b-as,S)}}else{t.moveTo(l,c);const L=Math.cos(S)*u+l,P=Math.sin(S)*u+c;t.lineTo(L,P);const J=Math.cos(T)*u+l,Ee=Math.sin(T)*u+c;t.lineTo(J,Ee)}t.closePath()}function dP(t,e,s,r,a){const{fullCircles:i,startAngle:l,circumference:c}=e;let o=e.endAngle;if(i){Wo(t,e,s,r,o,a);for(let d=0;d<i;++d)t.fill();isNaN(c)||(o=l+(c%Ht||Ht))}return Wo(t,e,s,r,o,a),t.fill(),o}function fP(t,e,s,r,a){const{fullCircles:i,startAngle:l,circumference:c,options:o}=e,{borderWidth:d,borderJoinStyle:f,borderDash:u,borderDashOffset:h,borderRadius:x}=o,m=o.borderAlign==="inner";if(!d)return;t.setLineDash(u||[]),t.lineDashOffset=h,m?(t.lineWidth=d*2,t.lineJoin=f||"round"):(t.lineWidth=d,t.lineJoin=f||"bevel");let p=e.endAngle;if(i){Wo(t,e,s,r,p,a);for(let v=0;v<i;++v)t.stroke();isNaN(c)||(p=l+(c%Ht||Ht))}m&&lP(t,e,p),o.selfJoin&&p-l>=pt&&x===0&&f!=="miter"&&iP(t,e,p),i||(Wo(t,e,s,r,p,a),t.stroke())}class Rr extends Wr{constructor(s){super();Re(this,"circumference");Re(this,"endAngle");Re(this,"fullCircles");Re(this,"innerRadius");Re(this,"outerRadius");Re(this,"pixelMargin");Re(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,s&&Object.assign(this,s)}inRange(s,r,a){const i=this.getProps(["x","y"],a),{angle:l,distance:c}=Gv(i,{x:s,y:r}),{startAngle:o,endAngle:d,innerRadius:f,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],a),x=(this.options.spacing+this.options.borderWidth)/2,m=nt(h,d-o),p=Vl(l,o,d)&&o!==d,v=m>=Ht||p,b=qa(c,f+x,u+x);return v&&b}getCenterPoint(s){const{x:r,y:a,startAngle:i,endAngle:l,innerRadius:c,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],s),{offset:d,spacing:f}=this.options,u=(i+l)/2,h=(c+o+f+d)/2;return{x:r+Math.cos(u)*h,y:a+Math.sin(u)*h}}tooltipPosition(s){return this.getCenterPoint(s)}draw(s){const{options:r,circumference:a}=this,i=(r.offset||0)/4,l=(r.spacing||0)/2,c=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=a>Ht?Math.floor(a/Ht):0,a===0||this.innerRadius<0||this.outerRadius<0)return;s.save();const o=(this.startAngle+this.endAngle)/2;s.translate(Math.cos(o)*i,Math.sin(o)*i);const d=1-Math.sin(Math.min(pt,a||0)),f=i*d;s.fillStyle=r.backgroundColor,s.strokeStyle=r.borderColor,dP(s,this,f,l,c),fP(s,this,f,l,c),s.restore()}}Re(Rr,"id","arc"),Re(Rr,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Re(Rr,"defaultRoutes",{backgroundColor:"backgroundColor"}),Re(Rr,"descriptors",{_scriptable:!0,_indexable:s=>s!=="borderDash"});function by(t,e,s=e){t.lineCap=nt(s.borderCapStyle,e.borderCapStyle),t.setLineDash(nt(s.borderDash,e.borderDash)),t.lineDashOffset=nt(s.borderDashOffset,e.borderDashOffset),t.lineJoin=nt(s.borderJoinStyle,e.borderJoinStyle),t.lineWidth=nt(s.borderWidth,e.borderWidth),t.strokeStyle=nt(s.borderColor,e.borderColor)}function uP(t,e,s){t.lineTo(s.x,s.y)}function hP(t){return t.stepped?O5:t.tension||t.cubicInterpolationMode==="monotone"?D5:uP}function _y(t,e,s={}){const r=t.length,{start:a=0,end:i=r-1}=s,{start:l,end:c}=e,o=Math.max(a,l),d=Math.min(i,c),f=a<l&&i<l||a>c&&i>c;return{count:r,start:o,loop:e.loop,ilen:d<o&&!f?r+d-o:d-o}}function mP(t,e,s,r){const{points:a,options:i}=e,{count:l,start:c,loop:o,ilen:d}=_y(a,s,r),f=hP(i);let{move:u=!0,reverse:h}=r||{},x,m,p;for(x=0;x<=d;++x)m=a[(c+(h?d-x:x))%l],!m.skip&&(u?(t.moveTo(m.x,m.y),u=!1):f(t,p,m,h,i.stepped),p=m);return o&&(m=a[(c+(h?d:0))%l],f(t,p,m,h,i.stepped)),!!o}function xP(t,e,s,r){const a=e.points,{count:i,start:l,ilen:c}=_y(a,s,r),{move:o=!0,reverse:d}=r||{};let f=0,u=0,h,x,m,p,v,b;const _=j=>(l+(d?c-j:j))%i,g=()=>{p!==v&&(t.lineTo(f,v),t.lineTo(f,p),t.lineTo(f,b))};for(o&&(x=a[_(0)],t.moveTo(x.x,x.y)),h=0;h<=c;++h){if(x=a[_(h)],x.skip)continue;const j=x.x,w=x.y,k=j|0;k===m?(w<p?p=w:w>v&&(v=w),f=(u*f+j)/++u):(g(),t.lineTo(j,w),m=k,u=0,p=v=w),b=w}g()}function nf(t){const e=t.options,s=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!s?xP:mP}function pP(t){return t.stepped?uD:t.tension||t.cubicInterpolationMode==="monotone"?hD:gn}function gP(t,e,s,r){let a=e._path;a||(a=e._path=new Path2D,e.path(a,s,r)&&a.closePath()),by(t,e.options),t.stroke(a)}function vP(t,e,s,r){const{segments:a,options:i}=e,l=nf(e);for(const c of a)by(t,i,c.style),t.beginPath(),l(t,e,c,{start:s,end:s+r-1})&&t.closePath(),t.stroke()}const yP=typeof Path2D=="function";function bP(t,e,s,r){yP&&!e.options.segment?gP(t,e,s,r):vP(t,e,s,r)}class ra extends Wr{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,s){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const a=r.spanGaps?this._loop:this._fullLoop;aD(this._points,r,e,a,s),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_D(this,this.options.segment))}first(){const e=this.segments,s=this.points;return e.length&&s[e[0].start]}last(){const e=this.segments,s=this.points,r=e.length;return r&&s[e[r-1].end]}interpolate(e,s){const r=this.options,a=e[s],i=this.points,l=vD(this,{property:s,start:a,end:a});if(!l.length)return;const c=[],o=pP(r);let d,f;for(d=0,f=l.length;d<f;++d){const{start:u,end:h}=l[d],x=i[u],m=i[h];if(x===m){c.push(x);continue}const p=Math.abs((a-x[s])/(m[s]-x[s])),v=o(x,m,p,r.stepped);v[s]=e[s],c.push(v)}return c.length===1?c[0]:c}pathSegment(e,s,r){return nf(this)(e,this,s,r)}path(e,s,r){const a=this.segments,i=nf(this);let l=this._loop;s=s||0,r=r||this.points.length-s;for(const c of a)l&=i(e,this,c,{start:s,end:s+r-1});return!!l}draw(e,s,r,a){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),bP(e,this,r,a),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Re(ra,"id","line"),Re(ra,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Re(ra,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Re(ra,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function Tx(t,e,s,r){const a=t.options,{[s]:i}=t.getProps([s],r);return Math.abs(e-i)<a.radius+a.hitRadius}class Pn extends Wr{constructor(s){super();Re(this,"parsed");Re(this,"skip");Re(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,s&&Object.assign(this,s)}inRange(s,r,a){const i=this.options,{x:l,y:c}=this.getProps(["x","y"],a);return Math.pow(s-l,2)+Math.pow(r-c,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(s,r){return Tx(this,s,"x",r)}inYRange(s,r){return Tx(this,s,"y",r)}getCenterPoint(s){const{x:r,y:a}=this.getProps(["x","y"],s);return{x:r,y:a}}size(s){s=s||this.options||{};let r=s.radius||0;r=Math.max(r,r&&s.hoverRadius||0);const a=r&&s.borderWidth||0;return(r+a)*2}draw(s,r){const a=this.options;this.skip||a.radius<.1||!wa(this,r,this.size(a)/2)||(s.strokeStyle=a.borderColor,s.lineWidth=a.borderWidth,s.fillStyle=a.backgroundColor,sf(s,a,this.x,this.y))}getRange(){const s=this.options||{};return s.radius+s.hitRadius}}Re(Pn,"id","point"),Re(Pn,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Re(Pn,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function wy(t,e){const{x:s,y:r,base:a,width:i,height:l}=t.getProps(["x","y","base","width","height"],e);let c,o,d,f,u;return t.horizontal?(u=l/2,c=Math.min(s,a),o=Math.max(s,a),d=r-u,f=r+u):(u=i/2,c=s-u,o=s+u,d=Math.min(r,a),f=Math.max(r,a)),{left:c,top:d,right:o,bottom:f}}function Ya(t,e,s,r){return t?0:Bs(e,s,r)}function _P(t,e,s){const r=t.options.borderWidth,a=t.borderSkipped,i=Qv(r);return{t:Ya(a.top,i.top,0,s),r:Ya(a.right,i.right,0,e),b:Ya(a.bottom,i.bottom,0,s),l:Ya(a.left,i.left,0,e)}}function wP(t,e,s){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),a=t.options.borderRadius,i=On(a),l=Math.min(e,s),c=t.borderSkipped,o=r||ht(a);return{topLeft:Ya(!o||c.top||c.left,i.topLeft,0,l),topRight:Ya(!o||c.top||c.right,i.topRight,0,l),bottomLeft:Ya(!o||c.bottom||c.left,i.bottomLeft,0,l),bottomRight:Ya(!o||c.bottom||c.right,i.bottomRight,0,l)}}function NP(t){const e=wy(t),s=e.right-e.left,r=e.bottom-e.top,a=_P(t,s/2,r/2),i=wP(t,s/2,r/2);return{outer:{x:e.left,y:e.top,w:s,h:r,radius:i},inner:{x:e.left+a.l,y:e.top+a.t,w:s-a.l-a.r,h:r-a.t-a.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,i.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(a.b,a.r))}}}}function _0(t,e,s,r){const a=e===null,i=s===null,c=t&&!(a&&i)&&wy(t,r);return c&&(a||qa(e,c.left,c.right))&&(i||qa(s,c.top,c.bottom))}function jP(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function kP(t,e){t.rect(e.x,e.y,e.w,e.h)}function w0(t,e,s={}){const r=t.x!==s.x?-e:0,a=t.y!==s.y?-e:0,i=(t.x+t.w!==s.x+s.w?e:0)-r,l=(t.y+t.h!==s.y+s.h?e:0)-a;return{x:t.x+r,y:t.y+a,w:t.w+i,h:t.h+l,radius:t.radius}}class na extends Wr{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:s,options:{borderColor:r,backgroundColor:a}}=this,{inner:i,outer:l}=NP(this),c=jP(l.radius)?zl:kP;e.save(),(l.w!==i.w||l.h!==i.h)&&(e.beginPath(),c(e,w0(l,s,i)),e.clip(),c(e,w0(i,-s,l)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),c(e,w0(i,s)),e.fillStyle=a,e.fill(),e.restore()}inRange(e,s,r){return _0(this,e,s,r)}inXRange(e,s){return _0(this,e,null,s)}inYRange(e,s){return _0(this,null,e,s)}getCenterPoint(e){const{x:s,y:r,base:a,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(s+a)/2:s,y:i?r:(r+a)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Re(na,"id","bar"),Re(na,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Re(na,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Cx=(t,e)=>{let{boxHeight:s=e,boxWidth:r=e}=t;return t.usePointStyle&&(s=Math.min(s,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:s,itemHeight:Math.max(e,s)}},SP=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class Ax extends Wr{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,s,r){this.maxWidth=e,this.maxHeight=s,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let s=At(e.generateLabels,[this.chart],this)||[];e.filter&&(s=s.filter(r=>e.filter(r,this.chart.data))),e.sort&&(s=s.sort((r,a)=>e.sort(r,a,this.chart.data))),this.options.reverse&&s.reverse(),this.legendItems=s}fit(){const{options:e,ctx:s}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,a=ps(r.font),i=a.size,l=this._computeTitleHeight(),{boxWidth:c,itemHeight:o}=Cx(r,i);let d,f;s.font=a.string,this.isHorizontal()?(d=this.maxWidth,f=this._fitRows(l,i,c,o)+10):(f=this.maxHeight,d=this._fitCols(l,a,c,o)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(f,e.maxHeight||this.maxHeight)}_fitRows(e,s,r,a){const{ctx:i,maxWidth:l,options:{labels:{padding:c}}}=this,o=this.legendHitBoxes=[],d=this.lineWidths=[0],f=a+c;let u=e;i.textAlign="left",i.textBaseline="middle";let h=-1,x=-f;return this.legendItems.forEach((m,p)=>{const v=r+s/2+i.measureText(m.text).width;(p===0||d[d.length-1]+v+2*c>l)&&(u+=f,d[d.length-(p>0?0:1)]=0,x+=f,h++),o[p]={left:0,top:x,row:h,width:v,height:a},d[d.length-1]+=v+c}),u}_fitCols(e,s,r,a){const{ctx:i,maxHeight:l,options:{labels:{padding:c}}}=this,o=this.legendHitBoxes=[],d=this.columnSizes=[],f=l-e;let u=c,h=0,x=0,m=0,p=0;return this.legendItems.forEach((v,b)=>{const{itemWidth:_,itemHeight:g}=EP(r,s,i,v,a);b>0&&x+g+2*c>f&&(u+=h+c,d.push({width:h,height:x}),m+=h+c,p++,h=x=0),o[b]={left:m,top:x,col:p,width:_,height:g},h=Math.max(h,_),x+=g+c}),u+=h,d.push({width:h,height:x}),u}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:s,options:{align:r,labels:{padding:a},rtl:i}}=this,l=ki(i,this.left,this.width);if(this.isHorizontal()){let c=0,o=Os(r,this.left+a,this.right-this.lineWidths[c]);for(const d of s)c!==d.row&&(c=d.row,o=Os(r,this.left+a,this.right-this.lineWidths[c])),d.top+=this.top+e+a,d.left=l.leftForLtr(l.x(o),d.width),o+=d.width+a}else{let c=0,o=Os(r,this.top+e+a,this.bottom-this.columnSizes[c].height);for(const d of s)d.col!==c&&(c=d.col,o=Os(r,this.top+e+a,this.bottom-this.columnSizes[c].height)),d.top=o,d.left+=this.left+a,d.left=l.leftForLtr(l.x(d.left),d.width),o+=d.height+a}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Cu(e,this),this._draw(),Au(e)}}_draw(){const{options:e,columnSizes:s,lineWidths:r,ctx:a}=this,{align:i,labels:l}=e,c=Zt.color,o=ki(e.rtl,this.left,this.width),d=ps(l.font),{padding:f}=l,u=d.size,h=u/2;let x;this.drawTitle(),a.textAlign=o.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=d.string;const{boxWidth:m,boxHeight:p,itemHeight:v}=Cx(l,u),b=function(k,y,N){if(isNaN(m)||m<=0||isNaN(p)||p<0)return;a.save();const S=nt(N.lineWidth,1);if(a.fillStyle=nt(N.fillStyle,c),a.lineCap=nt(N.lineCap,"butt"),a.lineDashOffset=nt(N.lineDashOffset,0),a.lineJoin=nt(N.lineJoin,"miter"),a.lineWidth=S,a.strokeStyle=nt(N.strokeStyle,c),a.setLineDash(nt(N.lineDash,[])),l.usePointStyle){const T={radius:p*Math.SQRT2/2,pointStyle:N.pointStyle,rotation:N.rotation,borderWidth:S},E=o.xPlus(k,m/2),A=y+h;Zv(a,T,E,A,l.pointStyleWidth&&m)}else{const T=y+Math.max((u-p)/2,0),E=o.leftForLtr(k,m),A=On(N.borderRadius);a.beginPath(),Object.values(A).some(H=>H!==0)?zl(a,{x:E,y:T,w:m,h:p,radius:A}):a.rect(E,T,m,p),a.fill(),S!==0&&a.stroke()}a.restore()},_=function(k,y,N){Vn(a,N.text,k,y+v/2,d,{strikethrough:N.hidden,textAlign:o.textAlign(N.textAlign)})},g=this.isHorizontal(),j=this._computeTitleHeight();g?x={x:Os(i,this.left+f,this.right-r[0]),y:this.top+f+j,line:0}:x={x:this.left+f,y:Os(i,this.top+j+f,this.bottom-s[0].height),line:0},ny(this.ctx,e.textDirection);const w=v+f;this.legendItems.forEach((k,y)=>{a.strokeStyle=k.fontColor,a.fillStyle=k.fontColor;const N=a.measureText(k.text).width,S=o.textAlign(k.textAlign||(k.textAlign=l.textAlign)),T=m+h+N;let E=x.x,A=x.y;o.setWidth(this.width),g?y>0&&E+T+f>this.right&&(A=x.y+=w,x.line++,E=x.x=Os(i,this.left+f,this.right-r[x.line])):y>0&&A+w>this.bottom&&(E=x.x=E+s[x.line].width+f,x.line++,A=x.y=Os(i,this.top+j+f,this.bottom-s[x.line].height));const H=o.x(E);if(b(H,A,k),E=y5(S,E+m+h,g?E+T:this.right,e.rtl),_(o.x(E),A,k),g)x.x+=T+f;else if(typeof k.text!="string"){const V=d.lineHeight;x.y+=Ny(k,V)+f}else x.y+=w}),iy(this.ctx,e.textDirection)}drawTitle(){const e=this.options,s=e.title,r=ps(s.font),a=Ws(s.padding);if(!s.display)return;const i=ki(e.rtl,this.left,this.width),l=this.ctx,c=s.position,o=r.size/2,d=a.top+o;let f,u=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),f=this.top+d,u=Os(e.align,u,this.right-h);else{const m=this.columnSizes.reduce((p,v)=>Math.max(p,v.height),0);f=d+Os(e.align,this.top,this.bottom-m-e.labels.padding-this._computeTitleHeight())}const x=Os(c,u,u+h);l.textAlign=i.textAlign(Eu(c)),l.textBaseline="middle",l.strokeStyle=s.color,l.fillStyle=s.color,l.font=r.string,Vn(l,s.text,x,f,r)}_computeTitleHeight(){const e=this.options.title,s=ps(e.font),r=Ws(e.padding);return e.display?s.lineHeight+r.height:0}_getLegendItemAt(e,s){let r,a,i;if(qa(e,this.left,this.right)&&qa(s,this.top,this.bottom)){for(i=this.legendHitBoxes,r=0;r<i.length;++r)if(a=i[r],qa(e,a.left,a.left+a.width)&&qa(s,a.top,a.top+a.height))return this.legendItems[r]}return null}handleEvent(e){const s=this.options;if(!AP(e.type,s))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const a=this._hoveredItem,i=SP(a,r);a&&!i&&At(s.onLeave,[e,a,this],this),this._hoveredItem=r,r&&!i&&At(s.onHover,[e,r,this],this)}else r&&At(s.onClick,[e,r,this],this)}}function EP(t,e,s,r,a){const i=TP(r,t,e,s),l=CP(a,r,e.lineHeight);return{itemWidth:i,itemHeight:l}}function TP(t,e,s,r){let a=t.text;return a&&typeof a!="string"&&(a=a.reduce((i,l)=>i.length>l.length?i:l)),e+s.size/2+r.measureText(a).width}function CP(t,e,s){let r=t;return typeof e.text!="string"&&(r=Ny(e,s)),r}function Ny(t,e){const s=t.text?t.text.length:0;return e*s}function AP(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var ei={id:"legend",_element:Ax,start(t,e,s){const r=t.legend=new Ax({ctx:t.ctx,options:s,chart:t});jr.configure(t,r,s),jr.addBox(t,r)},stop(t){jr.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,s){const r=t.legend;jr.configure(t,r,s),r.options=s},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,s){const r=e.datasetIndex,a=s.chart;a.isDatasetVisible(r)?(a.hide(r),e.hidden=!0):(a.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:s,pointStyle:r,textAlign:a,color:i,useBorderRadius:l,borderRadius:c}}=t.legend.options;return t._getSortedDatasetMetas().map(o=>{const d=o.controller.getStyle(s?0:void 0),f=Ws(d.borderWidth);return{text:e[o.index].label,fillStyle:d.backgroundColor,fontColor:i,hidden:!o.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(f.width+f.height)/4,strokeStyle:d.borderColor,pointStyle:r||d.pointStyle,rotation:d.rotation,textAlign:a||d.textAlign,borderRadius:l&&(c||d.borderRadius),datasetIndex:o.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class jy extends Wr{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,s){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=s;const a=zt(r.text)?r.text.length:1;this._padding=Ws(r.padding);const i=a*ps(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:s,left:r,bottom:a,right:i,options:l}=this,c=l.align;let o=0,d,f,u;return this.isHorizontal()?(f=Os(c,r,i),u=s+e,d=i-r):(l.position==="left"?(f=r+e,u=Os(c,a,s),o=pt*-.5):(f=i-e,u=Os(c,s,a),o=pt*.5),d=a-s),{titleX:f,titleY:u,maxWidth:d,rotation:o}}draw(){const e=this.ctx,s=this.options;if(!s.display)return;const r=ps(s.font),i=r.lineHeight/2+this._padding.top,{titleX:l,titleY:c,maxWidth:o,rotation:d}=this._drawArgs(i);Vn(e,s.text,0,0,r,{color:s.color,maxWidth:o,rotation:d,textAlign:Eu(s.align),textBaseline:"middle",translation:[l,c]})}}function FP(t,e){const s=new jy({ctx:t.ctx,options:e,chart:t});jr.configure(t,s,e),jr.addBox(t,s),t.titleBlock=s}var ti={id:"title",_element:jy,start(t,e,s){FP(t,s)},stop(t){const e=t.titleBlock;jr.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,s){const r=t.titleBlock;jr.configure(t,r,s),r.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ll={average(t){if(!t.length)return!1;let e,s,r=new Set,a=0,i=0;for(e=0,s=t.length;e<s;++e){const c=t[e].element;if(c&&c.hasValue()){const o=c.tooltipPosition();r.add(o.x),a+=o.y,++i}}return i===0||r.size===0?!1:{x:[...r].reduce((c,o)=>c+o)/r.size,y:a/i}},nearest(t,e){if(!t.length)return!1;let s=e.x,r=e.y,a=Number.POSITIVE_INFINITY,i,l,c;for(i=0,l=t.length;i<l;++i){const o=t[i].element;if(o&&o.hasValue()){const d=o.getCenterPoint(),f=ef(e,d);f<a&&(a=f,c=o)}}if(c){const o=c.tooltipPosition();s=o.x,r=o.y}return{x:s,y:r}}};function Yr(t,e){return e&&(zt(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function va(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function OP(t,e){const{element:s,datasetIndex:r,index:a}=e,i=t.getDatasetMeta(r).controller,{label:l,value:c}=i.getLabelAndValue(a);return{chart:t,label:l,parsed:i.getParsed(a),raw:t.data.datasets[r].data[a],formattedValue:c,dataset:i.getDataset(),dataIndex:a,datasetIndex:r,element:s}}function Fx(t,e){const s=t.chart.ctx,{body:r,footer:a,title:i}=t,{boxWidth:l,boxHeight:c}=e,o=ps(e.bodyFont),d=ps(e.titleFont),f=ps(e.footerFont),u=i.length,h=a.length,x=r.length,m=Ws(e.padding);let p=m.height,v=0,b=r.reduce((j,w)=>j+w.before.length+w.lines.length+w.after.length,0);if(b+=t.beforeBody.length+t.afterBody.length,u&&(p+=u*d.lineHeight+(u-1)*e.titleSpacing+e.titleMarginBottom),b){const j=e.displayColors?Math.max(c,o.lineHeight):o.lineHeight;p+=x*j+(b-x)*o.lineHeight+(b-1)*e.bodySpacing}h&&(p+=e.footerMarginTop+h*f.lineHeight+(h-1)*e.footerSpacing);let _=0;const g=function(j){v=Math.max(v,s.measureText(j).width+_)};return s.save(),s.font=d.string,jt(t.title,g),s.font=o.string,jt(t.beforeBody.concat(t.afterBody),g),_=e.displayColors?l+2+e.boxPadding:0,jt(r,j=>{jt(j.before,g),jt(j.lines,g),jt(j.after,g)}),_=0,s.font=f.string,jt(t.footer,g),s.restore(),v+=m.width,{width:v,height:p}}function DP(t,e){const{y:s,height:r}=e;return s<r/2?"top":s>t.height-r/2?"bottom":"center"}function PP(t,e,s,r){const{x:a,width:i}=r,l=s.caretSize+s.caretPadding;if(t==="left"&&a+i+l>e.width||t==="right"&&a-i-l<0)return!0}function MP(t,e,s,r){const{x:a,width:i}=s,{width:l,chartArea:{left:c,right:o}}=t;let d="center";return r==="center"?d=a<=(c+o)/2?"left":"right":a<=i/2?d="left":a>=l-i/2&&(d="right"),PP(d,t,e,s)&&(d="center"),d}function Ox(t,e,s){const r=s.yAlign||e.yAlign||DP(t,s);return{xAlign:s.xAlign||e.xAlign||MP(t,e,s,r),yAlign:r}}function RP(t,e){let{x:s,width:r}=t;return e==="right"?s-=r:e==="center"&&(s-=r/2),s}function IP(t,e,s){let{y:r,height:a}=t;return e==="top"?r+=s:e==="bottom"?r-=a+s:r-=a/2,r}function Dx(t,e,s,r){const{caretSize:a,caretPadding:i,cornerRadius:l}=t,{xAlign:c,yAlign:o}=s,d=a+i,{topLeft:f,topRight:u,bottomLeft:h,bottomRight:x}=On(l);let m=RP(e,c);const p=IP(e,o,d);return o==="center"?c==="left"?m+=d:c==="right"&&(m-=d):c==="left"?m-=Math.max(f,h)+a:c==="right"&&(m+=Math.max(u,x)+a),{x:Bs(m,0,r.width-e.width),y:Bs(p,0,r.height-e.height)}}function Bc(t,e,s){const r=Ws(s.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function Px(t){return Yr([],va(t))}function LP(t,e,s){return dn(t,{tooltip:e,tooltipItems:s,type:"tooltip"})}function Mx(t,e){const s=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return s?t.override(s):t}const ky={beforeTitle:pa,title(t){if(t.length>0){const e=t[0],s=e.chart.data.labels,r=s?s.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return s[e.dataIndex]}return""},afterTitle:pa,beforeBody:pa,beforeLabel:pa,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const s=t.formattedValue;return ut(s)||(e+=s),e},labelColor(t){const s=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:s.borderColor,backgroundColor:s.backgroundColor,borderWidth:s.borderWidth,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const s=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:s.pointStyle,rotation:s.rotation}},afterLabel:pa,afterBody:pa,beforeFooter:pa,footer:pa,afterFooter:pa};function Qs(t,e,s,r){const a=t[e].call(s,r);return typeof a>"u"?ky[e].call(s,r):a}class lf extends Wr{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const s=this.chart,r=this.options.setContext(this.getContext()),a=r.enabled&&s.options.animation&&r.animations,i=new cy(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=LP(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,s){const{callbacks:r}=s,a=Qs(r,"beforeTitle",this,e),i=Qs(r,"title",this,e),l=Qs(r,"afterTitle",this,e);let c=[];return c=Yr(c,va(a)),c=Yr(c,va(i)),c=Yr(c,va(l)),c}getBeforeBody(e,s){return Px(Qs(s.callbacks,"beforeBody",this,e))}getBody(e,s){const{callbacks:r}=s,a=[];return jt(e,i=>{const l={before:[],lines:[],after:[]},c=Mx(r,i);Yr(l.before,va(Qs(c,"beforeLabel",this,i))),Yr(l.lines,Qs(c,"label",this,i)),Yr(l.after,va(Qs(c,"afterLabel",this,i))),a.push(l)}),a}getAfterBody(e,s){return Px(Qs(s.callbacks,"afterBody",this,e))}getFooter(e,s){const{callbacks:r}=s,a=Qs(r,"beforeFooter",this,e),i=Qs(r,"footer",this,e),l=Qs(r,"afterFooter",this,e);let c=[];return c=Yr(c,va(a)),c=Yr(c,va(i)),c=Yr(c,va(l)),c}_createItems(e){const s=this._active,r=this.chart.data,a=[],i=[],l=[];let c=[],o,d;for(o=0,d=s.length;o<d;++o)c.push(OP(this.chart,s[o]));return e.filter&&(c=c.filter((f,u,h)=>e.filter(f,u,h,r))),e.itemSort&&(c=c.sort((f,u)=>e.itemSort(f,u,r))),jt(c,f=>{const u=Mx(e.callbacks,f);a.push(Qs(u,"labelColor",this,f)),i.push(Qs(u,"labelPointStyle",this,f)),l.push(Qs(u,"labelTextColor",this,f))}),this.labelColors=a,this.labelPointStyles=i,this.labelTextColors=l,this.dataPoints=c,c}update(e,s){const r=this.options.setContext(this.getContext()),a=this._active;let i,l=[];if(!a.length)this.opacity!==0&&(i={opacity:0});else{const c=ll[r.position].call(this,a,this._eventPosition);l=this._createItems(r),this.title=this.getTitle(l,r),this.beforeBody=this.getBeforeBody(l,r),this.body=this.getBody(l,r),this.afterBody=this.getAfterBody(l,r),this.footer=this.getFooter(l,r);const o=this._size=Fx(this,r),d=Object.assign({},c,o),f=Ox(this.chart,r,d),u=Dx(r,d,f,this.chart);this.xAlign=f.xAlign,this.yAlign=f.yAlign,i={opacity:1,x:u.x,y:u.y,width:o.width,height:o.height,caretX:c.x,caretY:c.y}}this._tooltipItems=l,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:s})}drawCaret(e,s,r,a){const i=this.getCaretPosition(e,r,a);s.lineTo(i.x1,i.y1),s.lineTo(i.x2,i.y2),s.lineTo(i.x3,i.y3)}getCaretPosition(e,s,r){const{xAlign:a,yAlign:i}=this,{caretSize:l,cornerRadius:c}=r,{topLeft:o,topRight:d,bottomLeft:f,bottomRight:u}=On(c),{x:h,y:x}=e,{width:m,height:p}=s;let v,b,_,g,j,w;return i==="center"?(j=x+p/2,a==="left"?(v=h,b=v-l,g=j+l,w=j-l):(v=h+m,b=v+l,g=j-l,w=j+l),_=v):(a==="left"?b=h+Math.max(o,f)+l:a==="right"?b=h+m-Math.max(d,u)-l:b=this.caretX,i==="top"?(g=x,j=g-l,v=b-l,_=b+l):(g=x+p,j=g+l,v=b+l,_=b-l),w=g),{x1:v,x2:b,x3:_,y1:g,y2:j,y3:w}}drawTitle(e,s,r){const a=this.title,i=a.length;let l,c,o;if(i){const d=ki(r.rtl,this.x,this.width);for(e.x=Bc(this,r.titleAlign,r),s.textAlign=d.textAlign(r.titleAlign),s.textBaseline="middle",l=ps(r.titleFont),c=r.titleSpacing,s.fillStyle=r.titleColor,s.font=l.string,o=0;o<i;++o)s.fillText(a[o],d.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+c,o+1===i&&(e.y+=r.titleMarginBottom-c)}}_drawColorBox(e,s,r,a,i){const l=this.labelColors[r],c=this.labelPointStyles[r],{boxHeight:o,boxWidth:d}=i,f=ps(i.bodyFont),u=Bc(this,"left",i),h=a.x(u),x=o<f.lineHeight?(f.lineHeight-o)/2:0,m=s.y+x;if(i.usePointStyle){const p={radius:Math.min(d,o)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},v=a.leftForLtr(h,d)+d/2,b=m+o/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,sf(e,p,v,b),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,sf(e,p,v,b)}else{e.lineWidth=ht(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const p=a.leftForLtr(h,d),v=a.leftForLtr(a.xPlus(h,1),d-2),b=On(l.borderRadius);Object.values(b).some(_=>_!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,zl(e,{x:p,y:m,w:d,h:o,radius:b}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),zl(e,{x:v,y:m+1,w:d-2,h:o-2,radius:b}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(p,m,d,o),e.strokeRect(p,m,d,o),e.fillStyle=l.backgroundColor,e.fillRect(v,m+1,d-2,o-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,s,r){const{body:a}=this,{bodySpacing:i,bodyAlign:l,displayColors:c,boxHeight:o,boxWidth:d,boxPadding:f}=r,u=ps(r.bodyFont);let h=u.lineHeight,x=0;const m=ki(r.rtl,this.x,this.width),p=function(N){s.fillText(N,m.x(e.x+x),e.y+h/2),e.y+=h+i},v=m.textAlign(l);let b,_,g,j,w,k,y;for(s.textAlign=l,s.textBaseline="middle",s.font=u.string,e.x=Bc(this,v,r),s.fillStyle=r.bodyColor,jt(this.beforeBody,p),x=c&&v!=="right"?l==="center"?d/2+f:d+2+f:0,j=0,k=a.length;j<k;++j){for(b=a[j],_=this.labelTextColors[j],s.fillStyle=_,jt(b.before,p),g=b.lines,c&&g.length&&(this._drawColorBox(s,e,j,m,r),h=Math.max(u.lineHeight,o)),w=0,y=g.length;w<y;++w)p(g[w]),h=u.lineHeight;jt(b.after,p)}x=0,h=u.lineHeight,jt(this.afterBody,p),e.y-=i}drawFooter(e,s,r){const a=this.footer,i=a.length;let l,c;if(i){const o=ki(r.rtl,this.x,this.width);for(e.x=Bc(this,r.footerAlign,r),e.y+=r.footerMarginTop,s.textAlign=o.textAlign(r.footerAlign),s.textBaseline="middle",l=ps(r.footerFont),s.fillStyle=r.footerColor,s.font=l.string,c=0;c<i;++c)s.fillText(a[c],o.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+r.footerSpacing}}drawBackground(e,s,r,a){const{xAlign:i,yAlign:l}=this,{x:c,y:o}=e,{width:d,height:f}=r,{topLeft:u,topRight:h,bottomLeft:x,bottomRight:m}=On(a.cornerRadius);s.fillStyle=a.backgroundColor,s.strokeStyle=a.borderColor,s.lineWidth=a.borderWidth,s.beginPath(),s.moveTo(c+u,o),l==="top"&&this.drawCaret(e,s,r,a),s.lineTo(c+d-h,o),s.quadraticCurveTo(c+d,o,c+d,o+h),l==="center"&&i==="right"&&this.drawCaret(e,s,r,a),s.lineTo(c+d,o+f-m),s.quadraticCurveTo(c+d,o+f,c+d-m,o+f),l==="bottom"&&this.drawCaret(e,s,r,a),s.lineTo(c+x,o+f),s.quadraticCurveTo(c,o+f,c,o+f-x),l==="center"&&i==="left"&&this.drawCaret(e,s,r,a),s.lineTo(c,o+u),s.quadraticCurveTo(c,o,c+u,o),s.closePath(),s.fill(),a.borderWidth>0&&s.stroke()}_updateAnimationTarget(e){const s=this.chart,r=this.$animations,a=r&&r.x,i=r&&r.y;if(a||i){const l=ll[e.position].call(this,this._active,this._eventPosition);if(!l)return;const c=this._size=Fx(this,e),o=Object.assign({},l,this._size),d=Ox(s,e,o),f=Dx(e,o,d,s);(a._to!==f.x||i._to!==f.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=c.width,this.height=c.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,f))}}_willRender(){return!!this.opacity}draw(e){const s=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(s);const a={width:this.width,height:this.height},i={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const l=Ws(s.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;s.enabled&&c&&(e.save(),e.globalAlpha=r,this.drawBackground(i,e,a,s),ny(e,s.textDirection),i.y+=l.top,this.drawTitle(i,e,s),this.drawBody(i,e,s),this.drawFooter(i,e,s),iy(e,s.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,s){const r=this._active,a=e.map(({datasetIndex:c,index:o})=>{const d=this.chart.getDatasetMeta(c);if(!d)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:d.data[o],index:o}}),i=!Ro(r,a),l=this._positionChanged(a,s);(i||l)&&(this._active=a,this._eventPosition=s,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,s,r=!0){if(s&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const a=this.options,i=this._active||[],l=this._getActiveElements(e,i,s,r),c=this._positionChanged(l,e),o=s||!Ro(l,i)||c;return o&&(this._active=l,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,s))),o}_getActiveElements(e,s,r,a){const i=this.options;if(e.type==="mouseout")return[];if(!a)return s.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,i.mode,i,r);return i.reverse&&l.reverse(),l}_positionChanged(e,s){const{caretX:r,caretY:a,options:i}=this,l=ll[i.position].call(this,e,s);return l!==!1&&(r!==l.x||a!==l.y)}}Re(lf,"positioners",ll);var si={id:"tooltip",_element:lf,positioners:ll,afterInit(t,e,s){s&&(t.tooltip=new lf({chart:t,options:s}))},beforeUpdate(t,e,s){t.tooltip&&t.tooltip.initialize(s)},reset(t,e,s){t.tooltip&&t.tooltip.initialize(s)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const s={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...s,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",s)}},afterEvent(t,e){if(t.tooltip){const s=e.replay;t.tooltip.handleEvent(e.event,s,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:ky},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const BP=(t,e,s,r)=>(typeof e=="string"?(s=t.push(e)-1,r.unshift({index:s,label:e})):isNaN(e)&&(s=null),s);function UP(t,e,s,r){const a=t.indexOf(e);if(a===-1)return BP(t,e,s,r);const i=t.lastIndexOf(e);return a!==i?s:a}const $P=(t,e)=>t===null?null:Bs(Math.round(t),0,e);function Rx(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Ca extends Qn{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const s=this._addedLabels;if(s.length){const r=this.getLabels();for(const{index:a,label:i}of s)r[a]===i&&r.splice(a,1);this._addedLabels=[]}super.init(e)}parse(e,s){if(ut(e))return null;const r=this.getLabels();return s=isFinite(s)&&r[s]===e?s:UP(r,e,nt(s,e),this._addedLabels),$P(s,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:s}=this.getUserBounds();let{min:r,max:a}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),s||(a=this.getLabels().length-1)),this.min=r,this.max=a}buildTicks(){const e=this.min,s=this.max,r=this.options.offset,a=[];let i=this.getLabels();i=e===0&&s===i.length-1?i:i.slice(e,s+1),this._valueRange=Math.max(i.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let l=e;l<=s;l++)a.push({value:l});return a}getLabelForValue(e){return Rx.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const s=this.ticks;return e<0||e>s.length-1?null:this.getPixelForValue(s[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Re(Ca,"id","category"),Re(Ca,"defaults",{ticks:{callback:Rx}});function WP(t,e){const s=[],{bounds:a,step:i,min:l,max:c,precision:o,count:d,maxTicks:f,maxDigits:u,includeBounds:h}=t,x=i||1,m=f-1,{min:p,max:v}=e,b=!ut(l),_=!ut(c),g=!ut(d),j=(v-p)/(u+1);let w=Bm((v-p)/m/x)*x,k,y,N,S;if(w<1e-14&&!b&&!_)return[{value:p},{value:v}];S=Math.ceil(v/w)-Math.floor(p/w),S>m&&(w=Bm(S*w/m/x)*x),ut(o)||(k=Math.pow(10,o),w=Math.ceil(w*k)/k),a==="ticks"?(y=Math.floor(p/w)*w,N=Math.ceil(v/w)*w):(y=p,N=v),b&&_&&i&&u5((c-l)/i,w/1e3)?(S=Math.round(Math.min((c-l)/w,f)),w=(c-l)/S,y=l,N=c):g?(y=b?l:y,N=_?c:N,S=d-1,w=(N-y)/S):(S=(N-y)/w,_l(S,Math.round(S),w/1e3)?S=Math.round(S):S=Math.ceil(S));const T=Math.max(Um(w),Um(y));k=Math.pow(10,ut(o)?T:o),y=Math.round(y*k)/k,N=Math.round(N*k)/k;let E=0;for(b&&(h&&y!==l?(s.push({value:l}),y<l&&E++,_l(Math.round((y+E*w)*k)/k,l,Ix(l,j,t))&&E++):y<l&&E++);E<S;++E){const A=Math.round((y+E*w)*k)/k;if(_&&A>c)break;s.push({value:A})}return _&&h&&N!==c?s.length&&_l(s[s.length-1].value,c,Ix(c,j,t))?s[s.length-1].value=c:s.push({value:c}):(!_||N===c)&&s.push({value:N}),s}function Ix(t,e,{horizontal:s,minRotation:r}){const a=sa(r),i=(s?Math.sin(a):Math.cos(a))||.001,l=.75*e*(""+t).length;return Math.min(e/i,l)}class Vo extends Qn{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,s){return ut(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:s,maxDefined:r}=this.getUserBounds();let{min:a,max:i}=this;const l=o=>a=s?a:o,c=o=>i=r?i:o;if(e){const o=aa(a),d=aa(i);o<0&&d<0?c(0):o>0&&d>0&&l(0)}if(a===i){let o=i===0?1:Math.abs(i*.05);c(i+o),e||l(a-o)}this.min=a,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:s,stepSize:r}=e,a;return r?(a=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,a>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${a} ticks. Limiting to 1000.`),a=1e3)):(a=this.computeTickLimit(),s=s||11),s&&(a=Math.min(s,a)),a}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,s=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const a={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:s.precision,step:s.stepSize,count:s.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:s.minRotation||0,includeBounds:s.includeBounds!==!1},i=this._range||this,l=WP(a,i);return e.bounds==="ticks"&&Hv(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let s=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const a=(r-s)/Math.max(e.length-1,1)/2;s-=a,r+=a}this._startValue=s,this._endValue=r,this._valueRange=r-s}getLabelForValue(e){return wd(e,this.chart.options.locale,this.options.ticks.format)}}class Aa extends Vo{determineDataLimits(){const{min:e,max:s}=this.getMinMax(!0);this.min=ks(e)?e:0,this.max=ks(s)?s:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),s=e?this.width:this.height,r=sa(this.options.ticks.minRotation),a=(e?Math.sin(r):Math.cos(r))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(s/Math.min(40,i.lineHeight/a))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Re(Aa,"id","linear"),Re(Aa,"defaults",{ticks:{callback:Nd.formatters.numeric}});const Gl=t=>Math.floor(Xa(t)),xn=(t,e)=>Math.pow(10,Gl(t)+e);function Lx(t){return t/Math.pow(10,Gl(t))===1}function Bx(t,e,s){const r=Math.pow(10,s),a=Math.floor(t/r);return Math.ceil(e/r)-a}function VP(t,e){const s=e-t;let r=Gl(s);for(;Bx(t,e,r)>10;)r++;for(;Bx(t,e,r)<10;)r--;return Math.min(r,Gl(t))}function zP(t,{min:e,max:s}){e=or(t.min,e);const r=[],a=Gl(e);let i=VP(e,s),l=i<0?Math.pow(10,Math.abs(i)):1;const c=Math.pow(10,i),o=a>i?Math.pow(10,a):0,d=Math.round((e-o)*l)/l,f=Math.floor((e-o)/c/10)*c*10;let u=Math.floor((d-f)/Math.pow(10,i)),h=or(t.min,Math.round((o+f+u*Math.pow(10,i))*l)/l);for(;h<s;)r.push({value:h,major:Lx(h),significand:u}),u>=10?u=u<15?15:20:u++,u>=20&&(i++,u=2,l=i>=0?1:l),h=Math.round((o+f+u*Math.pow(10,i))*l)/l;const x=or(t.max,h);return r.push({value:x,major:Lx(x),significand:u}),r}class Ux extends Qn{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,s){const r=Vo.prototype.parse.apply(this,[e,s]);if(r===0){this._zero=!0;return}return ks(r)&&r>0?r:null}determineDataLimits(){const{min:e,max:s}=this.getMinMax(!0);this.min=ks(e)?Math.max(0,e):null,this.max=ks(s)?Math.max(0,s):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!ks(this._userMin)&&(this.min=e===xn(this.min,0)?xn(this.min,-1):xn(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:s}=this.getUserBounds();let r=this.min,a=this.max;const i=c=>r=e?r:c,l=c=>a=s?a:c;r===a&&(r<=0?(i(1),l(10)):(i(xn(r,-1)),l(xn(a,1)))),r<=0&&i(xn(a,-1)),a<=0&&l(xn(r,1)),this.min=r,this.max=a}buildTicks(){const e=this.options,s={min:this._userMin,max:this._userMax},r=zP(s,this);return e.bounds==="ticks"&&Hv(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(e){return e===void 0?"0":wd(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Xa(e),this._valueRange=Xa(this.max)-Xa(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Xa(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const s=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+s*this._valueRange)}}Re(Ux,"id","logarithmic"),Re(Ux,"defaults",{ticks:{callback:Nd.formatters.logarithmic,major:{enabled:!0}}});function cf(t){const e=t.ticks;if(e.display&&t.display){const s=Ws(e.backdropPadding);return nt(e.font&&e.font.size,Zt.font.size)+s.height}return 0}function HP(t,e,s){return s=zt(s)?s:[s],{w:F5(t,e.string,s),h:s.length*e.lineHeight}}function $x(t,e,s,r,a){return t===r||t===a?{start:e-s/2,end:e+s/2}:t<r||t>a?{start:e-s,end:e}:{start:e,end:e+s}}function GP(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},s=Object.assign({},e),r=[],a=[],i=t._pointLabels.length,l=t.options.pointLabels,c=l.centerPointLabels?pt/i:0;for(let o=0;o<i;o++){const d=l.setContext(t.getPointLabelContext(o));a[o]=d.padding;const f=t.getPointPosition(o,t.drawingArea+a[o],c),u=ps(d.font),h=HP(t.ctx,u,t._pointLabels[o]);r[o]=h;const x=sr(t.getIndexAngle(o)+c),m=Math.round(ku(x)),p=$x(m,f.x,h.w,0,180),v=$x(m,f.y,h.h,90,270);XP(s,e,x,p,v)}t.setCenterPoint(e.l-s.l,s.r-e.r,e.t-s.t,s.b-e.b),t._pointLabelItems=KP(t,r,a)}function XP(t,e,s,r,a){const i=Math.abs(Math.sin(s)),l=Math.abs(Math.cos(s));let c=0,o=0;r.start<e.l?(c=(e.l-r.start)/i,t.l=Math.min(t.l,e.l-c)):r.end>e.r&&(c=(r.end-e.r)/i,t.r=Math.max(t.r,e.r+c)),a.start<e.t?(o=(e.t-a.start)/l,t.t=Math.min(t.t,e.t-o)):a.end>e.b&&(o=(a.end-e.b)/l,t.b=Math.max(t.b,e.b+o))}function qP(t,e,s){const r=t.drawingArea,{extra:a,additionalAngle:i,padding:l,size:c}=s,o=t.getPointPosition(e,r+a+l,i),d=Math.round(ku(sr(o.angle+as))),f=QP(o.y,c.h,d),u=JP(d),h=ZP(o.x,c.w,u);return{visible:!0,x:o.x,y:f,textAlign:u,left:h,top:f,right:h+c.w,bottom:f+c.h}}function YP(t,e){if(!e)return!0;const{left:s,top:r,right:a,bottom:i}=t;return!(wa({x:s,y:r},e)||wa({x:s,y:i},e)||wa({x:a,y:r},e)||wa({x:a,y:i},e))}function KP(t,e,s){const r=[],a=t._pointLabels.length,i=t.options,{centerPointLabels:l,display:c}=i.pointLabels,o={extra:cf(i)/2,additionalAngle:l?pt/a:0};let d;for(let f=0;f<a;f++){o.padding=s[f],o.size=e[f];const u=qP(t,f,o);r.push(u),c==="auto"&&(u.visible=YP(u,d),u.visible&&(d=u))}return r}function JP(t){return t===0||t===180?"center":t<180?"left":"right"}function ZP(t,e,s){return s==="right"?t-=e:s==="center"&&(t-=e/2),t}function QP(t,e,s){return s===90||s===270?t-=e/2:(s>270||s<90)&&(t-=e),t}function eM(t,e,s){const{left:r,top:a,right:i,bottom:l}=s,{backdropColor:c}=e;if(!ut(c)){const o=On(e.borderRadius),d=Ws(e.backdropPadding);t.fillStyle=c;const f=r-d.left,u=a-d.top,h=i-r+d.width,x=l-a+d.height;Object.values(o).some(m=>m!==0)?(t.beginPath(),zl(t,{x:f,y:u,w:h,h:x,radius:o}),t.fill()):t.fillRect(f,u,h,x)}}function tM(t,e){const{ctx:s,options:{pointLabels:r}}=t;for(let a=e-1;a>=0;a--){const i=t._pointLabelItems[a];if(!i.visible)continue;const l=r.setContext(t.getPointLabelContext(a));eM(s,l,i);const c=ps(l.font),{x:o,y:d,textAlign:f}=i;Vn(s,t._pointLabels[a],o,d+c.lineHeight/2,c,{color:l.color,textAlign:f,textBaseline:"middle"})}}function Sy(t,e,s,r){const{ctx:a}=t;if(s)a.arc(t.xCenter,t.yCenter,e,0,Ht);else{let i=t.getPointPosition(0,e);a.moveTo(i.x,i.y);for(let l=1;l<r;l++)i=t.getPointPosition(l,e),a.lineTo(i.x,i.y)}}function sM(t,e,s,r,a){const i=t.ctx,l=e.circular,{color:c,lineWidth:o}=e;!l&&!r||!c||!o||s<0||(i.save(),i.strokeStyle=c,i.lineWidth=o,i.setLineDash(a.dash||[]),i.lineDashOffset=a.dashOffset,i.beginPath(),Sy(t,s,l,r),i.closePath(),i.stroke(),i.restore())}function rM(t,e,s){return dn(t,{label:s,index:e,type:"pointLabel"})}class kn extends Vo{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Ws(cf(this.options)/2),s=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+s/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(s,r)/2)}determineDataLimits(){const{min:e,max:s}=this.getMinMax(!1);this.min=ks(e)&&!isNaN(e)?e:0,this.max=ks(s)&&!isNaN(s)?s:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/cf(this.options))}generateTickLabels(e){Vo.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((s,r)=>{const a=At(this.options.pointLabels.callback,[s,r],this);return a||a===0?a:""}).filter((s,r)=>this.chart.getDataVisibility(r))}fit(){const e=this.options;e.display&&e.pointLabels.display?GP(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,s,r,a){this.xCenter+=Math.floor((e-s)/2),this.yCenter+=Math.floor((r-a)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,s,r,a))}getIndexAngle(e){const s=Ht/(this._pointLabels.length||1),r=this.options.startAngle||0;return sr(e*s+sa(r))}getDistanceFromCenterForValue(e){if(ut(e))return NaN;const s=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*s:(e-this.min)*s}getValueForDistanceFromCenter(e){if(ut(e))return NaN;const s=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-s:this.min+s}getPointLabelContext(e){const s=this._pointLabels||[];if(e>=0&&e<s.length){const r=s[e];return rM(this.getContext(),e,r)}}getPointPosition(e,s,r=0){const a=this.getIndexAngle(e)-as+r;return{x:Math.cos(a)*s+this.xCenter,y:Math.sin(a)*s+this.yCenter,angle:a}}getPointPositionForValue(e,s){return this.getPointPosition(e,this.getDistanceFromCenterForValue(s))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:s,top:r,right:a,bottom:i}=this._pointLabelItems[e];return{left:s,top:r,right:a,bottom:i}}drawBackground(){const{backgroundColor:e,grid:{circular:s}}=this.options;if(e){const r=this.ctx;r.save(),r.beginPath(),Sy(this,this.getDistanceFromCenterForValue(this._endValue),s,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const e=this.ctx,s=this.options,{angleLines:r,grid:a,border:i}=s,l=this._pointLabels.length;let c,o,d;if(s.pointLabels.display&&tM(this,l),a.display&&this.ticks.forEach((f,u)=>{if(u!==0||u===0&&this.min<0){o=this.getDistanceFromCenterForValue(f.value);const h=this.getContext(u),x=a.setContext(h),m=i.setContext(h);sM(this,x,o,l,m)}}),r.display){for(e.save(),c=l-1;c>=0;c--){const f=r.setContext(this.getPointLabelContext(c)),{color:u,lineWidth:h}=f;!h||!u||(e.lineWidth=h,e.strokeStyle=u,e.setLineDash(f.borderDash),e.lineDashOffset=f.borderDashOffset,o=this.getDistanceFromCenterForValue(s.reverse?this.min:this.max),d=this.getPointPosition(c,o),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(d.x,d.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,s=this.options,r=s.ticks;if(!r.display)return;const a=this.getIndexAngle(0);let i,l;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(a),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((c,o)=>{if(o===0&&this.min>=0&&!s.reverse)return;const d=r.setContext(this.getContext(o)),f=ps(d.font);if(i=this.getDistanceFromCenterForValue(this.ticks[o].value),d.showLabelBackdrop){e.font=f.string,l=e.measureText(c.label).width,e.fillStyle=d.backdropColor;const u=Ws(d.backdropPadding);e.fillRect(-l/2-u.left,-i-f.size/2-u.top,l+u.width,f.size+u.height)}Vn(e,c.label,0,-i,f,{color:d.color,strokeColor:d.textStrokeColor,strokeWidth:d.textStrokeWidth})}),e.restore()}drawTitle(){}}Re(kn,"id","radialLinear"),Re(kn,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Nd.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),Re(kn,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Re(kn,"descriptors",{angleLines:{_fallback:"grid"}});const kd={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},rr=Object.keys(kd);function Wx(t,e){return t-e}function Vx(t,e){if(ut(e))return null;const s=t._adapter,{parser:r,round:a,isoWeekday:i}=t._parseOpts;let l=e;return typeof r=="function"&&(l=r(l)),ks(l)||(l=typeof r=="string"?s.parse(l,r):s.parse(l)),l===null?null:(a&&(l=a==="week"&&(Wl(i)||i===!0)?s.startOf(l,"isoWeek",i):s.startOf(l,a)),+l)}function zx(t,e,s,r){const a=rr.length;for(let i=rr.indexOf(t);i<a-1;++i){const l=kd[rr[i]],c=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((s-e)/(c*l.size))<=r)return rr[i]}return rr[a-1]}function aM(t,e,s,r,a){for(let i=rr.length-1;i>=rr.indexOf(s);i--){const l=rr[i];if(kd[l].common&&t._adapter.diff(a,r,l)>=e-1)return l}return rr[s?rr.indexOf(s):0]}function nM(t){for(let e=rr.indexOf(t)+1,s=rr.length;e<s;++e)if(kd[rr[e]].common)return rr[e]}function Hx(t,e,s){if(!s)t[e]=!0;else if(s.length){const{lo:r,hi:a}=Su(s,e),i=s[r]>=e?s[r]:s[a];t[i]=!0}}function iM(t,e,s,r){const a=t._adapter,i=+a.startOf(e[0].value,r),l=e[e.length-1].value;let c,o;for(c=i;c<=l;c=+a.add(c,1,r))o=s[c],o>=0&&(e[o].major=!0);return e}function Gx(t,e,s){const r=[],a={},i=e.length;let l,c;for(l=0;l<i;++l)c=e[l],a[c]=l,r.push({value:c,major:!1});return i===0||!s?r:iM(t,r,a,s)}class zo extends Qn{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,s={}){const r=e.time||(e.time={}),a=this._adapter=new JD._date(e.adapters.date);a.init(s),bl(r.displayFormats,a.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=s.normalized}parse(e,s){return e===void 0?null:Vx(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,s=this._adapter,r=e.time.unit||"day";let{min:a,max:i,minDefined:l,maxDefined:c}=this.getUserBounds();function o(d){!l&&!isNaN(d.min)&&(a=Math.min(a,d.min)),!c&&!isNaN(d.max)&&(i=Math.max(i,d.max))}(!l||!c)&&(o(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&o(this.getMinMax(!1))),a=ks(a)&&!isNaN(a)?a:+s.startOf(Date.now(),r),i=ks(i)&&!isNaN(i)?i:+s.endOf(Date.now(),r)+1,this.min=Math.min(a,i-1),this.max=Math.max(a+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let s=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(s=e[0],r=e[e.length-1]),{min:s,max:r}}buildTicks(){const e=this.options,s=e.time,r=e.ticks,a=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);const i=this.min,l=this.max,c=p5(a,i,l);return this._unit=s.unit||(r.autoSkip?zx(s.minUnit,this.min,this.max,this._getLabelCapacity(i)):aM(this,c.length,s.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:nM(this._unit),this.initOffsets(a),e.reverse&&c.reverse(),Gx(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let s=0,r=0,a,i;this.options.offset&&e.length&&(a=this.getDecimalForValue(e[0]),e.length===1?s=1-a:s=(this.getDecimalForValue(e[1])-a)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?r=i:r=(i-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;s=Bs(s,0,l),r=Bs(r,0,l),this._offsets={start:s,end:r,factor:1/(s+1+r)}}_generate(){const e=this._adapter,s=this.min,r=this.max,a=this.options,i=a.time,l=i.unit||zx(i.minUnit,s,r,this._getLabelCapacity(s)),c=nt(a.ticks.stepSize,1),o=l==="week"?i.isoWeekday:!1,d=Wl(o)||o===!0,f={};let u=s,h,x;if(d&&(u=+e.startOf(u,"isoWeek",o)),u=+e.startOf(u,d?"day":l),e.diff(r,s,l)>1e5*c)throw new Error(s+" and "+r+" are too far apart with stepSize of "+c+" "+l);const m=a.ticks.source==="data"&&this.getDataTimestamps();for(h=u,x=0;h<r;h=+e.add(h,c,l),x++)Hx(f,h,m);return(h===r||a.bounds==="ticks"||x===1)&&Hx(f,h,m),Object.keys(f).sort(Wx).map(p=>+p)}getLabelForValue(e){const s=this._adapter,r=this.options.time;return r.tooltipFormat?s.format(e,r.tooltipFormat):s.format(e,r.displayFormats.datetime)}format(e,s){const a=this.options.time.displayFormats,i=this._unit,l=s||a[i];return this._adapter.format(e,l)}_tickFormatFunction(e,s,r,a){const i=this.options,l=i.ticks.callback;if(l)return At(l,[e,s,r],this);const c=i.time.displayFormats,o=this._unit,d=this._majorUnit,f=o&&c[o],u=d&&c[d],h=r[s],x=d&&u&&h&&h.major;return this._adapter.format(e,a||(x?u:f))}generateTickLabels(e){let s,r,a;for(s=0,r=e.length;s<r;++s)a=e[s],a.label=this._tickFormatFunction(a.value,s,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const s=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((s.start+r)*s.factor)}getValueForPixel(e){const s=this._offsets,r=this.getDecimalForPixel(e)/s.factor-s.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const s=this.options.ticks,r=this.ctx.measureText(e).width,a=sa(this.isHorizontal()?s.maxRotation:s.minRotation),i=Math.cos(a),l=Math.sin(a),c=this._resolveTickFontOptions(0).size;return{w:r*i+c*l,h:r*l+c*i}}_getLabelCapacity(e){const s=this.options.time,r=s.displayFormats,a=r[s.unit]||r.millisecond,i=this._tickFormatFunction(e,0,Gx(this,[e],this._majorUnit),a),l=this._getLabelSize(i),c=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],s,r;if(e.length)return e;const a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(s=0,r=a.length;s<r;++s)e=e.concat(a[s].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let s,r;if(e.length)return e;const a=this.getLabels();for(s=0,r=a.length;s<r;++s)e.push(Vx(this,a[s]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return qv(e.sort(Wx))}}Re(zo,"id","time"),Re(zo,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Uc(t,e,s){let r=0,a=t.length-1,i,l,c,o;s?(e>=t[r].pos&&e<=t[a].pos&&({lo:r,hi:a}=jn(t,"pos",e)),{pos:i,time:c}=t[r],{pos:l,time:o}=t[a]):(e>=t[r].time&&e<=t[a].time&&({lo:r,hi:a}=jn(t,"time",e)),{time:i,pos:c}=t[r],{time:l,pos:o}=t[a]);const d=l-i;return d?c+(o-c)*(e-i)/d:c}class Xx extends zo{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),s=this._table=this.buildLookupTable(e);this._minPos=Uc(s,this.min),this._tableRange=Uc(s,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:s,max:r}=this,a=[],i=[];let l,c,o,d,f;for(l=0,c=e.length;l<c;++l)d=e[l],d>=s&&d<=r&&a.push(d);if(a.length<2)return[{time:s,pos:0},{time:r,pos:1}];for(l=0,c=a.length;l<c;++l)f=a[l+1],o=a[l-1],d=a[l],Math.round((f+o)/2)!==d&&i.push({time:d,pos:l/(c-1)});return i}_generate(){const e=this.min,s=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(s)||r.length===1)&&r.push(s),r.sort((a,i)=>a-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const s=this.getDataTimestamps(),r=this.getLabelTimestamps();return s.length&&r.length?e=this.normalize(s.concat(r)):e=s.length?s:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Uc(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const s=this._offsets,r=this.getDecimalForPixel(e)/s.factor-s.end;return Uc(this._table,r*this._tableRange+this._minPos,!0)}}Re(Xx,"id","timeseries"),Re(Xx,"defaults",zo.defaults);const Ey="label";function qx(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function lM(t,e){const s=t.options;s&&e&&Object.assign(s,e)}function Ty(t,e){t.labels=e}function Cy(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ey;const r=[];t.datasets=e.map(a=>{const i=t.datasets.find(l=>l[s]===a[s]);return!i||!a.data||r.includes(i)?{...a}:(r.push(i),Object.assign(i,a),i)})}function cM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ey;const s={labels:[],datasets:[]};return Ty(s,t.labels),Cy(s,t.datasets,e),s}function oM(t,e){const{height:s=150,width:r=300,redraw:a=!1,datasetIdKey:i,type:l,data:c,options:o,plugins:d=[],fallbackContent:f,updateMode:u,...h}=t,x=G.useRef(null),m=G.useRef(null),p=()=>{x.current&&(m.current=new fa(x.current,{type:l,data:cM(c,i),options:o&&{...o},plugins:d}),qx(e,m.current))},v=()=>{qx(e,null),m.current&&(m.current.destroy(),m.current=null)};return G.useEffect(()=>{!a&&m.current&&o&&lM(m.current,o)},[a,o]),G.useEffect(()=>{!a&&m.current&&Ty(m.current.config.data,c.labels)},[a,c.labels]),G.useEffect(()=>{!a&&m.current&&c.datasets&&Cy(m.current.config.data,c.datasets,i)},[a,c.datasets]),G.useEffect(()=>{m.current&&(a?(v(),setTimeout(p)):m.current.update(u))},[a,o,c.labels,c.datasets,u]),G.useEffect(()=>{m.current&&(v(),setTimeout(p))},[l]),G.useEffect(()=>(p(),()=>v()),[]),at.createElement("canvas",{ref:x,role:"img",height:s,width:r,...h},f)}const dM=G.forwardRef(oM);function Sd(t,e){return fa.register(e),G.forwardRef((s,r)=>at.createElement(dM,{...s,ref:r,type:t}))}const Ed=Sd("line",so),Fa=Sd("bar",to),Yx=Sd("radar",ro),uc=Sd("doughnut",nl);fa.register(Ca,Aa,na,ti,si,ei,Rr);const fM=()=>{const t=vt(),{teacherAnalytics:e,loading:s}=ge(f=>f.analytics),{user:r}=ge(f=>f.auth),{subjects:a}=ge(f=>f.subjects);G.useEffect(()=>{r!=null&&r.id&&t(cl(r.id)),t(It())},[t,r]);const i=a.filter(f=>f.teacher_id===(r==null?void 0:r.id));if(s)return n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})});if(!e)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(gt,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:"No analytics data available"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Configure exams and enter marks to see analytics"})]});const l={labels:["Average Performance","Pass Rate","Top Performers","At Risk"],datasets:[{label:"Class Statistics",data:[e.class_performance.average_percentage,e.class_performance.pass_rate,e.class_performance.top_performers,e.class_performance.at_risk_students],backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(34, 197, 94, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:["rgba(59, 130, 246, 1)","rgba(34, 197, 94, 1)","rgba(245, 158, 11, 1)","rgba(239, 68, 68, 1)"],borderWidth:1}]},c={labels:Object.keys(e.co_po_attainment.co_attainment),datasets:[{data:Object.values(e.co_po_attainment.co_attainment),backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(34, 197, 94, 0.8)","rgba(245, 158, 11, 0.8)","rgba(139, 92, 246, 0.8)","rgba(239, 68, 68, 0.8)","rgba(6, 182, 212, 0.8)"],borderColor:["rgba(59, 130, 246, 1)","rgba(34, 197, 94, 1)","rgba(245, 158, 11, 1)","rgba(139, 92, 246, 1)","rgba(239, 68, 68, 1)","rgba(6, 182, 212, 1)"],borderWidth:2}]},o={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:100}}},d={responsive:!0,plugins:{legend:{position:"bottom"}}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teaching Analytics"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:n.jsx(Pt,{className:"h-6 w-6 text-blue-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Average Performance"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[e.class_performance.average_percentage.toFixed(1),"%"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:n.jsx(Ot,{className:"h-6 w-6 text-green-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pass Rate"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[e.class_performance.pass_rate.toFixed(1),"%"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:n.jsx(Mt,{className:"h-6 w-6 text-yellow-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Top Performers"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.class_performance.top_performers})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-red-100 p-3 rounded-lg",children:n.jsx(Cs,{className:"h-6 w-6 text-red-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"At Risk Students"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.class_performance.at_risk_students})]})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Class Performance Overview"}),n.jsx("div",{className:"h-64",children:n.jsx(Fa,{data:l,options:o})})]}),Object.keys(e.co_po_attainment.co_attainment).length>0&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"CO Attainment"}),n.jsx("div",{className:"h-64",children:n.jsx(uc,{data:c,options:d})})]})]}),e.question_analysis.length>0&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Question-wise Analysis"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Question"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Max Marks"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Avg Marks"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Success Rate"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Attempt Rate"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Difficulty"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Section"})]})}),n.jsx("tbody",{children:e.question_analysis.map((f,u)=>n.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[n.jsxs("td",{className:"py-3 px-4 font-medium text-gray-900",children:["Q",f.question_id]}),n.jsx("td",{className:"py-3 px-4 text-center",children:"10"}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:`font-semibold ${f.average_marks/10>=.7?"text-green-600":f.average_marks/10>=.5?"text-yellow-600":"text-red-600"}`,children:f.average_marks})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-semibold ${f.success_rate>=70?"text-green-600":f.success_rate>=50?"text-yellow-600":"text-red-600"}`,children:[f.success_rate,"%"]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:"font-semibold",children:[f.attempt_rate,"%"]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${f.success_rate>=80?"bg-green-100 text-green-800":f.success_rate>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:f.success_rate>=80?"Easy":f.success_rate>=60?"Medium":"Hard"})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs font-medium",children:"A"})})]},u))})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Subjects"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(f=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[n.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:n.jsx(gt,{className:"h-5 w-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900",children:f.name}),n.jsx("p",{className:"text-sm text-gray-600",children:f.code})]})]}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Credits:"}),n.jsx("span",{className:"font-medium",children:f.credits})]}),f.cos&&f.cos.length>0&&n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"COs:"}),n.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:f.cos.map((u,h)=>n.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs",children:u},h))})]})]})]},f.id))})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Key Insights"}),n.jsxs("div",{className:"space-y-3",children:[e.class_performance.average_percentage>=75&&n.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[n.jsx(Ot,{size:16}),n.jsx("span",{className:"text-sm",children:"Strong overall class performance"})]}),e.class_performance.pass_rate>=85&&n.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[n.jsx(Ot,{size:16}),n.jsx("span",{className:"text-sm",children:"Excellent pass rate achieved"})]}),e.class_performance.top_performers>=5&&n.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[n.jsx(Mt,{size:16}),n.jsx("span",{className:"text-sm",children:"Good number of top performers"})]}),e.class_performance.at_risk_students>0&&n.jsxs("div",{className:"flex items-center space-x-2 text-amber-600",children:[n.jsx(Cs,{size:16}),n.jsxs("span",{className:"text-sm",children:[e.class_performance.at_risk_students," students need attention"]})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Action Items"}),n.jsxs("div",{className:"space-y-3",children:[e.class_performance.at_risk_students>0&&n.jsxs("div",{className:"p-3 bg-red-50 border-l-4 border-red-400 rounded",children:[n.jsx("p",{className:"text-sm font-medium text-red-800",children:"Schedule remedial sessions"}),n.jsx("p",{className:"text-xs text-red-600",children:"Focus on students below 50% performance"})]}),e.question_analysis.some(f=>f.success_rate<50)&&n.jsxs("div",{className:"p-3 bg-yellow-50 border-l-4 border-yellow-400 rounded",children:[n.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Review difficult questions"}),n.jsx("p",{className:"text-xs text-yellow-600",children:"Consider additional practice materials"})]}),n.jsxs("div",{className:"p-3 bg-blue-50 border-l-4 border-blue-400 rounded",children:[n.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Continue effective methods"}),n.jsx("p",{className:"text-xs text-blue-600",children:"Maintain current teaching strategies"})]})]})]})]})]})},uM=()=>{const t=vt(),{subjects:e}=ge(x=>x.subjects),{user:s}=ge(x=>x.auth),{subjectAttainment:r,subjectAttainmentLoading:a,subjectAttainmentError:i,selectedSubjectId:l}=ge(x=>x.copo),[c,o]=G.useState(""),d=G.useMemo(()=>e.filter(x=>x.teacher_id===(s==null?void 0:s.id)),[e,s==null?void 0:s.id]);G.useEffect(()=>{t(It())},[t]),G.useEffect(()=>{if(l){if(!d.some(m=>m.id===l)){t(wo(0));return}t(Qc({subjectId:l,examType:c}))}},[t,l,c,d]);const f=x=>{t(wo(x))},u=x=>{switch(x){case"L1":return"bg-yellow-100 text-yellow-800";case"L2":return"bg-blue-100 text-blue-800";case"L3":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},h=x=>x>0?"text-green-600":x<0?"text-red-600":"text-gray-600";return n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Attainment Analytics"}),n.jsx("p",{className:"text-gray-600",children:"Analyze CO/PO attainment and performance metrics"})]}),n.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Subject"}),n.jsxs("select",{value:l||"",onChange:x=>f(Number(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Choose a subject..."}),d.map(x=>n.jsxs("option",{value:x.id,children:[x.name," (",x.code,")"]},x.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exam Type (Optional)"}),n.jsxs("select",{value:c,onChange:x=>o(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Exams"}),n.jsx("option",{value:"internal1",children:"Internal 1"}),n.jsx("option",{value:"internal2",children:"Internal 2"}),n.jsx("option",{value:"final",children:"Final"})]})]})]}),i&&n.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:n.jsx("p",{className:"text-red-600",children:i})}),a&&n.jsxs("div",{className:"p-6 text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),n.jsx("p",{className:"mt-2 text-gray-600",children:"Loading attainment analytics..."})]}),r&&!a&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[n.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:[r.subject_name," - Attainment Overview"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"CO Coverage"}),n.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[r.co_coverage,"%"]})]}),n.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"text-sm font-medium text-green-900",children:"Total COs"}),n.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.co_attainment.length})]}),n.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"text-sm font-medium text-purple-900",children:"Total POs"}),n.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r.po_attainment.length})]})]})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"CO Attainment Details"})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CO Code"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Target %"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actual %"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gap"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Coverage %"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Evidence"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.co_attainment.map((x,m)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:x.co_code}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[x.target_pct,"%"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[x.actual_pct.toFixed(1),"%"]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${u(x.level)}`,children:x.level})}),n.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${h(x.gap)}`,children:[x.gap>0?"+":"",x.gap.toFixed(1),"%"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[x.coverage,"%"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[x.evidence.length," questions"]})]},m))})]})})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"PO Attainment Details"})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PO Code"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Direct %"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Indirect %"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total %"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gap"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contributing COs"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.po_attainment.map((x,m)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:x.po_code}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[x.direct_pct.toFixed(1),"%"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[x.indirect_pct.toFixed(1),"%"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[x.total_pct.toFixed(1),"%"]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${u(x.level)}`,children:x.level})}),n.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${h(x.gap)}`,children:[x.gap>0?"+":"",x.gap.toFixed(1),"%"]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x.contributing_cos.join(", ")})]},m))})]})})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Bloom's Taxonomy Distribution"})}),n.jsx("div",{className:"p-6",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(r.blooms_distribution).map(([x,m])=>n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-900",children:x}),n.jsxs("p",{className:"text-2xl font-bold text-gray-600",children:[m.percentage,"%"]}),n.jsxs("p",{className:"text-xs text-gray-500",children:[m.count," questions (",m.marks," marks)"]})]},x))})})]}),n.jsxs("div",{className:"bg-white shadow rounded-lg",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Difficulty Mix"})}),n.jsx("div",{className:"p-6",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(r.difficulty_mix).map(([x,m])=>n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-900 capitalize",children:x}),n.jsxs("p",{className:"text-2xl font-bold text-gray-600",children:[m.percentage,"%"]}),n.jsxs("p",{className:"text-xs text-gray-500",children:[m.count," questions (",m.marks," marks)"]})]},x))})})]})]}),!l&&!a&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"text-gray-400 mb-4",children:n.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),d.length===0?n.jsxs(n.Fragment,{children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Subjects Assigned"}),n.jsx("p",{className:"text-gray-500",children:"You don't have any subjects assigned to you yet. Contact your administrator."})]}):n.jsxs(n.Fragment,{children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Subject Selected"}),n.jsx("p",{className:"text-gray-500",children:"Please select a subject to view attainment analytics."})]})]})]})};class hM extends at.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("ComprehensiveAnalytics Error:",e,s)}render(){return this.state.hasError?n.jsx("div",{className:"card text-center py-12",children:n.jsxs("div",{className:"text-red-500 mb-4",children:[n.jsx(gt,{className:"h-12 w-12 mx-auto mb-2"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Analytics"}),n.jsx("p",{className:"text-gray-600",children:"Something went wrong while loading the analytics data."}),n.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Reload Page"})]})}):this.props.children}}const mM=()=>{var E,A,H,V,L,P,J,Ee,Y,de,De,B,X,W,z,ae,me,xe,ue,oe,ze,F,ye,Ie,Le;const t=vt(),{subjects:e}=ge(K=>K.subjects),{user:s}=ge(K=>K.auth),[r,a]=G.useState(null),[i,l]=G.useState("all"),[c,o]=G.useState(!1),[d,f]=G.useState("overview"),[u,h]=G.useState(!1),[x,m]=G.useState({}),[p,v]=G.useState({}),[b,_]=G.useState({}),[g,j]=G.useState(null),[w,k]=G.useState([]),y=G.useMemo(()=>(e==null?void 0:e.filter(K=>K&&K.teacher_id===(s==null?void 0:s.id)))||[],[e,s==null?void 0:s.id]);G.useEffect(()=>{t(It())},[t]);const N=async()=>{if(r){o(!0);try{const[K,Z,Oe,Te,M]=await Promise.all([Qr.getCOAttainment(r,i),Qr.getPOAttainment(r,i),Qr.getStudentPerformance(r,void 0,i),Qr.getClassPerformance(r,i),Qr.getCOPOMapping(r)]);m(K||{}),v(Z||{}),_(Oe||{}),j(Te||null),k(M||[])}catch(K){console.error("Error fetching analytics data:",K)}finally{o(!1)}}};G.useEffect(()=>{r&&N()},[r,i]);const S=G.useMemo(()=>{const K=Object.values(x||{}),Z=Object.values(p||{}),Oe=Object.values(b||{});return{totalCOs:K.length,achievedCOs:K.filter(Te=>Te&&Te.status==="Achieved").length,totalPOs:Z.length,achievedPOs:Z.filter(Te=>Te&&Te.status==="Achieved").length,totalStudents:Oe.length,averageCOAttainment:K.length>0?K.reduce((Te,M)=>Te+((M==null?void 0:M.attainment)||0),0)/K.length:0,averagePOAttainment:Z.length>0?Z.reduce((Te,M)=>Te+((M==null?void 0:M.attainment)||0),0)/Z.length:0,averageStudentPerformance:Oe.length>0?Oe.reduce((Te,M)=>Te+((M==null?void 0:M.overall_percentage)||0),0)/Oe.length:0,classStats:g||{total_students:Oe.length,average_percentage:Oe.length>0?Oe.reduce((Te,M)=>Te+((M==null?void 0:M.overall_percentage)||0),0)/Oe.length:0,highest_percentage:Oe.length>0?Math.max(...Oe.map(Te=>(Te==null?void 0:Te.overall_percentage)||0)):0,lowest_percentage:Oe.length>0?Math.min(...Oe.map(Te=>(Te==null?void 0:Te.overall_percentage)||0)):0,pass_rate:Oe.length>0?Oe.filter(Te=>((Te==null?void 0:Te.overall_percentage)||0)>=40).length/Oe.length*100:0,grade_distribution:{},performance_trends:{},student_rankings:Oe.sort((Te,M)=>((M==null?void 0:M.overall_percentage)||0)-((Te==null?void 0:Te.overall_percentage)||0))}}},[x,p,g,b]),T=()=>{var M;const K={subject:((M=y==null?void 0:y.find(q=>q&&q.id===r))==null?void 0:M.name)||"Unknown Subject",examType:i,generatedAt:new Date().toISOString(),coAttainment:x,poAttainment:p,studentPerformance:b,classPerformance:g,coPoMapping:w},Z=new Blob([JSON.stringify(K,null,2)],{type:"application/json"}),Oe=URL.createObjectURL(Z),Te=document.createElement("a");Te.href=Oe,Te.download=`analytics-report-${r}-${i}.json`,document.body.appendChild(Te),Te.click(),document.body.removeChild(Te),URL.revokeObjectURL(Oe)};return y.length===0?n.jsxs("div",{className:"text-center py-12",children:[n.jsx(gt,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Subjects Assigned"}),n.jsx("p",{className:"text-gray-600",children:"You don't have any subjects assigned to view analytics."})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Comprehensive Analytics"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Detailed CO/PO attainment and performance analysis"})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("button",{onClick:N,disabled:c||!r,className:"btn-secondary flex items-center space-x-2",children:[n.jsx(S0,{className:`w-4 h-4 ${c?"animate-spin":""}`}),n.jsx("span",{children:"Refresh"})]}),n.jsxs("button",{onClick:T,disabled:!r,className:"btn-primary flex items-center space-x-2",children:[n.jsx(kr,{className:"w-4 h-4"}),n.jsx("span",{children:"Export Report"})]})]})]}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),n.jsxs("select",{value:r||"",onChange:K=>a(Number(K.target.value)||null),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Select a subject"}),y.map(K=>n.jsxs("option",{value:K.id,children:[K.name," (",K.code,")"]},K.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exam Type"}),n.jsxs("select",{value:i,onChange:K=>l(K.target.value),className:"input-field w-full",children:[n.jsx("option",{value:"all",children:"All Exams"}),n.jsx("option",{value:"midterm",children:"Midterm"}),n.jsx("option",{value:"final",children:"Final"}),n.jsx("option",{value:"quiz",children:"Quiz"}),n.jsx("option",{value:"assignment",children:"Assignment"})]})]})]})}),r?c?n.jsxs("div",{className:"card text-center py-12",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-blue-600 border-t-transparent mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading analytics data..."}),n.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Fetching CO/PO attainment, student performance, and class analytics..."})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"card mb-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"text-md font-medium text-gray-700",children:"Data Status"}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${Object.keys(x||{}).length>0?"bg-green-500":"bg-gray-300"}`}),n.jsxs("span",{className:"text-sm text-gray-600",children:["CO Data (",Object.keys(x||{}).length,")"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${Object.keys(p||{}).length>0?"bg-green-500":"bg-gray-300"}`}),n.jsxs("span",{className:"text-sm text-gray-600",children:["PO Data (",Object.keys(p||{}).length,")"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${Object.keys(b||{}).length>0?"bg-green-500":"bg-gray-300"}`}),n.jsxs("span",{className:"text-sm text-gray-600",children:["Students (",Object.keys(b||{}).length,")"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${w&&w.length>0?"bg-green-500":"bg-gray-300"}`}),n.jsxs("span",{className:"text-sm text-gray-600",children:["CO-PO Mapping (",(w==null?void 0:w.length)||0,")"]})]})]})]})}),S&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Rt,{className:"w-8 h-8 text-blue-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"CO Attainment"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[S.achievedCOs,"/",S.totalCOs]}),n.jsxs("p",{className:"text-xs text-gray-500",children:[((E=S.averageCOAttainment)==null?void 0:E.toFixed(1))||"0.0","% avg"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Mt,{className:"w-8 h-8 text-green-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"PO Attainment"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[S.achievedPOs,"/",S.totalPOs]}),n.jsxs("p",{className:"text-xs text-gray-500",children:[((A=S.averagePOAttainment)==null?void 0:A.toFixed(1))||"0.0","% avg"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Ct,{className:"w-8 h-8 text-purple-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Class Performance"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[((V=(H=S.classStats)==null?void 0:H.average_percentage)==null?void 0:V.toFixed(1))||"0.0","%"]}),n.jsxs("p",{className:"text-xs text-gray-500",children:[((P=(L=S.classStats)==null?void 0:L.pass_rate)==null?void 0:P.toFixed(1))||"0.0","% pass rate"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Pt,{className:"w-8 h-8 text-orange-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Students"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((J=S.classStats)==null?void 0:J.total_students)||0}),n.jsxs("p",{className:"text-xs text-gray-500",children:[((Y=(Ee=S.classStats)==null?void 0:Ee.highest_percentage)==null?void 0:Y.toFixed(1))||"0.0","% highest"]})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",name:"Overview",icon:rs},{id:"co",name:"CO Analysis",icon:Rt},{id:"po",name:"PO Analysis",icon:Mt},{id:"students",name:"Student Performance",icon:Ct},{id:"class",name:"Class Analysis",icon:Pt}].map(K=>n.jsxs("button",{onClick:()=>f(K.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${d===K.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(K.icon,{className:"w-4 h-4"}),n.jsx("span",{children:K.name})]},K.id))})}),n.jsxs("div",{className:"p-6",children:[d==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Analytics Overview"}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm text-gray-500",children:"Exam Type:"}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-md text-sm font-medium",children:i==="all"?"All Exams":i.charAt(0).toUpperCase()+i.slice(1)})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"CO-PO Mapping Matrix"}),w&&w.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-600",children:"CO"}),Object.keys(p||{}).map(K=>n.jsx("th",{className:"text-center py-2 px-3 font-medium text-gray-600",children:K},K))]})}),n.jsx("tbody",{children:(()=>{var K;try{return((K=w==null?void 0:w.filter(Z=>Z&&Z.co_code))==null?void 0:K.map(Z=>n.jsxs("tr",{className:"border-b border-gray-100",children:[n.jsx("td",{className:"py-2 px-3 font-medium text-gray-900",children:(Z==null?void 0:Z.co_code)||"N/A"}),Object.keys(p||{}).map(Oe=>{var Te;try{const M=(Te=Z==null?void 0:Z.mapped_pos)==null?void 0:Te.find(q=>q&&q.po_code===Oe);return n.jsx("td",{className:"text-center py-2 px-3",children:M?n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${M.strength===3?"bg-red-100 text-red-800":M.strength===2?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:M.strength}):n.jsx("span",{className:"text-gray-300",children:"-"})},Oe)}catch(M){return console.error("Error rendering PO mapping:",M),n.jsx("td",{className:"text-center py-2 px-3",children:n.jsx("span",{className:"text-gray-300",children:"-"})},Oe)}})]},(Z==null?void 0:Z.co_code)||"unknown")))||[]}catch(Z){return console.error("Error rendering CO-PO mapping:",Z),n.jsx("tr",{children:n.jsx("td",{colSpan:Object.keys(p||{}).length+1,className:"text-center py-4 text-gray-500",children:"Error loading CO-PO mapping data"})})}})()})]})}):n.jsx("div",{className:"text-center py-8 text-gray-500",children:n.jsx("p",{children:"No CO-PO mapping data available"})})]}),g&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"Grade Distribution"}),n.jsx("div",{className:"grid grid-cols-7 gap-2",children:Object.entries((g==null?void 0:g.grade_distribution)||{}).map(([K,Z])=>n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:`text-2xl font-bold ${K==="A+"?"text-green-600":K==="A"?"text-blue-600":K==="B+"?"text-yellow-600":K==="B"?"text-orange-600":K==="C+"?"text-red-600":K==="C"?"text-red-700":"text-gray-600"}`,children:Z}),n.jsxs("div",{className:"text-xs text-gray-600",children:["Grade ",K]})]},K))})]})]}),d==="co"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Outcome (CO) Analysis"}),n.jsxs("button",{onClick:()=>h(!u),className:"flex items-center space-x-2 px-3 py-1 text-sm bg-blue-50 text-blue-600 rounded-md hover:bg-blue-100 transition-colors",children:[u?n.jsx(xi,{size:16}):n.jsx(pi,{size:16}),n.jsx("span",{children:u?"Hide Details":"Show Details"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Rt,{className:"w-8 h-8 text-blue-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total COs"}),n.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Object.keys(x||{}).length})]})]})}),n.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Mt,{className:"w-8 h-8 text-green-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Achieved COs"}),n.jsx("p",{className:"text-2xl font-bold text-green-900",children:Object.values(x||{}).filter(K=>K&&K.status==="Achieved").length})]})]})}),n.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Pt,{className:"w-8 h-8 text-purple-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Avg Attainment"}),n.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[((de=S==null?void 0:S.averageCOAttainment)==null?void 0:de.toFixed(1))||"0.0","%"]})]})]})}),n.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(rs,{className:"w-8 h-8 text-orange-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Target Achievement"}),n.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[Object.values(x||{}).length>0?Math.round(Object.values(x||{}).filter(K=>K&&K.status==="Achieved").length/Object.values(x||{}).length*100):0,"%"]})]})]})})]}),n.jsx("div",{className:"space-y-4",children:Object.entries(x||{}).map(([K,Z])=>{const Oe=Z.target-Z.attainment,Te=Oe>20?"High":Oe>10?"Medium":"Low",M=Z.exam_details&&Z.exam_details.length>1?Z.exam_details[Z.exam_details.length-1].attainment>Z.exam_details[0].attainment?"Improving":"Declining":"Stable";return n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-semibold text-gray-900 text-lg",children:K}),n.jsx("p",{className:"text-gray-600 mt-1",children:Z.co_title}),n.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[n.jsxs("span",{className:"text-sm text-gray-500",children:["Target: ",Z.target,"%"]}),n.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Te==="High"?"bg-red-100 text-red-800":Te==="Medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[Te," Priority"]}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${M==="Improving"?"bg-green-100 text-green-800":M==="Declining"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:M})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:`text-3xl font-bold ${Z.status==="Achieved"?"text-green-600":"text-red-600"}`,children:[Z.attainment.toFixed(1),"%"]}),n.jsx("div",{className:`text-sm font-medium ${Z.status==="Achieved"?"text-green-600":"text-red-600"}`,children:Z.status}),Oe>0&&n.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Gap: ",Oe.toFixed(1),"%"]})]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-4",children:n.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${Z.status==="Achieved"?"bg-green-500":"bg-red-500"}`,style:{width:`${Math.min(Z.attainment,100)}%`}})}),u&&Z.exam_details&&Z.exam_details.length>0&&n.jsxs("div",{className:"mt-6 space-y-4",children:[n.jsxs("h5",{className:"font-semibold text-gray-700 flex items-center",children:[n.jsx(rs,{className:"w-4 h-4 mr-2"}),"Exam-wise Performance"]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Z.exam_details.map((q,Q)=>n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("span",{className:"font-medium text-sm text-gray-700",children:q.exam_name}),n.jsxs("span",{className:`text-sm font-bold ${q.attainment>=70?"text-green-600":"text-red-600"}`,children:[q.attainment.toFixed(1),"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full ${q.attainment>=70?"bg-green-500":"bg-red-500"}`,style:{width:`${Math.min(q.attainment,100)}%`}})})]},Q))})]}),Oe>0&&n.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[n.jsx("h6",{className:"font-medium text-yellow-800 mb-2",children:"Recommendations:"}),n.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[Te==="High"&&n.jsxs(n.Fragment,{children:[n.jsx("li",{children:" Conduct remedial classes for this CO"}),n.jsx("li",{children:" Review teaching methodology and materials"}),n.jsx("li",{children:" Provide additional practice exercises"})]}),Te==="Medium"&&n.jsxs(n.Fragment,{children:[n.jsx("li",{children:" Increase practice sessions"}),n.jsx("li",{children:" Review assessment methods"}),n.jsx("li",{children:" Provide targeted feedback"})]}),Te==="Low"&&n.jsxs(n.Fragment,{children:[n.jsx("li",{children:" Monitor progress closely"}),n.jsx("li",{children:" Provide additional support if needed"})]})]})]})]},K)})})]}),d==="po"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Program Outcome (PO) Analysis"}),n.jsxs("button",{onClick:()=>h(!u),className:"flex items-center space-x-2 px-3 py-1 text-sm bg-blue-50 text-blue-600 rounded-md hover:bg-blue-100 transition-colors",children:[u?n.jsx(xi,{size:16}):n.jsx(pi,{size:16}),n.jsx("span",{children:u?"Hide Details":"Show Details"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-indigo-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Mt,{className:"w-8 h-8 text-indigo-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-indigo-600 font-medium",children:"Total POs"}),n.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:Object.keys(p||{}).length})]})]})}),n.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Rt,{className:"w-8 h-8 text-green-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Achieved POs"}),n.jsx("p",{className:"text-2xl font-bold text-green-900",children:Object.values(p||{}).filter(K=>K&&K.status==="Achieved").length})]})]})}),n.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Pt,{className:"w-8 h-8 text-purple-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Avg Attainment"}),n.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[((De=S==null?void 0:S.averagePOAttainment)==null?void 0:De.toFixed(1))||"0.0","%"]})]})]})}),n.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(rs,{className:"w-8 h-8 text-orange-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Target Achievement"}),n.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[Object.values(p||{}).length>0?Math.round(Object.values(p||{}).filter(K=>K&&K.status==="Achieved").length/Object.values(p||{}).length*100):0,"%"]})]})]})})]}),n.jsx("div",{className:"space-y-4",children:Object.entries(p||{}).map(([K,Z])=>{const Oe=70-Z.attainment,Te=Oe>20?"High":Oe>10?"Medium":"Low",M=Z.mapped_cos?Z.mapped_cos.length:0,q=Z.mapped_cos?Z.mapped_cos.filter(Q=>Q&&Q.attainment>=70).length:0;return n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-semibold text-gray-900 text-lg",children:K}),n.jsxs("p",{className:"text-gray-600 mt-1",children:["Mapped COs: ",Z.mapped_cos?Z.mapped_cos.map(Q=>(Q==null?void 0:Q.co_code)||"N/A").join(", "):"None"]}),n.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[n.jsx("span",{className:"text-sm text-gray-500",children:"Target: 70%"}),n.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Te==="High"?"bg-red-100 text-red-800":Te==="Medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[Te," Priority"]}),n.jsxs("span",{className:"text-sm text-gray-500",children:["COs: ",q,"/",M," Strong"]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:`text-3xl font-bold ${Z.status==="Achieved"?"text-green-600":"text-red-600"}`,children:[Z.attainment.toFixed(1),"%"]}),n.jsx("div",{className:`text-sm font-medium ${Z.status==="Achieved"?"text-green-600":"text-red-600"}`,children:Z.status}),Oe>0&&n.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Gap: ",Oe.toFixed(1),"%"]})]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-4",children:n.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${Z.status==="Achieved"?"bg-green-500":"bg-red-500"}`,style:{width:`${Math.min(Z.attainment,100)}%`}})}),u&&Z.mapped_cos&&Z.mapped_cos.length>0&&n.jsxs("div",{className:"mt-6 space-y-4",children:[n.jsxs("h5",{className:"font-semibold text-gray-700 flex items-center",children:[n.jsx(rs,{className:"w-4 h-4 mr-2"}),"Contributing COs"]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(Z.mapped_cos||[]).map((Q,_e)=>n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("span",{className:"font-medium text-sm text-gray-700",children:Q.co_code}),n.jsxs("span",{className:`text-sm font-bold ${Q.attainment>=70?"text-green-600":"text-red-600"}`,children:[Q.attainment.toFixed(1),"%"]})]}),n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsxs("span",{className:"text-xs text-gray-500",children:["Strength: ",Q.strength||"Medium"]}),n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${Q.attainment>=70?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Q.attainment>=70?"Strong":"Weak"})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full ${Q.attainment>=70?"bg-green-500":"bg-red-500"}`,style:{width:`${Math.min(Q.attainment,100)}%`}})})]},_e))})]}),Oe>0&&n.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[n.jsx("h6",{className:"font-medium text-yellow-800 mb-2",children:"Recommendations:"}),n.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[Te==="High"&&n.jsxs(n.Fragment,{children:[n.jsx("li",{children:" Focus on improving weak contributing COs"}),n.jsx("li",{children:" Review CO-PO mapping weights"}),n.jsx("li",{children:" Conduct comprehensive assessment"})]}),Te==="Medium"&&n.jsxs(n.Fragment,{children:[n.jsx("li",{children:" Strengthen contributing COs"}),n.jsx("li",{children:" Review assessment strategies"}),n.jsx("li",{children:" Provide targeted support"})]}),Te==="Low"&&n.jsxs(n.Fragment,{children:[n.jsx("li",{children:" Monitor PO progress closely"}),n.jsx("li",{children:" Maintain current CO performance"})]})]})]})]},K)})})]}),d==="students"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Student Performance Analysis"}),n.jsxs("button",{onClick:()=>h(!u),className:"btn-secondary flex items-center space-x-2",children:[u?n.jsx(xi,{className:"w-4 h-4"}):n.jsx(pi,{className:"w-4 h-4"}),n.jsxs("span",{children:[u?"Hide":"Show"," Details"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Ct,{className:"w-8 h-8 text-blue-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Students"}),n.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(S==null?void 0:S.totalStudents)||0})]})]})}),n.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Pt,{className:"w-8 h-8 text-green-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Average Score"}),n.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[((B=S==null?void 0:S.averageStudentPerformance)==null?void 0:B.toFixed(1))||"0.0","%"]})]})]})}),n.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Mt,{className:"w-8 h-8 text-purple-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Pass Rate"}),n.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[((W=(X=S==null?void 0:S.classStats)==null?void 0:X.pass_rate)==null?void 0:W.toFixed(1))||"0.0","%"]})]})]})}),n.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(rs,{className:"w-8 h-8 text-orange-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Highest Score"}),n.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[((ae=(z=S==null?void 0:S.classStats)==null?void 0:z.highest_percentage)==null?void 0:ae.toFixed(1))||"0.0","%"]})]})]})})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Student"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Overall %"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Grade"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Marks"}),u&&n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Exam Details"})]})}),n.jsx("tbody",{children:Object.values(b||{}).filter(K=>K&&typeof K.overall_percentage=="number").sort((K,Z)=>Z.overall_percentage-K.overall_percentage).map(K=>n.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[n.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:K.student_name}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-medium ${K.overall_percentage>=80?"text-green-600":K.overall_percentage>=60?"text-yellow-600":"text-red-600"}`,children:[K.overall_percentage.toFixed(1),"%"]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${K.grade==="A+"?"bg-green-100 text-green-800":K.grade==="A"?"bg-blue-100 text-blue-800":K.grade==="B+"?"bg-yellow-100 text-yellow-800":K.grade==="B"?"bg-orange-100 text-orange-800":K.grade==="C+"?"bg-red-100 text-red-800":K.grade==="C"?"bg-red-200 text-red-900":"bg-gray-100 text-gray-800"}`,children:K.grade})}),n.jsxs("td",{className:"py-3 px-4 text-center text-sm text-gray-600",children:[K.total_obtained.toFixed(1),"/",K.total_possible.toFixed(1)]}),u&&n.jsx("td",{className:"py-3 px-4",children:n.jsx("div",{className:"space-y-1",children:(K.exam_details||[]).map((Z,Oe)=>n.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[n.jsx("span",{children:Z.exam_name}),n.jsxs("span",{children:[Z.percentage.toFixed(1),"%"]})]},Oe))})})]},K.student_id))})]})})]}),d==="class"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Class Performance Analysis"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[((me=g==null?void 0:g.average_percentage)==null?void 0:me.toFixed(1))||"0.0","%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"Class Average"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-green-600 mb-2",children:[((xe=g==null?void 0:g.pass_rate)==null?void 0:xe.toFixed(1))||"0.0","%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"Pass Rate"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:((ue=S==null?void 0:S.classStats)==null?void 0:ue.total_students)||0}),n.jsx("div",{className:"text-sm text-gray-600",children:"Total Students"})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:[((ze=(oe=S==null?void 0:S.classStats)==null?void 0:oe.highest_percentage)==null?void 0:ze.toFixed(1))||"0.0","%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"Highest Score"})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"Performance Range"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Highest Score"}),n.jsxs("span",{className:"font-medium text-green-600",children:[((F=g==null?void 0:g.highest_percentage)==null?void 0:F.toFixed(1))||"0.0","%"]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Lowest Score"}),n.jsxs("span",{className:"font-medium text-red-600",children:[((ye=g==null?void 0:g.lowest_percentage)==null?void 0:ye.toFixed(1))||"0.0","%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"bg-gradient-to-r from-red-500 via-yellow-500 to-green-500 h-2 rounded-full",style:{width:"100%",background:`linear-gradient(to right, 
                              red 0%, 
                              red ${g?g.lowest_percentage/g.highest_percentage*100:0}%, 
                              yellow ${g?50/g.highest_percentage*100:0}%, 
                              green ${g?80/g.highest_percentage*100:0}%, 
                              green 100%)`}})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"Top Performers"}),n.jsx("div",{className:"space-y-2",children:(Le=(Ie=g==null?void 0:g.student_rankings)==null?void 0:Ie.slice(0,5))==null?void 0:Le.map((K,Z)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold text-white ${Z===0?"bg-yellow-500":Z===1?"bg-gray-400":Z===2?"bg-orange-500":"bg-blue-500"}`,children:Z+1}),n.jsx("span",{className:"font-medium text-gray-900",children:K.student_name})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"font-medium text-gray-900",children:[K.overall_percentage.toFixed(1),"%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:K.grade})]})]},K.student_id))})]})]})]})]})]}):n.jsxs("div",{className:"card text-center py-12",children:[n.jsx(rs,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Subject"}),n.jsx("p",{className:"text-gray-600",children:"Choose a subject to view comprehensive analytics."})]})]})},xM=()=>n.jsx(hM,{children:n.jsx(mM,{})}),pM=()=>{const t=vt(),{subjects:e}=ge(V=>V.subjects),{user:s}=ge(V=>V.auth),[r,a]=G.useState(null),[i,l]=G.useState(null),[c,o]=G.useState({examType:"all",dateRange:"all",includeCharts:!0,includeDetails:!0,includeRecommendations:!0}),[d,f]=G.useState(!1),[u,h]=G.useState([]),[x,m]=G.useState(!1),[p,v]=G.useState([]),[b,_]=G.useState(!1);G.useState(null);const[g,j]=G.useState(""),w=G.useMemo(()=>e.filter(V=>V.teacher_id===(s==null?void 0:s.id)),[e,s==null?void 0:s.id]),k=V=>({student_performance:Ct,co_po_attainment:Rt,teacher_performance:Mt,class_analytics:rs,comprehensive:Fr,grade_distribution:sp,performance_trends:Pt,raw_data:ub})[V]||Fr,y=V=>({student_performance:"purple",co_po_attainment:"blue",teacher_performance:"green",class_analytics:"orange",comprehensive:"indigo",grade_distribution:"pink",performance_trends:"teal",raw_data:"gray"})[V]||"blue";G.useEffect(()=>{t(It()),S(),N()},[t]);const N=async()=>{_(!0);try{const L=(await gi.getTemplates()).map(P=>({id:P.id,name:P.name,description:P.description,category:P.id.includes("attainment")?"attainment":P.id.includes("performance")?"performance":"academic",format:P.id.includes("raw")?"json":"pdf",icon:k(P.id),color:y(P.id),filters:P.filters||[]}));v(L)}catch(V){console.error("Error fetching report templates:",V)}finally{_(!1)}},S=()=>{const V=localStorage.getItem("generatedReports");V&&h(JSON.parse(V))},T=async()=>{if(!(!r||!i)){f(!0);try{const V={subject_id:r,exam_type:c.examType==="all"?void 0:c.examType,include_charts:c.includeCharts,include_details:c.includeDetails,include_recommendations:c.includeRecommendations},L=await gi.generateReport(i.id,V,i.format),P=new Blob([L],{type:i.format==="pdf"?"application/pdf":i.format==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv"}),J=window.URL.createObjectURL(P),Ee=document.createElement("a");Ee.href=J,Ee.download=`${i.name}_${new Date().toISOString().split("T")[0]}.${i.format}`,document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee),window.URL.revokeObjectURL(J);const Y={id:Date.now().toString(),name:i.name,type:i.id,format:i.format,generatedAt:new Date().toISOString(),size:P.size,status:"completed"};h(de=>[Y,...de]),j("Report generated successfully!")}catch(V){console.error("Error generating report:",V),j("Error generating report")}finally{f(!1)}}},E=async V=>{try{const L=await gi.downloadReport(V.downloadUrl),P=URL.createObjectURL(L),J=document.createElement("a");J.href=P,J.download=`${V.template.name}-${new Date(V.generatedAt).toISOString().split("T")[0]}.${V.template.format}`,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(P)}catch(L){console.error("Error downloading report:",L)}},A=V=>({academic:"bg-blue-100 text-blue-800",performance:"bg-green-100 text-green-800",attainment:"bg-purple-100 text-purple-800",comprehensive:"bg-indigo-100 text-indigo-800"})[V]||"bg-gray-100 text-gray-800",H=V=>({pdf:"bg-red-100 text-red-800",excel:"bg-green-100 text-green-800",json:"bg-yellow-100 text-yellow-800",csv:"bg-blue-100 text-blue-800"})[V]||"bg-gray-100 text-gray-800";return w.length===0?n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Fr,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Subjects Assigned"}),n.jsx("p",{className:"text-gray-600",children:"You don't have any subjects assigned to generate reports."})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Report Management"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Generate comprehensive reports for your subjects"})]}),n.jsx("div",{className:"flex items-center space-x-3",children:n.jsxs("button",{onClick:()=>m(!x),className:"btn-secondary flex items-center space-x-2",children:[x?n.jsx(xi,{className:"w-4 h-4"}):n.jsx(pi,{className:"w-4 h-4"}),n.jsxs("span",{children:[x?"Hide":"Show"," Preview"]})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Subject"}),n.jsxs("select",{value:r||"",onChange:V=>a(Number(V.target.value)||null),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"Choose a subject"}),w.map(V=>n.jsxs("option",{value:V.id,children:[V.name," (",V.code,")"]},V.id))]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Templates"}),b?n.jsxs("div",{className:"text-center py-8",children:[n.jsx(S0,{className:"h-8 w-8 text-gray-400 mx-auto mb-3 animate-spin"}),n.jsx("p",{className:"text-gray-600",children:"Loading report templates..."})]}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(V=>n.jsx("div",{onClick:()=>l(V),className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${(i==null?void 0:i.id)===V.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("div",{className:`p-2 rounded-lg bg-${V.color}-100`,children:n.jsx(V.icon,{className:`w-6 h-6 text-${V.color}-600`})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:V.name}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:V.description}),n.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${A(V.category)}`,children:V.category}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H(V.format)}`,children:V.format.toUpperCase()})]})]})]})},V.id))})]}),i&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Options"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exam Type"}),n.jsxs("select",{value:c.examType,onChange:V=>o(L=>({...L,examType:V.target.value})),className:"input-field w-full",children:[n.jsx("option",{value:"all",children:"All Exams"}),n.jsx("option",{value:"midterm",children:"Midterm"}),n.jsx("option",{value:"final",children:"Final"}),n.jsx("option",{value:"quiz",children:"Quiz"}),n.jsx("option",{value:"assignment",children:"Assignment"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),n.jsxs("select",{value:c.dateRange,onChange:V=>o(L=>({...L,dateRange:V.target.value})),className:"input-field w-full",children:[n.jsx("option",{value:"all",children:"All Time"}),n.jsx("option",{value:"current_semester",children:"Current Semester"}),n.jsx("option",{value:"last_30_days",children:"Last 30 Days"}),n.jsx("option",{value:"last_90_days",children:"Last 90 Days"})]})]})]}),n.jsxs("div",{className:"mt-4 space-y-3",children:[n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",checked:c.includeCharts,onChange:V=>o(L=>({...L,includeCharts:V.target.checked})),className:"rounded"}),n.jsx("span",{className:"text-sm text-gray-700",children:"Include Charts and Graphs"})]}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",checked:c.includeDetails,onChange:V=>o(L=>({...L,includeDetails:V.target.checked})),className:"rounded"}),n.jsx("span",{className:"text-sm text-gray-700",children:"Include Detailed Analysis"})]}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",checked:c.includeRecommendations,onChange:V=>o(L=>({...L,includeRecommendations:V.target.checked})),className:"rounded"}),n.jsx("span",{className:"text-sm text-gray-700",children:"Include Recommendations"})]})]})]}),r&&i&&n.jsxs("div",{className:"card",children:[n.jsxs("button",{onClick:T,disabled:d,className:"btn-primary w-full flex items-center justify-center space-x-2",children:[d?n.jsx(S0,{className:"w-5 h-5 animate-spin"}):n.jsx(Fr,{className:"w-5 h-5"}),n.jsx("span",{children:d?`Generating Report... (${g})`:`Generate ${i.name}`})]}),d&&n.jsxs("div",{className:"mt-3 text-sm text-gray-600 text-center",children:[n.jsx("p",{children:"Report generation is in progress. This may take a few minutes."}),n.jsxs("p",{className:"text-xs mt-1",children:["Status: ",g]})]})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Generated Reports"}),u.length===0?n.jsxs("div",{className:"text-center py-8",children:[n.jsx(Fr,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-600",children:"No reports generated yet"})]}):n.jsx("div",{className:"space-y-3",children:u.filter(V=>V.generatedBy===(s==null?void 0:s.id)).sort((V,L)=>new Date(L.generatedAt).getTime()-new Date(V.generatedAt).getTime()).map(V=>{var L;return n.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:V.template.name}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(L=w.find(P=>P.id===V.subjectId))==null?void 0:L.name}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(V.generatedAt).toLocaleString()}),n.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H(V.template.format)}`,children:V.template.format.toUpperCase()}),n.jsxs("span",{className:"text-xs text-gray-500",children:[(V.size/1024).toFixed(1)," KB"]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>E(V),className:"p-2 text-gray-400 hover:text-gray-600",title:"Download",children:n.jsx(kr,{className:"w-4 h-4"})}),n.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600",title:"Share",children:n.jsx(fb,{className:"w-4 h-4"})})]})]})},V.id)})})]}),x&&i&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Preview"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsxs("div",{className:"text-center py-8",children:[n.jsx(i.icon,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:i.name}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:i.description}),n.jsx("div",{className:"text-xs text-gray-500",children:"Preview will be available after generation"})]})})]})]})]})]})};fa.register(Ca,Aa,na,ra,Pn,ti,si,ei,Rr,kn);const gM=()=>{const t=vt(),{studentAnalytics:e,loading:s}=ge(y=>y.analytics),{user:r}=ge(y=>y.auth),{subjects:a}=ge(y=>y.subjects);ge(y=>y.exams);const[i,l]=G.useState("overview"),[c,o]=G.useState("");G.useEffect(()=>{r!=null&&r.id&&t(yi(r.id)),t(It()),t(Br())},[t,r]);const d=a.filter(y=>y.class_id===(r==null?void 0:r.class_id));if(s&&!e)return n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})});if(!e)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(gt,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:"No analytics data available"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Complete some exams to see your analytics"})]});const f={labels:e.performance_trend.map(y=>y.exam),datasets:[{label:"Your Performance (%)",data:e.performance_trend.map(y=>y.percentage),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0}]},u={labels:Object.keys(e.co_attainment),datasets:[{label:"Your CO Attainment (%)",data:Object.values(e.co_attainment),backgroundColor:"rgba(34, 197, 94, 0.2)",borderColor:"rgba(34, 197, 94, 1)",pointBackgroundColor:"rgba(34, 197, 94, 1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 197, 94, 1)"}]},h={labels:Object.keys(e.po_attainment),datasets:[{label:"Your PO Attainment (%)",data:Object.values(e.po_attainment),backgroundColor:"rgba(139, 92, 246, 0.2)",borderColor:"rgba(139, 92, 246, 1)",pointBackgroundColor:"rgba(139, 92, 246, 1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(139, 92, 246, 1)"}]},x=e.performance_trend.reduce((y,N)=>{let S="F";return N.percentage>=90?S="A+":N.percentage>=80?S="A":N.percentage>=70?S="B+":N.percentage>=60?S="B":N.percentage>=50&&(S="C"),y[S]=(y[S]||0)+1,y},{}),m={labels:Object.keys(x),datasets:[{data:Object.values(x),backgroundColor:["rgba(34, 197, 94, 0.8)","rgba(59, 130, 246, 0.8)","rgba(245, 158, 11, 0.8)","rgba(139, 92, 246, 0.8)","rgba(239, 68, 68, 0.8)","rgba(156, 163, 175, 0.8)"]}]},p={responsive:!0,maintainAspectRatio:!1,scales:{r:{beginAtZero:!0,max:100,ticks:{stepSize:20}}},plugins:{legend:{position:"top"}}},v={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:100}}},b=d.map(y=>{const N=e.performance_trend.filter(T=>T.exam.toLowerCase().includes(y.name.toLowerCase()));if(N.length===0)return null;const S=N.reduce((T,E)=>T+E.percentage,0)/N.length;return{subject:y.name,code:y.code,average:S,exams:N.length,cos:y.cos||[],pos:y.pos||[]}}).filter(Boolean),_=Object.entries(e.co_attainment),g=_.filter(([y,N])=>N>=80).map(([y,N])=>y),j=_.filter(([y,N])=>N<60).map(([y,N])=>y),w=()=>{const y=[];return e.percentage>=85?(y.push("Excellent performance! Consider peer tutoring to help others."),y.push("Focus on advanced problem-solving and research projects.")):e.percentage>=70?(y.push("Good performance! Aim for consistency across all subjects."),y.push("Work on improving weaker areas identified in CO analysis.")):e.percentage>=50?(y.push("Focus on fundamental concepts in weak subjects."),y.push("Consider additional practice sessions and study groups.")):(y.push("Urgent attention needed. Consult teachers for remedial help."),y.push("Create a structured study plan with daily targets.")),j.length>0&&y.push(`Priority focus areas: ${j.join(", ")}`),y},k=[{id:"overview",label:"Overview",icon:Pt},{id:"co-po",label:"CO/PO Analysis",icon:Rt},{id:"subjects",label:"Subject-wise",icon:gt},{id:"insights",label:"Insights & Goals",icon:ba}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Academic Analytics"}),n.jsx("p",{className:"text-gray-600",children:"Track your progress and identify improvement areas"})]}),n.jsx("div",{className:"flex items-center space-x-3",children:n.jsxs("button",{className:"btn-secondary flex items-center space-x-2",children:[n.jsx(kr,{size:18}),n.jsx("span",{children:"Export Report"})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:n.jsx(Pt,{className:"h-6 w-6 text-blue-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overall Percentage"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[e.percentage.toFixed(1),"%"]})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full ${e.percentage>=80?"bg-green-500":e.percentage>=60?"bg-blue-500":e.percentage>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(e.percentage,100)}%`}})})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:n.jsx(co,{className:"h-6 w-6 text-yellow-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Class Rank"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:["#",e.rank]})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:e.rank<=3?" Top performer!":e.rank<=10?" Great performance!":"Keep improving!"})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:n.jsx(Mt,{className:"h-6 w-6 text-green-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Marks"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.total_marks.toFixed(0)})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:"Across all exams"})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:n.jsx(gt,{className:"h-6 w-6 text-purple-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Exams Taken"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.performance_trend.length})]})]}),n.jsx("div",{className:"mt-4",children:n.jsxs("p",{className:"text-xs text-gray-500",children:[d.length," subjects enrolled"]})})]})]}),n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("nav",{className:"-mb-px flex space-x-8",children:k.map(y=>{const N=y.icon;return n.jsxs("button",{onClick:()=>l(y.id),className:`group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm ${i===y.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(N,{className:`mr-2 h-5 w-5 ${i===y.id?"text-primary-500":"text-gray-400 group-hover:text-gray-500"}`}),y.label]},y.id)})})}),i==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Trend"}),n.jsx("div",{className:"h-64",children:n.jsx(Ed,{data:f,options:v})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Distribution"}),n.jsx("div",{className:"h-64",children:n.jsx(uc,{data:m})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Exam Results"}),n.jsx("div",{className:"space-y-3",children:e.performance_trend.slice(-5).reverse().map((y,N)=>n.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${y.percentage>=80?"bg-green-500":y.percentage>=60?"bg-blue-500":y.percentage>=40?"bg-yellow-500":"bg-red-500"}`}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:y.exam}),n.jsxs("p",{className:"text-sm text-gray-600",children:["Grade: ",y.percentage>=90?"A+":y.percentage>=80?"A":y.percentage>=70?"B+":y.percentage>=60?"B":y.percentage>=50?"C":"F"]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-lg font-semibold",children:[y.percentage.toFixed(1),"%"]}),n.jsx("p",{className:"text-xs text-gray-500",children:"Performance"})]})]},N))})]})]}),i==="co-po"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Object.keys(e.co_attainment).length>0&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Course Outcomes (CO) Attainment"}),n.jsx("div",{className:"h-80",children:n.jsx(Yx,{data:u,options:p})})]}),Object.keys(e.po_attainment).length>0&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Program Outcomes (PO) Attainment"}),n.jsx("div",{className:"h-80",children:n.jsx(Yx,{data:h,options:p})})]})]}),Object.keys(e.co_attainment).length>0&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detailed CO Analysis"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Course Outcome"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Your Attainment"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Threshold (60%)"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Status"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Recommendation"})]})}),n.jsx("tbody",{children:Object.entries(e.co_attainment).map(([y,N])=>n.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[n.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:y}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-semibold ${N>=80?"text-green-600":N>=60?"text-blue-600":N>=40?"text-yellow-600":"text-red-600"}`,children:[N.toFixed(1),"%"]})}),n.jsx("td",{className:"py-3 px-4 text-center text-gray-600",children:"60%"}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${N>=60?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:N>=60?"Achieved":"Not Achieved"})}),n.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:N>=80?"Excellent! Maintain this level.":N>=60?"Good. Aim for 80%+":"Needs improvement. Focus on this area."})]},y))})]})})]}),Object.keys(e.po_attainment).length>0&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibant text-gray-900 mb-4",children:"Program Outcomes Analysis"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(e.po_attainment).map(([y,N])=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:y}),n.jsxs("span",{className:`font-semibold ${N>=80?"text-green-600":N>=60?"text-blue-600":N>=40?"text-yellow-600":"text-red-600"}`,children:[N.toFixed(1),"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:n.jsx("div",{className:`h-2 rounded-full ${N>=80?"bg-green-500":N>=60?"bg-blue-500":N>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(N,100)}%`}})}),n.jsx("p",{className:"text-xs text-gray-600",children:N>=80?"Excellent proficiency":N>=60?"Good proficiency":N>=40?"Developing":"Needs attention"})]},y))})]})]}),i==="subjects"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Subject-wise Performance"}),n.jsxs("select",{value:c,onChange:y=>o(y.target.value),className:"input-field",children:[n.jsx("option",{value:"",children:"All Subjects"}),d.map(y=>n.jsx("option",{value:y.id,children:y.name},y.id))]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map((y,N)=>y&&n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900",children:y.subject}),n.jsx("p",{className:"text-sm text-gray-600",children:y.code})]}),n.jsxs("span",{className:`font-semibold text-lg ${y.average>=80?"text-green-600":y.average>=60?"text-blue-600":y.average>=40?"text-yellow-600":"text-red-600"}`,children:[y.average.toFixed(1),"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-3",children:n.jsx("div",{className:`h-2 rounded-full ${y.average>=80?"bg-green-500":y.average>=60?"bg-blue-500":y.average>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(y.average,100)}%`}})}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Exams taken:"}),n.jsx("span",{className:"font-medium",children:y.exams})]}),y.cos.length>0&&n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"COs:"}),n.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:y.cos.map((S,T)=>n.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs",children:S},T))})]})]})]},N))})]})}),i==="insights"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Strengths"}),n.jsx("div",{className:"space-y-3",children:g.length>0?g.map((y,N)=>n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx(Qa,{className:"h-5 w-5 text-green-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-800",children:y}),n.jsxs("p",{className:"text-sm text-green-600",children:[e.co_attainment[y].toFixed(1),"% - Excellent performance"]})]})]},N)):n.jsx("p",{className:"text-gray-500",children:"Complete more exams to identify your strengths"})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Areas for Improvement"}),n.jsx("div",{className:"space-y-3",children:j.length>0?j.map((y,N)=>n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[n.jsx(Sn,{className:"h-5 w-5 text-red-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-red-800",children:y}),n.jsxs("p",{className:"text-sm text-red-600",children:[e.co_attainment[y].toFixed(1),"% - Needs attention"]})]})]},N)):n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx(Qa,{className:"h-5 w-5 text-green-600"}),n.jsx("p",{className:"text-green-800",children:"Great job! No major weak areas identified."})]})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personalized Study Recommendations"}),n.jsx("div",{className:"space-y-3",children:w().map((y,N)=>n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[n.jsx(ba,{className:"h-5 w-5 text-blue-600 mt-0.5"}),n.jsx("p",{className:"text-blue-800",children:y})]},N))})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Academic Goals"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:"Short-term Goals (This Semester)"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[n.jsx("span",{className:"text-sm",children:"Achieve 80%+ overall"}),n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${e.percentage>=80?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e.percentage>=80?"Achieved":"In Progress"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[n.jsx("span",{className:"text-sm",children:"Top 10 in class"}),n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${e.rank<=10?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e.rank<=10?"Achieved":"In Progress"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[n.jsx("span",{className:"text-sm",children:"All COs above 60%"}),n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${Object.values(e.co_attainment).every(y=>y>=60)?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:Object.values(e.co_attainment).every(y=>y>=60)?"Achieved":"In Progress"})]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:"Long-term Goals (Academic Year)"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[n.jsx("span",{className:"text-sm",children:"Maintain top 5 position"}),n.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-800",children:"Target"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[n.jsx("span",{className:"text-sm",children:"Excel in core subjects"}),n.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-800",children:"Target"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[n.jsx("span",{className:"text-sm",children:"Leadership in projects"}),n.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-800",children:"Target"})]})]})]})]})]})]})]})};fa.register(Ca,Aa,na,ra,Pn,ti,si,ei,Rr);const vM=()=>{const t=vt(),{studentAnalytics:e,loading:s}=ge(_=>_.analytics),{user:r}=ge(_=>_.auth);ge(_=>_.subjects),ge(_=>_.exams);const[a,i]=G.useState([]),[l,c]=G.useState([]),[o,d]=G.useState(!1),[f,u]=G.useState(null);G.useEffect(()=>{r!=null&&r.id&&(t(yi(r.id)),h(r.id)),t(It()),t(Br())},[t,r]);const h=async _=>{try{d(!0),u(null);const g=await cw.getProgress(_);i(g.goals||[]),c(g.milestones||[])}catch(g){console.error("Error fetching progress data:",g),u("Failed to load progress data"),x()}finally{d(!1)}},x=()=>{i([]),c([])};if(G.useEffect(()=>{e&&a.length>0&&(i(_=>_.map(g=>{let j=g.current_value;switch(g.title){case"Achieve 85% overall":j=e.percentage;break;case"Top 5 in class":j=e.rank<=5?100:(11-e.rank)*10;break;case"All COs above 70%":const w=Object.values(e.co_attainment);j=w.length>0?w.filter(k=>k>=70).length/w.length*100:0;break}return{...g,current_value:j}})),c(_=>_.map(g=>{let j=g.achieved,w=g.achieved_date;switch(g.title){case"First A+ Grade":j=e.performance_trend.some(N=>N.percentage>=90),j&&!g.achieved&&(w=new Date().toISOString());break;case"Consistent Performer":const k=e.performance_trend.slice(-3);j=k.length>=3&&k.every(N=>N.percentage>=80),j&&!g.achieved&&(w=new Date().toISOString());break;case"Subject Expert":j=e.performance_trend.some(N=>N.percentage>=95),j&&!g.achieved&&(w=new Date().toISOString());break;case"Class Leader":j=e.rank<=3,j&&!g.achieved&&(w=new Date().toISOString());break;case"CO Champion":const y=Object.values(e.co_attainment);j=y.length>0&&y.every(N=>N>=80),j&&!g.achieved&&(w=new Date().toISOString());break}return{...g,achieved:j,achieved_date:j?w:null}})))},[e,a.length]),s||o)return n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})});if(f)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Cs,{className:"h-12 w-12 text-red-300 mx-auto mb-3"}),n.jsx("p",{className:"text-red-500 mb-2",children:"Error loading progress data"}),n.jsx("p",{className:"text-sm text-gray-400",children:f}),n.jsx("button",{onClick:()=>(r==null?void 0:r.id)&&h(r.id),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]});if(!e)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Rt,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:"No progress data available"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Complete some exams to track your progress"})]});const m={labels:e.performance_trend.map((_,g)=>`Exam ${g+1}`),datasets:[{label:"Your Progress (%)",data:e.performance_trend.map(_=>_.percentage),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0},{label:"Target (80%)",data:new Array(e.performance_trend.length).fill(80),borderColor:"rgba(34, 197, 94, 1)",backgroundColor:"rgba(34, 197, 94, 0.1)",borderDash:[5,5],tension:0,fill:!1}]},p={labels:["Completed","In Progress","Not Started"],datasets:[{data:[a.filter(_=>_.current_value>=_.target_value).length,a.filter(_=>_.current_value>0&&_.current_value<_.target_value).length,a.filter(_=>_.current_value===0).length],backgroundColor:["rgba(34, 197, 94, 0.8)","rgba(245, 158, 11, 0.8)","rgba(156, 163, 175, 0.8)"]}]},v=l.filter(_=>_.achieved).length,b=l.length;return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Progress Tracking"}),n.jsx("p",{className:"text-gray-600",children:"Monitor your academic journey and achievements"})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:n.jsx(Pt,{className:"h-6 w-6 text-blue-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Current Average"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[e.percentage.toFixed(1),"%"]})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("div",{className:"flex items-center space-x-1",children:e.performance_trend.length>=2&&n.jsxs(n.Fragment,{children:[e.performance_trend[e.performance_trend.length-1].percentage>e.performance_trend[e.performance_trend.length-2].percentage?n.jsx(Pt,{className:"h-4 w-4 text-green-500"}):n.jsx(Pt,{className:"h-4 w-4 text-red-500 transform rotate-180"}),n.jsxs("span",{className:`text-sm ${e.performance_trend[e.performance_trend.length-1].percentage>e.performance_trend[e.performance_trend.length-2].percentage?"text-green-600":"text-red-600"}`,children:[Math.abs(e.performance_trend[e.performance_trend.length-1].percentage-e.performance_trend[e.performance_trend.length-2].percentage).toFixed(1),"% vs last exam"]})]})})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:n.jsx(Rt,{className:"h-6 w-6 text-yellow-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Goals Progress"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[a.filter(_=>_.current_value>=_.target_value).length,"/",a.length]})]})]}),n.jsx("div",{className:"mt-4",children:n.jsxs("p",{className:"text-xs text-gray-500",children:[(a.filter(_=>_.current_value>=_.target_value).length/a.length*100).toFixed(0),"% completed"]})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:n.jsx(Mt,{className:"h-6 w-6 text-green-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Milestones"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[v,"/",b]})]})]}),n.jsx("div",{className:"mt-4",children:n.jsxs("p",{className:"text-xs text-gray-500",children:[(v/b*100).toFixed(0),"% unlocked"]})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:n.jsx(co,{className:"h-6 w-6 text-purple-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Class Position"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:["#",e.rank]})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:e.rank<=5?" Top 5!":"Keep climbing!"})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Trend"}),n.jsx("div",{className:"h-64",children:n.jsx(Ed,{data:m,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:100}}}})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Goal Completion Status"}),n.jsx("div",{className:"h-64",children:n.jsx(uc,{data:p,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Academic Goals"}),n.jsx("div",{className:"space-y-4",children:a.map(_=>{const g=Math.min(_.current_value/_.target_value*100,100),j=_.current_value>=_.target_value,w=_.deadline?Math.ceil((new Date(_.deadline).getTime()-new Date().getTime())/(1e3*60*60*24)):0;return n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`p-2 rounded-lg ${j?"bg-green-100":"bg-gray-100"}`,children:j?n.jsx(Ot,{className:"h-5 w-5 text-green-600"}):n.jsx(Rt,{className:"h-5 w-5 text-gray-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900",children:_.title}),n.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[n.jsxs("span",{children:["Target: ",_.target_value,_.title.includes("%")?"%":""]}),n.jsxs("span",{children:["Current: ",_.current_value.toFixed(1),_.title.includes("%")?"%":""]}),_.deadline&&n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(oo,{className:"h-4 w-4"}),n.jsx("span",{children:w>0?`${w} days left`:"Overdue"})]})]})]})]}),n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${j?"bg-green-100 text-green-800":g>=70?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:j?"Completed":`${g.toFixed(0)}%`})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${j?"bg-green-500":g>=70?"bg-yellow-500":"bg-blue-500"}`,style:{width:`${g}%`}})})]},_.id)})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Achievement Milestones"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(_=>n.jsx("div",{className:`border-2 rounded-lg p-4 transition-all ${_.achieved?"border-green-200 bg-green-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("div",{className:`p-2 rounded-lg flex-shrink-0 ${_.achieved?"bg-green-100":"bg-gray-100"}`,children:_.achieved?n.jsx(Qa,{className:"h-5 w-5 text-green-600"}):n.jsx(Qa,{className:"h-5 w-5 text-gray-400"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:`font-medium ${_.achieved?"text-green-900":"text-gray-900"}`,children:_.title}),n.jsx("p",{className:`text-sm mt-1 ${_.achieved?"text-green-700":"text-gray-600"}`,children:_.description}),_.achieved&&_.achieved_date&&n.jsxs("div",{className:"flex items-center space-x-1 mt-2",children:[n.jsx(Ot,{className:"h-4 w-4 text-green-600"}),n.jsxs("span",{className:"text-xs text-green-600",children:["Achieved on ",new Date(_.achieved_date).toLocaleDateString()]})]})]})]})},_.id))})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Study Plan Recommendations"}),n.jsx("div",{className:"space-y-3",children:e.percentage>=85?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx(Ot,{className:"h-5 w-5 text-green-600 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-green-900",children:"Maintain Excellence"}),n.jsx("p",{className:"text-xs text-green-700",children:"Continue current study methods. Consider peer tutoring."})]})]}),n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[n.jsx(gt,{className:"h-5 w-5 text-blue-600 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Advanced Learning"}),n.jsx("p",{className:"text-xs text-blue-700",children:"Explore additional projects and research opportunities."})]})]})]}):e.percentage>=70?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[n.jsx(Rt,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Push for Excellence"}),n.jsx("p",{className:"text-xs text-yellow-700",children:"Focus on consistency. Review weak topics regularly."})]})]}),n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[n.jsx(Si,{className:"h-5 w-5 text-blue-600 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Time Management"}),n.jsx("p",{className:"text-xs text-blue-700",children:"Allocate more time to challenging subjects."})]})]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[n.jsx(Cs,{className:"h-5 w-5 text-red-600 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-red-900",children:"Focus Required"}),n.jsx("p",{className:"text-xs text-red-700",children:"Immediate attention needed. Consider remedial sessions."})]})]}),n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[n.jsx(gt,{className:"h-5 w-5 text-orange-600 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Back to Basics"}),n.jsx("p",{className:"text-xs text-orange-700",children:"Review fundamental concepts before moving to advanced topics."})]})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibant text-gray-900 mb-4",children:"Next Steps"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[n.jsx("div",{className:"bg-blue-100 p-1 rounded",children:n.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"1"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Review weak COs"}),n.jsx("p",{className:"text-xs text-blue-700",children:"Focus on course outcomes below 60%"})]})]}),n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[n.jsx("div",{className:"bg-purple-100 p-1 rounded",children:n.jsx("span",{className:"text-purple-600 font-bold text-sm",children:"2"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Practice regularly"}),n.jsx("p",{className:"text-xs text-purple-700",children:"Daily problem-solving in weak areas"})]})]}),n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx("div",{className:"bg-green-100 p-1 rounded",children:n.jsx("span",{className:"text-green-600 font-bold text-sm",children:"3"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-green-900",children:"Set mini-goals"}),n.jsx("p",{className:"text-xs text-green-700",children:"Weekly targets for improvement"})]})]})]})]})]})]})};fa.register(Ca,Aa,na,ra,Pn,ti,si,ei,Rr,kn);const yM=()=>{var N,S,T;const t=vt(),{hodAnalytics:e,loading:s}=ge(E=>E.analytics),{user:r}=ge(E=>E.auth),{departments:a}=ge(E=>E.departments),[i,l]=G.useState("overview"),[c,o]=G.useState(""),[d,f]=G.useState(null),[u,h]=G.useState(!1),[x,m]=G.useState(null),p=async E=>{var A;try{h(!0),m(null);const H=await Qr.getStrategicDashboardData(E);(A=H.departmentalIntelligence)!=null&&A.compliance_monitoring&&f(H.departmentalIntelligence.compliance_monitoring)}catch(H){console.error("Error fetching NBA compliance data:",H),m("Failed to fetch NBA compliance data")}finally{h(!1)}};G.useEffect(()=>{r!=null&&r.department_id&&(t(bi(r.department_id)),p(r.department_id)),t(Lr()),t(gs()),t(It())},[t,r]);const v=a.find(E=>E.id===(r==null?void 0:r.department_id));if(s&&!e)return n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})});if(!e)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Pt,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:"No analytics data available"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Department data will appear once exams are conducted"})]});const b={labels:e.subject_performance.map(E=>E.subject_name.length>15?E.subject_name.substring(0,15)+"...":E.subject_name),datasets:[{label:"Average Performance (%)",data:e.subject_performance.map(E=>E.average_percentage),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1},{label:"Pass Rate (%)",data:e.subject_performance.map(E=>E.pass_rate),backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1}]},_={labels:e.teacher_performance.map(E=>E.teacher_name.split(" ")[0]),datasets:[{label:"Class Performance (%)",data:e.teacher_performance.map(E=>E.average_class_performance),backgroundColor:e.teacher_performance.map(E=>E.average_class_performance>=80?"rgba(34, 197, 94, 0.8)":E.average_class_performance>=70?"rgba(59, 130, 246, 0.8)":E.average_class_performance>=60?"rgba(245, 158, 11, 0.8)":"rgba(239, 68, 68, 0.8)"),borderColor:e.teacher_performance.map(E=>E.average_class_performance>=80?"rgba(34, 197, 94, 1)":E.average_class_performance>=70?"rgba(59, 130, 246, 1)":E.average_class_performance>=60?"rgba(245, 158, 11, 1)":"rgba(239, 68, 68, 1)"),borderWidth:1}]},g={labels:["Excellent (80%+)","Good (70-79%)","Average (60-69%)","Below Average (<60%)"],datasets:[{data:[e.subject_performance.filter(E=>E.average_percentage>=80).length,e.subject_performance.filter(E=>E.average_percentage>=70&&E.average_percentage<80).length,e.subject_performance.filter(E=>E.average_percentage>=60&&E.average_percentage<70).length,e.subject_performance.filter(E=>E.average_percentage<60).length],backgroundColor:["rgba(34, 197, 94, 0.8)","rgba(59, 130, 246, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"]}]},j=d?{coAttainment:((N=d.current_status)==null?void 0:N.co_attainment)||0,poAttainment:((S=d.current_status)==null?void 0:S.po_attainment)||0,overallCompliance:d.compliance_score||0,thresholdMet:d.compliance_score>=70}:{coAttainment:0,poAttainment:0,overallCompliance:0,thresholdMet:!1},w={topPerformingSubjects:e.subject_performance.filter(E=>E.average_percentage>=80).sort((E,A)=>A.average_percentage-E.average_percentage).slice(0,3),underPerformingSubjects:e.subject_performance.filter(E=>E.average_percentage<60).sort((E,A)=>E.average_percentage-A.average_percentage).slice(0,3),topTeachers:e.teacher_performance.filter(E=>E.average_class_performance>=80).sort((E,A)=>A.average_class_performance-E.average_class_performance).slice(0,3),teachersNeedingSupport:e.teacher_performance.filter(E=>E.average_class_performance<70).sort((E,A)=>E.average_class_performance-A.average_class_performance).slice(0,3)},k={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:100}}},y=[{id:"overview",label:"Overview",icon:Pt},{id:"subjects",label:"Subject Analysis",icon:gt},{id:"faculty",label:"Faculty Performance",icon:Ct},{id:"compliance",label:"NBA Compliance",icon:Mt}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Department Analytics"}),n.jsxs("p",{className:"text-gray-600",children:[v==null?void 0:v.name," - Comprehensive Performance Overview"]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("button",{className:"btn-secondary flex items-center space-x-2",children:[n.jsx(uo,{size:18}),n.jsx("span",{children:"Filter"})]}),n.jsxs("button",{className:"btn-secondary flex items-center space-x-2",children:[n.jsx(kr,{size:18}),n.jsx("span",{children:"Export Report"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:n.jsx(Pt,{className:"h-6 w-6 text-blue-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dept. Average"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[e.department_overview.average_performance.toFixed(1),"%"]})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full ${e.department_overview.average_performance>=80?"bg-green-500":e.department_overview.average_performance>=70?"bg-blue-500":e.department_overview.average_performance>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(e.department_overview.average_performance,100)}%`}})})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:n.jsx(Ct,{className:"h-6 w-6 text-green-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.department_overview.total_students})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:"Active across all classes"})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:n.jsx(gt,{className:"h-6 w-6 text-purple-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Faculty"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.department_overview.total_teachers})]})]}),n.jsx("div",{className:"mt-4",children:n.jsxs("p",{className:"text-xs text-gray-500",children:["Teaching ",e.department_overview.total_subjects," subjects"]})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:n.jsx(Mt,{className:"h-6 w-6 text-yellow-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"NBA Score"}),u?n.jsx("div",{className:"animate-pulse bg-gray-200 h-8 w-16 rounded"}):x?n.jsx("p",{className:"text-red-600 text-sm",children:"Error loading data"}):n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[j.overallCompliance.toFixed(1),"%"]})]})]}),n.jsx("div",{className:"mt-4",children:u?n.jsx("div",{className:"animate-pulse bg-gray-200 h-4 w-24 rounded"}):x?n.jsx("p",{className:"text-red-600 text-xs",children:"Failed to load"}):n.jsx("p",{className:`text-xs ${j.thresholdMet?"text-green-600":"text-red-600"}`,children:j.thresholdMet?" Threshold met":" Below threshold"})})]})]}),n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("nav",{className:"-mb-px flex space-x-8",children:y.map(E=>{const A=E.icon;return n.jsxs("button",{onClick:()=>l(E.id),className:`group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm ${i===E.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(A,{className:`mr-2 h-5 w-5 ${i===E.id?"text-primary-500":"text-gray-400 group-hover:text-gray-500"}`}),E.label]},E.id)})})}),i==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Subject Performance Overview"}),n.jsx("div",{className:"h-80",children:n.jsx(Fa,{data:b,options:k})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Distribution"}),n.jsx("div",{className:"h-80",children:n.jsx(uc,{data:g,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Areas"}),n.jsx("div",{className:"space-y-3",children:w.topPerformingSubjects.length>0?w.topPerformingSubjects.map((E,A)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Ot,{className:"h-5 w-5 text-green-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-900",children:E.subject_name}),n.jsxs("p",{className:"text-sm text-green-700",children:["Pass Rate: ",E.pass_rate.toFixed(1),"%"]})]})]}),n.jsxs("span",{className:"font-semibold text-green-800",children:[E.average_percentage.toFixed(1),"%"]})]},A)):n.jsx("p",{className:"text-gray-500",children:"No subjects with 80%+ performance yet"})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Areas Needing Attention"}),n.jsx("div",{className:"space-y-3",children:w.underPerformingSubjects.length>0?w.underPerformingSubjects.map((E,A)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Cs,{className:"h-5 w-5 text-red-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-red-900",children:E.subject_name}),n.jsxs("p",{className:"text-sm text-red-700",children:["Pass Rate: ",E.pass_rate.toFixed(1),"%"]})]})]}),n.jsxs("span",{className:"font-semibold text-red-800",children:[E.average_percentage.toFixed(1),"%"]})]},A)):n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx(Ot,{className:"h-5 w-5 text-green-600"}),n.jsx("p",{className:"text-green-800",children:"All subjects performing above 60%"})]})})]})]})]}),i==="subjects"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Subject-wise Performance Analysis"}),n.jsxs("select",{value:c,onChange:E=>o(E.target.value),className:"input-field",children:[n.jsx("option",{value:"",children:"All Subjects"}),e.subject_performance.map(E=>n.jsx("option",{value:E.subject_name,children:E.subject_name},E.subject_name))]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Subject"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Teacher"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Avg Performance"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Pass Rate"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Status"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Action Required"})]})}),n.jsx("tbody",{children:e.subject_performance.filter(E=>!c||E.subject_name===c).map((E,A)=>n.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[n.jsx("td",{className:"py-3 px-4",children:n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:E.subject_name}),n.jsx("p",{className:"text-sm text-gray-600",children:E.subject_name})]})}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("p",{className:"text-sm text-gray-900",children:"N/A"})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-semibold ${E.average_percentage>=80?"text-green-600":E.average_percentage>=70?"text-blue-600":E.average_percentage>=60?"text-yellow-600":"text-red-600"}`,children:[E.average_percentage.toFixed(1),"%"]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:"font-medium",children:[E.pass_rate.toFixed(1),"%"]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${E.average_percentage>=80?"bg-green-100 text-green-800":E.average_percentage>=70?"bg-blue-100 text-blue-800":E.average_percentage>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:E.average_percentage>=80?"Excellent":E.average_percentage>=70?"Good":E.average_percentage>=60?"Average":"Needs Attention"})}),n.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:E.average_percentage<60?"Review teaching methods, provide support":E.average_percentage<70?"Monitor progress, additional resources":E.average_percentage<80?"Maintain standards, aim for excellence":"Continue excellent work, share best practices"})]},A))})]})})]})}),i==="faculty"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Faculty Performance Overview"}),n.jsx("div",{className:"h-80",children:n.jsx(Fa,{data:_,options:k})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Faculty"}),n.jsx("div",{className:"space-y-3",children:w.topTeachers.length>0?w.topTeachers.map((E,A)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Qa,{className:"h-5 w-5 text-green-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-900",children:E.teacher_name}),n.jsxs("p",{className:"text-sm text-green-700",children:[E.subjects_taught," subjects"]})]})]}),n.jsxs("span",{className:"font-semibold text-green-800",children:[E.average_class_performance.toFixed(1),"%"]})]},A)):n.jsx("p",{className:"text-gray-500",children:"No faculty with 80%+ class performance yet"})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Faculty Needing Support"}),n.jsx("div",{className:"space-y-3",children:w.teachersNeedingSupport.length>0?w.teachersNeedingSupport.map((E,A)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Rt,{className:"h-5 w-5 text-yellow-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-yellow-900",children:E.teacher_name}),n.jsxs("p",{className:"text-sm text-yellow-700",children:[E.subjects_taught," subjects"]})]})]}),n.jsxs("span",{className:"font-semibold text-yellow-800",children:[E.average_class_performance.toFixed(1),"%"]})]},A)):n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx(Ot,{className:"h-5 w-5 text-green-600"}),n.jsx("p",{className:"text-green-800",children:"All faculty performing above 70%"})]})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detailed Faculty Analysis"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Faculty Name"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Subjects"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Students"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Avg Performance"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Rating"}),n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Recommendation"})]})}),n.jsx("tbody",{children:e.teacher_performance.map((E,A)=>n.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[n.jsx("td",{className:"py-3 px-4",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-gray-100 p-2 rounded-full",children:n.jsx(Ct,{className:"h-4 w-4 text-gray-600"})}),n.jsx("p",{className:"font-medium text-gray-900",children:E.teacher_name})]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-medium",children:E.subjects_taught})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("span",{className:"font-medium",children:"N/A"})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-semibold ${E.average_class_performance>=80?"text-green-600":E.average_class_performance>=70?"text-blue-600":E.average_class_performance>=60?"text-yellow-600":"text-red-600"}`,children:[E.average_class_performance.toFixed(1),"%"]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsx("div",{className:"flex items-center justify-center space-x-1",children:[1,2,3,4,5].map(H=>n.jsx(Qa,{className:`h-4 w-4 ${H<=Math.round(E.average_class_performance/20)?"text-yellow-400 fill-current":"text-gray-300"}`},H))})}),n.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:E.average_class_performance>=85?"Excellent! Share best practices":E.average_class_performance>=75?"Good performance, maintain quality":E.average_class_performance>=65?"Needs improvement, provide support":"Urgent intervention needed, remedial training"})]},A))})]})})]})]}),i==="compliance"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"CO Attainment"}),n.jsx(Mt,{className:"h-6 w-6 text-green-600"})]}),n.jsx("div",{className:"text-center",children:u?n.jsx("div",{className:"relative inline-flex items-center justify-center w-24 h-24 mb-4",children:n.jsx("div",{className:"animate-spin rounded-full h-24 w-24 border-2 border-gray-200 border-t-green-500"})}):x?n.jsx("div",{className:"text-red-600",children:n.jsx("p",{className:"text-sm",children:"Error loading data"})}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"relative inline-flex items-center justify-center w-24 h-24 mb-4",children:[n.jsxs("svg",{className:"w-24 h-24 transform -rotate-90",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",className:"text-gray-200 h-24 w-24"}),n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeDasharray:`${2*Math.PI*10}`,strokeDashoffset:`${2*Math.PI*10*(1-j.coAttainment/100)}`,className:"text-green-500 h-24 w-24"})]}),n.jsxs("span",{className:"absolute text-xl font-bold text-gray-900",children:[j.coAttainment.toFixed(1),"%"]})]}),n.jsx("p",{className:"text-sm text-gray-600",children:"Course Outcomes"}),n.jsx("p",{className:`text-xs ${j.coAttainment>=75?"text-green-600":"text-red-600"}`,children:j.coAttainment>=75?"Target Achieved":"Below Target"})]})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PO Attainment"}),n.jsx(Rt,{className:"h-6 w-6 text-blue-600"})]}),n.jsx("div",{className:"text-center",children:u?n.jsx("div",{className:"relative inline-flex items-center justify-center w-24 h-24 mb-4",children:n.jsx("div",{className:"animate-spin rounded-full h-24 w-24 border-2 border-gray-200 border-t-blue-500"})}):x?n.jsx("div",{className:"text-red-600",children:n.jsx("p",{className:"text-sm",children:"Error loading data"})}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"relative inline-flex items-center justify-center w-24 h-24 mb-4",children:[n.jsxs("svg",{className:"w-24 h-24 transform -rotate-90",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",className:"text-gray-200 h-24 w-24"}),n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeDasharray:`${2*Math.PI*10}`,strokeDashoffset:`${2*Math.PI*10*(1-j.poAttainment/100)}`,className:"text-blue-500 h-24 w-24"})]}),n.jsxs("span",{className:"absolute text-xl font-bold text-gray-900",children:[j.poAttainment.toFixed(1),"%"]})]}),n.jsx("p",{className:"text-sm text-gray-600",children:"Program Outcomes"}),n.jsx("p",{className:`text-xs ${j.poAttainment>=70?"text-green-600":"text-red-600"}`,children:j.poAttainment>=70?"Target Achieved":"Below Target"})]})})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overall Compliance"}),n.jsx(Ot,{className:"h-6 w-6 text-purple-600"})]}),n.jsx("div",{className:"text-center",children:u?n.jsx("div",{className:"relative inline-flex items-center justify-center w-24 h-24 mb-4",children:n.jsx("div",{className:"animate-spin rounded-full h-24 w-24 border-2 border-gray-200 border-t-purple-500"})}):x?n.jsx("div",{className:"text-red-600",children:n.jsx("p",{className:"text-sm",children:"Error loading data"})}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"relative inline-flex items-center justify-center w-24 h-24 mb-4",children:[n.jsxs("svg",{className:"w-24 h-24 transform -rotate-90",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",className:"text-gray-200 h-24 w-24"}),n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeDasharray:`${2*Math.PI*10}`,strokeDashoffset:`${2*Math.PI*10*(1-j.overallCompliance/100)}`,className:"text-purple-500 h-24 w-24"})]}),n.jsxs("span",{className:"absolute text-xl font-bold text-gray-900",children:[j.overallCompliance.toFixed(1),"%"]})]}),n.jsx("p",{className:"text-sm text-gray-600",children:"NBA Compliance"}),n.jsx("p",{className:`text-xs ${j.thresholdMet?"text-green-600":"text-red-600"}`,children:j.thresholdMet?"Compliant":"Non-Compliant"})]})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"NBA Compliance Checklist"}),u?n.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(E=>n.jsx("div",{className:"animate-pulse",children:n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"h-5 w-5 bg-gray-300 rounded"}),n.jsxs("div",{children:[n.jsx("div",{className:"h-4 bg-gray-300 rounded w-48 mb-2"}),n.jsx("div",{className:"h-3 bg-gray-300 rounded w-32"})]})]}),n.jsx("div",{className:"h-6 bg-gray-300 rounded w-16"})]})},E))}):x?n.jsxs("div",{className:"text-center py-8",children:[n.jsx("p",{className:"text-red-600",children:"Failed to load compliance data"}),n.jsx("button",{onClick:()=>(r==null?void 0:r.department_id)&&p(r.department_id),className:"mt-2 text-blue-600 hover:text-blue-800",children:"Retry"})]}):n.jsx("div",{className:"space-y-4",children:((T=d==null?void 0:d.alerts)==null?void 0:T.length)>0?d.alerts.map((E,A)=>n.jsxs("div",{className:`flex items-center justify-between p-4 ${E.type==="success"?"bg-green-50 border-green-200":E.type==="warning"?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"} border rounded-lg`,children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[E.type==="success"?n.jsx(Ot,{className:"h-5 w-5 text-green-600"}):E.type==="warning"?n.jsx(Si,{className:"h-5 w-5 text-yellow-600"}):n.jsx(Cs,{className:"h-5 w-5 text-red-600"}),n.jsxs("div",{children:[n.jsx("p",{className:`font-medium ${E.type==="success"?"text-green-900":E.type==="warning"?"text-yellow-900":"text-red-900"}`,children:E.message}),n.jsxs("p",{className:`text-sm ${E.type==="success"?"text-green-700":E.type==="warning"?"text-yellow-700":"text-red-700"}`,children:["Priority: ",E.priority]})]})]}),n.jsx("span",{className:`font-medium ${E.type==="success"?"text-green-600":E.type==="warning"?"text-yellow-600":"text-red-600"}`,children:E.type==="success"?"Complete":E.type==="warning"?"In Progress":"Needs Attention"})]},A)):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Ot,{className:"h-5 w-5 text-green-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-900",children:"CO Attainment Documentation"}),n.jsx("p",{className:"text-sm text-green-700",children:"All course outcomes properly mapped and evaluated"})]})]}),n.jsx("span",{className:"text-green-600 font-medium",children:"Complete"})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Ot,{className:"h-5 w-5 text-green-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-900",children:"Assessment Methods"}),n.jsx("p",{className:"text-sm text-green-700",children:"Multiple assessment tools implemented"})]})]}),n.jsx("span",{className:"text-green-600 font-medium",children:"Complete"})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Si,{className:"h-5 w-5 text-yellow-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-yellow-900",children:"Student Feedback Analysis"}),n.jsx("p",{className:"text-sm text-yellow-700",children:"In progress - data being collected"})]})]}),n.jsx("span",{className:"text-yellow-600 font-medium",children:"In Progress"})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Ot,{className:"h-5 w-5 text-green-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-900",children:"Faculty Development"}),n.jsx("p",{className:"text-sm text-green-700",children:"Training programs completed"})]})]}),n.jsx("span",{className:"text-green-600 font-medium",children:"Complete"})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Action Items for NBA Compliance"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[n.jsx("div",{className:"bg-blue-100 p-1 rounded",children:n.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"1"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Complete Student Feedback Collection"}),n.jsx("p",{className:"text-xs text-blue-700",children:"Deadline: End of semester"})]})]}),n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[n.jsx("div",{className:"bg-purple-100 p-1 rounded",children:n.jsx("span",{className:"text-purple-600 font-bold text-sm",children:"2"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Update Course Files"}),n.jsx("p",{className:"text-xs text-purple-700",children:"Ensure all documentation is current"})]})]}),n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[n.jsx("div",{className:"bg-orange-100 p-1 rounded",children:n.jsx("span",{className:"text-orange-600 font-bold text-sm",children:"3"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Prepare Assessment Reports"}),n.jsx("p",{className:"text-xs text-orange-700",children:"Quarterly assessment analysis"})]})]})]})]})]})]})},bM=()=>{const t=vt(),{user:e}=ge(P=>P.auth),{users:s,loading:r}=ge(P=>P.users),{classes:a}=ge(P=>P.classes),[i,l]=G.useState(""),[c,o]=G.useState("all"),[d,f]=G.useState(!1),[u,h]=G.useState(null),[x,m]=G.useState({username:"",email:"",first_name:"",last_name:"",role:"student",class_id:null,password:"",is_active:!0}),[p,v]=G.useState(""),[b,_]=G.useState(!1);G.useEffect(()=>{t(gs()),t(ir())},[t]);const g=()=>{const P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let J="";for(let Ee=0;Ee<12;Ee++)J+=P.charAt(Math.floor(Math.random()*P.length));return J},j=s.filter(P=>P.department_id===(e==null?void 0:e.department_id)),w=a.filter(P=>P.department_id===(e==null?void 0:e.department_id)),k=j.filter(P=>{const J=P.first_name.toLowerCase().includes(i.toLowerCase())||P.last_name.toLowerCase().includes(i.toLowerCase())||P.email.toLowerCase().includes(i.toLowerCase())||P.username.toLowerCase().includes(i.toLowerCase()),Ee=c==="all"||P.role===c;return J&&Ee}),y=async P=>{P.preventDefault();try{const J={...x,department_id:e==null?void 0:e.department_id,password:x.password||g(),role:x.role,class_id:x.class_id||void 0};await t(kf(J)).unwrap(),Ue.success("User created successfully"),f(!1),m({username:"",email:"",first_name:"",last_name:"",role:"student",class_id:null,password:"",is_active:!0}),v(""),_(!1)}catch(J){Ue.error(J.message||"Failed to create user")}},N=P=>{h(P),m({username:P.username,email:P.email,first_name:P.first_name,last_name:P.last_name,role:P.role,class_id:P.class_id,password:"",is_active:P.is_active}),f(!0)},S=async P=>{if(P.preventDefault(),!!u)try{const J={...x,department_id:e==null?void 0:e.department_id,role:x.role,class_id:x.class_id||void 0};x.password&&(J.password=x.password),await t(Sf({id:u.id,...J})).unwrap(),Ue.success("User updated successfully"),f(!1),h(null),m({username:"",email:"",first_name:"",last_name:"",role:"student",class_id:null,password:"",is_active:!0})}catch(J){Ue.error(J.message||"Failed to update user")}},T=async P=>{if(window.confirm("Are you sure you want to delete this user?"))try{await t(Ef(P)).unwrap(),Ue.success("User deleted successfully")}catch(J){Ue.error(J.message||"Failed to delete user")}},E=P=>{switch(P){case"admin":return"bg-red-100 text-red-800";case"hod":return"bg-purple-100 text-purple-800";case"teacher":return"bg-blue-100 text-blue-800";case"student":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},A=P=>{if(!P)return"No class assigned";const J=w.find(Ee=>Ee.id===P);return J?`${J.name} (${J.semester}${J.section})`:"Unknown class"},H=()=>{const P=g();m({...x,password:P}),v(P),_(!0)},V=()=>{navigator.clipboard.writeText(p),Ue.success("Password copied to clipboard!")},L=async(P,J)=>{if(window.confirm(`Reset password for ${J}? A new password will be generated.`))try{const Ee=await Jl.resetPassword(P);Ue.success(`Password reset successfully! New password: ${Ee.new_password}`,{duration:1e4,style:{background:"#10B981",color:"white"}})}catch(Ee){Ue.error(Ee.message||"Failed to reset password")}};return r?n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Department Users"}),n.jsx("p",{className:"text-gray-600",children:"Manage users in your department"}),n.jsx("div",{className:"mt-3 p-4 bg-blue-50 border border-blue-200 rounded-md",children:n.jsxs("div",{className:"flex",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(Uu,{className:"h-5 w-5 text-blue-400"})}),n.jsxs("div",{className:"ml-3",children:[n.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Password Management"}),n.jsx("div",{className:"mt-2 text-sm text-blue-700",children:n.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[n.jsx("li",{children:"When creating new users, you can set a custom password or leave it empty to auto-generate a secure password"}),n.jsx("li",{children:"Generated passwords are shown once and can be copied to clipboard"}),n.jsx("li",{children:'Use the "Reset" button to generate a new password for existing users'}),n.jsx("li",{children:"Share the password securely with the user for their first login"})]})})]})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Ct,{className:"h-8 w-8 text-blue-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:j.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(ia,{className:"h-8 w-8 text-green-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Students"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:j.filter(P=>P.role==="student").length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(gt,{className:"h-8 w-8 text-purple-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Teachers"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:j.filter(P=>P.role==="teacher").length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"h-8 w-8 bg-orange-100 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-orange-600 font-bold text-sm",children:"A"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:j.filter(P=>P.is_active).length})]})]})})]}),n.jsx("div",{className:"card mb-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Oi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),n.jsx("input",{type:"text",placeholder:"Search users...",value:i,onChange:P=>l(P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("select",{value:c,onChange:P=>o(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"all",children:"All Roles"}),n.jsx("option",{value:"student",children:"Students"}),n.jsx("option",{value:"teacher",children:"Teachers"})]}),n.jsxs("button",{onClick:()=>f(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center",children:[n.jsx(hb,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(P=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[P.first_name[0],P.last_name[0]]})}),n.jsxs("div",{className:"ml-4",children:[n.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[P.first_name," ",P.last_name]}),n.jsx("div",{className:"text-sm text-gray-500",children:P.email})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${E(P.role)}`,children:P.role.charAt(0).toUpperCase()+P.role.slice(1)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:A(P.class_id||null)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${P.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:P.is_active?"Active":"Inactive"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex space-x-2",children:[n.jsxs("button",{onClick:()=>N(P),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[n.jsx(Xo,{className:"h-4 w-4 mr-1"}),"Edit"]}),n.jsxs("button",{onClick:()=>L(P.id,`${P.first_name} ${P.last_name}`),className:"text-yellow-600 hover:text-yellow-900 flex items-center",title:"Reset Password",children:[n.jsx(Uu,{className:"h-4 w-4 mr-1"}),"Reset"]}),n.jsxs("button",{onClick:()=>T(P.id),className:"text-red-600 hover:text-red-900 flex items-center",children:[n.jsx(la,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},P.id))})]})})}),d&&n.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:n.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:n.jsxs("div",{className:"mt-3",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:u?"Edit User":"Add New User"}),n.jsxs("form",{onSubmit:u?S:y,children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),n.jsx("input",{type:"text",value:x.first_name,onChange:P=>m({...x,first_name:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),n.jsx("input",{type:"text",value:x.last_name,onChange:P=>m({...x,last_name:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),n.jsx("input",{type:"email",value:x.email,onChange:P=>m({...x,email:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),n.jsx("input",{type:"text",value:x.username,onChange:P=>m({...x,username:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",!u&&n.jsx("span",{className:"text-gray-500",children:"(Optional - will generate if empty)"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx("input",{type:b?"text":"password",value:x.password,onChange:P=>m({...x,password:P.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:u?"Leave empty to keep current password":"Enter password or leave empty to generate"}),n.jsx("button",{type:"button",onClick:()=>_(!b),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:b?n.jsx(xi,{className:"h-4 w-4"}):n.jsx(pi,{className:"h-4 w-4"})})]}),!u&&n.jsx("button",{type:"button",onClick:H,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:"Generate"})]}),p&&b&&n.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-md",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-green-800",children:"Generated Password:"}),n.jsx("p",{className:"text-sm text-green-700 font-mono",children:p})]}),n.jsx("button",{type:"button",onClick:V,className:"ml-2 px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700",children:"Copy"})]})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),n.jsxs("select",{value:x.role,onChange:P=>m({...x,role:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"student",children:"Student"}),n.jsx("option",{value:"teacher",children:"Teacher"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),n.jsxs("select",{value:x.class_id||"",onChange:P=>m({...x,class_id:P.target.value?Number(P.target.value):null}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Class"}),w.map(P=>n.jsxs("option",{value:P.id,children:[P.name," (",P.semester,P.section,")"]},P.id))]})]})]}),n.jsxs("div",{className:"flex items-center mb-6",children:[n.jsx("input",{type:"checkbox",id:"is_active",checked:x.is_active,onChange:P=>m({...x,is_active:P.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),n.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Active user"})]}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:u?"Update":"Create"})]})]})]})})})]})},_M=()=>{const t=vt(),{user:e}=ge(T=>T.auth),{classes:s,loading:r}=ge(T=>T.classes),{subjects:a}=ge(T=>T.subjects),{users:i}=ge(T=>T.users),[l,c]=G.useState(""),[o,d]=G.useState("all"),[f,u]=G.useState(!1),[h,x]=G.useState(null),[m,p]=G.useState({name:"",semester:"",section:"",academic_year:new Date().getFullYear().toString(),is_active:!0});G.useEffect(()=>{t(ir()),t(It()),t(gs())},[t]);const v=s.filter(T=>T.department_id===(e==null?void 0:e.department_id)),b=a.filter(T=>{const E=s.find(A=>A.id===T.class_id);return(E==null?void 0:E.department_id)===(e==null?void 0:e.department_id)}),_=i.filter(T=>T.role==="student"&&T.department_id===(e==null?void 0:e.department_id)),g=v.filter(T=>{const E=T.name.toLowerCase().includes(l.toLowerCase())||T.section.toLowerCase().includes(l.toLowerCase())||T.semester.toString().toLowerCase().includes(l.toLowerCase()),A=o==="all"||T.semester.toString()===o;return E&&A}),j=async T=>{T.preventDefault();try{const E={...m,department_id:e==null?void 0:e.department_id,semester:Number(m.semester),academic_year:Number(m.academic_year)};await t(Tf(E)).unwrap(),Ue.success("Class created successfully"),u(!1),p({name:"",semester:"",section:"",academic_year:new Date().getFullYear().toString(),is_active:!0})}catch(E){Ue.error(E.message||"Failed to create class")}},w=T=>{var E;x(T),p({name:T.name,semester:T.semester,section:T.section,academic_year:((E=T.academic_year)==null?void 0:E.toString())||new Date().getFullYear().toString(),is_active:T.is_active}),u(!0)},k=async T=>{if(T.preventDefault(),!!h)try{const E={...m,department_id:e==null?void 0:e.department_id,semester:Number(m.semester),academic_year:Number(m.academic_year)};await t(Cf({id:h.id,...E})).unwrap(),Ue.success("Class updated successfully"),u(!1),x(null),p({name:"",semester:"",section:"",academic_year:new Date().getFullYear().toString(),is_active:!0})}catch(E){Ue.error(E.message||"Failed to update class")}},y=async T=>{if(window.confirm("Are you sure you want to delete this class?"))try{await t(Af(T)).unwrap(),Ue.success("Class deleted successfully")}catch(E){Ue.error(E.message||"Failed to delete class")}},N=T=>{const E=_.filter(H=>H.class_id===T),A=b.filter(H=>H.class_id===T);return{studentCount:E.length,subjectCount:A.length}},S=()=>[...new Set(v.map(E=>E.semester))].sort();return r?n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Department Classes"}),n.jsx("p",{className:"text-gray-600",children:"Manage classes in your department"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Sr,{className:"h-8 w-8 text-blue-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Classes"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Ct,{className:"h-8 w-8 text-green-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:_.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(gt,{className:"h-8 w-8 text-purple-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Subjects"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:b.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"h-8 w-8 bg-orange-100 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-orange-600 font-bold text-sm",children:"A"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Classes"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.length})]})]})})]}),n.jsx("div",{className:"card mb-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Oi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),n.jsx("input",{type:"text",placeholder:"Search classes...",value:l,onChange:T=>c(T.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("select",{value:o,onChange:T=>d(T.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"all",children:"All Semesters"}),S().map(T=>n.jsxs("option",{value:T,children:["Semester ",T]},T))]}),n.jsxs("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center",children:[n.jsx(Na,{className:"h-4 w-4 mr-2"}),"Add Class"]})]})]})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class Details"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Semester"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Students"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subjects"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(T=>{const E=N(T.id);return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:n.jsx(Sr,{className:"h-5 w-5 text-blue-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.name}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Section ",T.section]})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:["Semester ",T.semester]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Ct,{className:"h-4 w-4 text-gray-400 mr-1"}),E.studentCount]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(gt,{className:"h-4 w-4 text-gray-400 mr-1"}),E.subjectCount]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Active"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex space-x-2",children:[n.jsxs("button",{onClick:()=>w(T),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[n.jsx(Xo,{className:"h-4 w-4 mr-1"}),"Edit"]}),n.jsxs("button",{onClick:()=>y(T.id),className:"text-red-600 hover:text-red-900 flex items-center",children:[n.jsx(la,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},T.id)})})]})})}),f&&n.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:n.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:n.jsxs("div",{className:"mt-3",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:h?"Edit Class":"Add New Class"}),n.jsxs("form",{onSubmit:h?k:j,children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class Name"}),n.jsx("input",{type:"text",value:m.name,onChange:T=>p({...m,name:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Computer Science",required:!0})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Semester"}),n.jsx("input",{type:"text",value:m.semester,onChange:T=>p({...m,semester:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 1, 2, 3",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),n.jsx("input",{type:"text",value:m.section,onChange:T=>p({...m,section:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., A, B, C",required:!0})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),n.jsx("input",{type:"number",value:m.academic_year,onChange:T=>p({...m,academic_year:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"2020",max:"2030",required:!0})]}),n.jsxs("div",{className:"flex items-center mb-6",children:[n.jsx("input",{type:"checkbox",id:"is_active",checked:m.is_active,onChange:T=>p({...m,is_active:T.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),n.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Active class"})]}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx("button",{type:"button",onClick:()=>{u(!1),x(null),p({name:"",semester:"",section:"",academic_year:new Date().getFullYear().toString(),is_active:!0})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:h?"Update":"Create"})]})]})]})})})]})},wM=()=>{const t=vt(),{user:e}=ge(T=>T.auth),{subjects:s,loading:r}=ge(T=>T.subjects),{classes:a}=ge(T=>T.classes),{users:i}=ge(T=>T.users),[l,c]=G.useState(""),[o,d]=G.useState("all"),[f,u]=G.useState(!1),[h,x]=G.useState(null),[m,p]=G.useState({code:"",name:"",credits:"",class_id:null,teacher_id:null,is_active:!0});G.useEffect(()=>{t(It()),t(ir()),t(gs())},[t]);const v=a.filter(T=>T.department_id===(e==null?void 0:e.department_id)),b=s.filter(T=>{const E=a.find(A=>A.id===T.class_id);return(E==null?void 0:E.department_id)===(e==null?void 0:e.department_id)}),_=i.filter(T=>T.role==="teacher"&&T.department_id===(e==null?void 0:e.department_id)),g=b.filter(T=>{const E=T.code.toLowerCase().includes(l.toLowerCase())||T.name.toLowerCase().includes(l.toLowerCase()),A=o==="all"||T.class_id===Number(o);return E&&A}),j=async T=>{T.preventDefault();try{const E={...m,credits:Number(m.credits),class_id:m.class_id||0,teacher_id:m.teacher_id||0,cos:[],pos:[]};await t(Ff(E)).unwrap(),Ue.success("Subject created successfully"),u(!1),p({code:"",name:"",credits:"",class_id:null,teacher_id:null,is_active:!0})}catch(E){Ue.error(E.message||"Failed to create subject")}},w=T=>{var E;x(T),p({code:T.code,name:T.name,credits:((E=T.credits)==null?void 0:E.toString())||"",class_id:T.class_id,teacher_id:T.teacher_id,is_active:T.is_active}),u(!0)},k=async T=>{if(T.preventDefault(),!!h)try{const E={...m,credits:Number(m.credits),class_id:m.class_id||0,teacher_id:m.teacher_id||0,cos:[],pos:[]};await t(Of({id:h.id,...E})).unwrap(),Ue.success("Subject updated successfully"),u(!1),x(null),p({code:"",name:"",credits:"",class_id:null,teacher_id:null,is_active:!0})}catch(E){Ue.error(E.message||"Failed to update subject")}},y=async T=>{if(window.confirm("Are you sure you want to delete this subject?"))try{await t(Df(T)).unwrap(),Ue.success("Subject deleted successfully")}catch(E){Ue.error(E.message||"Failed to delete subject")}},N=T=>{if(!T)return"No class assigned";const E=v.find(A=>A.id===T);return E?`${E.name} (Sem ${E.semester}${E.section})`:"Unknown class"},S=T=>{if(!T)return"No teacher assigned";const E=_.find(A=>A.id===T);return E?`${E.first_name} ${E.last_name}`:"Unknown teacher"};return r?n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Department Subjects"}),n.jsx("p",{className:"text-gray-600",children:"Manage subjects in your department"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(gt,{className:"h-8 w-8 text-blue-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Subjects"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:b.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Ct,{className:"h-8 w-8 text-green-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Teachers"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:_.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(ia,{className:"h-8 w-8 text-purple-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Classes"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"h-8 w-8 bg-orange-100 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-orange-600 font-bold text-sm",children:"A"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Subjects"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:b.length})]})]})})]}),n.jsx("div",{className:"card mb-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Oi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),n.jsx("input",{type:"text",placeholder:"Search subjects...",value:l,onChange:T=>c(T.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("select",{value:o,onChange:T=>d(T.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"all",children:"All Classes"}),v.map(T=>n.jsxs("option",{value:T.id,children:[T.name," (Sem ",T.semester,T.section,")"]},T.id))]}),n.jsxs("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center",children:[n.jsx(Na,{className:"h-4 w-4 mr-2"}),"Add Subject"]})]})]})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject Details"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credits"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(T=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center",children:n.jsx(gt,{className:"h-5 w-5 text-green-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.code}),n.jsx("div",{className:"text-sm text-gray-500",children:T.name})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(T.class_id)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S(T.teacher_id||null)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Si,{className:"h-4 w-4 text-gray-400 mr-1"}),T.credits||"N/A"]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Active"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex space-x-2",children:[n.jsxs("button",{onClick:()=>w(T),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[n.jsx(Xo,{className:"h-4 w-4 mr-1"}),"Edit"]}),n.jsxs("button",{onClick:()=>y(T.id),className:"text-red-600 hover:text-red-900 flex items-center",children:[n.jsx(la,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},T.id))})]})})}),f&&n.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:n.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:n.jsxs("div",{className:"mt-3",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:h?"Edit Subject":"Add New Subject"}),n.jsxs("form",{onSubmit:h?k:j,children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Code"}),n.jsx("input",{type:"text",value:m.code,onChange:T=>p({...m,code:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., CS101",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Credits"}),n.jsx("input",{type:"number",value:m.credits,onChange:T=>p({...m,credits:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 3",min:"1",max:"10",required:!0})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Name"}),n.jsx("input",{type:"text",value:m.name,onChange:T=>p({...m,name:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Data Structures",required:!0})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),n.jsxs("select",{value:m.class_id||"",onChange:T=>p({...m,class_id:T.target.value?Number(T.target.value):null}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select Class"}),v.map(T=>n.jsxs("option",{value:T.id,children:[T.name," (Sem ",T.semester,T.section,")"]},T.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teacher"}),n.jsxs("select",{value:m.teacher_id||"",onChange:T=>p({...m,teacher_id:T.target.value?Number(T.target.value):null}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Teacher"}),_.map(T=>n.jsxs("option",{value:T.id,children:[T.first_name," ",T.last_name]},T.id))]})]})]}),n.jsxs("div",{className:"flex items-center mb-6",children:[n.jsx("input",{type:"checkbox",id:"is_active",checked:m.is_active,onChange:T=>p({...m,is_active:T.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),n.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Active subject"})]}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx("button",{type:"button",onClick:()=>{u(!1),x(null),p({code:"",name:"",credits:"",class_id:null,teacher_id:null,is_active:!0})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:h?"Update":"Create"})]})]})]})})})]})};fa.register(Ca,Aa,na,ra,Rr,ti,si,ei);const NM=()=>{const t=vt(),{user:e}=ge(y=>y.auth),{users:s}=ge(y=>y.users),{subjects:r}=ge(y=>y.subjects),{classes:a}=ge(y=>y.classes),{exams:i}=ge(y=>y.exams),[l,c]=G.useState(null),[o,d]=G.useState(null),[f,u]=G.useState("");G.useEffect(()=>{t(gs()),t(It()),t(ir()),t(Br())},[t]);const h=s.filter(y=>y.department_id===(e==null?void 0:e.department_id)),x=a.filter(y=>y.department_id===(e==null?void 0:e.department_id)),m=r.filter(y=>{const N=a.find(S=>S.id===y.class_id);return(N==null?void 0:N.department_id)===(e==null?void 0:e.department_id)}),p=i.filter(y=>{const N=r.find(T=>T.id===y.subject_id),S=a.find(T=>T.id===(N==null?void 0:N.class_id));return(S==null?void 0:S.department_id)===(e==null?void 0:e.department_id)}),v=l?h.filter(y=>y.role==="student"&&y.class_id===l):h.filter(y=>y.role==="student"),_=v.filter(y=>y.first_name.toLowerCase().includes(f.toLowerCase())||y.last_name.toLowerCase().includes(f.toLowerCase())||y.email.toLowerCase().includes(f.toLowerCase())).map(y=>{var E;const N=p.filter(A=>{const H=r.find(L=>L.id===A.subject_id),V=a.find(L=>L.id===(H==null?void 0:H.class_id));return(V==null?void 0:V.id)===y.class_id}),S=N.reduce((A,H)=>A+(H.total_marks||0),0),T=N.length>0?S/N.length:0;return{name:`${y.first_name} ${y.last_name}`,class:((E=a.find(A=>A.id===y.class_id))==null?void 0:E.name)||"Unknown",percentage:Math.round(T),exams:N.length,status:T>=80?"Excellent":T>=60?"Good":"Needs Improvement"}}),g=x.map(y=>{const N=v.filter(A=>A.class_id===y.id),S=p.filter(A=>{const H=r.find(V=>V.id===A.subject_id);return(H==null?void 0:H.class_id)===y.id}),T=N.reduce((A,H)=>{const V=S.filter(P=>{const J=r.find(Ee=>Ee.id===P.subject_id);return(J==null?void 0:J.class_id)===y.id}),L=V.reduce((P,J)=>P+(J.total_marks||0),0);return A+(V.length>0?L/V.length:0)},0),E=N.length>0?T/N.length:0;return{class:y.name,students:N.length,average:Math.round(E),semester:y.semester}}),j=m.map(y=>{const N=p.filter(A=>A.subject_id===y.id),S=v.filter(A=>A.class_id===y.class_id),T=S.reduce((A,H)=>{const V=N,L=V.reduce((P,J)=>P+(J.total_marks||0),0);return A+(V.length>0?L/V.length:0)},0),E=S.length>0?T/S.length:0;return{subject:y.name,code:y.code,average:Math.round(E),students:S.length,exams:N.length}}),w=[{name:"A+ (90-100)",value:_.filter(y=>y.percentage>=90).length,color:"#10B981"},{name:"A (80-89)",value:_.filter(y=>y.percentage>=80&&y.percentage<90).length,color:"#34D399"},{name:"B (70-79)",value:_.filter(y=>y.percentage>=70&&y.percentage<80).length,color:"#FBBF24"},{name:"C (60-69)",value:_.filter(y=>y.percentage>=60&&y.percentage<70).length,color:"#F59E0B"},{name:"D (50-59)",value:_.filter(y=>y.percentage>=50&&y.percentage<60).length,color:"#EF4444"},{name:"F (<50)",value:_.filter(y=>y.percentage<50).length,color:"#DC2626"}],k=["#10B981","#34D399","#FBBF24","#F59E0B","#EF4444","#DC2626"];return n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Student Analytics"}),n.jsx("p",{className:"text-gray-600",children:"Comprehensive analysis of student performance in your department"})]}),n.jsx("div",{className:"card mb-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Oi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),n.jsx("input",{type:"text",placeholder:"Search students...",value:f,onChange:y=>u(y.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),n.jsxs("select",{value:l||"",onChange:y=>c(y.target.value?Number(y.target.value):null),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Classes"}),x.map(y=>n.jsxs("option",{value:y.id,children:[y.name," (Semester ",y.semester,")"]},y.id))]}),n.jsxs("select",{value:o||"",onChange:y=>d(y.target.value?Number(y.target.value):null),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Subjects"}),m.map(y=>n.jsxs("option",{value:y.id,children:[y.name," (",y.code,")"]},y.id))]}),n.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center",children:[n.jsx(kr,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Ct,{className:"h-8 w-8 text-blue-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Pt,{className:"h-8 w-8 text-green-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Average Performance"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[_.length>0?Math.round(_.reduce((y,N)=>y+N.percentage,0)/_.length):0,"%"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Mt,{className:"h-8 w-8 text-purple-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Excellent Students"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:_.filter(y=>y.percentage>=80).length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Rt,{className:"h-8 w-8 text-orange-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Need Support"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:_.filter(y=>y.percentage<60).length})]})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Class Performance"}),n.jsx("div",{className:"h-80",children:n.jsx(Fa,{data:{labels:g.map(y=>y.class),datasets:[{label:"Average Performance (%)",data:g.map(y=>y.average),backgroundColor:"#3B82F6",borderColor:"#3B82F6",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,max:100}}}})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Distribution"}),n.jsx("div",{className:"h-80",children:n.jsx(uc,{data:{labels:w.map(y=>y.name),datasets:[{data:w.map(y=>y.value),backgroundColor:k,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})]})]}),n.jsxs("div",{className:"card mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Subject Performance"}),n.jsx("div",{className:"h-80",children:n.jsx(Fa,{data:{labels:j.map(y=>y.code),datasets:[{label:"Average Performance (%)",data:j.map(y=>y.average),backgroundColor:"#10B981",borderColor:"#10B981",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,max:100}}}})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Student Performance Details"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exams"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map((y,N)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.name})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.class}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mr-2",children:n.jsx("div",{className:`h-2 rounded-full ${y.percentage>=80?"bg-green-500":y.percentage>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${y.percentage}%`}})}),n.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[y.percentage,"%"]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${y.status==="Excellent"?"bg-green-100 text-green-800":y.status==="Good"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:y.status})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.exams})]},N))})]})})]})]})};fa.register(Ca,Aa,na,ra,Rr,ti,si,ei);const jM=()=>{const t=vt(),{user:e}=ge(g=>g.auth),{users:s}=ge(g=>g.users),{subjects:r}=ge(g=>g.subjects),{classes:a}=ge(g=>g.classes),{exams:i}=ge(g=>g.exams),[l,c]=G.useState(""),[o,d]=G.useState(null);G.useEffect(()=>{t(gs()),t(It()),t(ir()),t(Br())},[t]);const f=s.filter(g=>g.department_id===(e==null?void 0:e.department_id)),u=r.filter(g=>{const j=a.find(w=>w.id===g.class_id);return(j==null?void 0:j.department_id)===(e==null?void 0:e.department_id)}),h=i.filter(g=>{const j=r.find(k=>k.id===g.subject_id),w=a.find(k=>k.id===(j==null?void 0:j.class_id));return(w==null?void 0:w.department_id)===(e==null?void 0:e.department_id)}),x=f.filter(g=>g.role==="teacher"),p=x.filter(g=>g.first_name.toLowerCase().includes(l.toLowerCase())||g.last_name.toLowerCase().includes(l.toLowerCase())||g.email.toLowerCase().includes(l.toLowerCase())).map(g=>{const j=u.filter(S=>S.teacher_id===g.id),w=h.filter(S=>{const T=r.find(E=>E.id===S.subject_id);return(T==null?void 0:T.teacher_id)===g.id}),k=j.map(S=>{const T=s.filter(H=>H.role==="student"&&H.class_id===S.class_id),E=h.filter(H=>H.subject_id===S.id),A=T.reduce((H,V)=>{const L=E,P=L.reduce((J,Ee)=>J+(Ee.total_marks||0),0);return H+(L.length>0?P/L.length:0)},0);return T.length>0?A/T.length:0}),y=k.length>0?k.reduce((S,T)=>S+T,0)/k.length:0,N=j.reduce((S,T)=>{const E=s.filter(A=>A.role==="student"&&A.class_id===T.class_id);return S+E.length},0);return{name:`${g.first_name} ${g.last_name}`,email:g.email,subjects:j.length,students:N,exams:w.length,performance:Math.round(y),status:y>=80?"Excellent":y>=70?"Good":y>=60?"Average":"Needs Improvement"}}),v=u.map(g=>{var j,w,k;return{subject:g.name,code:g.code,teacher:g.teacher_id?((j=s.find(y=>y.id===g.teacher_id))==null?void 0:j.first_name)+" "+((w=s.find(y=>y.id===g.teacher_id))==null?void 0:w.last_name):"Unassigned",students:s.filter(y=>y.role==="student"&&y.class_id===g.class_id).length,class:((k=a.find(y=>y.id===g.class_id))==null?void 0:k.name)||"Unknown"}}),b=x.map(g=>{const j=u.filter(k=>k.teacher_id===g.id),w=j.reduce((k,y)=>{const N=s.filter(S=>S.role==="student"&&S.class_id===y.class_id);return k+N.length},0);return{teacher:`${g.first_name} ${g.last_name}`,subjects:j.length,students:w,workload:j.length*2+Math.floor(w/10)}}),_=at.useMemo(()=>{const g={};return h.forEach(j=>{const k=new Date(j.created_at).toLocaleDateString("en-US",{month:"short"});if(g[k]||(g[k]={total:0,count:0}),s.filter(N=>N.role==="student"&&N.class_id===j.class_id).length>0){const N=j.total_marks?j.total_marks/100*100:0;g[k].total+=N,g[k].count+=1}}),Object.entries(g).map(([j,w])=>({month:j,performance:w.count>0?Math.round(w.total/w.count):0})).sort((j,w)=>{const k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return k.indexOf(j.month)-k.indexOf(w.month)})},[h,s]);return n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Teacher Analytics"}),n.jsx("p",{className:"text-gray-600",children:"Comprehensive analysis of teacher performance and workload in your department"})]}),n.jsx("div",{className:"card mb-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Oi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),n.jsx("input",{type:"text",placeholder:"Search teachers...",value:l,onChange:g=>c(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),n.jsxs("select",{value:o||"",onChange:g=>d(g.target.value?Number(g.target.value):null),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Teachers"}),x.map(g=>n.jsxs("option",{value:g.id,children:[g.first_name," ",g.last_name]},g.id))]}),n.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center",children:[n.jsx(kr,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Ct,{className:"h-8 w-8 text-blue-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Teachers"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:x.length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(gt,{className:"h-8 w-8 text-green-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Assigned Subjects"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:u.filter(g=>g.teacher_id).length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Mt,{className:"h-8 w-8 text-purple-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Excellent Teachers"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:p.filter(g=>g.status==="Excellent").length})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Rt,{className:"h-8 w-8 text-orange-500"}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Need Support"}),n.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:p.filter(g=>g.status==="Needs Improvement").length})]})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Performance"}),n.jsx("div",{className:"h-80",children:n.jsx(Fa,{data:{labels:p.map(g=>g.name),datasets:[{label:"Performance (%)",data:p.map(g=>g.performance),backgroundColor:"#3B82F6",borderColor:"#3B82F6",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{ticks:{maxRotation:45}},y:{beginAtZero:!0,max:100}}}})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Workload Distribution"}),n.jsx("div",{className:"h-80",children:n.jsx(Fa,{data:{labels:b.map(g=>g.teacher),datasets:[{label:"Workload Score",data:b.map(g=>g.workload),backgroundColor:"#10B981",borderColor:"#10B981",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{ticks:{maxRotation:45}},y:{beginAtZero:!0}}}})})]})]}),n.jsxs("div",{className:"card mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Department Performance Trends"}),n.jsx("div",{className:"h-80",children:n.jsx(Ed,{data:{labels:_.map(g=>g.month),datasets:[{label:"Performance (%)",data:_.map(g=>g.performance),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,max:100}}}})})]}),n.jsxs("div",{className:"card mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Subject Assignment Status"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Students"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map((g,j)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.subject}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.code}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.teacher}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.class}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.students}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g.teacher!=="Unassigned"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.teacher!=="Unassigned"?"Assigned":"Unassigned"})})]},j))})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Performance Details"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subjects"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Students"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exams"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map((g,j)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.name}),n.jsx("div",{className:"text-sm text-gray-500",children:g.email})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.subjects}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.students}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mr-2",children:n.jsx("div",{className:`h-2 rounded-full ${g.performance>=80?"bg-green-500":g.performance>=70?"bg-yellow-500":"bg-red-500"}`,style:{width:`${g.performance}%`}})}),n.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[g.performance,"%"]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g.status==="Excellent"?"bg-green-100 text-green-800":g.status==="Good"?"bg-blue-100 text-blue-800":g.status==="Average"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:g.status})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.exams})]},j))})]})})]})]})};function zn(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function Zs(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function ua(t){Zs(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||ep(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function kM(t,e){Zs(2,arguments);var s=ua(t).getTime(),r=zn(e);return new Date(s+r)}var SM={};function Td(){return SM}function EM(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function TM(t){return Zs(1,arguments),t instanceof Date||ep(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function CM(t){if(Zs(1,arguments),!TM(t)&&typeof t!="number")return!1;var e=ua(t);return!isNaN(Number(e))}function AM(t,e){Zs(2,arguments);var s=zn(e);return kM(t,-s)}var FM=864e5;function OM(t){Zs(1,arguments);var e=ua(t),s=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var r=e.getTime(),a=s-r;return Math.floor(a/FM)+1}function Ho(t){Zs(1,arguments);var e=1,s=ua(t),r=s.getUTCDay(),a=(r<e?7:0)+r-e;return s.setUTCDate(s.getUTCDate()-a),s.setUTCHours(0,0,0,0),s}function Ay(t){Zs(1,arguments);var e=ua(t),s=e.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(s+1,0,4),r.setUTCHours(0,0,0,0);var a=Ho(r),i=new Date(0);i.setUTCFullYear(s,0,4),i.setUTCHours(0,0,0,0);var l=Ho(i);return e.getTime()>=a.getTime()?s+1:e.getTime()>=l.getTime()?s:s-1}function DM(t){Zs(1,arguments);var e=Ay(t),s=new Date(0);s.setUTCFullYear(e,0,4),s.setUTCHours(0,0,0,0);var r=Ho(s);return r}var PM=6048e5;function MM(t){Zs(1,arguments);var e=ua(t),s=Ho(e).getTime()-DM(e).getTime();return Math.round(s/PM)+1}function Go(t,e){var s,r,a,i,l,c,o,d;Zs(1,arguments);var f=Td(),u=zn((s=(r=(a=(i=e==null?void 0:e.weekStartsOn)!==null&&i!==void 0?i:e==null||(l=e.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&a!==void 0?a:f.weekStartsOn)!==null&&r!==void 0?r:(o=f.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&s!==void 0?s:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ua(t),x=h.getUTCDay(),m=(x<u?7:0)+x-u;return h.setUTCDate(h.getUTCDate()-m),h.setUTCHours(0,0,0,0),h}function Fy(t,e){var s,r,a,i,l,c,o,d;Zs(1,arguments);var f=ua(t),u=f.getUTCFullYear(),h=Td(),x=zn((s=(r=(a=(i=e==null?void 0:e.firstWeekContainsDate)!==null&&i!==void 0?i:e==null||(l=e.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&a!==void 0?a:h.firstWeekContainsDate)!==null&&r!==void 0?r:(o=h.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(x>=1&&x<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var m=new Date(0);m.setUTCFullYear(u+1,0,x),m.setUTCHours(0,0,0,0);var p=Go(m,e),v=new Date(0);v.setUTCFullYear(u,0,x),v.setUTCHours(0,0,0,0);var b=Go(v,e);return f.getTime()>=p.getTime()?u+1:f.getTime()>=b.getTime()?u:u-1}function RM(t,e){var s,r,a,i,l,c,o,d;Zs(1,arguments);var f=Td(),u=zn((s=(r=(a=(i=e==null?void 0:e.firstWeekContainsDate)!==null&&i!==void 0?i:e==null||(l=e.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&a!==void 0?a:f.firstWeekContainsDate)!==null&&r!==void 0?r:(o=f.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1),h=Fy(t,e),x=new Date(0);x.setUTCFullYear(h,0,u),x.setUTCHours(0,0,0,0);var m=Go(x,e);return m}var IM=6048e5;function LM(t,e){Zs(1,arguments);var s=ua(t),r=Go(s,e).getTime()-RM(s,e).getTime();return Math.round(r/IM)+1}function wt(t,e){for(var s=t<0?"-":"",r=Math.abs(t).toString();r.length<e;)r="0"+r;return s+r}var BM={y:function(e,s){var r=e.getUTCFullYear(),a=r>0?r:1-r;return wt(s==="yy"?a%100:a,s.length)},M:function(e,s){var r=e.getUTCMonth();return s==="M"?String(r+1):wt(r+1,2)},d:function(e,s){return wt(e.getUTCDate(),s.length)},a:function(e,s){var r=e.getUTCHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(e,s){return wt(e.getUTCHours()%12||12,s.length)},H:function(e,s){return wt(e.getUTCHours(),s.length)},m:function(e,s){return wt(e.getUTCMinutes(),s.length)},s:function(e,s){return wt(e.getUTCSeconds(),s.length)},S:function(e,s){var r=s.length,a=e.getUTCMilliseconds(),i=Math.floor(a*Math.pow(10,r-3));return wt(i,s.length)}};const Ba=BM;var di={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},UM={G:function(e,s,r){var a=e.getUTCFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(e,s,r){if(s==="yo"){var a=e.getUTCFullYear(),i=a>0?a:1-a;return r.ordinalNumber(i,{unit:"year"})}return Ba.y(e,s)},Y:function(e,s,r,a){var i=Fy(e,a),l=i>0?i:1-i;if(s==="YY"){var c=l%100;return wt(c,2)}return s==="Yo"?r.ordinalNumber(l,{unit:"year"}):wt(l,s.length)},R:function(e,s){var r=Ay(e);return wt(r,s.length)},u:function(e,s){var r=e.getUTCFullYear();return wt(r,s.length)},Q:function(e,s,r){var a=Math.ceil((e.getUTCMonth()+1)/3);switch(s){case"Q":return String(a);case"QQ":return wt(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,s,r){var a=Math.ceil((e.getUTCMonth()+1)/3);switch(s){case"q":return String(a);case"qq":return wt(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,s,r){var a=e.getUTCMonth();switch(s){case"M":case"MM":return Ba.M(e,s);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,s,r){var a=e.getUTCMonth();switch(s){case"L":return String(a+1);case"LL":return wt(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,s,r,a){var i=LM(e,a);return s==="wo"?r.ordinalNumber(i,{unit:"week"}):wt(i,s.length)},I:function(e,s,r){var a=MM(e);return s==="Io"?r.ordinalNumber(a,{unit:"week"}):wt(a,s.length)},d:function(e,s,r){return s==="do"?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):Ba.d(e,s)},D:function(e,s,r){var a=OM(e);return s==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):wt(a,s.length)},E:function(e,s,r){var a=e.getUTCDay();switch(s){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,s,r,a){var i=e.getUTCDay(),l=(i-a.weekStartsOn+8)%7||7;switch(s){case"e":return String(l);case"ee":return wt(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,s,r,a){var i=e.getUTCDay(),l=(i-a.weekStartsOn+8)%7||7;switch(s){case"c":return String(l);case"cc":return wt(l,s.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,s,r){var a=e.getUTCDay(),i=a===0?7:a;switch(s){case"i":return String(i);case"ii":return wt(i,s.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,s,r){var a=e.getUTCHours(),i=a/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,s,r){var a=e.getUTCHours(),i;switch(a===12?i=di.noon:a===0?i=di.midnight:i=a/12>=1?"pm":"am",s){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,s,r){var a=e.getUTCHours(),i;switch(a>=17?i=di.evening:a>=12?i=di.afternoon:a>=4?i=di.morning:i=di.night,s){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,s,r){if(s==="ho"){var a=e.getUTCHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Ba.h(e,s)},H:function(e,s,r){return s==="Ho"?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):Ba.H(e,s)},K:function(e,s,r){var a=e.getUTCHours()%12;return s==="Ko"?r.ordinalNumber(a,{unit:"hour"}):wt(a,s.length)},k:function(e,s,r){var a=e.getUTCHours();return a===0&&(a=24),s==="ko"?r.ordinalNumber(a,{unit:"hour"}):wt(a,s.length)},m:function(e,s,r){return s==="mo"?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):Ba.m(e,s)},s:function(e,s,r){return s==="so"?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):Ba.s(e,s)},S:function(e,s){return Ba.S(e,s)},X:function(e,s,r,a){var i=a._originalDate||e,l=i.getTimezoneOffset();if(l===0)return"Z";switch(s){case"X":return Jx(l);case"XXXX":case"XX":return vn(l);case"XXXXX":case"XXX":default:return vn(l,":")}},x:function(e,s,r,a){var i=a._originalDate||e,l=i.getTimezoneOffset();switch(s){case"x":return Jx(l);case"xxxx":case"xx":return vn(l);case"xxxxx":case"xxx":default:return vn(l,":")}},O:function(e,s,r,a){var i=a._originalDate||e,l=i.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Kx(l,":");case"OOOO":default:return"GMT"+vn(l,":")}},z:function(e,s,r,a){var i=a._originalDate||e,l=i.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Kx(l,":");case"zzzz":default:return"GMT"+vn(l,":")}},t:function(e,s,r,a){var i=a._originalDate||e,l=Math.floor(i.getTime()/1e3);return wt(l,s.length)},T:function(e,s,r,a){var i=a._originalDate||e,l=i.getTime();return wt(l,s.length)}};function Kx(t,e){var s=t>0?"-":"+",r=Math.abs(t),a=Math.floor(r/60),i=r%60;if(i===0)return s+String(a);var l=e||"";return s+String(a)+l+wt(i,2)}function Jx(t,e){if(t%60===0){var s=t>0?"-":"+";return s+wt(Math.abs(t)/60,2)}return vn(t,e)}function vn(t,e){var s=e||"",r=t>0?"-":"+",a=Math.abs(t),i=wt(Math.floor(a/60),2),l=wt(a%60,2);return r+i+s+l}const $M=UM;var Zx=function(e,s){switch(e){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Oy=function(e,s){switch(e){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},WM=function(e,s){var r=e.match(/(P+)(p+)?/)||[],a=r[1],i=r[2];if(!i)return Zx(e,s);var l;switch(a){case"P":l=s.dateTime({width:"short"});break;case"PP":l=s.dateTime({width:"medium"});break;case"PPP":l=s.dateTime({width:"long"});break;case"PPPP":default:l=s.dateTime({width:"full"});break}return l.replace("{{date}}",Zx(a,s)).replace("{{time}}",Oy(i,s))},VM={p:Oy,P:WM};const zM=VM;var HM=["D","DD"],GM=["YY","YYYY"];function XM(t){return HM.indexOf(t)!==-1}function qM(t){return GM.indexOf(t)!==-1}function Qx(t,e,s){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var YM={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},KM=function(e,s,r){var a,i=YM[e];return typeof i=="string"?a=i:s===1?a=i.one:a=i.other.replace("{{count}}",s.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};const JM=KM;function N0(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=e.width?String(e.width):t.defaultWidth,r=t.formats[s]||t.formats[t.defaultWidth];return r}}var ZM={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},QM={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},eR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},tR={date:N0({formats:ZM,defaultWidth:"full"}),time:N0({formats:QM,defaultWidth:"full"}),dateTime:N0({formats:eR,defaultWidth:"full"})};const sR=tR;var rR={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},aR=function(e,s,r,a){return rR[e]};const nR=aR;function Qi(t){return function(e,s){var r=s!=null&&s.context?String(s.context):"standalone",a;if(r==="formatting"&&t.formattingValues){var i=t.defaultFormattingWidth||t.defaultWidth,l=s!=null&&s.width?String(s.width):i;a=t.formattingValues[l]||t.formattingValues[i]}else{var c=t.defaultWidth,o=s!=null&&s.width?String(s.width):t.defaultWidth;a=t.values[o]||t.values[c]}var d=t.argumentCallback?t.argumentCallback(e):e;return a[d]}}var iR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},lR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},cR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},oR={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},fR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},uR=function(e,s){var r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},hR={ordinalNumber:uR,era:Qi({values:iR,defaultWidth:"wide"}),quarter:Qi({values:lR,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Qi({values:cR,defaultWidth:"wide"}),day:Qi({values:oR,defaultWidth:"wide"}),dayPeriod:Qi({values:dR,defaultWidth:"wide",formattingValues:fR,defaultFormattingWidth:"wide"})};const mR=hR;function el(t){return function(e){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=s.width,a=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;var l=i[0],c=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],o=Array.isArray(c)?pR(c,function(u){return u.test(l)}):xR(c,function(u){return u.test(l)}),d;d=t.valueCallback?t.valueCallback(o):o,d=s.valueCallback?s.valueCallback(d):d;var f=e.slice(l.length);return{value:d,rest:f}}}function xR(t,e){for(var s in t)if(t.hasOwnProperty(s)&&e(t[s]))return s}function pR(t,e){for(var s=0;s<t.length;s++)if(e(t[s]))return s}function gR(t){return function(e){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.match(t.matchPattern);if(!r)return null;var a=r[0],i=e.match(t.parsePattern);if(!i)return null;var l=t.valueCallback?t.valueCallback(i[0]):i[0];l=s.valueCallback?s.valueCallback(l):l;var c=e.slice(a.length);return{value:l,rest:c}}}var vR=/^(\d+)(th|st|nd|rd)?/i,yR=/\d+/i,bR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_R={any:[/^b/i,/^(a|c)/i]},wR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},NR={any:[/1/i,/2/i,/3/i,/4/i]},jR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},kR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},SR={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ER={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},TR={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},CR={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},AR={ordinalNumber:gR({matchPattern:vR,parsePattern:yR,valueCallback:function(e){return parseInt(e,10)}}),era:el({matchPatterns:bR,defaultMatchWidth:"wide",parsePatterns:_R,defaultParseWidth:"any"}),quarter:el({matchPatterns:wR,defaultMatchWidth:"wide",parsePatterns:NR,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:el({matchPatterns:jR,defaultMatchWidth:"wide",parsePatterns:kR,defaultParseWidth:"any"}),day:el({matchPatterns:SR,defaultMatchWidth:"wide",parsePatterns:ER,defaultParseWidth:"any"}),dayPeriod:el({matchPatterns:TR,defaultMatchWidth:"any",parsePatterns:CR,defaultParseWidth:"any"})};const FR=AR;var OR={code:"en-US",formatDistance:JM,formatLong:sR,formatRelative:nR,localize:mR,match:FR,options:{weekStartsOn:0,firstWeekContainsDate:1}};const DR=OR;var PR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,MR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,RR=/^'([^]*?)'?$/,IR=/''/g,LR=/[a-zA-Z]/;function $c(t,e,s){var r,a,i,l,c,o,d,f,u,h,x,m,p,v,b,_,g,j;Zs(2,arguments);var w=String(e),k=Td(),y=(r=(a=s==null?void 0:s.locale)!==null&&a!==void 0?a:k.locale)!==null&&r!==void 0?r:DR,N=zn((i=(l=(c=(o=s==null?void 0:s.firstWeekContainsDate)!==null&&o!==void 0?o:s==null||(d=s.locale)===null||d===void 0||(f=d.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&c!==void 0?c:k.firstWeekContainsDate)!==null&&l!==void 0?l:(u=k.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(N>=1&&N<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var S=zn((x=(m=(p=(v=s==null?void 0:s.weekStartsOn)!==null&&v!==void 0?v:s==null||(b=s.locale)===null||b===void 0||(_=b.options)===null||_===void 0?void 0:_.weekStartsOn)!==null&&p!==void 0?p:k.weekStartsOn)!==null&&m!==void 0?m:(g=k.locale)===null||g===void 0||(j=g.options)===null||j===void 0?void 0:j.weekStartsOn)!==null&&x!==void 0?x:0);if(!(S>=0&&S<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!y.localize)throw new RangeError("locale must contain localize property");if(!y.formatLong)throw new RangeError("locale must contain formatLong property");var T=ua(t);if(!CM(T))throw new RangeError("Invalid time value");var E=EM(T),A=AM(T,E),H={firstWeekContainsDate:N,weekStartsOn:S,locale:y,_originalDate:T},V=w.match(MR).map(function(L){var P=L[0];if(P==="p"||P==="P"){var J=zM[P];return J(L,y.formatLong)}return L}).join("").match(PR).map(function(L){if(L==="''")return"'";var P=L[0];if(P==="'")return BR(L);var J=$M[P];if(J)return!(s!=null&&s.useAdditionalWeekYearTokens)&&qM(L)&&Qx(L,e,String(t)),!(s!=null&&s.useAdditionalDayOfYearTokens)&&XM(L)&&Qx(L,e,String(t)),J(A,L,y.localize,H);if(P.match(LR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+P+"`");return L}).join("");return V}function BR(t){var e=t.match(RR);return e?e[1].replace(IR,"'"):t}const UR=()=>{const{user:t}=ge(g=>g.auth),{subjects:e}=ge(g=>g.subjects),{classes:s}=ge(g=>g.classes),{users:r}=ge(g=>g.users),a=vt(),[i,l]=G.useState(""),[c,o]=G.useState({subject_id:"",class_id:"",teacher_id:"",exam_type:"",date_from:"",date_to:"",format:"pdf"}),[d,f]=G.useState(!1);G.useEffect(()=>{a(It()),a(ir()),a(gs()),u()},[a]);const u=async()=>{try{const g=await gi.getTemplates();console.log("Report templates loaded:",g)}catch(g){console.error("Failed to load report templates:",g)}},h=[{id:"student_performance",name:"Student Performance Report",description:"Individual student performance analysis with CO/PO mapping",icon:Ct,filters:["class_id","subject_id","exam_type","date_from","date_to"],category:"Student Analytics"},{id:"class_analytics",name:"Class Analytics Report",description:"Comprehensive class performance with statistical analysis",icon:rs,filters:["class_id","subject_id","exam_type"],category:"Class Analytics"},{id:"co_po_attainment",name:"CO/PO Attainment Report",description:"Course and Program Outcomes attainment analysis",icon:Mt,filters:["subject_id","class_id","exam_type"],category:"Attainment Analysis"},{id:"exam_analysis",name:"Exam Analysis Report",description:"Detailed exam performance and question analysis",icon:Fr,filters:["exam_id","subject_id"],category:"Exam Analytics"},{id:"comprehensive_analysis",name:"Comprehensive Analysis Report",description:"Complete analysis with all metrics and insights",icon:rs,filters:["class_id","subject_id","exam_type"],category:"Comprehensive Analytics"},{id:"custom_analysis",name:"Custom Analysis Report",description:"Customizable analysis based on specific criteria",icon:uo,filters:["class_id","subject_id","exam_type","date_from","date_to"],category:"Custom Analytics"},{id:"detailed_co_analysis",name:"Detailed CO Analysis Report",description:"Comprehensive Course Outcome analysis with trends, gaps, and recommendations",icon:Rt,filters:["subject_id","exam_type"],category:"CO-PO Analysis"},{id:"detailed_po_analysis",name:"Detailed PO Analysis Report",description:"Comprehensive Program Outcome analysis with dependency mapping",icon:fo,filters:["subject_id","exam_type"],category:"CO-PO Analysis"},{id:"co_po_mapping_analysis",name:"CO-PO Mapping Analysis Report",description:"Analysis of CO-PO relationships and mapping effectiveness",icon:rp,filters:["subject_id","class_id"],category:"CO-PO Analysis"},{id:"comprehensive_co_po_report",name:"Comprehensive CO-PO Report",description:"Complete CO-PO analysis with all metrics, trends, and strategic insights",icon:ba,filters:["subject_id","class_id","exam_type"],category:"CO-PO Analysis"},{id:"department_performance",name:"Department Performance Report",description:"Overall department performance and key metrics",icon:Sr,filters:["date_from","date_to"],category:"Department Analytics"},{id:"teacher_effectiveness",name:"Teacher Effectiveness Report",description:"Faculty performance evaluation and effectiveness analysis",icon:gt,filters:["teacher_id","subject_id","date_from","date_to"],category:"Faculty Analytics"},{id:"student_progress_tracking",name:"Student Progress Tracking Report",description:"Long-term student progress and improvement tracking",icon:Pt,filters:["class_id","subject_id","date_from","date_to"],category:"Student Analytics"},{id:"attainment_gap_analysis",name:"Attainment Gap Analysis Report",description:"Analysis of gaps in CO/PO attainment and improvement areas",icon:Rt,filters:["subject_id","class_id","exam_type"],category:"Attainment Analysis"},{id:"strategic_planning",name:"Strategic Planning Report",description:"Strategic insights for department planning and development",icon:ba,filters:["date_from","date_to"],category:"Strategic Analytics"},{id:"comparative_analysis",name:"Comparative Analysis Report",description:"Comparative analysis across classes, subjects, and time periods",icon:rs,filters:["class_id","subject_id","exam_type","date_from","date_to"],category:"Comparative Analytics"},{id:"accreditation_report",name:"Accreditation Report",description:"NBA accreditation ready reports with all required metrics",icon:Mt,filters:["class_id","date_from","date_to"],category:"Accreditation"},{id:"resource_utilization",name:"Resource Utilization Report",description:"Analysis of resource utilization and efficiency metrics",icon:k0,filters:["date_from","date_to"],category:"Resource Analytics"}],x=s.filter(g=>g.department_id===(t==null?void 0:t.department_id)),m=e.filter(g=>!!x.find(w=>w.id===g.class_id)),p=r.filter(g=>g.role==="teacher"&&g.department_id===(t==null?void 0:t.department_id)),v=async()=>{var g,j;if(!i){Ue.error("Please select a report type");return}if((i.includes("co")||i.includes("po"))&&!c.subject_id){Ue.error("Please select a subject for CO/PO analysis reports");return}f(!0);try{const w=await gi.generateReport(i,{...c,department_id:t==null?void 0:t.department_id},c.format),k=new Blob([w],{type:c.format==="pdf"?"application/pdf":c.format==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv"}),y=window.URL.createObjectURL(k),N=document.createElement("a");N.href=y,N.download=`${i}_${$c(new Date,"yyyy-MM-dd")}.${c.format}`,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(y),Ue.success("Report generated successfully!")}catch(w){console.error("Report generation error:",w),Ue.error(((j=(g=w.response)==null?void 0:g.data)==null?void 0:j.detail)||w.message||"Failed to generate report")}finally{f(!1)}},b=async(g,j={})=>{var w,k;f(!0);try{const N=e.filter(H=>{var V;return H.class_id&&((V=s.find(L=>L.id===H.class_id))==null?void 0:V.department_id)===(t==null?void 0:t.department_id)})[0];if(!N&&(g.includes("co")||g.includes("po"))){Ue.error("No subjects available for CO/PO analysis. Please add subjects first."),f(!1);return}const S=await gi.generateReport(g,{...j,department_id:t==null?void 0:t.department_id,subject_id:(N==null?void 0:N.id)||j.subject_id},"pdf"),T=new Blob([S],{type:"application/pdf"}),E=window.URL.createObjectURL(T),A=document.createElement("a");A.href=E,A.download=`${g}_${$c(new Date,"yyyy-MM-dd")}.pdf`,document.body.appendChild(A),A.click(),document.body.removeChild(A),window.URL.revokeObjectURL(E),Ue.success("Quick report generated successfully!")}catch(y){console.error("Quick report generation error:",y),Ue.error(((k=(w=y.response)==null?void 0:w.data)==null?void 0:k.detail)||y.message||"Failed to generate report")}finally{f(!1)}},_=h.find(g=>g.id===i);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reports & Analytics"}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("span",{className:"text-sm text-gray-500",children:"Export Format:"}),n.jsxs("select",{value:c.format,onChange:g=>o({...c,format:g.target.value}),className:"input-field",children:[n.jsx("option",{value:"pdf",children:"PDF"}),n.jsx("option",{value:"excel",children:"Excel"}),n.jsx("option",{value:"csv",children:"CSV"})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Reports"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[n.jsxs("button",{onClick:()=>b("detailed_co_analysis"),disabled:d,className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[n.jsx(Rt,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Detailed CO Analysis"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Course Outcomes"})]}),n.jsxs("button",{onClick:()=>b("detailed_po_analysis"),disabled:d,className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[n.jsx(fo,{className:"h-8 w-8 text-purple-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Detailed PO Analysis"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Program Outcomes"})]}),n.jsxs("button",{onClick:()=>b("comprehensive_co_po_report"),disabled:d,className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[n.jsx(ba,{className:"h-8 w-8 text-indigo-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Comprehensive CO-PO"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Complete analysis"})]}),n.jsxs("button",{onClick:()=>b("department_performance"),disabled:d,className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[n.jsx(Sr,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Department Performance"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Overall metrics"})]}),n.jsxs("button",{onClick:()=>b("teacher_effectiveness"),disabled:d,className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[n.jsx(gt,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Faculty Effectiveness"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Teaching evaluation"})]}),n.jsxs("button",{onClick:()=>b("accreditation_report"),disabled:d,className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[n.jsx(Mt,{className:"h-8 w-8 text-purple-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Accreditation Report"}),n.jsx("p",{className:"text-xs text-gray-600",children:"NBA compliance"})]}),n.jsxs("button",{onClick:()=>b("strategic_planning"),disabled:d,className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[n.jsx(ba,{className:"h-8 w-8 text-orange-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Strategic Planning"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Department insights"})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Custom Report Generation"}),Object.entries(h.reduce((g,j)=>{const w=j.category||"Other";return g[w]||(g[w]=[]),g[w].push(j),g},{})).map(([g,j])=>n.jsxs("div",{className:"mb-8",children:[n.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4 border-b border-gray-200 pb-2",children:g}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:j.map(w=>{const k=w.icon;return n.jsxs("button",{onClick:()=>l(w.id),className:`p-4 border-2 rounded-lg text-left transition-all ${i===w.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[n.jsx(k,{className:`h-6 w-6 ${i===w.id?"text-primary-600":"text-gray-600"}`}),n.jsx("h4",{className:"font-medium text-gray-900",children:w.name})]}),n.jsx("p",{className:"text-sm text-gray-600",children:w.description})]},w.id)})})]},g)),_&&n.jsxs("div",{className:"border-t pt-6",children:[n.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[n.jsx(uo,{className:"h-5 w-5 text-gray-600"}),n.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Report Filters"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[_.filters.includes("class_id")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),n.jsxs("select",{value:c.class_id,onChange:g=>o({...c,class_id:g.target.value}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"All Classes"}),x.map(g=>n.jsx("option",{value:g.id,children:g.name},g.id))]})]}),_.filters.includes("subject_id")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),n.jsxs("select",{value:c.subject_id,onChange:g=>o({...c,subject_id:g.target.value}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"All Subjects"}),m.map(g=>n.jsxs("option",{value:g.id,children:[g.name," (",g.code,")"]},g.id))]})]}),_.filters.includes("teacher_id")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher"}),n.jsxs("select",{value:c.teacher_id,onChange:g=>o({...c,teacher_id:g.target.value}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"All Teachers"}),p.map(g=>n.jsxs("option",{value:g.id,children:[g.first_name," ",g.last_name]},g.id))]})]}),_.filters.includes("exam_type")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Type"}),n.jsxs("select",{value:c.exam_type,onChange:g=>o({...c,exam_type:g.target.value}),className:"input-field w-full",children:[n.jsx("option",{value:"",children:"All Exams"}),n.jsx("option",{value:"internal1",children:"Internal 1"}),n.jsx("option",{value:"internal2",children:"Internal 2"}),n.jsx("option",{value:"final",children:"Final Exam"})]})]}),_.filters.includes("date_from")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),n.jsx("input",{type:"date",value:c.date_from,onChange:g=>o({...c,date_from:g.target.value}),className:"input-field w-full"})]}),_.filters.includes("date_to")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),n.jsx("input",{type:"date",value:c.date_to,onChange:g=>o({...c,date_to:g.target.value}),className:"input-field w-full"})]})]}),n.jsx("div",{className:"mt-6 flex justify-end",children:n.jsxs("button",{onClick:v,disabled:d,className:"btn-primary flex items-center space-x-2 disabled:opacity-50",children:[d?n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):n.jsx(kr,{size:18}),n.jsx("span",{children:d?"Generating...":"Generate Report"})]})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Saved Report Templates"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Fr,{className:"h-5 w-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:"NBA Accreditation Package"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Complete documentation for NBA submission"})]})]}),n.jsx("button",{onClick:()=>b("nba_compliance"),disabled:d,className:"btn-secondary text-sm disabled:opacity-50",children:d?"Generating...":"Generate"})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(rs,{className:"h-5 w-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:"Monthly Performance Dashboard"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Executive summary for leadership review"})]})]}),n.jsx("button",{onClick:()=>b("department_summary"),disabled:d,className:"btn-secondary text-sm disabled:opacity-50",children:d?"Generating...":"Generate"})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Mt,{className:"h-5 w-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:"Faculty Assessment Report"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Teaching effectiveness evaluation"})]})]}),n.jsx("button",{onClick:()=>b("teacher_performance"),disabled:d,className:"btn-secondary text-sm disabled:opacity-50",children:d?"Generating...":"Generate"})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Reports"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-blue-100 p-2 rounded",children:n.jsx(Fr,{className:"h-4 w-4 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:"Student Performance Report"}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Generated on ",$c(new Date,"MMM dd, yyyy")]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm text-green-600",children:"PDF"}),n.jsx("button",{className:"text-primary-600 hover:text-primary-700",children:n.jsx(kr,{size:16})})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-green-100 p-2 rounded",children:n.jsx(Mt,{className:"h-4 w-4 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900",children:"CO/PO Attainment Report"}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Generated on ",$c(new Date(Date.now()-864e5),"MMM dd, yyyy")]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm text-blue-600",children:"Excel"}),n.jsx("button",{className:"text-primary-600 hover:text-primary-700",children:n.jsx(kr,{size:16})})]})]})]})]})]})};fa.register(Ca,Aa,na,ra,Pn,ti,si,ei,Rr,kn);const $R=()=>{var E,A,H,V,L,P,J,Ee,Y,de,De,B,X,W,z,ae,me,xe,ue,oe,ze,F,ye,Ie,Le,K,Z,Oe,Te,M,q,Q,_e,ve,fe,Fe,rt,Ze,St,Ke,ct,cs,yt,ee,je,Ae,$e,Ve,Xe,ot,qe,ys,Ut,os,ds,bs;const t=vt(),{loading:e}=ge(pe=>pe.analytics),{user:s}=ge(pe=>pe.auth),{departments:r}=ge(pe=>pe.departments);ge(pe=>pe.users),ge(pe=>pe.subjects);const[a,i]=G.useState("departmental_intelligence"),[l,c]=G.useState(null),[o,d]=G.useState(!1),[f,u]=G.useState(null);G.useEffect(()=>{s!=null&&s.department_id&&(t(bi(s.department_id)),h(s.department_id)),t(Lr()),t(gs()),t(It())},[t,s]);const h=async pe=>{try{d(!0),u(null);const dt=await Qr.getStrategicDashboardData(pe);c(dt)}catch(dt){console.error("Error fetching strategic dashboard data:",dt),u("Failed to load strategic dashboard data")}finally{d(!1)}},x=r.find(pe=>pe.id===(s==null?void 0:s.department_id));if(e||o)return n.jsx("div",{className:"flex items-center justify-center min-h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})});if(f)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Cs,{className:"h-12 w-12 text-red-300 mx-auto mb-3"}),n.jsx("p",{className:"text-red-500 mb-2",children:"Error loading strategic dashboard"}),n.jsx("p",{className:"text-sm text-gray-400",children:f}),n.jsx("button",{onClick:()=>(s==null?void 0:s.department_id)&&h(s.department_id),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]});if(!l)return n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Sr,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:"No strategic dashboard data available"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Department data will appear once exams are conducted"})]});const m=l==null?void 0:l.departmental_intelligence,p=l==null?void 0:l.strategic_performance,v=l==null?void 0:l.risk_management,b=l==null?void 0:l.faculty_development,_=pe=>{switch(pe){case"success":return"text-green-600 bg-green-100";case"warning":return"text-yellow-600 bg-yellow-100";case"error":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},g=pe=>{switch(pe){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},j=pe=>{switch(pe){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},w=pe=>{switch(pe){case"up":return n.jsx(gb,{className:"h-4 w-4 text-green-500"});case"down":return n.jsx(pb,{className:"h-4 w-4 text-red-500"});default:return n.jsx(xb,{className:"h-4 w-4 text-gray-500"})}},k=pe=>{switch(pe){case"active":return"text-blue-600 bg-blue-100";case"planned":return"text-yellow-600 bg-yellow-100";case"completed":return"text-green-600 bg-green-100";case"none":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},y={labels:["CO Attainment","PO Attainment","Student Success"],datasets:[{label:"Current Status",data:(E=m==null?void 0:m.compliance_monitoring)!=null&&E.current_status?[m.compliance_monitoring.current_status.co_attainment||0,m.compliance_monitoring.current_status.po_attainment||0,m.compliance_monitoring.current_status.student_success||0]:[0,0,0],backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1},{label:"NBA Thresholds",data:(A=m==null?void 0:m.compliance_monitoring)!=null&&A.nba_thresholds?[m.compliance_monitoring.nba_thresholds.co_attainment||0,m.compliance_monitoring.nba_thresholds.po_attainment||0,m.compliance_monitoring.nba_thresholds.student_success||0]:[0,0,0],backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1}]},N={labels:((H=p==null?void 0:p.longitudinal_trends)==null?void 0:H.map(pe=>pe.semester))||[],datasets:[{label:"Overall Performance",data:((V=p==null?void 0:p.longitudinal_trends)==null?void 0:V.map(pe=>pe.overall_performance))||[],borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0},{label:"CO Attainment",data:((L=p==null?void 0:p.longitudinal_trends)==null?void 0:L.map(pe=>pe.co_attainment))||[],borderColor:"rgba(34, 197, 94, 1)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0},{label:"PO Attainment",data:((P=p==null?void 0:p.longitudinal_trends)==null?void 0:P.map(pe=>pe.po_attainment))||[],borderColor:"rgba(168, 85, 247, 1)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4,fill:!0}]},S={labels:((Ee=(J=p==null?void 0:p.cross_sectional_analysis)==null?void 0:J.class_comparison)==null?void 0:Ee.map(pe=>pe.class))||[],datasets:[{label:"Average Performance",data:((de=(Y=p==null?void 0:p.cross_sectional_analysis)==null?void 0:Y.class_comparison)==null?void 0:de.map(pe=>pe.average_performance))||[],backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1},{label:"CO Attainment",data:((B=(De=p==null?void 0:p.cross_sectional_analysis)==null?void 0:De.class_comparison)==null?void 0:B.map(pe=>pe.co_attainment))||[],backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1},{label:"PO Attainment",data:((W=(X=p==null?void 0:p.cross_sectional_analysis)==null?void 0:X.class_comparison)==null?void 0:W.map(pe=>pe.po_attainment))||[],backgroundColor:"rgba(168, 85, 247, 0.8)",borderColor:"rgba(168, 85, 247, 1)",borderWidth:1}]},T=[{id:"departmental_intelligence",label:"Departmental Intelligence",icon:Sr},{id:"strategic_performance",label:"Strategic Performance",icon:rs},{id:"risk_management",label:"Risk Management",icon:io},{id:"faculty_development",label:"Faculty Development",icon:Ct}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Strategic Dashboard"}),n.jsxs("p",{className:"text-gray-600",children:[x==null?void 0:x.name," - Comprehensive Departmental Intelligence"]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("button",{className:"btn-secondary flex items-center space-x-2",children:[n.jsx(uo,{size:18}),n.jsx("span",{children:"Filter"})]}),n.jsxs("button",{className:"btn-secondary flex items-center space-x-2",children:[n.jsx(kr,{size:18}),n.jsx("span",{children:"Export Report"})]})]})]}),n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("nav",{className:"-mb-px flex space-x-8",children:T.map(pe=>{const dt=pe.icon;return n.jsxs("button",{onClick:()=>i(pe.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${a===pe.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(dt,{size:18}),n.jsx("span",{children:pe.label})]},pe.id)})})}),a==="departmental_intelligence"&&m&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"NBA/NAAC Compliance Monitoring"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[((ae=(z=m==null?void 0:m.compliance_monitoring)==null?void 0:z.compliance_score)==null?void 0:ae.toFixed(1))||0,"%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"Compliance Score"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-green-600 mb-2",children:[((ue=(xe=(me=m==null?void 0:m.compliance_monitoring)==null?void 0:me.current_status)==null?void 0:xe.co_attainment)==null?void 0:ue.toFixed(1))||0,"%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"CO Attainment"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:[((F=(ze=(oe=m==null?void 0:m.compliance_monitoring)==null?void 0:oe.current_status)==null?void 0:ze.po_attainment)==null?void 0:F.toFixed(1))||0,"%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"PO Attainment"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:[((Le=(Ie=(ye=m==null?void 0:m.compliance_monitoring)==null?void 0:ye.current_status)==null?void 0:Ie.student_success)==null?void 0:Le.toFixed(1))||0,"%"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"Student Success"})]})]}),n.jsx("div",{className:"h-80",children:n.jsx(Fa,{data:y,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:100}}}})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"System Alerts"}),n.jsx("div",{className:"space-y-3",children:((Z=(K=m==null?void 0:m.compliance_monitoring)==null?void 0:K.alerts)==null?void 0:Z.map((pe,dt)=>{var Tt;return n.jsxs("div",{className:`flex items-center space-x-3 p-3 rounded-lg ${_(pe.type)}`,children:[n.jsx(Cs,{className:"h-5 w-5"}),n.jsx("div",{className:"flex-1",children:n.jsx("p",{className:"text-sm font-medium",children:pe.message})}),n.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${j(pe.priority)}`,children:(Tt=pe.priority)==null?void 0:Tt.toUpperCase()})]},dt)}))||[]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Subject Performance Ranking"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rank"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Outcome Achievement"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Satisfaction"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Overall Score"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:((Oe=m==null?void 0:m.subject_performance_ranking)==null?void 0:Oe.map((pe,dt)=>{var Tt,zs,_s;return n.jsxs("tr",{children:[n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",dt+1]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:pe.subject}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:pe.teacher}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[((Tt=pe.outcome_achievement)==null?void 0:Tt.toFixed(1))||0,"%"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[((zs=pe.student_satisfaction)==null?void 0:zs.toFixed(1))||0,"%"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[((_s=pe.overall_score)==null?void 0:_s.toFixed(1))||0,"%"]})]},dt)}))||[]})]})})]})]}),a==="strategic_performance"&&p&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Longitudinal Performance Trends"}),n.jsx("div",{className:"h-80",children:n.jsx(Ed,{data:N,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:100}}}})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cross-Sectional Class Analysis"}),n.jsx("div",{className:"h-80",children:n.jsx(Fa,{data:S,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:100}}}})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Exam Difficulty Calibration"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[((M=(Te=p==null?void 0:p.exam_difficulty_calibration)==null?void 0:Te.calibration_score)==null?void 0:M.toFixed(1))||0,"%"]}),n.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Calibration Score"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Easy Questions"}),n.jsxs("span",{children:[((_e=(Q=(q=p==null?void 0:p.exam_difficulty_calibration)==null?void 0:q.difficulty_distribution)==null?void 0:Q.easy)==null?void 0:_e.toFixed(1))||0,"%"]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Medium Questions"}),n.jsxs("span",{children:[((Fe=(fe=(ve=p==null?void 0:p.exam_difficulty_calibration)==null?void 0:ve.difficulty_distribution)==null?void 0:fe.medium)==null?void 0:Fe.toFixed(1))||0,"%"]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Hard Questions"}),n.jsxs("span",{children:[((St=(Ze=(rt=p==null?void 0:p.exam_difficulty_calibration)==null?void 0:rt.difficulty_distribution)==null?void 0:Ze.hard)==null?void 0:St.toFixed(1))||0,"%"]})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Recommendations"}),n.jsx("ul",{className:"space-y-1 text-sm text-gray-600",children:((ct=(Ke=p==null?void 0:p.exam_difficulty_calibration)==null?void 0:Ke.recommendations)==null?void 0:ct.map((pe,dt)=>n.jsxs("li",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),n.jsx("span",{children:pe})]},dt)))||[]})]})]})]})]}),a==="risk_management"&&v&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:n.jsx(Ot,{className:"h-6 w-6 text-green-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Success Rate"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[((yt=(cs=v==null?void 0:v.success_prediction)==null?void 0:cs.overall_success_rate)==null?void 0:yt.toFixed(1))||0,"%"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:n.jsx(ia,{className:"h-6 w-6 text-blue-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Graduation Rate"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[((je=(ee=v==null?void 0:v.success_prediction)==null?void 0:ee.predicted_graduation_rate)==null?void 0:je.toFixed(1))||0,"%"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:n.jsx(Cs,{className:"h-6 w-6 text-yellow-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"At-Risk Students"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[(($e=(Ae=v==null?void 0:v.success_prediction)==null?void 0:Ae.at_risk_percentage)==null?void 0:$e.toFixed(1))||0,"%"]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:n.jsx(mb,{className:"h-6 w-6 text-purple-600"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Intervention Effectiveness"}),n.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[((Xe=(Ve=v==null?void 0:v.success_prediction)==null?void 0:Ve.intervention_effectiveness)==null?void 0:Xe.toFixed(1))||0,"%"]})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"At-Risk Student Pipeline"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Risk Level"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Predicted Outcome"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Intervention Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Risk Factors"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:((ot=v==null?void 0:v.at_risk_student_pipeline)==null?void 0:ot.map(pe=>{var dt,Tt,zs,_s;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:pe.student_name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:pe.class}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g(pe.risk_level)}`,children:(dt=pe.risk_level)==null?void 0:dt.toUpperCase()})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[((Tt=pe.predicted_outcome)==null?void 0:Tt.toFixed(1))||0,"%"]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${k(pe.intervention_status)}`,children:(zs=pe.intervention_status)==null?void 0:zs.toUpperCase()})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((_s=pe.risk_factors)==null?void 0:_s.join(", "))||"N/A"})]},pe.student_id)}))||[]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Remedial Planning"}),n.jsx("div",{className:"space-y-4",children:((qe=v==null?void 0:v.remedial_planning)==null?void 0:qe.map((pe,dt)=>{var Tt,zs,_s;return n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:pe.area}),n.jsxs("span",{className:"text-sm text-gray-500",children:["Timeline: ",pe.timeline]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-3",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Affected Students:"}),n.jsx("span",{className:"ml-2 font-medium",children:pe.affected_students})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Current Performance:"}),n.jsxs("span",{className:"ml-2 font-medium",children:[((Tt=pe.current_performance)==null?void 0:Tt.toFixed(1))||0,"%"]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Target Performance:"}),n.jsxs("span",{className:"ml-2 font-medium",children:[((zs=pe.target_performance)==null?void 0:zs.toFixed(1))||0,"%"]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Expected Outcome:"}),n.jsxs("span",{className:"ml-2 font-medium",children:[((_s=pe.expected_outcome)==null?void 0:_s.toFixed(1))||0,"%"]})]})]}),n.jsx("p",{className:"text-sm text-gray-600",children:pe.intervention_strategy})]},dt)}))||[]})]})]}),a==="faculty_development"&&(m||b)&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Faculty Effectiveness Metrics"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subjects Taught"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Outcome Achievement"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Satisfaction"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trend"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Effectiveness Score"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:((ys=(m==null?void 0:m.faculty_effectiveness_metrics)||(b==null?void 0:b.faculty_effectiveness_metrics))==null?void 0:ys.map((pe,dt)=>{var Tt,zs,_s;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:pe.teacher}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:pe.subjects_taught}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[((Tt=pe.average_outcome_achievement)==null?void 0:Tt.toFixed(1))||0,"%"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[((zs=pe.student_satisfaction)==null?void 0:zs.toFixed(1))||0,"%"]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 flex items-center",children:w(pe.improvement_trend)}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[((_s=pe.effectiveness_score)==null?void 0:_s.toFixed(1))||0,"%"]})]},dt)}))||[]})]})})]}),v&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Resource Allocation"}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Faculty Workload"}),n.jsx("div",{className:"space-y-3",children:((os=(Ut=v==null?void 0:v.resource_allocation)==null?void 0:Ut.faculty_workload)==null?void 0:os.map((pe,dt)=>{var Tt;return n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm font-medium text-gray-900",children:pe.teacher}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("span",{className:"text-sm text-gray-600",children:[pe.current_load,"/",pe.max_capacity," hours"]}),n.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full ${pe.utilization_percentage>90?"bg-red-500":pe.utilization_percentage>75?"bg-yellow-500":"bg-green-500"}`,style:{width:`${pe.utilization_percentage}%`}})}),n.jsxs("span",{className:"text-sm text-gray-600",children:[((Tt=pe.utilization_percentage)==null?void 0:Tt.toFixed(1))||0,"%"]})]})]},dt)}))||[]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Resource Requirements"}),n.jsx("div",{className:"space-y-3",children:((bs=(ds=v==null?void 0:v.resource_allocation)==null?void 0:ds.resource_requirements)==null?void 0:bs.map((pe,dt)=>{var Tt;return n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm font-medium text-gray-900",children:pe.resource}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("span",{className:"text-sm text-gray-600",children:[pe.current_availability,"/",pe.required_amount]}),n.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${j(pe.priority)}`,children:(Tt=pe.priority)==null?void 0:Tt.toUpperCase()})]})]},dt)}))||[]})]})]})]})]})]})};function WR(){const t=vt(),{user:e,isAuthenticated:s,loading:r}=ge(a=>a.auth);return G.useEffect(()=>{t(fw()),localStorage.getItem("token")&&t(Xc())},[t]),console.log("Auth state:",{user:e,isAuthenticated:s,loading:r}),r?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-primary-600 border-t-transparent"})}):s?n.jsx(hw,{children:n.jsxs(nN,{children:[n.jsx(mw,{}),n.jsx(xw,{}),n.jsxs(zy,{children:[n.jsx(Ft,{path:"/",element:n.jsx(sN,{})}),n.jsx(Ft,{path:"/admin/departments",element:n.jsx(qt,{allowedRoles:["admin","hod"],children:n.jsx(lN,{})})}),n.jsx(Ft,{path:"/admin/classes",element:n.jsx(qt,{allowedRoles:["admin","hod"],children:n.jsx(oN,{})})}),n.jsx(Ft,{path:"/admin/subjects",element:n.jsx(qt,{allowedRoles:["admin","hod"],children:n.jsx(fN,{})})}),n.jsx(Ft,{path:"/admin/users",element:n.jsx(qt,{allowedRoles:["admin","hod"],children:n.jsx(hN,{})})}),n.jsx(Ft,{path:"/admin/co-management",element:n.jsx(qt,{allowedRoles:["admin","hod"],children:n.jsx(NN,{})})}),n.jsx(Ft,{path:"/admin/po-management",element:n.jsx(qt,{allowedRoles:["admin","hod"],children:n.jsx(jN,{})})}),n.jsx(Ft,{path:"/admin/co-targets",element:n.jsx(qt,{allowedRoles:["admin","hod","teacher"],children:n.jsx(kN,{})})}),n.jsx(Ft,{path:"/teacher/exam-config",element:n.jsx(qt,{allowedRoles:["teacher"],children:n.jsx(TN,{})})}),n.jsx(Ft,{path:"/teacher/marks-entry",element:n.jsx(qt,{allowedRoles:["teacher"],children:n.jsx(OO,{})})}),n.jsx(Ft,{path:"/teacher/analytics",element:n.jsx(qt,{allowedRoles:["teacher"],children:n.jsx(fM,{})})}),n.jsx(Ft,{path:"/teacher/attainment-analytics",element:n.jsx(qt,{allowedRoles:["teacher"],children:n.jsx(uM,{})})}),n.jsx(Ft,{path:"/teacher/comprehensive-analytics",element:n.jsx(qt,{allowedRoles:["teacher"],children:n.jsx(xM,{})})}),n.jsx(Ft,{path:"/teacher/reports",element:n.jsx(qt,{allowedRoles:["teacher"],children:n.jsx(pM,{})})}),n.jsx(Ft,{path:"/student/analytics",element:n.jsx(qt,{allowedRoles:["student"],children:n.jsx(gM,{})})}),n.jsx(Ft,{path:"/student/progress",element:n.jsx(qt,{allowedRoles:["student"],children:n.jsx(vM,{})})}),n.jsx(Ft,{path:"/hod/analytics",element:n.jsx(qt,{allowedRoles:["hod","admin"],children:n.jsx(yM,{})})}),n.jsx(Ft,{path:"/hod/reports",element:n.jsx(qt,{allowedRoles:["hod","admin"],children:n.jsx(UR,{})})}),n.jsx(Ft,{path:"/hod/strategic-dashboard",element:n.jsx(qt,{allowedRoles:["hod","admin"],children:n.jsx($R,{})})}),n.jsx(Ft,{path:"/hod/users",element:n.jsx(qt,{allowedRoles:["hod","admin"],children:n.jsx(bM,{})})}),n.jsx(Ft,{path:"/hod/classes",element:n.jsx(qt,{allowedRoles:["hod","admin"],children:n.jsx(_M,{})})}),n.jsx(Ft,{path:"/hod/subjects",element:n.jsx(qt,{allowedRoles:["hod","admin"],children:n.jsx(wM,{})})}),n.jsx(Ft,{path:"/hod/student-analytics",element:n.jsx(qt,{allowedRoles:["hod","admin"],children:n.jsx(NM,{})})}),n.jsx(Ft,{path:"/hod/teacher-analytics",element:n.jsx(qt,{allowedRoles:["hod","admin"],children:n.jsx(jM,{})})}),n.jsx(Ft,{path:"*",element:n.jsx(Hy,{to:"/",replace:!0})})]})]})}):n.jsx(D2,{})}const VR=Uy({reducer:{auth:uw,departments:R2,users:B2,classes:W2,subjects:H2,exams:Q2,marks:ON,analytics:Y2,copo:wN}});"serviceWorker"in navigator?window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(t=>{console.log(" ServiceWorker registration successful:",t.scope),t.addEventListener("updatefound",()=>{const e=t.installing;e&&e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&confirm("New version available! Refresh to update?")&&window.location.reload()})})}).catch(t=>{console.log(" ServiceWorker registration failed:",t)})}):console.log(" ServiceWorker not supported in this browser");E0.createRoot(document.getElementById("root")).render(n.jsx(at.StrictMode,{children:n.jsx($y,{store:VR,children:n.jsxs(Gy,{children:[n.jsx(WR,{}),n.jsx(vb,{position:"top-right"})]})})}));
